<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbec_appo_race_result(경주결과조회)">
	<query id="tbec_appo_race_result_fd001" desc="경주결과조회" fetchSize="10">
		<![CDATA[
			SELECT  /* tbec_appo_race_result_fd001 */
			         B.CD_NM              CD_NM
                    ,D.STND_YEAR          STND_YEAR
                    ,D.MBR_CD             MBR_CD
                    ,D.TMS                TMS
                    ,D.DAY_ORD            DAY_ORD
                    ,D.RACE_NO            RACE_NO
                    ,D.RACE_DGRE_CD       RACE_DGRE_CD
                    ,(SELECT RMK FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00005' AND CD = D.RACE_DGRE_CD) RACE_DGRE_NM
                    ,D.ST_MTHD_CD         ST_MTHD_CD
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00002' AND CD = D.ST_MTHD_CD) ST_MTHD_NM
                    ,D.STRT_TIME          STRT_TIME
                    ,D.RACE_REG_NO_CNT    RACE_REG_NO_CNT
                    ,D.RACE_DIST          RACE_DIST
                    ,D.TURN_CNT           TURN_CNT
                    ,D.ANTC_DESC          ANTC_DESC
                    ,D.RSLT_DESC          RSLT_DESC
                    ,D.ANTC_RANK          ANTC_RANK
                    ,D.RSLT_RANK          RSLT_RANK
                    ,D.TOT_SALE_AMT       TOT_SALE_AMT
                    ,D.RACE_END_YN        RACE_END_YN
                    ,D.RACE_STTS_CD       RACE_STTS_CD
                    ,D.RACE_STTS2_CD      RACE_STTS2_CD
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00036' AND CD = D.RACE_STTS_CD) RACE_STTS_NM
                    ,D.RACE_STTS_DESC     RACE_STTS_DESC
                    ,D.WEATH_CD           WEATH_CD
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00030' AND CD = D.WEATH_CD) WEATH_NM
                    ,D.TEMPT              TEMPT
                    ,D.WIND_SPD           WIND_SPD
                    ,D.WIND_DIRC_CD       WIND_DIRC_CD
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00031' AND CD = D.WIND_DIRC_CD ) WIND_DIRC_NM
                    ,D.WATER_TEMPT        WATER_TEMPT
                    ,D.WAVE               WAVE
                    ,D.WATER_LVL          WATER_LVL
                    ,D.HUMIDITY           HUMIDITY
                    ,D.DIS_NEED_TIME      DIS_NEED_TIME
                    ,D.MNG                MNG
                    ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = D.MNG) MNG_NM
                    ,D.MNG_FILE_URL       MNG_FILE_URL
                    ,D.REFE_HEAD          REFE_HEAD
                    ,D.REFE_HEAD_FILE_URL REFE_HEAD_FILE_URL
                    ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = D.REFE_HEAD) REFE_HEAD_NM
                    ,D.INSP_CMAN          INSP_CMAN
                    ,D.INSP_CMAN_FILE_URL INSP_CMAN_FILE_URL
                    ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = D.INSP_CMAN) INSP_CMAN_NM
                    ,D.LAPTIME_1          LAPTIME_1
                    ,D.LAPTIME_2          LAPTIME_2
                    ,D.LAPTIME_3          LAPTIME_3
                    ,D.INST_ID            INST_ID
                    ,D.INST_DTM           INST_DTM
                    ,D.UPDT_ID            UPDT_ID
                    ,D.UPDT_DTM           UPDT_DTM       
            FROM    TBEB_CFRNT_METH A,
                    TBEA_SPEC_CD    B, 
                    TBEB_RACE_TMS   C,
                    TBEB_RACE       D
            WHERE A.CFRNT_CD        = C.CFRNT_CD 
              AND B.GRP_CD          ='E00001'
              AND A.RACE_KINDS_CD   = B.CD
              AND A.STND_YEAR       = C.STND_YEAR
                AND D.STND_YEAR     = C.STND_YEAR
              AND D.MBR_CD          = C.MBR_CD
              AND D.TMS             = C.TMS
              AND D.STND_YEAR       = ?
              AND D.MBR_CD          = ?
              AND D.TMS             = ?
              AND D.DAY_ORD         = ?
              AND D.RACE_NO         = ?
		]]>
	</query> 

	<query id="tbec_appo_race_result_fd002" desc="경주결과조회" fetchSize="10">
		<![CDATA[
          SELECT     /*  tbec_appo_race_result_fd002 IWORK_SFR-008 경정 선수편성 메뉴 개선  정번8 까지 추가 수정.  */
          			 B.VOIL_CD      TODAY_VOIL_CD
			        ,C.VOIL_CD      PREV_VOIL_CD
			        ,A.STND_YEAR    STND_YEAR   
			        ,A.MBR_CD       MBR_CD      
			        ,A.TMS          TMS         
			        ,A.DAY_ORD      DAY_ORD     
			        ,A.RACE_NO      RACE_NO     
			        ,A.RACE_REG_NO  RACE_REG_NO 
			        ,A.RACER_NO     RACER_NO
			        ,D.NM_KOR     	RACER_NM   
			        ,A.ABSE_CD      ABSE_CD     
			        ,A.BOAT_NO      BOAT_NO     
			        ,A.MOT_NO       MOT_NO      
			        ,A.RANK         RANK        
			        ,A.RACE_TM      RACE_TM     
			        ,A.TIME_DIFF    TIME_DIFF   
			        ,A.STRATEGY_CD  STRATEGY_CD 
			        ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00063' AND CD = A.STRATEGY_CD ) STRATEGY_NM
			        ,A.ENTRY_COURSE ENTRY_COURSE
			        ,TO_CHAR(A.STAR_TM ,'00.00')      STAR_TM     
			        ,A.RMK          RMK         
			        ,A.INTRO_RUN_TM INTRO_RUN_TM
			        ,A.FLYING_CNT   FLYING_CNT  
			        ,A.LATE_CNT     LATE_CNT    
			        ,A.INST_ID      INST_ID     
			        ,A.INST_DTM     INST_DTM    
			        ,A.UPDT_ID      UPDT_ID     
			        ,A.UPDT_DTM     UPDT_DTM    
			        ,A.IMMT_CLS_CD  IMMT_CLS_CD 
			 FROM   (SELECT  A.STND_YEAR
			                ,A.MBR_CD      
			                ,A.TMS         
			                ,A.DAY_ORD     
			                ,A.RACE_NO     
			                ,A.RACE_REG_NO 
			                ,A.RACER_NO    
			                ,A.ABSE_CD     
			                ,A.BOAT_NO     
			                ,A.MOT_NO      
			                ,A.RANK        
			                ,A.RACE_TM     
			                ,A.TIME_DIFF   
			                ,A.STRATEGY_CD 
			                ,A.ENTRY_COURSE
			                ,A.STAR_TM     
			                ,A.RMK         
			                ,A.INTRO_RUN_TM
			                ,A.FLYING_CNT  
			                ,A.LATE_CNT    
			                ,A.INST_ID     
			                ,A.INST_DTM    
			                ,A.UPDT_ID     
			                ,A.UPDT_DTM    
			                ,A.IMMT_CLS_CD 
			        FROM TBEB_ORGAN         A,
			             TBEB_RACE          B
			        WHERE A.STND_YEAR   = B.STND_YEAR
			          AND A.MBR_CD      = B.MBR_CD
			          AND A.TMS         = B.TMS
			          AND A.DAY_ORD     = B.DAY_ORD
			          AND A.RACE_NO     = B.RACE_NO
			          AND A.STND_YEAR   = ?
			          AND A.MBR_CD      = ?
			          AND A.TMS         = ?
			          AND A.DAY_ORD     = ?
			          AND A.RACE_NO     = ? ) A,
			          (  SELECT STND_YEAR,  --기준년도
			                       MBR_CD,     --경정장코드
			                       TMS,        --회차
			                       DAY_ORD,    --일차
			                       RACE_NO,    --경주번호 
			                       RACE_REG_NO,--정번
			                       RACER_NO,
			                       SUBSTR(MAX(SYS_CONNECT_BY_PATH(VOIL_CD,',')),2) VOIL_CD 
			            FROM (
			                    SELECT STND_YEAR,
			                           MBR_CD,
			                           TMS,
			                           DAY_ORD,
			                           RACE_NO,
			                           RACE_REG_NO,
			                           RACER_NO,
			                           (SELECT CD_NM VOIL_CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00035' AND CD = VOIL_CD) VOIL_CD, 
			                           ROW_NUMBER() OVER (PARTITION BY  STND_YEAR,
			                                                             MBR_CD,
			                                                             TMS,
			                                                             DAY_ORD,
			                                                             RACE_NO,
			                                                             RACE_REG_NO,
			                                                             RACER_NO
			                                              ORDER BY       STND_YEAR,
			                                                             MBR_CD,
			                                                             TMS,
			                                                             DAY_ORD,
			                                                             RACE_NO,
			                                                             RACE_REG_NO,
			                                                             RACER_NO) ROW_ID 
			                         FROM TBED_RACE_VOIL_ACT
			                         WHERE STND_YEAR   = ?
			                           AND MBR_CD      = ?
			                           AND TMS         = ?
			                           AND DAY_ORD     = ?
			                           AND RACE_NO     = ?  
			                   )
			                        START WITH ROW_ID = 1
			                        CONNECT BY PRIOR ROW_ID = ROW_ID -1
			                        AND PRIOR STND_YEAR 	= STND_YEAR
                                    AND PRIOR MBR_CD 		= MBR_CD
                                    AND PRIOR TMS 			= TMS
                                    AND PRIOR DAY_ORD 		= DAY_ORD
                                    AND PRIOR RACE_NO 		= RACE_NO
                                    AND PRIOR RACE_REG_NO 	= RACE_REG_NO 
                                    AND PRIOR RACER_NO      = RACER_NO
			                        GROUP BY STND_YEAR,
			                                 MBR_CD,
			                                 TMS,
			                                 DAY_ORD,
			                                 RACE_NO,
			                                 RACE_REG_NO,
			                                 RACER_NO   ) B,
			          (SELECT     STND_YEAR,
			                      MBR_CD,
			                      TMS,
			                      RACER_NO,
			                      SUBSTR(MAX(SYS_CONNECT_BY_PATH(VOIL_CD,',')),2) VOIL_CD 
			            FROM (
			                    SELECT STND_YEAR,
			                           MBR_CD,
			                           TMS,
			                           RACER_NO,
			                           (SELECT CD_NM VOIL_CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00035' AND CD = VOIL_CD) VOIL_CD, 
			                           ROW_NUMBER() OVER (PARTITION BY   STND_YEAR,
			                                                             MBR_CD,
			                                                             TMS,
			                                                             RACER_NO
			                                              ORDER BY       STND_YEAR,
			                                                             MBR_CD,
			                                                             TMS,
			                                                             RACER_NO) ROW_ID 
			                         FROM TBED_RACE_VOIL_ACT
			                         WHERE STND_YEAR   = ?
			                           AND MBR_CD      = ?
			                           AND TMS         = ?
			                           AND DAY_ORD     = to_number(?) - 1 
			                     )
			                        START WITH ROW_ID = 1
			                        CONNECT BY PRIOR ROW_ID = ROW_ID -1
			                        AND PRIOR STND_YEAR 	= STND_YEAR
                                    AND PRIOR MBR_CD 		= MBR_CD
                                    AND PRIOR TMS 			= TMS
                                   AND PRIOR RACER_NO      = RACER_NO
			                        GROUP BY STND_YEAR,
			                                 MBR_CD,
			                                 TMS,
			                                 RACER_NO   ) C,
			                  TBEC_RACER_MASTER D                  
			WHERE A.STND_YEAR     = B.STND_YEAR(+)
			  AND A.MBR_CD        = B.MBR_CD(+)
			  AND A.TMS           = B.TMS(+)
			  AND A.DAY_ORD       = B.DAY_ORD(+)
			  AND A.RACE_NO       = B.RACE_NO(+)
			  AND A.RACE_REG_NO   = B.RACE_REG_NO(+)
			  AND A.RACER_NO      = B.RACER_NO(+)
			  AND A.STND_YEAR     = C.STND_YEAR(+)
			  AND A.MBR_CD        = C.MBR_CD(+)
			  AND A.TMS           = C.TMS(+)
			  AND A.RACER_NO      = C.RACER_NO(+)
			  AND A.RACER_NO      = D.RACER_NO(+)
			  ORDER BY   A.STND_YEAR    
			            ,A.MBR_CD       
			            ,A.TMS          
			            ,A.DAY_ORD      
			            ,A.RACE_NO      
			            ,A.RACE_REG_NO  
			            ,A.RACER_NO    
		]]>
	</query>

	<query id="tbec_appo_race_result_fd003" desc="위반행위조회" fetchSize="10">
		<![CDATA[
				SELECT   A.STND_YEAR      
			            ,A.MBR_CD         
			            ,A.TMS            
			            ,A.DAY_ORD        
			            ,A.RACE_NO
			            ,A.RACE_REG_NO    
			            ,A.RACER_NO 
			            ,(SELECT NM_KOR FROM TBEC_RACER_MASTER WHERE   RACER_NO= A.RACER_NO) RACER_NM
			            ,A.SEQ            
			            ,A.CIRCUIT_CNT_CD
			            ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00045' AND CD = A.CIRCUIT_CNT_CD) CIRCUIT_CNT_NM
			            ,A.ACDNT_LOC_CD
			            ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00034' AND CD = A.ACDNT_LOC_CD) ACDNT_LOC_NM   
			            ,A.VOIL_JO
			            ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00048' AND CD = A.VOIL_JO) VOIL_JO_NM        
			            ,A.VOIL_HANG      
			            ,A.VOIL_HO        
			            ,A.VOIL_CD 
			            ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00035' AND CD = A.VOIL_CD) VOIL_NM        
			            ,A.VOIL_DESC      
			            ,A.RMK            
			            ,A.INST_ID        
			            ,A.INST_DTM       
			            ,A.UPDT_ID        
			            ,A.UPDT_DTM 
			            ,A.SANC_ISSUE_NO
			  FROM   TBED_RACE_VOIL_ACT A
			   WHERE  A.STND_YEAR       = ?
				  AND A.MBR_CD          = ?
				  AND A.TMS             = ?
				  AND A.DAY_ORD         = ?
				  AND A.RACE_NO         = ?
			      ORDER BY A.STND_YEAR           
			            ,A.MBR_CD              
			            ,A.TMS                 
			            ,A.DAY_ORD             
			            ,A.RACE_NO             
			            ,A.RACE_REG_NO         
			            ,A.SEQ 
		]]>
	</query> 

	<query id="tbec_appo_race_result_fd004" desc="사고행위조회" fetchSize="10">
		<![CDATA[
			SELECT        
					 A.STND_YEAR      
					,A.MBR_CD         
					,A.TMS            
					,A.DAY_ORD        
					,A.RACE_NO        
					,A.RACE_REG_NO   
					,A.RACER_NO       
					,(SELECT NM_KOR FROM TBEC_RACER_MASTER WHERE   RACER_NO= A.RACER_NO) RACER_NM 
					,A.SEQ            
					,A.CIRCUIT_CNT_CD
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00045' AND CD = A.CIRCUIT_CNT_CD) CIRCUIT_CNT_NM
					,A.ACDNT_LOC_CD
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00034' AND CD = A.ACDNT_LOC_CD) ACDNT_LOC_NM  
					,A.ACDNT_ITEM 
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00048' AND CD = A.ACDNT_ITEM) ACDNT_ITEM_NM       
					,A.ACDNT_TPE_CD   
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00062' AND CD = A.ACDNT_TPE_CD) ACDNT_TPE_NM   
					,A.ACDNT_DESC     
					,A.RMK            
					,A.INST_ID        
					,A.INST_DTM       
					,A.UPDT_ID        
					,A.UPDT_DTM       
			  FROM   TBED_RACE_ACDNT_STTS A          
			  WHERE  A.STND_YEAR    = ?   
			  AND A.MBR_CD          = ?    
			  AND A.TMS             = ?       
			  AND A.DAY_ORD         = ?        
			  AND A.RACE_NO         = ?     
			    ORDER BY A.STND_YEAR           
			            ,A.MBR_CD              
			            ,A.TMS                 
			            ,A.DAY_ORD             
			            ,A.RACE_NO             
			            ,A.RACE_REG_NO         
			            ,A.SEQ                 
		]]>
	</query> 

	<query id="tbec_appo_race_result_fd005" desc="경주결과확정인조회" fetchSize="10">
		<![CDATA[
	           
	           SELECT  /* tbec_appo_race_result_fd005 */
	                     MAX(REFERERE_SEQ) REFERERE_SEQ
                        ,MNG
                        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID= TBED_REFERERE_USER.MNG) MNG_NM
                        ,MNG_FILE_NAME
                        ,MNG_FILE_URL
                        ,MNG_FILE_SIZE
                        ,REFE_HEAD
                        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID= TBED_REFERERE_USER.REFE_HEAD) REFE_HEAD_NM
                        ,REFE_HEAD_FILE_NAME
                        ,REFE_HEAD_FILE_URL
                        ,REFE_HEAD_FILE_SIZE
                        ,INSP_CMAN
                        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID= TBED_REFERERE_USER.INSP_CMAN) INSP_CMAN_NM
                        ,INSP_CMAN_FILE_NAME
                        ,INSP_CMAN_FILE_URL
                        ,INSP_CMAN_FILE_SIZE
               FROM TBED_REFERERE_USER
               GROUP BY  MNG
                        ,MNG_FILE_NAME
                        ,MNG_FILE_URL
                        ,MNG_FILE_SIZE
                        ,REFE_HEAD
                        ,REFE_HEAD_FILE_NAME
                        ,REFE_HEAD_FILE_URL
                        ,REFE_HEAD_FILE_SIZE
                        ,INSP_CMAN
                        ,INSP_CMAN_FILE_NAME
                        ,INSP_CMAN_FILE_URL
                        ,INSP_CMAN_FILE_SIZE    
		]]>
	</query>

	<query id="tbec_appo_race_result_fd006" desc="경주결과배당률조회" fetchSize="10">
		<![CDATA[
			SELECT '단승' GUBUN, RUNNER_1ST  BAEBUN, PAYOFF WIN
			  FROM USRBM.TBES_SDL_RS
			 WHERE STND_YEAR = ?
			   AND TMS       = ?
			   AND DAY_ORD   = ?
			   AND RACE_NO   = ?
			   AND POOL_CD   = '001'
			   AND MEET_CD   = '003' 
			UNION  ALL 
			SELECT '연승' GUBUN, RUNNER_1ST  BAEBUN, PAYOFF WIN
			  FROM USRBM.TBES_SDL_RS
			 WHERE STND_YEAR = ?
			   AND TMS       = ?
			   AND DAY_ORD   = ?
			   AND RACE_NO   = ?
			   AND POOL_CD   = '002'
			   AND MEET_CD   = '003' 
			UNION  ALL 
			SELECT '복승' GUBUN, RUNNER_1ST||'/'||RUNNER_2ND  BAEBUN, PAYOFF WIN 
			  FROM USRBM.TBES_SDL_RS
			 WHERE STND_YEAR = ?
			   AND TMS       = ?
			   AND DAY_ORD   = ?
			   AND RACE_NO   = ?
			   AND POOL_CD   = '005'
			   AND MEET_CD   = '003' 
			UNION  ALL 
			SELECT  '쌍승' GUBUN, RUNNER_1ST||'/'||RUNNER_2ND  BAEBUN, PAYOFF WIN
			  FROM USRBM.TBES_SDL_RS
			 WHERE STND_YEAR = ?
			   AND TMS       = ?
			   AND DAY_ORD   = ?
			   AND RACE_NO   = ?
			   AND POOL_CD   = '004'
			   AND MEET_CD   = '003' 
			UNION  ALL 
			SELECT '삼복승' GUBUN, RUNNER_1ST||'-'||RUNNER_2ND||'-'||RUNNER_3RD  BAEBUN, PAYOFF WIN
			  FROM USRBM.TBES_SDL_RS
			 WHERE STND_YEAR = ?
			   AND TMS       = ?
			   AND DAY_ORD   = ?
			   AND RACE_NO   = ?
			   AND POOL_CD   = '006'
			   AND MEET_CD   = '003' 
		]]>
	</query> 

	<query id="tbec_appo_race_result_fd007" desc="경주결과첨부파일조회" fetchSize="10">
		<![CDATA[
	               SELECT 
				         STND_YEAR
				        ,MBR_CD
				        ,TMS
				        ,DAY_ORD
				        ,RACE_NO
				        ,FILE_SEQ
				        ,FILE_NAME
				        ,FILE_URL
				        ,FILE_SIZE
				        ,INST_ID
						,INST_DTM
						,UPDT_ID
						,UPDT_DTM
						,0 AS CHK
				  FROM  TBED_RACE_ATTACH 
				  WHERE  STND_YEAR  = ?
				    AND  MBR_CD     = ?
				    AND  TMS        = ?
				    AND  DAY_ORD    = ?
				    AND  RACE_NO    = ?
				  ORDER BY  STND_YEAR
					        ,MBR_CD
					        ,TMS
					        ,DAY_ORD
					        ,RACE_NO
					        ,FILE_SEQ     
		]]>
	</query>

	<query id="tbec_appo_race_result_fd008" desc="경주결과기준정보조회" fetchSize="10">
		<![CDATA[
	           SELECT    SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),1,4) RACE_YEAR
                        ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),5,2) RACE_MONTH
                        ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),7,2) RACE_DAY
                        ,TO_CHAR(TO_DATE(A.RACE_DAY, 'YYYYMMDD'), 'DAY')     RACE_WEEK
                       ,B.TMS                                                TMS
                       ,B.DAY_ORD                                            DAY_ORD 
                       ,B.RACE_NO                                            RACE_NO
                       ,(SELECT RMK FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00005' AND CD = B.RACE_DGRE_CD) RACE_DGRE_NM
                       ,SUBSTR(B.STRT_TIME,1,2) || ':' || SUBSTR(B.STRT_TIME,3,2) STRT_TIME 
                        ,DECODE(INTRO_NOTI_YN,'Y','공지','미공지') INTRO_NOTI_YN
                        ,DECODE(RANK_NOTI_YN ,'Y','공지','미공지') RANK_NOTI_YN
                FROM   TBEB_RACE_DAY_ORD A,TBEB_RACE B
                WHERE  A.STND_YEAR       = ?
                AND    A.MBR_CD          = ?   
                AND    A.TMS             = ?      
                AND    A.DAY_ORD         = ? 
				AND    A.STND_YEAR       = B.STND_YEAR
				AND    A.MBR_CD          = B.MBR_CD     
				AND    A.TMS             = B.TMS      
				AND    A.DAY_ORD         = B.DAY_ORD
				AND    B.RACE_NO         = ?
		]]>
	</query>

	<query id="tbec_appo_race_result_fd009" desc="경주상황기록표조회" fetchSize="10">
		<![CDATA[
	           SELECT   SUBSTR(TO_CHAR(TO_DATE(C.RACE_DAY),'YYYYMMDD'),1,4)    RACE_YEAR
			            ,SUBSTR(TO_CHAR(TO_DATE(C.RACE_DAY),'YYYYMMDD'),5,2)   RACE_MONTH
			            ,SUBSTR(TO_CHAR(TO_DATE(C.RACE_DAY),'YYYYMMDD'),7,2)   RACE_DAY
			            ,TO_CHAR(TO_DATE(C.RACE_DAY, 'YYYYMMDD'), 'DAY')       RACE_WEEK
			           ,C.TMS                                                  TMS
			           ,C.DAY_ORD                                              DAY_ORD 
			           ,C.RACE_NO                                              RACE_NO
			           ,(SELECT RMK   FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00005' AND CD = B.RACE_DGRE_CD)  RACE_DGRE_NM
			           ,SUBSTR(B.STRT_TIME,1,2) || '시' || SUBSTR(B.STRT_TIME,3,2)  || '분' 					STRT_TIME 
			           ,C.RACE_REG_NO  																		RACE_REG_NO 
				       ,C.RACER_NO     																		RACER_NO
			           ,(SELECT NM_KOR FROM TBEC_RACER_MASTER WHERE   RACER_NO= C.RACER_NO) 				RACER_NM     
				       ,C.BOAT_NO      																		BOAT_NO     
				       ,C.MOT_NO       																		MOT_NO    
			    FROM   TBEB_RACE_DAY_ORD A,TBEB_RACE B, TBEB_ORGAN C
			    WHERE  A.STND_YEAR       = ?
			    AND    A.MBR_CD          = ? 
			    AND    A.TMS             = ?
			    AND    A.DAY_ORD         = ?     
			    AND    A.STND_YEAR       = B.STND_YEAR
			    AND    A.MBR_CD          = B.MBR_CD     
			    AND    A.TMS             = B.TMS      
			    AND    A.DAY_ORD         = B.DAY_ORD
			    AND    C.STND_YEAR       = B.STND_YEAR
			    AND    C.MBR_CD          = B.MBR_CD     
			    AND    C.TMS             = B.TMS      
			    AND    C.DAY_ORD         = B.DAY_ORD
			    AND    C.RACE_NO         = B.RACE_NO
			    ORDER BY  C.STND_YEAR
			              ,C.MBR_CD
			              ,C.TMS
			              ,C.DAY_ORD 
			              ,C.RACE_NO
			              ,C.RACE_REG_NO
		]]>
	</query>

	<query id="tbec_appo_race_result_fd010" desc="위반행위통보서조회" fetchSize="10">
		<![CDATA[
	           SELECT  SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),1,4)    RACE_YEAR
				       ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),5,2)   RACE_MONTH
				       ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),7,2)   RACE_DAY
				       ,TO_CHAR(TO_DATE( A.RACE_DAY, 'YYYYMMDD'), 'DAY')      RACE_WEEK
				       ,(SELECT RMK   FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00005' AND CD = B.RACE_DGRE_CD)  RACE_DGRE_NM
				       ,A.STND_YEAR      STND_YEAR
				       ,A.MBR_CD         MBR_CD
				       ,A.TMS            TMS
				       ,A.DAY_ORD        DAY_ORD
				       ,A.RACE_NO        RACE_NO
				       ,A.RACE_REG_NO    RACE_REG_NO
				       ,A.RACER_NO       RACER_NO
				       ,(SELECT NM_KOR FROM TBEC_RACER_MASTER WHERE   RACER_NO=  A.RACER_NO) RACER_NM  
				       ,A.VOIL_CD        VOIL_CD
				       ,(SELECT CD_NM VOIL_CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00035' AND CD = A.VOIL_CD) VOIL_NM
				       ,A.VOIL_DESC || '  ' 
				        || (SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00048' AND CD = A.VOIL_JO) 
				        || '에 의거 ' 
				        || (SELECT CD_NM VOIL_CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00035' AND CD = A.VOIL_CD) VOIL_DESC
				        ,B.MNG                MNG
				        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = B.MNG) MNG_NM
				        ,B.REFE_HEAD          REFE_HEAD
				        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = B.REFE_HEAD) REFE_HEAD_NM
				        ,B.INSP_CMAN          INSP_CMAN
				        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = B.INSP_CMAN) INSP_CMAN_NM
				 FROM TBED_RACE_VOIL_ACT A, TBEB_RACE B
				   WHERE  A.STND_YEAR       = B.STND_YEAR   
				     AND  A.MBR_CD          = B.MBR_CD      
				     AND  A.TMS             = B.TMS         
				     AND  A.DAY_ORD         = B.DAY_ORD
				     AND  A.RACE_NO         = B.RACE_NO    
				     AND A.STND_YEAR   = ?
				     AND A.MBR_CD      = ?
				     AND A.TMS         = ?
				     AND A.DAY_ORD     = ?
				     AND A.RACE_NO     = ? 
				   ORDER BY     A.STND_YEAR
				               ,A.MBR_CD
				               ,A.TMS
				               ,A.DAY_ORD
				               ,A.RACE_NO
				               ,A.RACE_REG_NO
		]]>
	</query>
    
	<query id="tbec_appo_race_result_fd011" desc="사고행위통보서조회" fetchSize="10">
		<![CDATA[
	            
	            SELECT  SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),1,4)   RACE_YEAR
				       ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),5,2)   RACE_MONTH
				       ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),7,2)   RACE_DAY
				       ,TO_CHAR(TO_DATE( A.RACE_DAY, 'YYYYMMDD'), 'DAY')      RACE_WEEK
				       ,(SELECT RMK   FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00005' AND CD = B.RACE_DGRE_CD)  RACE_DGRE_NM
				       ,A.STND_YEAR     STND_YEAR
				       ,A.MBR_CD        MBR_CD
				       ,A.TMS           TMS
				       ,A.DAY_ORD       DAY_ORD
				       ,A.RACE_NO       RACE_NO
				       ,A.RACE_REG_NO   RACE_REG_NO
				       ,A.RACER_NO      RACER_NO
				       ,(SELECT NM_KOR FROM TBEC_RACER_MASTER WHERE   RACER_NO=  A.RACER_NO) 			  RACER_NM  
				       ,A.ACDNT_LOC_CD  																  ACDNT_LOC_CD
				       ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00034' AND CD = A.ACDNT_LOC_CD)  ACDNT_LOC_NM
				       ,A.ACDNT_ITEM																	  ACDNT_ITEM
						,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00048' AND CD = A.ACDNT_ITEM)   ACDNT_ITEM_NM       
						,A.ACDNT_TPE_CD   																  ACDNT_TPE_CD
				        ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00062' AND CD = A.ACDNT_TPE_CD) ACDNT_TPE_NM 
					    ,A.ACDNT_DESC || '  ' 
				        || (SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00048' AND CD = A.ACDNT_ITEM)
				        || '에 의거 ' 
				        ||(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00062' AND CD = A.ACDNT_TPE_CD) ACDNT_DESC 
				        ,B.MNG                															   MNG
				        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = B.MNG) 							   MNG_NM
				        ,B.REFE_HEAD          															   REFE_HEAD
				        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = B.REFE_HEAD) 					   REFE_HEAD_NM
				        ,B.INSP_CMAN          															   INSP_CMAN
				        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = B.INSP_CMAN) 					   INSP_CMAN_NM
				 FROM TBED_RACE_ACDNT_STTS A, TBEB_RACE B
				   WHERE  A.STND_YEAR       = B.STND_YEAR   
				     AND  A.MBR_CD          = B.MBR_CD      
				     AND  A.TMS             = B.TMS         
				     AND  A.DAY_ORD         = B.DAY_ORD
				     AND  A.RACE_NO         = B.RACE_NO    
				     AND A.STND_YEAR   		= ?
				     AND A.MBR_CD      		= ?
				     AND A.TMS         		= ?
				     AND A.DAY_ORD     		= ?
				     AND A.RACE_NO     		= ?
				   ORDER BY     A.STND_YEAR
				               ,A.MBR_CD
				               ,A.TMS
				               ,A.DAY_ORD
				               ,A.RACE_NO
				               ,A.RACE_REG_NO
		]]>
	</query>

	<query id="tbec_appo_race_result_fd012" desc="경정성적표 15개출력" fetchSize="10">
		<![CDATA[ 
           SELECT   SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),1,4)    		RACE_YEAR
                        ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),5,2)    RACE_MONTH
                        ,SUBSTR(TO_CHAR(TO_DATE(A.RACE_DAY),'YYYYMMDD'),7,2)    RACE_DAY
                        ,TO_CHAR(TO_DATE(A.RACE_DAY, 'YYYYMMDD'), 'DAY')        RACE_WEEK
                        ,B.TMS                                                  TMS
                        ,B.DAY_ORD                                              DAY_ORD 
                        ,B.RACE_NO                                              RACE_NO
                        ,(SELECT RMK  FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00005' AND CD = B.RACE_DGRE_CD) 				 RACE_DGRE_NM
                        ,SUBSTR(B.STRT_TIME,1,2) || ':' || SUBSTR(B.STRT_TIME,3,2)     									 STRT_TIME 
                        ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00002' AND CD = B.ST_MTHD_CD) 				 ST_MTHD_NM
                        ,B.RACE_DIST          																			 RACE_DIST
                        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = (SELECT MAX(MNG) FROM TBED_REFERERE_USER)) 		 MNG_NM
                        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = (SELECT MAX(REFE_HEAD) FROM TBED_REFERERE_USER)) REFE_HEAD_NM
                        ,(SELECT DISTINCT USER_NM FROM VWEA_USER WHERE USER_ID = (SELECT MAX(INSP_CMAN) FROM TBED_REFERERE_USER)) INSP_CMAN_NM
                FROM   TBEB_RACE_DAY_ORD A,TBEB_RACE B
                WHERE  A.STND_YEAR       = ?
                AND    A.MBR_CD          = ?
                AND    A.TMS             = ?  
                AND    A.DAY_ORD         = ?
                AND    A.STND_YEAR       = B.STND_YEAR
                AND    A.MBR_CD          = B.MBR_CD     
                AND    A.TMS             = B.TMS      
                AND    A.DAY_ORD         = B.DAY_ORD
                ORDER BY  RACE_YEAR
                         ,RACE_MONTH
                         ,RACE_DAY
                         ,RACE_WEEK
                         ,TMS
                         ,DAY_ORD
                         ,RACE_NO 
		]]>
	</query>

	<query id="tbec_appo_race_result_fd013" desc="경정성적표 15개출력" fetchSize="10">
		<![CDATA[
             SELECT     
                     B.VOIL_CD      PREV_VOIL_CD
                    ,A.STND_YEAR    STND_YEAR   
                    ,A.MBR_CD       MBR_CD      
                    ,A.TMS          TMS         
                    ,A.DAY_ORD      DAY_ORD     
                    ,A.RACE_NO      RACE_NO     
                    ,A.RACE_REG_NO  RACE_REG_NO 
                    ,A.RACER_NO     RACER_NO
                    ,D.NM_KOR       RACER_NM  
                    ,A.BOAT_NO      BOAT_NO     
                    ,A.MOT_NO       MOT_NO  
             FROM   (SELECT  A.STND_YEAR
                            ,A.MBR_CD      
                            ,A.TMS         
                            ,A.DAY_ORD     
                            ,A.RACE_NO     
                            ,A.RACE_REG_NO 
                            ,A.RACER_NO    
                            ,A.ABSE_CD     
                            ,A.BOAT_NO     
                            ,A.MOT_NO  
                    FROM TBEB_ORGAN         A,
                         TBEB_RACE          B
                    WHERE A.STND_YEAR   = B.STND_YEAR
                      AND A.MBR_CD      = B.MBR_CD
                      AND A.TMS         = B.TMS
                      AND A.DAY_ORD     = B.DAY_ORD
                      AND A.RACE_NO     = B.RACE_NO
                      AND A.STND_YEAR   = ?
                      AND A.MBR_CD      = ?
                      AND A.TMS         = ?
                      AND A.DAY_ORD     = ?  ) A,
                      (  SELECT    STND_YEAR,  --기준년도
                                   MBR_CD,     --경정장코드
                                   TMS,        --회차
                                   RACER_NO,
                                   SUBSTR(MAX(SYS_CONNECT_BY_PATH(VOIL_CD,',')),2) VOIL_CD 
                        FROM (
                                SELECT STND_YEAR,
                                       MBR_CD,
                                       TMS,
                                       RACER_NO,
                                      (SELECT CD_NM VOIL_CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00035' AND CD = VOIL_CD) VOIL_CD, 
                                       ROW_NUMBER() OVER (PARTITION BY  STND_YEAR,
                                                                         MBR_CD,
                                                                         TMS,
                                                                         RACER_NO
                                                          ORDER BY       STND_YEAR,
                                                                         MBR_CD,
                                                                         TMS,
                                                                         RACER_NO) ROW_ID 
                                     FROM TBED_RACE_VOIL_ACT
                                     WHERE STND_YEAR   = ?
                                       AND MBR_CD      = ?
                                       AND TMS         = ?
                                       AND DAY_ORD     = to_number(?) - 1  
                               )
                                    START WITH ROW_ID = 1
                                    CONNECT BY PRIOR ROW_ID = ROW_ID -1
                                    AND PRIOR STND_YEAR     = STND_YEAR
                                    AND PRIOR MBR_CD        = MBR_CD
                                    AND PRIOR TMS           = TMS
                                   AND PRIOR RACER_NO       = RACER_NO
                                    GROUP BY STND_YEAR,
                                             MBR_CD,
                                             TMS,
                                             RACER_NO   ) B, 
                                            TBEC_RACER_MASTER D                  
            WHERE A.STND_YEAR     = B.STND_YEAR(+)
              AND A.MBR_CD        = B.MBR_CD(+)
              AND A.TMS           = B.TMS(+)
              AND A.RACER_NO      = B.RACER_NO(+)
              AND A.RACER_NO      = D.RACER_NO(+)
              ORDER BY   A.STND_YEAR    
                        ,A.MBR_CD       
                        ,A.TMS          
                        ,A.DAY_ORD      
                        ,A.RACE_NO      
                        ,A.RACE_REG_NO  
                        ,A.RACER_NO
		]]>
	</query>

	<query id="tbec_appo_race_result_fd014" desc="경주회차 및 경주일차 상태조회" fetchSize="10">
		<![CDATA[
                      
                      SELECT   A.RACE_TMS_STAT_CD RACE_TMS_STAT_CD
			               	  ,A.RACE_TMS_STAT_NM RACE_TMS_STAT_NM
			               	  ,B.ORGAN_STAT_CD    ORGAN_STAT_CD
			                  ,B.ORGAN_STAT_NM    ORGAN_STAT_NM
			           FROM
			             (  SELECT RACE_TMS_STAT_CD
			                      ,(SELECT CD_NM  FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00106' AND CD = RACE_TMS_STAT_CD) RACE_TMS_STAT_NM
			                FROM TBEB_RACE_TMS
			                WHERE STND_YEAR = ?
			                  AND MBR_CD    = ?
			                  AND TMS       = ?
			              ) A,
			              ( SELECT ORGAN_STAT_CD
			                        ,(SELECT CD_NM  FROM TBEA_SPEC_CD WHERE GRP_CD  ='E00119' AND CD = ORGAN_STAT_CD) ORGAN_STAT_NM
			                  FROM TBEB_RACE_DAY_ORD
			                WHERE STND_YEAR = ?
			                  AND MBR_CD    = ?
			                  AND TMS       = ?
			                  AND DAY_ORD   = ?
			              ) B
		]]>
	</query> 

	<query id="tbec_appo_race_result_fd015" desc="경주별 SDL결과 건수 조회" fetchSize="10">
		<![CDATA[
                      
                SELECT  /* tbec_appo_race_result_fd015 */
                        RANK
                       ,REG_NO
				FROM    USRBM.TBES_SDL_FN
				WHERE   MEET_CD   = '003'	--경정
				AND     STND_YEAR = ?
				AND     TMS       = ?
				AND     DAY_ORD   = ?
				AND     RACE_NO   = ?
		]]>
	</query> 

	<query id="tbec_appo_race_result_ud001" desc="경주결과저장" fetchSize="10">
		<![CDATA[
		BEGIN
			UPDATE 	/* tbec_appo_race_result_ud001 */
			        TBEB_RACE
			 	SET
					 RACE_STTS_CD		= ?
					,RACE_STTS2_CD		= ?
					,RACE_STTS_DESC     = ?
					,WEATH_CD			= ?
					,TEMPT		    	= ?
					,WIND_SPD	  		= ?
					,WIND_DIRC_CD		= ?
					,WATER_TEMPT		= ?
					,WAVE				= ?
					,WATER_LVL			= ?
					,HUMIDITY			= ?
					,STRT_TIME			= ?
					,DIS_NEED_TIME		= ?
					,MNG				= ?
					,MNG_FILE_URL		= ?
					,REFE_HEAD			= ?
					,REFE_HEAD_FILE_URL	= ?
					,INSP_CMAN			= ?
					,INSP_CMAN_FILE_URL	= ?
					,UPDT_ID        	= ?
					,UPDT_DTM       	= SYSDATE
			WHERE STND_YEAR 	  		= ?
			AND MBR_CD    	  			= ?
			AND TMS 			 		= ?
			AND DAY_ORD		  			= ?
			AND RACE_NO		  			= ? ;
		
		   UPDATE TBEB_RACE_TMS
              SET RACE_TMS_STAT_CD = '050'
			WHERE STND_YEAR = ?
			  AND MBR_CD    = ?
			  AND TMS       = ? ;
		
		END;	
		]]>
	</query>
    
	<query id="tbec_appo_race_result_ud002" desc="경주결과확정" fetchSize="10">
		<![CDATA[
		 BEGIN	 	
				
				UPDATE 	TBEB_RACE 	SET   -- 마감여부
						 RACE_END_YN    = 'Y'
						,UPDT_ID        = ?
						,UPDT_DTM       = SYSDATE
				WHERE STND_YEAR 	  	= ?
				AND MBR_CD    	  		= ?
				AND TMS 			 	= ?
				AND DAY_ORD		  		= ?
				AND RACE_NO		  		= ?;
				
				UPDATE TBEB_ORGAN        --면책구분(자책)
				SET     IMMT_CLS_CD = '002'
				WHERE (STND_YEAR, MBR_CD, TMS, DAY_ORD, RACE_NO, RACER_NO) IN 
				(
				SELECT 
				      STND_YEAR
				    , MBR_CD
				    , TMS
				    , DAY_ORD
				    , RACE_NO
				    , RACER_NO
				FROM TBED_RACE_VOIL_ACT
				WHERE VOIL_CD NOT IN ('999','998','996')
				  AND STND_YEAR      = ?
				  AND  MBR_CD        = ?
				  AND  TMS           = ?
				  AND  DAY_ORD       = ?
				  AND  RACE_NO       = ?
				GROUP BY 
				      STND_YEAR
				    , MBR_CD
				    , TMS
				    , DAY_ORD
				    , RACE_NO
				    , RACER_NO
				);
			      
			    UPDATE TBEB_ORGAN        --면책구분(면책)
				SET     IMMT_CLS_CD = '003'
				WHERE (STND_YEAR, MBR_CD, TMS, DAY_ORD, RACE_NO, RACER_NO) IN 
				(
				SELECT 
				      STND_YEAR
				    , MBR_CD
				    , TMS
				    , DAY_ORD
				    , RACE_NO
				    , RACER_NO
				FROM TBED_RACE_VOIL_ACT
				WHERE VOIL_CD IN ('999','998','996')
				  AND STND_YEAR      = ?
				  AND  MBR_CD        = ?
				  AND  TMS           = ?
				  AND  DAY_ORD       = ?
				  AND  RACE_NO       = ?
				GROUP BY 
				      STND_YEAR
				    , MBR_CD
				    , TMS
				    , DAY_ORD
				    , RACE_NO
				    , RACER_NO
				);
				
				UPDATE TBEB_ORGAN    --결장구분(결장)	
				   SET ABSE_CD = '002'
					WHERE (STND_YEAR, MBR_CD, TMS, DAY_ORD, RACE_NO, RACER_NO) IN 
					(
					SELECT 
					      STND_YEAR
					    , MBR_CD
					    , TMS
					    , DAY_ORD
					    , RACE_NO
					    , RACER_NO
					FROM TBED_RACE_VOIL_ACT
					WHERE VOIL_CD IN ('130')
					  AND STND_YEAR      = ?
					  AND  MBR_CD        = ?
					  AND  TMS           = ?
					  AND  DAY_ORD       = ?
					  AND  RACE_NO       = ?
					GROUP BY 
					      STND_YEAR
					    , MBR_CD
					    , TMS
					    , DAY_ORD
					    , RACE_NO
					    , RACER_NO
					);
			      
			     UPDATE TBEB_ORGAN    		--결장구분(면책결장)
					SET	ABSE_CD = '003'
				   WHERE (STND_YEAR, MBR_CD, TMS, DAY_ORD, RACE_NO, RACER_NO) IN 
						(
						SELECT 
						      STND_YEAR
						    , MBR_CD
						    , TMS
						    , DAY_ORD
						    , RACE_NO
						    , RACER_NO
						FROM TBED_RACE_VOIL_ACT
						WHERE VOIL_CD IN ('998')
						  AND STND_YEAR     = ?
						  AND  MBR_CD       = ?
						  AND  TMS          = ?
						  AND  DAY_ORD      = ?
						  AND  RACE_NO      = ?
						GROUP BY 
						      STND_YEAR
						    , MBR_CD
						    , TMS
						    , DAY_ORD
						    , RACE_NO
						    , RACER_NO
						);
		END;	
			 
		]]>
	</query>

</queryMap>