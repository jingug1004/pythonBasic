<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbeb_temp_organ(가편성)">

    <query id="tbeb_temp_organ_fb001" desc="가편성정보 조회" fetchSize="10">
        <![CDATA[
            SELECT  /*  tbeb_temp_organ_fb001 가편성정보 조회 */
	                 TTO  .STND_YEAR
	               , TTO  .MBR_CD   
	               , TTO  .TMS      
	               , TTO  .DAY_ORD  
	               , TTO  .RACE_NO  
	               , ( SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00009' AND CD = TTO.RACE_REG_NO ) RACE_REG_COLOR
	               , TTO  .RACE_REG_NO
			       , TTO  .RACER_NO ORG_RACER_NO                                            -- 선수등록번호
			       , ''    RACER_RSN                                                        -- 선수변경사유
			       , TTO  .RACER_NO                                                         -- 선수등록번호
			       , TA   .SPEC_CD                                                         -- 선수등록번호
			       , TTO  .MOT_NO ORG_MOT_NO                                                -- 모터번호    
			       , ''    MOT_RSN                                                          -- 모터변경사유
			       , TTO  .MOT_NO                                                           -- 모터번호    
			       , SUBSTR(TTO  .MOT_NO, 6, 3) VIEW_MOT_NO                                 -- 모터번호    
			       , TTO  .BOAT_NO ORG_BOAT_NO                                              -- 보트번호    
			       , ''    BOAT_RSN                                                         -- 보트변경사유
			       , TTO  .BOAT_NO                                                          -- 보트번호
			       , TTO  .ST_MTHD_CD                                                       -- 온라인스타트 여부
			       , SUBSTR(TTO  .BOAT_NO, 6, 3) VIEW_BOAT_NO    
			       , ''    ABSE_CD                           
			       , TCI  .SPEC_INFO RMK                           
			       , TRM  .RACER_GRD_CD
			       , TRM  .NM_KOR
			       , TRM  .RACER_STAT_CD
			       , TRM  .FAVOR_COURSE_CD
			       , TRM  .EMAIL_ADDR
			       , TRM  .RACER_PERIO_NO
			       , ''    ETC_RACE                                                         -- 보트변경사유
			       , (SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00024' AND CD = TRD  .NATV_PLAC_CD) NATV_PLAC_CD
			       , TRD  .NATY_UNIV
			       , ROUND(NVL(TRI  .ENTRY_BODY_WGHT, TRD.WGHT)) ENTRY_BODY_WGHT
--			       , ROUND(TRI.ENTRY_BODY_WGHT) ENTRY_BODY_WGHT
			       , 1 RACE_ALLOC_CNT
	               , NVL(NXT.RACE_ALLOC_CNT, TRRAN.RACE_ALLOC_CNT) NEXT_RACE_ALLOC_CNT
			       , DECODE(TTO.ST_MTHD_CD, '001', 
			       				TRIM(TO_CHAR((NVL(TRRAS2.TMS_6_AVG_RANK_SCR, 0) * 0.7) + (NVL(TMRAS2.AVG_RANK_SCR, 0) * 0.25) + (NVL(TBRAS2.AVG_RANK_SCR, 0) * 0.05), '90.99')),
			       				TRIM(TO_CHAR((NVL(TRRAS.TMS_6_AVG_RANK_SCR, 0) * 0.7) + (NVL(TMRAS.AVG_RANK_SCR, 0) * 0.25) + (NVL(TBRAS.AVG_RANK_SCR, 0) * 0.05), '90.99')) 
			         ) SCR
			       , DENSE_RANK() OVER (ORDER BY TRIM(TO_CHAR((NVL(TRRAS.TMS_6_AVG_RANK_SCR, 0) * 0.7) + (NVL(TMRAS.AVG_RANK_SCR, 0) * 0.25) + (NVL(TBRAS.AVG_RANK_SCR, 0) * 0.05), '90.99')) DESC ) RANK
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RACER_RANK             ,TRRAS.RACER_RANK              )   TRRAS_RACER_RANK
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_AMU_RANK_SCR     ,TRRAS.TMS_6_AMU_RANK_SCR      )   TRRAS_TMS_6_AMU_RANK_SCR     
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_AVG_RANK_SCR     ,TRRAS.TMS_6_AVG_RANK_SCR      )   TRRAS_TMS_6_AVG_RANK_SCR     
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_AMU_ACDNT_SCR    ,TRRAS.TMS_6_AMU_ACDNT_SCR     )   TRRAS_TMS_6_AMU_ACDNT_SCR    
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_AVG_ACDNT_SCR    ,TRRAS.TMS_6_AVG_ACDNT_SCR     )   TRRAS_TMS_6_AVG_ACDNT_SCR    
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_AVG_SCR          ,TRRAS.TMS_6_AVG_SCR           )   TRRAS_TMS_6_AVG_SCR          
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_WIN_RATIO        ,TRRAS.TMS_6_WIN_RATIO         )   TRRAS_TMS_6_WIN_RATIO        
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_HIGH_RANK_RATIO  ,TRRAS.TMS_6_HIGH_RANK_RATIO   )   TRRAS_TMS_6_HIGH_RANK_RATIO  
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_HIGH_3_RANK_RATIO,TRRAS.TMS_6_HIGH_3_RANK_RATIO )   TRRAS_TMS_6_HIGH_3_RANK_RATIO
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_AVG_STRT_TM      ,TRRAS.TMS_6_AVG_STRT_TM       )   TRRAS_TMS_6_AVG_STRT_TM      
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_8_RANK_ORD         ,TRRAS.TMS_8_RANK_ORD          )   TRRAS_TMS_8_RANK_ORD         
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_RACE_CNT         ,TRRAS.TMS_6_RACE_CNT          )   TRRAS_TMS_6_RACE_CNT         
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_RANK_1           ,TRRAS.TMS_6_RANK_1            )   TRRAS_TMS_6_RANK_1           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_RANK_2           ,TRRAS.TMS_6_RANK_2            )   TRRAS_TMS_6_RANK_2           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TMS_6_RANK_3           ,TRRAS.TMS_6_RANK_3            )   TRRAS_TMS_6_RANK_3           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AMU_RANK_SCR           ,TRRAS.AMU_RANK_SCR            )   TRRAS_AMU_RANK_SCR           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AVG_RANK_SCR           ,TRRAS.AVG_RANK_SCR            )   TRRAS_AVG_RANK_SCR           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AMU_ACDNT_SCR          ,TRRAS.AMU_ACDNT_SCR           )   TRRAS_AMU_ACDNT_SCR          
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AVG_ACDNT_SCR          ,TRRAS.AVG_ACDNT_SCR           )   TRRAS_AVG_ACDNT_SCR          
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_AMU_ACDNT_SCR       ,TRRAS.BF_AMU_ACDNT_SCR        )   TRRAS_BF_AMU_ACDNT_SCR      
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_AVG_ACDNT_SCR       ,TRRAS.BF_AVG_ACDNT_SCR        )   TRRAS_BF_AVG_ACDNT_SCR      
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AF_AMU_ACDNT_SCR       ,TRRAS.AF_AMU_ACDNT_SCR        )   TRRAS_AF_AMU_ACDNT_SCR      
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AF_AVG_ACDNT_SCR       ,TRRAS.AF_AVG_ACDNT_SCR        )   TRRAS_AF_AVG_ACDNT_SCR      
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AVG_SCR                ,TRRAS.AVG_SCR                 )   TRRAS_AVG_SCR                
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.WIN_RATIO              ,TRRAS.WIN_RATIO               )   TRRAS_WIN_RATIO              
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.HIGH_RANK_RATIO        ,TRRAS.HIGH_RANK_RATIO         )   TRRAS_HIGH_RANK_RATIO        
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.HIGH_3_RANK_RATIO      ,TRRAS.HIGH_3_RANK_RATIO       )   TRRAS_HIGH_3_RANK_RATIO      
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AVG_STRT_TM            ,TRRAS.AVG_STRT_TM             )   TRRAS_AVG_STRT_TM            
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RUN_CNT                ,TRRAS.RUN_CNT                 )   TRRAS_RUN_CNT                
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RACE_DAY_CNT           ,TRRAS.RACE_DAY_CNT            )   TRRAS_RACE_DAY_CNT           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RACE_CNT               ,TRRAS.RACE_CNT                )   TRRAS_RACE_CNT               
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.TOT_RACE_CNT           ,TRRAS.TOT_RACE_CNT            )   TRRAS_TOT_RACE_CNT           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_RACE_CNT            ,TRRAS.BF_RACE_CNT             )   TRRAS_BF_RACE_CNT            
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AF_RACE_CNT            ,TRRAS.AF_RACE_CNT             )   TRRAS_AF_RACE_CNT            
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_1_CNT             ,TRRAS.RANK_1_CNT              )   TRRAS_RANK_1_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_2_CNT             ,TRRAS.RANK_2_CNT              )   TRRAS_RANK_2_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_3_CNT             ,TRRAS.RANK_3_CNT              )   TRRAS_RANK_3_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_4_CNT             ,TRRAS.RANK_4_CNT              )   TRRAS_RANK_4_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_5_CNT             ,TRRAS.RANK_5_CNT              )   TRRAS_RANK_5_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_6_CNT             ,TRRAS.RANK_6_CNT              )   TRRAS_RANK_6_CNT
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_7_CNT             ,TRRAS.RANK_7_CNT              )   TRRAS_RANK_7_CNT
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_8_CNT             ,TRRAS.RANK_8_CNT              )   TRRAS_RANK_8_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RANK_ETC_CNT           ,TRRAS.RANK_ETC_CNT            )   TRRAS_RANK_ETC_CNT           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.DGRE_JUDG_F_CNT        ,TRRAS.DGRE_JUDG_F_CNT         )   TRRAS_DGRE_JUDG_F_CNT        
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.DGRE_JUDG_L_CNT        ,TRRAS.DGRE_JUDG_L_CNT         )   TRRAS_DGRE_JUDG_L_CNT        
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_F_CNT               ,TRRAS.BF_F_CNT                )   TRRAS_BF_F_CNT                  
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AF_F_CNT               ,TRRAS.AF_F_CNT                )   TRRAS_AF_F_CNT                  
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_L_CNT               ,TRRAS.BF_L_CNT                )   TRRAS_BF_L_CNT                  
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.AF_L_CNT               ,TRRAS.AF_L_CNT                )   TRRAS_AF_L_CNT                  
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.ABSE_CNT               ,TRRAS.ABSE_CNT                )   TRRAS_ABSE_CNT               
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RACE_ESC_1_CNT         ,TRRAS.RACE_ESC_1_CNT          )   TRRAS_RACE_ESC_1_CNT         
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.RACE_ESC_2_CNT         ,TRRAS.RACE_ESC_2_CNT          )   TRRAS_RACE_ESC_2_CNT         
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.FOUL_ELIM_CNT          ,TRRAS.FOUL_ELIM_CNT           )   TRRAS_FOUL_ELIM_CNT          
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.ELIM_CNT               ,TRRAS.ELIM_CNT                )   TRRAS_ELIM_CNT               
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.FOUL_WARN_CNT          ,TRRAS.FOUL_WARN_CNT           )   TRRAS_FOUL_WARN_CNT          
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.WARN_CNT               ,TRRAS.WARN_CNT                )   TRRAS_WARN_CNT               
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.ATTEN_CNT              ,TRRAS.ATTEN_CNT               )   TRRAS_ATTEN_CNT              
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_TMS                 ,TRRAS.BF_TMS                  )   TRRAS_BF_TMS                 
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_BF_TMS              ,TRRAS.BF_BF_TMS               )   TRRAS_BF_BF_TMS              
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_BF_BF_TMS           ,TRRAS.BF_BF_BF_TMS            )   TRRAS_BF_BF_BF_TMS           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_MBR_CD              ,TRRAS.BF_MBR_CD               )   TRRAS_BF_MBR_CD              
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_BF_MBR_CD           ,TRRAS.BF_BF_MBR_CD            )   TRRAS_BF_BF_MBR_CD           
                   , DECODE(TTO.ST_MTHD_CD, '001', TRRAS2.BF_BF_BF_MBR_CD        ,TRRAS.BF_BF_BF_MBR_CD         )   TRRAS_BF_BF_BF_MBR_CD        
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RUN_CNT                ,TMRAS.RUN_CNT                 )   TMRAS_RUN_CNT                
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RACE_CNT               ,TMRAS.RACE_CNT                )   TMRAS_RACE_CNT               
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RACE_DAY_CNT           ,TMRAS.RACE_DAY_CNT            )   TMRAS_RACE_DAY_CNT           
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_1_CNT             ,TMRAS.RANK_1_CNT              )   TMRAS_RANK_1_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_2_CNT             ,TMRAS.RANK_2_CNT              )   TMRAS_RANK_2_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_3_CNT             ,TMRAS.RANK_3_CNT              )   TMRAS_RANK_3_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_4_CNT             ,TMRAS.RANK_4_CNT              )   TMRAS_RANK_4_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_5_CNT             ,TMRAS.RANK_5_CNT              )   TMRAS_RANK_5_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_6_CNT             ,TMRAS.RANK_6_CNT              )   TMRAS_RANK_6_CNT
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_7_CNT             ,TMRAS.RANK_7_CNT              )   TMRAS_RANK_7_CNT
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.RANK_8_CNT             ,TMRAS.RANK_8_CNT              )   TMRAS_RANK_8_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.AMU_RANK_SCR           ,TMRAS.AMU_RANK_SCR            )   TMRAS_AMU_RANK_SCR          
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.AVG_RANK_SCR           ,TMRAS.AVG_RANK_SCR            )   TMRAS_AVG_RANK_SCR           
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.WIN_RATIO              ,TMRAS.WIN_RATIO               )   TMRAS_WIN_RATIO              
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.HIGH_RANK_RATIO        ,TMRAS.HIGH_RANK_RATIO         )   TMRAS_HIGH_RANK_RATIO        
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.HIGH_3_RANK_RATIO      ,TMRAS.HIGH_3_RANK_RATIO       )   TMRAS_HIGH_3_RANK_RATIO      
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.TMS_3_ITRDT_RUN_TM     ,TMRAS.TMS_3_ITRDT_RUN_TM      )   TMRAS_TMS_3_ITRDT_RUN_TM     
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.AVG_ITRDT_RUN_TM       ,TMRAS.AVG_ITRDT_RUN_TM        )   TMRAS_AVG_ITRDT_RUN_TM       
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.MAX_ITRDT_RUN_TM       ,TMRAS.MAX_ITRDT_RUN_TM        )   TMRAS_MAX_ITRDT_RUN_TM       
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.MIN_ITRDT_RUN_TM       ,TMRAS.MIN_ITRDT_RUN_TM        )   TMRAS_MIN_ITRDT_RUN_TM       
                   , DECODE(TTO.ST_MTHD_CD, '001', TMRAS2.ITRDT_RUN_TM_DVTN      ,TMRAS.ITRDT_RUN_TM_DVTN       )   TMRAS_ITRDT_RUN_TM_DVTN      
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RUN_CNT                ,TBRAS.RUN_CNT                 )   TBRAS_RUN_CNT                
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RACE_CNT               ,TBRAS.RACE_CNT                )   TBRAS_RACE_CNT               
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RACE_DAY_CNT           ,TBRAS.RACE_DAY_CNT            )   TBRAS_RACE_DAY_CNT           
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_1_CNT             ,TBRAS.RANK_1_CNT              )   TBRAS_RANK_1_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_2_CNT             ,TBRAS.RANK_2_CNT              )   TBRAS_RANK_2_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_3_CNT             ,TBRAS.RANK_3_CNT              )   TBRAS_RANK_3_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_4_CNT             ,TBRAS.RANK_4_CNT              )   TBRAS_RANK_4_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_5_CNT             ,TBRAS.RANK_5_CNT              )   TBRAS_RANK_5_CNT             
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_6_CNT             ,TBRAS.RANK_6_CNT              )   TBRAS_RANK_6_CNT
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_7_CNT             ,TBRAS.RANK_7_CNT              )   TBRAS_RANK_7_CNT
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.RANK_8_CNT             ,TBRAS.RANK_8_CNT              )   TBRAS_RANK_8_CNT
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.AMU_RANK_SCR           ,TBRAS.AMU_RANK_SCR            )   TBRAS_AMU_RANK_SCR          
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.AVG_RANK_SCR           ,TBRAS.AVG_RANK_SCR            )   TBRAS_AVG_RANK_SCR           
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.WIN_RATIO              ,TBRAS.WIN_RATIO               )   TBRAS_WIN_RATIO              
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.HIGH_RANK_RATIO        ,TBRAS.HIGH_RANK_RATIO         )   TBRAS_HIGH_RANK_RATIO        
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.HIGH_3_RANK_RATIO      ,TBRAS.HIGH_3_RANK_RATIO       )   TBRAS_HIGH_3_RANK_RATIO      
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.TMS_3_ITRDT_RUN_TM     ,TBRAS.TMS_3_ITRDT_RUN_TM      )   TBRAS_TMS_3_ITRDT_RUN_TM     
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.AVG_ITRDT_RUN_TM       ,TBRAS.AVG_ITRDT_RUN_TM        )   TBRAS_AVG_ITRDT_RUN_TM       
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.MAX_ITRDT_RUN_TM       ,TBRAS.MAX_ITRDT_RUN_TM        )   TBRAS_MAX_ITRDT_RUN_TM       
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.MIN_ITRDT_RUN_TM       ,TBRAS.MIN_ITRDT_RUN_TM        )   TBRAS_MIN_ITRDT_RUN_TM       
                   , DECODE(TTO.ST_MTHD_CD, '001', TBRAS2.ITRDT_RUN_TM_DVTN      ,TBRAS.ITRDT_RUN_TM_DVTN       )   TBRAS_ITRDT_RUN_TM_DVTN      
                   , PRE  .RACE1    
                   , PRE  .RACE2    
			       
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_1_ON, '0/0'),NVL(RACE .RACE_CNT_1, '0/0')) RACE_CNT_1
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_2_ON, '0/0'),NVL(RACE .RACE_CNT_2, '0/0')) RACE_CNT_2
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_3_ON, '0/0'),NVL(RACE .RACE_CNT_3, '0/0')) RACE_CNT_3
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_4_ON, '0/0'),NVL(RACE .RACE_CNT_4, '0/0')) RACE_CNT_4
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_5_ON, '0/0'),NVL(RACE .RACE_CNT_5, '0/0')) RACE_CNT_5
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_6_ON, '0/0'),NVL(RACE .RACE_CNT_6, '0/0')) RACE_CNT_6
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_7_ON, '0/0'),NVL(RACE .RACE_CNT_7, '0/0')) RACE_CNT_7
			       , DECODE(TTO.ST_MTHD_CD, '001',NVL(RACE .RACE_CNT_8_ON, '0/0'),NVL(RACE .RACE_CNT_8, '0/0')) RACE_CNT_8
			       
			       , REGNO.PRE_RACE_REG_NO
			FROM     TBEC_RACER_MASTER        TRM
			       , TBEC_RACER_DETAIL        TRD
			       , TBEB_TEMP_ORGAN          TTO
			       , TBEB_ARRANGE             TA
                   , TBEC_RACER_INTERVIEW     TRI
			       , (
						SELECT *
						FROM   (
						            SELECT   RANK() OVER (PARTITION BY TRRAS.RACER_NO ORDER BY APLY_DT DESC) RANK
						                   , TRRAS.*
						            FROM   TBEB_RACER_RECD_ACCU_SUM TRRAS
						            WHERE  TRRAS.APLY_DT <= (
						                                        SELECT
						                                               MAX(TRDO.RACE_DAY) RACE_DAY
						                                        FROM   TBEB_RACE_DAY_ORD TRDO
						                                        WHERE  TRDO.STND_YEAR = ?
						                                        AND    TRDO.MBR_CD    = ?
						                                        AND    TRDO.TMS       = ?
						                                    )
						            AND   MBR_CD = '000'
						            AND   TMS    = 0
						            AND   TRRAS.ST_MTHD_CD = '000' --ST방식전체설정
						       )
						WHERE  RANK = 1
			         ) TRRAS -- 선수최근성적
			       , (
						SELECT *
						FROM   (
						            SELECT   RANK() OVER (PARTITION BY TRRAS.RACER_NO ORDER BY APLY_DT DESC) RANK
						                   , TRRAS.*
						            FROM   TBEB_RACER_RECD_ACCU_SUM TRRAS
						            WHERE  TRRAS.APLY_DT <= (
						                                        SELECT
						                                               MAX(TRDO.RACE_DAY) RACE_DAY
						                                        FROM   TBEB_RACE_DAY_ORD TRDO
						                                        WHERE  TRDO.STND_YEAR = ?
						                                        AND    TRDO.MBR_CD    = ?
						                                        AND    TRDO.TMS       = ?
						                                    )
						            AND   MBR_CD = '000'
						            AND   TMS    = 0
						            AND   TRRAS.ST_MTHD_CD = '001' --ST방식 온라인
						       )
						WHERE  RANK = 1
			         ) TRRAS2 -- 선수최근성적(온라인)  
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TMRAS.MOT_NO 
                                                            ORDER BY TMRAS.STND_YEAR DESC
                                                                   , TMRAS.TMS DESC 
                                                       ) RANK
                                         , TMRAS.*
                                  FROM   TBEB_MOT_RECD_ACCU_SUM TMRAS
                                  WHERE  TMRAS.MBR_CD = ?
                                  AND    TMRAS.STND_YEAR || LPAD(TMRAS.TMS, 3, '0') <= ? || LPAD(?, 3, '0')
                                  AND    TMRAS.ST_MTHD_CD = '000' --ST방식전체설정
			                   )
			            WHERE  RANK = 1
			         ) TMRAS -- 모터최근성적
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TMRAS.MOT_NO 
                                                            ORDER BY TMRAS.STND_YEAR DESC
                                                                   , TMRAS.TMS DESC 
                                                       ) RANK
                                         , TMRAS.*
                                  FROM   TBEB_MOT_RECD_ACCU_SUM TMRAS
                                  WHERE  TMRAS.MBR_CD = ?
                                  AND    TMRAS.STND_YEAR || LPAD(TMRAS.TMS, 3, '0') <= ? || LPAD(?, 3, '0')
                                  AND    TMRAS.ST_MTHD_CD = '001' --ST방식 온라인
			                   )
			            WHERE  RANK = 1
			         ) TMRAS2 -- 모터최근성적 온라인
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TBRAS.BOAT_NO 
                                                            ORDER BY TBRAS.STND_YEAR DESC
                                                                   , TBRAS.TMS DESC 
                                                       ) RANK
                                         , TBRAS.*
                                  FROM   TBEB_BOAT_RECD_ACCU_SUM TBRAS
                                  WHERE  TBRAS.MBR_CD = ?
                                  AND    TBRAS.STND_YEAR || LPAD(TBRAS.TMS, 3, '0') <= ? || LPAD(?, 3, '0')
                                  AND    TBRAS.ST_MTHD_CD = '000' --ST방식전체설정
			                   )
			            WHERE  RANK = 1
			         ) TBRAS -- 보트최근성적
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TBRAS.BOAT_NO 
                                                            ORDER BY TBRAS.STND_YEAR DESC
                                                                   , TBRAS.TMS DESC 
                                                       ) RANK
                                         , TBRAS.*
                                  FROM   TBEB_BOAT_RECD_ACCU_SUM TBRAS
                                  WHERE  TBRAS.MBR_CD = ?
                                  AND    TBRAS.STND_YEAR || LPAD(TBRAS.TMS, 3, '0') <= ? || LPAD(?, 3, '0')
                                  AND    TBRAS.ST_MTHD_CD = '001' --ST방식전체 온라인
			                   )
			            WHERE  RANK = 1
			         ) TBRAS2 -- 보트최근성적(온라인)  
			       , (
                        SELECT
                                 RACER_NO
                               , MIN(DECODE(RACE, 1, RACE_NO || '/' || NVL(RANK, RACE_REG_NO))) RACE1
                               , MIN(DECODE(RACE, 2, RACE_NO || '/' || NVL(RANK, RACE_REG_NO))) RACE2
                        FROM            
                               (
                                    SELECT 
                                              TTO.RACER_NO
                                            , TTO.RACE_NO
                                            , TTO.RANK
                                            , TTO.RACE_REG_NO
                                            , RANK() OVER (PARTITION BY TTO.RACER_NO ORDER BY TTO.RACE_NO DESC) RACE
                                    FROM    TBEB_ORGAN TTO
                                            , TBEB_RACE_DAY_ORD TRO
						            WHERE   TTO.STND_YEAR = TRO.STND_YEAR
                                    AND     TTO.MBR_CD    = TRO.MBR_CD   
                                    AND     TTO.TMS       = TRO.TMS
                                    AND     TTO.DAY_ORD   = TRO.DAY_ORD
                                    AND     TRO.STND_YEAR = ?
                                    AND     TRO.MBR_CD    = ?
                                    AND     TRO.TMS       = ?
                                    AND     TRO.DAY_ORD   = ? - 1
                                    AND     TRO.ORGAN_STAT_CD = '002'  -- 편성 확정시
                                    UNION ALL
                                    SELECT 
                                              TTO.RACER_NO
                                            , TTO.RACE_NO
                                            , NULL AS RANK
                                            , TTO.RACE_REG_NO
                                            , RANK() OVER (PARTITION BY TTO.RACER_NO ORDER BY TTO.RACE_NO DESC) RACE
                                    FROM    TBEB_TEMP_ORGAN TTO
                                            , TBEB_RACE_DAY_ORD TRO
						            WHERE   TTO.STND_YEAR = TRO.STND_YEAR
                                    AND     TTO.MBR_CD    = TRO.MBR_CD   
                                    AND     TTO.TMS       = TRO.TMS
                                    AND     TTO.DAY_ORD   = TRO.DAY_ORD
                                    AND     TRO.STND_YEAR = ?
                                    AND     TRO.MBR_CD    = ?
                                    AND     TRO.TMS       = ?
                                    AND     TRO.DAY_ORD   = ? - 1
                                    AND     TTO.ORGAN_OWNER_ID = ?
                                    AND     TTO.ORGAN_SEQ = ?                                                             
                                    AND     TRO.ORGAN_STAT_CD = '001'  -- 편성 미확정시                                    
                               )
                        GROUP BY RACER_NO
                     ) PRE -- 전일성적 또는 전일 정번
                   , ( 
						SELECT
                              RACER_NO 
                            , MAX(RACE_CNT_11||'/'||RACE_CNT_21) AS RACE_CNT_1
                            , MAX(RACE_CNT_12||'/'||RACE_CNT_22) AS RACE_CNT_2
                            , MAX(RACE_CNT_13||'/'||RACE_CNT_23) AS RACE_CNT_3
                            , MAX(RACE_CNT_14||'/'||RACE_CNT_24) AS RACE_CNT_4
                            , MAX(RACE_CNT_15||'/'||RACE_CNT_25) AS RACE_CNT_5
                            , MAX(RACE_CNT_16||'/'||RACE_CNT_26) AS RACE_CNT_6
                            , MAX(RACE_CNT_17||'/'||RACE_CNT_27) AS RACE_CNT_7
                            , MAX(RACE_CNT_18||'/'||RACE_CNT_28) AS RACE_CNT_8
                            
                            , MAX(RACE_CNT_11_ON||'/'||RACE_CNT_21_ON) AS RACE_CNT_1_ON
						    , MAX(RACE_CNT_12_ON||'/'||RACE_CNT_22_ON) AS RACE_CNT_2_ON
						    , MAX(RACE_CNT_13_ON||'/'||RACE_CNT_23_ON) AS RACE_CNT_3_ON
						    , MAX(RACE_CNT_14_ON||'/'||RACE_CNT_24_ON) AS RACE_CNT_4_ON
						    , MAX(RACE_CNT_15_ON||'/'||RACE_CNT_25_ON) AS RACE_CNT_5_ON
						    , MAX(RACE_CNT_16_ON||'/'||RACE_CNT_26_ON) AS RACE_CNT_6_ON
						    , MAX(RACE_CNT_17_ON||'/'||RACE_CNT_27_ON) AS RACE_CNT_7_ON
						    , MAX(RACE_CNT_18_ON||'/'||RACE_CNT_28_ON) AS RACE_CNT_8_ON
                        FROM (  
                            SELECT
                                     RACER_NO
                                   , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 1 THEN 1 ELSE 0 END) RACE_CNT_11
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 1 THEN 1 ELSE 0 END) RACE_CNT_21
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 2 THEN 1 ELSE 0 END) RACE_CNT_12
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 2 THEN 1 ELSE 0 END) RACE_CNT_22
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 3 THEN 1 ELSE 0 END) RACE_CNT_13
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 3 THEN 1 ELSE 0 END) RACE_CNT_23
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 4 THEN 1 ELSE 0 END) RACE_CNT_14
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 4 THEN 1 ELSE 0 END) RACE_CNT_24
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 5 THEN 1 ELSE 0 END) RACE_CNT_15
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 5 THEN 1 ELSE 0 END) RACE_CNT_25
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 6 THEN 1 ELSE 0 END) RACE_CNT_16
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 6 THEN 1 ELSE 0 END) RACE_CNT_26
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 7 THEN 1 ELSE 0 END) RACE_CNT_17
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 7 THEN 1 ELSE 0 END) RACE_CNT_27
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 1 AND RACE_REG_NO = 8 THEN 1 ELSE 0 END) RACE_CNT_18
							       , SUM(CASE WHEN ST_MTHD_CD = '002' AND DAY_ORD = 2 AND RACE_REG_NO = 8 THEN 1 ELSE 0 END) RACE_CNT_28
                                   
                                   , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 1 THEN 1 ELSE 0 END) RACE_CNT_11_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 1 THEN 1 ELSE 0 END) RACE_CNT_21_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 2 THEN 1 ELSE 0 END) RACE_CNT_12_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 2 THEN 1 ELSE 0 END) RACE_CNT_22_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 3 THEN 1 ELSE 0 END) RACE_CNT_13_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 3 THEN 1 ELSE 0 END) RACE_CNT_23_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 4 THEN 1 ELSE 0 END) RACE_CNT_14_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 4 THEN 1 ELSE 0 END) RACE_CNT_24_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 5 THEN 1 ELSE 0 END) RACE_CNT_15_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 5 THEN 1 ELSE 0 END) RACE_CNT_25_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 6 THEN 1 ELSE 0 END) RACE_CNT_16_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 6 THEN 1 ELSE 0 END) RACE_CNT_26_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 7 THEN 1 ELSE 0 END) RACE_CNT_17_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 7 THEN 1 ELSE 0 END) RACE_CNT_27_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 1 AND RACE_REG_NO = 8 THEN 1 ELSE 0 END) RACE_CNT_18_ON
							       , SUM(CASE WHEN ST_MTHD_CD = '001' AND DAY_ORD = 2 AND RACE_REG_NO = 8 THEN 1 ELSE 0 END) RACE_CNT_28_ON
                            FROM (
                                   SELECT TBO.RACER_NO, TBO.DAY_ORD, TBO.RACE_REG_NO, TBO.ST_MTHD_CD
                                   FROM   TBEB_ORGAN TBO,
                                          TBEB_RACE_DAY_ORD TRO,
                                          TBEB_RACE_TMS TRT,
                                          TBEB_RACE TR
                                   WHERE  TBO.STND_YEAR = TRO.STND_YEAR
                                   AND    TBO.MBR_CD    = TRO.MBR_CD   
                                   AND    TBO.TMS       = TRO.TMS
                                   AND    TBO.DAY_ORD   = TRO.DAY_ORD
                                   AND    TBO.STND_YEAR = TR.STND_YEAR
                                   AND    TBO.MBR_CD    = TR.MBR_CD
                                   AND    TBO.TMS       = TR.TMS
                                   AND    TBO.DAY_ORD   = TR.DAY_ORD
                                   AND    TBO.RACE_NO   = TR.RACE_NO
                                   AND    TR.STND_YEAR  = TRT.STND_YEAR
                                   AND    TR.MBR_CD     = TRT.MBR_CD
                                   AND    TR.TMS        = TRT.TMS 
                                   AND    TBO.STND_YEAR =  ?
                                   AND    TBO.RACE_DAY  < (
                                                   SELECT
                                                           MIN(TRDO.RACE_DAY) RACE_DAY
                                                    FROM   TBEB_RACE_DAY_ORD TRDO
                                                    WHERE  TRDO.STND_YEAR =  ?
                                                    AND    TRDO.MBR_CD    =  ?
                                                    AND    TRDO.TMS       =  ?
                                                    AND    TRDO.DAY_ORD   =  ?
                                               )
                                   AND    TBO.ABSE_CD  <> '003'
                                   AND    TRO.ORGAN_STAT_CD = '002'  -- 편성 확정시
                                   AND    TR.RACE_DGRE_CD NOT IN (SELECT CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00151')
                                   AND    TRT.QURT_CD = (SELECT QURT_CD FROM TBEB_RACE_TMS WHERE STND_YEAR = ? AND MBR_CD = ? AND TMS = ?)
                                   AND	  TBO.DAY_ORD IN ('1','2') --화면 공간 때문에 1,2일차만 표현  
                                   UNION ALL
                                   SELECT RACER_NO, TBO.DAY_ORD, RACE_REG_NO, TBO.ST_MTHD_CD         
                                   FROM   TBEB_TEMP_ORGAN TBO,
                                          TBEB_RACE_DAY_ORD TRO,
                                          TBEB_RACE_TMS TRT,
                                          TBEB_RACE TR
                                   WHERE  TBO.STND_YEAR = TRO.STND_YEAR
                                   AND    TBO.MBR_CD    = TRO.MBR_CD   
                                   AND    TBO.TMS       = TRO.TMS
                                   AND    TBO.DAY_ORD   = TRO.DAY_ORD
                                   AND    TBO.STND_YEAR = TR.STND_YEAR
                                   AND    TBO.MBR_CD    = TR.MBR_CD
                                   AND    TBO.TMS       = TR.TMS
                                   AND    TBO.DAY_ORD   = TR.DAY_ORD
                                   AND    TBO.RACE_NO   = TR.RACE_NO
                                   AND    TR.STND_YEAR  = TRT.STND_YEAR
                                   AND    TR.MBR_CD     = TRT.MBR_CD
                                   AND    TR.TMS        = TRT.TMS   
                                   AND    TBO.STND_YEAR =  ?
                                   AND    TBO.MBR_CD    =  ?
                                   AND    TBO.TMS       =  ?
                                   AND    TBO.DAY_ORD   <  ?
                                   AND    TBO.ORGAN_OWNER_ID = ?
                                   AND    TBO.ORGAN_SEQ = ?
                                   AND    TRO.ORGAN_STAT_CD = '001'  -- 편성 미확정시
                                   AND    TR.RACE_DGRE_CD NOT IN (SELECT CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00151')
                                   AND    TRT.QURT_CD = (SELECT QURT_CD FROM TBEB_RACE_TMS WHERE STND_YEAR = ? AND MBR_CD = ? AND TMS = ?)
                                   AND	  TBO.DAY_ORD IN ('1','2') --화면 공간 때문에 1,2일차만 표현  
                              )
                              GROUP BY RACER_NO, ST_MTHD_CD
                            ) GROUP BY RACER_NO
            				
				     ) RACE -- 정번별 출주수
				   , (
						SELECT 
						         RACER_NO
						       , RACE_ALLOC_CNT
						FROM   TBEB_RACER_RACE_ALLOC
						WHERE  STND_YEAR = ?
						AND    MBR_CD    = ?
						AND    TMS       = ?				     
						AND    DAY_ORD   = ? + 1				     
                     ) TRRAN -- 익일 출주 배정수
				   , (
						SELECT 
						         RACER_NO
						       , COUNT(*) RACE_ALLOC_CNT
						FROM   TBEB_TEMP_ORGAN
						WHERE  STND_YEAR = ?
						AND    MBR_CD    = ?
						AND    TMS       = ?
						AND    DAY_ORD   = ? + 1
						AND    ORGAN_OWNER_ID = ?           						
						AND    ORGAN_SEQ = ?			
						GROUP BY RACER_NO
						       , DAY_ORD
				     ) NXT -- 익일 출주수
				   , (
			            SELECT  
			                     RACER_NO   
			                   , SUBSTR(MAX(SYS_CONNECT_BY_PATH (RACE_REG_NO, '/')), 2) PRE_RACE_REG_NO
			            FROM   (
		                        SELECT 
           						         TBO.RACER_NO
           						       , TBO.RACE_REG_NO
		                               , RANK() OVER (PARTITION BY TBO.RACER_NO 
		                                                  ORDER BY TBO.RACE_REG_NO
		                                             ) SEQ
		                        FROM   TBEB_ORGAN TBO,
		                               TBEB_RACE_DAY_ORD TRO
		                        WHERE  TBO.STND_YEAR = TRO.STND_YEAR
		                        AND    TBO.MBR_CD    = TRO.MBR_CD   
		                        AND    TBO.TMS       = TRO.TMS
		                        AND    TBO.DAY_ORD   = TRO.DAY_ORD
          						AND    TBO.STND_YEAR =  ?
          						AND    TBO.MBR_CD    =  ?
          						AND    TBO.TMS       =  ?
          						AND    TBO.DAY_ORD   <  ? --전일에서 이전일전체로 변경
		                        AND    TRO.ORGAN_STAT_CD = '002'  -- 편성 확정시
		                        UNION ALL
		                        SELECT 
           						         TBO.RACER_NO
           						       , TBO.RACE_REG_NO
		                               , RANK() OVER (PARTITION BY TBO.RACER_NO 
		                                                  ORDER BY TBO.RACE_REG_NO
		                                             ) SEQ
		                        FROM   TBEB_TEMP_ORGAN TBO,
		                               TBEB_RACE_DAY_ORD TRO
		                        WHERE  TBO.STND_YEAR = TRO.STND_YEAR
		                        AND    TBO.MBR_CD    = TRO.MBR_CD   
		                        AND    TBO.TMS       = TRO.TMS
		                        AND    TBO.DAY_ORD   = TRO.DAY_ORD
           						AND    TBO.STND_YEAR = ?
           						AND    TBO.MBR_CD    = ?
           						AND    TBO.TMS       = ?
           						AND    TBO.DAY_ORD   < ? 	--전일에서 이전일전체로 변경 
                                AND    TBO.ORGAN_OWNER_ID = ?
                                AND    TBO.ORGAN_SEQ  = ?           						
		                        AND    TRO.ORGAN_STAT_CD = '001'  -- 편성 미확정시
			                   )            			                         
			            START WITH SEQ = 1
			            CONNECT BY PRIOR SEQ = SEQ - 1 AND PRIOR RACER_NO = RACER_NO
			            GROUP BY RACER_NO
			         ) REGNO -- 전일정번
				   , TBEB_CNF_INSP         TCI
            WHERE  TTO.RACER_NO  = TRM  .RACER_NO 
            AND    TTO.RACER_NO  = TRD  .RACER_NO (+)
            AND    TTO.RACER_NO  = PRE  .RACER_NO (+)
            AND    TTO.RACER_NO  = RACE .RACER_NO (+)
            AND    TTO.RACER_NO  = TRRAS.RACER_NO (+)
            AND    TTO.MOT_NO    = TMRAS.MOT_NO   (+)
            AND    TTO.BOAT_NO   = TBRAS.BOAT_NO  (+)
            AND    TTO.RACER_NO  = TRRAS2.RACER_NO(+)
            AND    TTO.MOT_NO    = TMRAS2.MOT_NO  (+)
            AND    TTO.BOAT_NO   = TBRAS2.BOAT_NO (+)
            AND    TTO.STND_YEAR = TRI  .STND_YEAR(+)
            AND    TTO.MBR_CD    = TRI  .MBR_CD   (+)
            AND    TTO.TMS       = TRI  .TMS      (+)
            AND    TTO.RACER_NO  = TRI  .RACER_NO (+)
            AND    TTO.RACER_NO  = TRRAN.RACER_NO (+)
            AND    TTO.RACER_NO  = NXT  .RACER_NO (+)
            AND    TTO.RACER_NO  = REGNO.RACER_NO (+)
            AND    TTO.STND_YEAR = TCI  .STND_YEAR(+)
            AND    TTO.MBR_CD    = TCI  .MBR_CD   (+)
            AND    TTO.TMS       = TCI  .TMS      (+)
            AND    TTO.RACER_NO  = TCI  .RACER_NO (+)
            AND    TTO.STND_YEAR = TA   .STND_YEAR(+)
            AND    TTO.MBR_CD    = TA   .MBR_CD   (+)
            AND    TTO.TMS       = TA   .TMS      (+)
            AND    TTO.RACER_NO  = TA   .RACER_NO (+)
            AND    TTO.STND_YEAR = ?
            AND    TTO.MBR_CD    = ?
            AND    TTO.TMS       = ?
            AND    TTO.DAY_ORD   = ?
            AND    TTO.ORGAN_OWNER_ID   = ?
            AND    TTO.ORGAN_SEQ   = ?
            AND    TTO.RACE_NO   = NVL(?, TTO.RACE_NO)
            ORDER BY 
                       TTO.STND_YEAR
                     , TTO.MBR_CD   
                     , TTO.TMS      
                     , TTO.DAY_ORD  
                     , TTO.RACE_NO  
                     , TTO.RACE_REG_NO
		]]>
    </query> 
    
    <query id="tbeb_temp_organ_ib001" desc="가편성입력" fetchSize="10">
        <![CDATA[
        	/*  tbeb_temp_organ_ib001 IWORK_SFR-008 경정 선수편성 메뉴 개선 */
			INSERT INTO TBEB_TEMP_ORGAN
			(
			         STND_YEAR    -- 기준년도    
			       , MBR_CD       -- 경정장코드  
			       , TMS          -- 회차        
			       , DAY_ORD      -- 일차  
			       , ORGAN_OWNER_ID -- 편성소유자ID 
			       , ORGAN_SEQ	  -- 편성순번
			       , RACE_NO      -- 경주번호    
			       , RACE_REG_NO  -- 정번        
			       , RACER_NO     -- 선수등록번호
			       , MOT_NO       -- 모터번호    
			       , BOAT_NO      -- 보트번호    
			       , INST_ID      -- 작성자ID
			       , INST_DTM     -- 작성일시
			       , UPDT_ID      -- 수정자ID
			       , UPDT_DTM     -- 수정일시
			       , ST_MTHD_CD   -- ST방식
			) VALUES (
			         ?            -- 기준년도    
			       , ?            -- 경정장코드  
			       , ?            -- 회차        
			       , ?            -- 일차     
			       , ?            -- 편성소유자ID
			       , ?            -- 편성순번
			       , LPAD(?, 2, '0') -- 경주번호    
			       , ?            -- 정번        
			       , ?            -- 선수등록번호
			       , ?            -- 모터번호    
			       , ?            -- 보트번호  
			       , ?            -- 작성자ID    
			       , SYSDATE      -- 작성일시    
			       , ?            -- 수정자ID    
			       , SYSDATE      -- 수정일시    
			       , ?            -- ST방식
			)
        ]]>
    </query> 
    <query id="tbeb_temp_organ_ub001" desc="가편성수정" fetchSize="10">
        <![CDATA[
			UPDATE /*  tbeb_temp_organ_ub001 IWORK_SFR-008 경정 선수편성 메뉴 개선 */
			         TBEB_TEMP_ORGAN SET
			         RACER_NO  = ?         -- 선수등록번호
			       , MOT_NO    = ?         -- 모터번호    
			       , BOAT_NO   = ?         -- 보트번호
			       , UPDT_ID   = ?         -- 수정자ID
			       , UPDT_DTM  = SYSDATE   -- 수정일시
			       , ST_MTHD_CD = ?		   -- 온라인스타트 여부
			WHERE  STND_YEAR   = ?         -- 기준년도    
			AND    MBR_CD      = ?         -- 경정장코드  
			AND    TMS         = ?         -- 회차        
			AND    DAY_ORD     = ?         -- 일차        
			AND    ORGAN_OWNER_ID = ?      -- 편성소유자ID 
			AND    ORGAN_SEQ   = ?	       -- 편성순번
			AND    RACE_NO     = LPAD(?, 2, '0')         -- 경주번호    
			AND    RACE_REG_NO = ?         -- 정번        
        ]]>
    </query> 

    <query id="tbeb_temp_organ_fb002" desc="편성목록조회" fetchSize="10">
        <![CDATA[
			SELECT /*  tbeb_temp_organ_fb002 IWORK_SFR-008 편성목록 조회  */
			       '신규' AS ORGAN_NM
			       , ?||'-'|| TO_CHAR(NVL(MAX(ORGAN_SEQ), 0) + 1)  AS ORGAN_SEQ
			       , 'NEW' AS ORGAN_TYPE 
			FROM   TBEB_TEMP_ORGAN
            WHERE  STND_YEAR = ?
            AND    MBR_CD    = ?
            AND    TMS       = ?
            AND    DAY_ORD   = ?
            AND    ORGAN_OWNER_ID = ? 
			UNION ALL
			SELECT (
			       SELECT CD_NM
			       FROM   TBEA_SPEC_CD TSC
			       WHERE  TSC.GRP_CD = 'E00119'
			       AND    TSC.CD = A.ORGAN_STAT_CD
			       ) AS  ORGAN_NM
			       , '-' AS ORGAN_SEQ
			       , 'REAL' AS ORGAN_TYPE
			FROM  (
			        SELECT DISTINCT TRDO.ORGAN_STAT_CD
			        FROM   TBEB_ORGAN TBO 
			        INNER JOIN
			               TBEB_RACE_DAY_ORD TRDO
			        ON     TBO.STND_YEAR = TRDO.STND_YEAR
			        AND    TBO.MBR_CD = TRDO.MBR_CD
			        AND    TBO.TMS = TRDO.TMS
			        AND    TBO.DAY_ORD = TRDO.DAY_ORD
			        WHERE  TBO.STND_YEAR = ?
			        AND    TBO.MBR_CD    = ?
			        AND    TBO.TMS       = ?
			        AND    TBO.DAY_ORD   = ?
			) A
			UNION ALL                      
			SELECT 
			       VU.USER_NM||'-'||TTO.ORGAN_SEQ AS ORGAN_NM
			       , TTO.ORGAN_OWNER_ID||'-'||TTO.ORGAN_SEQ AS ORGAN_SEQ
			       , 'TEMP' AS ORGAN_TYPE
			FROM   VWEA_USER VU 
			INNER JOIN                 
			      (
			       SELECT ORGAN_OWNER_ID 
			              , ORGAN_SEQ
			       FROM   TBEB_TEMP_ORGAN 
			       WHERE  STND_YEAR = ?
			       AND    MBR_CD    = ?
			       AND    TMS       = ?
			       AND    DAY_ORD   = ?
			       GROUP BY STND_YEAR, MBR_CD, TMS, DAY_ORD, ORGAN_OWNER_ID, ORGAN_SEQ
			       ) TTO
			ON     VU.USER_ID = TTO.ORGAN_OWNER_ID
			ORDER BY ORGAN_TYPE, ORGAN_NM, ORGAN_SEQ
		]]>
    </query>     
    
    <query id="tbeb_temp_organ_fb003" desc="가편성 출주표검증 조회" fetchSize="10">
        <![CDATA[
            SELECT /*  tbeb_temp_organ_fb003 IWORK_SFR-008 경정 선수편성 메뉴 개선  */
                     TOR.STND_YEAR
                   , TOR.MBR_CD
                   , TOR.TMS
                   , TOR.DAY_ORD
                   , TOR.RACE_NO
                   , TOR.RACE_REG_NO
                   , TSC.CD_NM
                   , TOR.RACER_NO
                   , TRM.NM_KOR
                   , GET_ESC_RACE_NEW    (TOR.STND_YEAR, TOR.MBR_CD, TOR.TMS, TOR.DAY_ORD, TOR.RACE_NO, TOR.RACER_NO, TOR.ORGAN_OWNER_ID, TOR.ORGAN_SEQ) ESC_RACE
                   , GET_VERIFI_RACER_NEW(TOR.STND_YEAR, TOR.MBR_CD, TOR.TMS, TOR.DAY_ORD, TOR.RACE_NO, TOR.RACER_NO, TOR.ORGAN_OWNER_ID, TOR.ORGAN_SEQ) VERIFI_RACER
                   , GET_RELA_RACER_NEW  (TOR.STND_YEAR, TOR.MBR_CD, TOR.TMS, TOR.DAY_ORD, TOR.RACE_NO, TOR.RACER_NO, TOR.ORGAN_OWNER_ID, TOR.ORGAN_SEQ) RELA_RACER
			       , NVL(RACE .RACE_CNT_1, '0/0') RACE_CNT_1
			       , NVL(RACE .RACE_CNT_2, '0/0') RACE_CNT_2
			       , NVL(RACE .RACE_CNT_3, '0/0') RACE_CNT_3
			       , NVL(RACE .RACE_CNT_4, '0/0') RACE_CNT_4
			       , NVL(RACE .RACE_CNT_5, '0/0') RACE_CNT_5
			       , NVL(RACE .RACE_CNT_6, '0/0') RACE_CNT_6
			       , NVL(RACE .RACE_CNT_7, '0/0') RACE_CNT_7
			       , NVL(RACE .RACE_CNT_8, '0/0') RACE_CNT_8
			       , REG.REG_CNT
            FROM     TBEB_TEMP_ORGAN   TOR
                   , TBEA_SPEC_CD      TSC
                   , TBEC_RACER_MASTER TRM
                   , (						
                        SELECT
                              RACER_NO 
                            , RACE_CNT_11||'/'||RACE_CNT_21 AS RACE_CNT_1
                            , RACE_CNT_12||'/'||RACE_CNT_22 AS RACE_CNT_2
                            , RACE_CNT_13||'/'||RACE_CNT_23 AS RACE_CNT_3
                            , RACE_CNT_14||'/'||RACE_CNT_24 AS RACE_CNT_4
                            , RACE_CNT_15||'/'||RACE_CNT_25 AS RACE_CNT_5
                            , RACE_CNT_16||'/'||RACE_CNT_26 AS RACE_CNT_6
                            , RACE_CNT_17||'/'||RACE_CNT_27 AS RACE_CNT_7
                            , RACE_CNT_18||'/'||RACE_CNT_28 AS RACE_CNT_8
                        FROM (  
                            SELECT
                                     RACER_NO
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 1 THEN 1 ELSE 0 END) RACE_CNT_11
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 1 THEN 1 ELSE 0 END) RACE_CNT_21
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 2 THEN 1 ELSE 0 END) RACE_CNT_12
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 2 THEN 1 ELSE 0 END) RACE_CNT_22
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 3 THEN 1 ELSE 0 END) RACE_CNT_13
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 3 THEN 1 ELSE 0 END) RACE_CNT_23
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 4 THEN 1 ELSE 0 END) RACE_CNT_14
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 4 THEN 1 ELSE 0 END) RACE_CNT_24
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 5 THEN 1 ELSE 0 END) RACE_CNT_15
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 5 THEN 1 ELSE 0 END) RACE_CNT_25
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 6 THEN 1 ELSE 0 END) RACE_CNT_16
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 6 THEN 1 ELSE 0 END) RACE_CNT_26
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 7 THEN 1 ELSE 0 END) RACE_CNT_17
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 7 THEN 1 ELSE 0 END) RACE_CNT_27
                                   , SUM(CASE WHEN DAY_ORD = 1 AND RACE_REG_NO = 8 THEN 1 ELSE 0 END) RACE_CNT_18
                                   , SUM(CASE WHEN DAY_ORD = 2 AND RACE_REG_NO = 8 THEN 1 ELSE 0 END) RACE_CNT_28
                            FROM (
                                   SELECT TBO.RACER_NO, TBO.DAY_ORD
                                          , TBO.RACE_REG_NO
                                   FROM   TBEB_ORGAN TBO,
                                          TBEB_RACE_DAY_ORD TRO,
                                          TBEB_RACE_TMS TRT,
                                          TBEB_RACE TR
                                   WHERE  TBO.STND_YEAR = TRO.STND_YEAR
                                   AND    TBO.MBR_CD    = TRO.MBR_CD   
                                   AND    TBO.TMS       = TRO.TMS
                                   AND    TBO.DAY_ORD   = TRO.DAY_ORD
                                   AND    TBO.STND_YEAR = TR.STND_YEAR
                                   AND    TBO.MBR_CD    = TR.MBR_CD
                                   AND    TBO.TMS       = TR.TMS
                                   AND    TBO.DAY_ORD   = TR.DAY_ORD
                                   AND    TBO.RACE_NO   = TR.RACE_NO
                                   AND    TR.STND_YEAR  = TRT.STND_YEAR
                                   AND    TR.MBR_CD     = TRT.MBR_CD
                                   AND    TR.TMS        = TRT.TMS 
                                   AND    TBO.STND_YEAR =  ?
                                   AND    TBO.RACE_DAY  < (
                                                   SELECT
                                                           MIN(TRDO.RACE_DAY) RACE_DAY
                                                    FROM   TBEB_RACE_DAY_ORD TRDO
                                                    WHERE  TRDO.STND_YEAR =  ?
                                                    AND    TRDO.MBR_CD    =  ?
                                                    AND    TRDO.TMS       =  ?
                                                    AND    TRDO.DAY_ORD   =  ?
                                               )
                                   AND    TBO.ABSE_CD  <> '003'
                                   AND    TRO.ORGAN_STAT_CD = '002'  -- 편성 확정시
                                   AND    TR.RACE_DGRE_CD NOT IN (SELECT CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00151')
                                   AND    TRT.QURT_CD = (SELECT QURT_CD FROM TBEB_RACE_TMS WHERE STND_YEAR = ? AND MBR_CD = ? AND TMS = ?)
                                   AND	  TBO.DAY_ORD IN ('1','2') --화면 공간 때문에 1,2일차만 표현
                                   AND    TBO.ST_MTHD_CD = DECODE(?, '000', TBO.ST_MTHD_CD, ?)  
                                   UNION ALL
                                   SELECT RACER_NO, TBO.DAY_ORD
                                          , RACE_REG_NO         
                                   FROM   TBEB_TEMP_ORGAN TBO,
                                          TBEB_RACE_DAY_ORD TRO,
                                          TBEB_RACE_TMS TRT,
                                          TBEB_RACE TR
                                   WHERE  TBO.STND_YEAR = TRO.STND_YEAR
                                   AND    TBO.MBR_CD    = TRO.MBR_CD   
                                   AND    TBO.TMS       = TRO.TMS
                                   AND    TBO.DAY_ORD   = TRO.DAY_ORD
                                   AND    TBO.STND_YEAR = TR.STND_YEAR
                                   AND    TBO.MBR_CD    = TR.MBR_CD
                                   AND    TBO.TMS       = TR.TMS
                                   AND    TBO.DAY_ORD   = TR.DAY_ORD
                                   AND    TBO.RACE_NO   = TR.RACE_NO
                                   AND    TR.STND_YEAR  = TRT.STND_YEAR
                                   AND    TR.MBR_CD     = TRT.MBR_CD
                                   AND    TR.TMS        = TRT.TMS   
                                   AND    TBO.STND_YEAR =  ?
                                   AND    TBO.MBR_CD    =  ?
                                   AND    TBO.TMS       =  ?
                                   AND    TBO.DAY_ORD   <  ?
                                   AND    TBO.ORGAN_OWNER_ID = ?
                                   AND    TBO.ORGAN_SEQ = ?
                                   AND    TRO.ORGAN_STAT_CD = '001'  -- 편성 미확정시
                                   AND    TR.RACE_DGRE_CD NOT IN (SELECT CD FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00151')
                                   AND    TRT.QURT_CD = (SELECT QURT_CD FROM TBEB_RACE_TMS WHERE STND_YEAR = ? AND MBR_CD = ? AND TMS = ?)
                                   AND	  TBO.DAY_ORD IN ('1','2') --화면 공간 때문에 1,2일차만 표현  
                                   AND    TBO.ST_MTHD_CD = DECODE(?, '000', TBO.ST_MTHD_CD, ?)
                              )
                              GROUP BY RACER_NO
                            )
                       
                     ) RACE -- 년도별 정번수
                   , (
						SELECT
						         RACER_NO
						       , RACE_REG_NO
						       , COUNT(*) REG_CNT
                        FROM (
                               SELECT TOR.RACER_NO
                                      , TOR.RACE_REG_NO
						       FROM   TBEB_ORGAN TOR,
                                      TBEB_RACE_DAY_ORD TRO
						       WHERE  TOR.STND_YEAR = TRO.STND_YEAR
                               AND    TOR.MBR_CD    = TRO.MBR_CD   
                               AND    TOR.TMS       = TRO.TMS
                               AND    TOR.DAY_ORD   = TRO.DAY_ORD
		                       AND    TOR.STND_YEAR      = ?
		                       AND    TOR.MBR_CD         = ?
		                       AND    TOR.TMS            = ?
		                       AND    TOR.DAY_ORD       <= ?                               
                               AND    TRO.ORGAN_STAT_CD = '002'  -- 편성 확정시
                               AND    TOR.ST_MTHD_CD = DECODE(?, '000', TOR.ST_MTHD_CD, ?)
                               UNION ALL
                               SELECT TBO.RACER_NO
                                      , TBO.RACE_REG_NO         
	                           FROM   TBEB_TEMP_ORGAN TBO,
		                              TBEB_RACE_DAY_ORD TRO
		                       WHERE  TBO.STND_YEAR = TRO.STND_YEAR
		                       AND    TBO.MBR_CD    = TRO.MBR_CD   
		                       AND    TBO.TMS       = TRO.TMS
		                       AND    TBO.DAY_ORD   = TRO.DAY_ORD
                               AND    TBO.STND_YEAR =  ?
                               AND    TBO.MBR_CD    =  ?
                               AND    TBO.TMS       =  ?
                               AND    TBO.DAY_ORD   <=  ?
                               AND    TBO.ORGAN_OWNER_ID = ?
                               AND    TBO.ORGAN_SEQ = ?
                               AND    TRO.ORGAN_STAT_CD = '001'  -- 편성 미확정시
                               AND    TBO.ST_MTHD_CD = DECODE(?, '000', TBO.ST_MTHD_CD, ?)
                          )
                          GROUP BY RACER_NO, RACE_REG_NO
                          HAVING COUNT(*) > 1	                        
                     ) REG -- 회차별 정번수
            WHERE  TOR.RACE_REG_NO = TSC.CD
            AND    TSC.GRP_CD      = 'E00009'
            AND    TOR.RACER_NO    = TRM .RACER_NO
            AND    TOR.RACER_NO    = RACE.RACER_NO   (+)
            AND    TOR.RACER_NO    = REG .RACER_NO   (+)
            AND    TOR.RACE_REG_NO = REG .RACE_REG_NO(+)
            AND    TOR.STND_YEAR   = ?
			AND    TOR.MBR_CD      = ?
			AND    TOR.TMS         = ?
			AND    TOR.DAY_ORD     = ?
            AND    TOR.ORGAN_OWNER_ID = ?
            AND    TOR.ORGAN_SEQ = ?	
            AND    TOR.ST_MTHD_CD = DECODE(?, '000', TOR.ST_MTHD_CD, ?)		
            ORDER BY 
                     TOR.STND_YEAR
                   , TOR.MBR_CD
                   , TOR.TMS
                   , TOR.DAY_ORD
                   , TOR.RACE_NO
                   , TOR.RACE_REG_NO
		]]>
    </query>  
    
    <query id="tbeb_temp_organ_fb004" desc="가편성 기수별 출주횟수 조회" fetchSize="10">
        <![CDATA[
			SELECT /*  tbeb_temp_organ_fb004 IWORK_SFR-008 경정 선수편성 메뉴 개선  */
			         TOR.STND_YEAR
			       , TOR.MBR_CD
			       , TOR.TMS
			       , TOR.DAY_ORD
			       , TOR.RACE_NO
			       , TRM.RACER_PERIO_NO
			       , TOR.RACE_NO || TRM.RACER_PERIO_NO PERIO_NO
			       , COUNT(*) CNT
			FROM   TBEB_TEMP_ORGAN     TOR
			       , TBEC_RACER_MASTER TRM
			WHERE  TOR.RACER_NO  = TRM.RACER_NO
			AND    TOR.STND_YEAR = ?
			AND    TOR.MBR_CD    = ?
			AND    TOR.TMS       = ?
			AND    TOR.DAY_ORD   = ?
            AND    TOR.ORGAN_OWNER_ID   = ?
            AND    TOR.ORGAN_SEQ   = ?
            AND    TOR.ST_MTHD_CD = DECODE(?, '000', TOR.ST_MTHD_CD, ?)
			GROUP BY
			         TOR.STND_YEAR
			       , TOR.MBR_CD
			       , TOR.TMS
			       , TOR.DAY_ORD
			       , TOR.RACE_NO
			       , TRM.RACER_PERIO_NO
			ORDER BY 
			         TOR.STND_YEAR
			       , TOR.MBR_CD
			       , TOR.TMS
			       , TOR.DAY_ORD
			       , TOR.RACE_NO    
		]]>
    </query>     
    <query id="tbeb_temp_organ_fb005" desc="가편성 최종저장자 조회" fetchSize="10">
        <![CDATA[
            SELECT /*  tbeb_temp_organ_fb005 IWORK_SFR-008 경정 선수편성 메뉴 개선  */
                     LAST_ID
                   , VU.USER_NM LAST_NM 
                   , LAST_DTM 
              FROM (
              	   	SELECT   DECODE(NVL(MAX(UPDT_DTM),''),'', MAX(INST_ID), MAX(UPDT_ID)) LAST_ID
            	           , DECODE(NVL(MAX(UPDT_DTM),''),'', MAX(INST_DTM), MAX(UPDT_DTM)) LAST_DTM 
            	      FROM (
              	   	         SELECT   MAX(INST_ID) INST_ID
                        	                    , MAX(INST_DTM) INST_DTM
                        	                    , '' UPDT_ID
            	                    , TO_DATE('') UPDT_DTM
            	               FROM   TBEB_TEMP_ORGAN
            	              WHERE   STND_YEAR = ?
            	                AND   MBR_CD = ?
            	                AND   TMS = ?
            	                AND   DAY_ORD = ?
            	                AND   ORGAN_OWNER_ID = ?
            	                AND   ORGAN_SEQ = ?
            	                AND   INST_DTM = (SELECT MAX(INST_DTM) 
                                                    FROM TBEB_TEMP_ORGAN
                                                   WHERE STND_YEAR = ?
                                                     AND MBR_CD = ?
                                                     AND TMS = ?
                                                     AND DAY_ORD = ?
                                                     AND ORGAN_OWNER_ID = ?
                                                     AND ORGAN_SEQ = ?
                                                     )
              	   	         UNION ALL
              	   	         SELECT ''
            		                , TO_DATE('')
            			            , MAX(UPDT_ID)
            			            , MAX(UPDT_DTM)
            	             FROM   TBEB_TEMP_ORGAN
            	            WHERE   STND_YEAR = ?
            	              AND   MBR_CD = ?
            	              AND   TMS = ?
            	              AND   DAY_ORD = ?
            	              AND   ORGAN_OWNER_ID = ?
            	              AND   ORGAN_SEQ = ?            	              
            	              AND   UPDT_DTM = (SELECT MAX(UPDT_DTM) 
                                                  FROM TBEB_TEMP_ORGAN
                                                 WHERE STND_YEAR = ?
                                                   AND MBR_CD = ?
                                                   AND TMS = ?
                                                   AND DAY_ORD = ?
                                                   AND ORGAN_OWNER_ID = ?
                                                   AND ORGAN_SEQ = ?
                                                   )
                           )
                   ) LAST
            	   , VWEA_USER VU
             WHERE LAST.LAST_ID = VU.USER_ID	   
		]]>
    </query>         
    <query id="tbeb_racer_result_se001" desc="선수정보 팝업 조회" fetchSize="10">
        <![CDATA[     
			/* 선수정보 팝업 조회   */
			SELECT TMS, 
			           DAY_ORD, 
			           RACE_DAY, 
			           RACE_NO, 
			           RANK, 
			           RACE_REG_NO, 
			           INTRO_RUN_TM, 
			           STAR_TM,
			           GET_RSLT_PAYOFF(STND_YEAR, '003', TMS, DAY_ORD, RACE_NO, '004', NULL) AS FIXMONEY_E,
			           GET_RSLT_PAYOFF(STND_YEAR, '003', TMS, DAY_ORD, RACE_NO, '006', NULL) AS FIXMONEY_T
			FROM TBEB_ORGAN
			WHERE 1=1
			           AND STND_YEAR = ?
			           AND MBR_CD = ?
			           AND RACER_NO = ?
			           AND ST_MTHD_CD = ?
			ORDER BY TMS DESC, DAY_ORD DESC, RACE_NO
		]]>
    </query>  
    
    <query id="tbeb_motor_result_se001" desc="모터정보 팝업 조회" fetchSize="10">
        <![CDATA[     
			/*  모터정보 팝업조회   */           
			SELECT TMS, 
			           DAY_ORD, 
			           RACE_DAY, 
			           RACE_NO, 
			           RANK, 
			           RACE_REG_NO, 
			           FC_GET_RACERNAME(RACER_NO) AS RACER_NM,
			           INTRO_RUN_TM
			FROM TBEB_ORGAN
			WHERE 1=1
			           AND STND_YEAR = ?
			           AND MBR_CD = ?
			           AND MOT_NO = ?
			           AND ST_MTHD_CD = ?
			ORDER BY TMS DESC, DAY_ORD DESC, RACE_NO
		]]>
    </query>  
          
    <query id="tbeb_boat_result_se001" desc="보트정보 팝업 조회" fetchSize="10">
        <![CDATA[     
			/* 보트정보 팝업 조회    */           
			SELECT TMS, 
			           DAY_ORD, 
			           RACE_DAY, 
			           RACE_NO, 
			           RANK, 
			           RACE_REG_NO,
			           FC_GET_RACERNAME(RACER_NO) AS RACER_NM,
			           INTRO_RUN_TM
			FROM TBEB_ORGAN
			WHERE 1=1
			           AND STND_YEAR = ?
			           AND MBR_CD = ?
			           AND BOAT_NO = ?
			           AND ST_MTHD_CD = ?
			ORDER BY TMS DESC, DAY_ORD DESC, RACE_NO 
		]]>
    </query>      
</queryMap>