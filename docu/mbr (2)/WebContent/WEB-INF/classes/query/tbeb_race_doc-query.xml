<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbeb_race_day_ord(출주표)">
    <query id="tbeb_race_doc_fb001" desc="출주표조회" fetchSize="10">
        <![CDATA[
			SELECT  /*  tbeb_race_doc_fb001 IWORK_SFR-008 경정 선수편성 메뉴 개선  */
			         TRD.STND_YEAR
			       , TRD.MBR_CD
			       , TRD.TMS
			       , TRD.DAY_ORD
			       , TRD.ORGAN_STAT_CD
			       , TRD.RACE_NO
			       , TRD.RACE_REG_NO
			       , TRD.RACE_DAY 
			       , TRD.COLOR                          RACE_REG_COLOR
			       , TRD.RACER_PERIO_NO                 RACER_PERIO_NO
			       , TRD.RACER_GRD_CD               	RACER_GRD_CD	-- 출주표 등급추가. 2013.1.18
			       , TRD.RACER_NO                       RACER_NO
			       , TRD.RACER_NM                       NM_KOR
                   , DECODE(SUBSTR(GET_DEC(TRDT.RES_NO), 7, 1), 2, '여', 4, '여','남') RACER_SEX     --성별
			       , TRD.ABSE_CD                        ABSE_CD
			       , TRD.AGE                            AGE
			       , TRD.WGHT                           ENTRY_BODY_WGHT
			       , TRD.BOAT_NO                        BOAT_NO
			       , SUBSTR(TRD.BOAT_NO, 6, 3)          VIEW_BOAT_NO
			       , TRD.MOT_NO                         MOT_NO
			       , SUBSTR(TRD.MOT_NO , 6, 3)          VIEW_MOT_NO
			       , TRD.TMS_6_AVG_RANK_SCR             TRRAS_TMS_6_AVG_RANK_SCR     
			       , TRD.TMS_6_AVG_ACDNT_SCR            TRRAS_TMS_6_AVG_ACDNT_SCR    
			       , TRD.TMS_6_AVG_SCR                  TRRAS_TMS_6_AVG_SCR          
			       , TRD.TMS_6_WIN_RATIO                TRRAS_TMS_6_WIN_RATIO        
			       , TRD.TMS_6_HIGH_RANK_RATIO          TRRAS_TMS_6_HIGH_RANK_RATIO  
			       , TRD.TMS_6_HIGH_3_RANK_RATIO        TRRAS_TMS_6_HIGH_3_RANK_RATIO
			       , TRD.TMS_6_AVG_STRT_TM              TRRAS_TMS_6_AVG_STRT_TM      
			       , TRD.TMS_8_RANK_ORD                 TRRAS_TMS_8_RANK_ORD         
			       , TRD.AVG_RANK_SCR                   TRRAS_AVG_RANK_SCR     
			       , TRD.AVG_ACDNT_SCR                  AVG_ACDNT_SCR    
			       , TRD.AVG_SCR                        TRRAS_AVG_SCR          
			       , TRD.WIN_RATIO                      TRRAS_WIN_RATIO        
			       , TRD.HIGH_RANK_RATIO                TRRAS_HIGH_RANK_RATIO  
			       , TRD.HIGH_3_RANK_RATIO              TRRAS_HIGH_3_RANK_RATIO
			       , TRD.AVG_STRT_TM                    TRRAS_AVG_STRT_TM      
			       , TRD.FL_CNT                         FL_CNT
			       , TRD.MM_6_RACE_CNT                  MON_6_RACE_CNT
			       , TRD.MM_6_HIGH_RANK_RATIO           MON_6_HIGH_RANK_RATIO
			       , TRD.MM_6_1_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_1
			       , TRD.MM_6_2_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_2
			       , TRD.MM_6_3_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_3
			       , TRD.MM_6_4_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_4
			       , TRD.MM_6_5_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_5
			       , TRD.MM_6_6_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_6
			       , TRD.MM_6_7_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_7
			       , TRD.MM_6_8_RACE_HIGH_RANK_RATIO    MON_6_RACE_REG_NO_8
			       , TRD.MOT_AVG_RANK_SCR               TMRAS_AVG_RANK_SCR     
			       , TRD.MOT_HIGH_RANK_RATIO            TMRAS_HIGH_RANK_RATIO  
			       , TRD.MOT_HIGH_3_RANK_RATIO          TMRAS_HIGH_3_RANK_RATIO
			       , TRD.MOT_BF_RACER_NO_1              MOT_PRE_RECE1
			       , TRD.MOT_BF_RACER_NO_2              MOT_PRE_RECE2
			       , TRD.BOAT_AVG_RANK_SCR              TBRAS_AVG_RANK_SCR     
			       , TRD.BOAT_HIGH_RANK_RATIO           TBRAS_HIGH_RANK_RATIO  
			       , TRD.BOAT_HIGH_3_RANK_RATIO         TBRAS_HIGH_3_RANK_RATIO
			       , TRD.THDD_RACE                      ETC_RACE
                   , DECODE(TRD.ORGAN_STAT_CD, '002', TRD.BF_DD_RECD) PRE_RACE
			       , TRD.SPEC_INFO                      RMK
			       , TRD.INST_ID
			       , TRD.INST_DTM
			       , TRD.UPDT_ID
			       , TRD.UPDT_DTM
			FROM     TBEB_RACE_DOC TRD
			       , TBEC_RACER_DETAIL TRDT
			WHERE  TRD.STND_YEAR     = ?
			AND    TRD.MBR_CD        = ?
			AND    TRD.TMS           = ?
			AND    TRD.DAY_ORD       = ?
			AND    TRD.ORGAN_STAT_CD = ?
			AND    TRD.RACE_NO       = NVL(?, TRD.RACE_NO)
			AND    TRD.RACER_NO = TRDT.RACER_NO
			ORDER BY TRD.STND_YEAR
			       , TRD.MBR_CD
			       , TRD.TMS
			       , TRD.DAY_ORD
			       , TRD.ORGAN_STAT_CD
			       , TRD.RACE_NO
			       , TRD.RACE_REG_NO
        ]]>
    </query> 
    <query id="tbeb_race_doc_ib001" desc="출주표저장" fetchSize="10">
        <![CDATA[
			INSERT /* tbeb_race_doc_ib001 출주표저장*/
			       INTO TBEB_RACE_DOC /*  tbeb_race_doc_ib001 IWORK_SFR-008 경정 선수편성 메뉴 개선  */
			(
			         STND_YEAR
			       , MBR_CD
			       , TMS
			       , DAY_ORD
			       , ORGAN_STAT_CD
			       , RACE_NO
			       , RACE_REG_NO
			       , RACE_DAY
			       , COLOR
			       , RACER_PERIO_NO
			       , RACER_GRD_CD	-- 출주표 등급추가. 2013.1.18
			       , RACER_NO
			       , RACER_NM
			       , ABSE_CD
			       , AGE
			       , WGHT
			       , BOAT_NO
			       , MOT_NO
			       , TMS_6_AVG_RANK_SCR
			       , TMS_6_AVG_ACDNT_SCR
			       , TMS_6_AVG_SCR
			       , TMS_6_WIN_RATIO
			       , TMS_6_HIGH_RANK_RATIO
			       , TMS_6_HIGH_3_RANK_RATIO
			       , TMS_6_AVG_STRT_TM
			       , TMS_8_RANK_ORD
			       , AVG_RANK_SCR
			       , AVG_ACDNT_SCR
			       , AVG_SCR
			       , WIN_RATIO
			       , HIGH_RANK_RATIO
			       , HIGH_3_RANK_RATIO
			       , AVG_STRT_TM
			       , FL_CNT
			       , MM_6_RACE_CNT
			       , MM_6_HIGH_RANK_RATIO
			       , MM_6_1_RACE_HIGH_RANK_RATIO
			       , MM_6_2_RACE_HIGH_RANK_RATIO
			       , MM_6_3_RACE_HIGH_RANK_RATIO
			       , MM_6_4_RACE_HIGH_RANK_RATIO
			       , MM_6_5_RACE_HIGH_RANK_RATIO
			       , MM_6_6_RACE_HIGH_RANK_RATIO
			       , MM_6_7_RACE_HIGH_RANK_RATIO
			       , MM_6_8_RACE_HIGH_RANK_RATIO
			       , MOT_AVG_RANK_SCR
			       , MOT_HIGH_RANK_RATIO
			       , MOT_HIGH_3_RANK_RATIO
			       , MOT_BF_RACER_NO_1
			       , MOT_BF_RACER_NO_2
			       , BOAT_AVG_RANK_SCR
			       , BOAT_HIGH_RANK_RATIO
			       , BOAT_HIGH_3_RANK_RATIO
			       , THDD_RACE
			       , BF_DD_RECD
			       , SPEC_INFO
			       , INST_ID
			       , INST_DTM
			       , UPDT_ID
			       , UPDT_DTM
			       , ST_MTHD_CD
			)
            SELECT
	                 TOR  .STND_YEAR
	               , TOR  .MBR_CD
	               , TOR  .TMS
	               , TOR  .DAY_ORD
	               , ?
	               , TOR  .RACE_NO
	               , TOR  .RACE_REG_NO
	               , TOR  .RACE_DAY
	               , ( SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00009' AND CD = TOR.RACE_REG_NO ) RACE_REG_COLOR
			       , TRM  .RACER_PERIO_NO
			       , TOR  .RACER_GRD_CD 	-- 출주표 등급추가. 2013.1.18
			       , TOR  .RACER_NO                                                         -- 선수등록번호
			       , TRM  .NM_KOR
			       , TOR  .ABSE_CD
			       , TOR  .STND_YEAR - SUBSTR(TRD  .BIRTH_DT, 1, 4) AGE
			       , ROUND(NVL(TRI  .ENTRY_BODY_WGHT, TRD  .WGHT)) ENTRY_BODY_WGHT
--			       , ROUND(TRI.ENTRY_BODY_WGHT) ENTRY_BODY_WGHT
			       , TOR  .BOAT_NO                                                          -- 보트번호
			       , TOR  .MOT_NO                                                           -- 모터번호
                   
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_RANK_SCR     , 0), NVL(TRRAS.TMS_6_AVG_RANK_SCR    ,  0))   TRRAS_TMS_6_AVG_RANK_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_ACDNT_SCR    , 0), NVL(TRRAS.TMS_6_AVG_ACDNT_SCR    , 0))   TRRAS_TMS_6_AVG_ACDNT_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_SCR          , 0), NVL(TRRAS.TMS_6_AVG_SCR          , 0))   TRRAS_TMS_6_AVG_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_WIN_RATIO        , 0), NVL(TRRAS.TMS_6_WIN_RATIO        , 0))   TRRAS_TMS_6_WIN_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_HIGH_RANK_RATIO  , 0), NVL(TRRAS.TMS_6_HIGH_RANK_RATIO  , 0))   TRRAS_TMS_6_HIGH_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_HIGH_3_RANK_RATIO, 0), NVL(TRRAS.TMS_6_HIGH_3_RANK_RATIO, 0))   TRRAS_TMS_6_HIGH_3_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_STRT_TM      , 0), NVL(TRRAS.TMS_6_AVG_STRT_TM      , 0))   TRRAS_TMS_6_AVG_STRT_TM
                   , DECODE(TOR.ST_MTHD_CD, '001',TRRAS2.TMS_8_RANK_ORD                 , TRRAS.TMS_8_RANK_ORD                 )   TRRAS_TMS_8_RANK_ORD
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.AVG_RANK_SCR           , 0), NVL(TRRAS.AVG_RANK_SCR           , 0))   TRRAS_AVG_RANK_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001'
			                                     ,NVL(DECODE(TRST.QURT_CD, '001', TRRAS2.BF_AVG_ACDNT_SCR, '002', TRRAS2.AF_AVG_ACDNT_SCR),0)
			                                     ,NVL(DECODE(TRST.QURT_CD, '001',  TRRAS.BF_AVG_ACDNT_SCR, '002',  TRRAS.AF_AVG_ACDNT_SCR),0)
			       								 ) AVG_ACDNT_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.AVG_SCR                , 0), NVL(TRRAS.AVG_SCR                , 0))   TRRAS_AVG_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.WIN_RATIO              , 0), NVL(TRRAS.WIN_RATIO              , 0))   TRRAS_WIN_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.HIGH_RANK_RATIO        , 0), NVL(TRRAS.HIGH_RANK_RATIO        , 0))   TRRAS_HIGH_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.HIGH_3_RANK_RATIO      , 0), NVL(TRRAS.HIGH_3_RANK_RATIO      , 0))   TRRAS_HIGH_3_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',TRRAS2.AVG_STRT_TM                    , TRRAS.AVG_STRT_TM                    )   TRRAS_AVG_STRT_TM

 			       , DECODE(TOR.ST_MTHD_CD, '001'							 
			                                     ,DECODE(TRST.QURT_CD, '001', 'F' || NVL(TRRAS2.BF_F_CNT, 0) || 'L' || NVL(TRRAS2.BF_L_CNT, 0), '002', 'F' || NVL(TRRAS2.AF_F_CNT, 0) || 'L' || NVL(TRRAS2.AF_L_CNT, 0)) 
			                                     ,DECODE(TRST.QURT_CD, '001', 'F' || NVL(TRRAS.BF_F_CNT, 0)  || 'L' || NVL(TRRAS.BF_L_CNT, 0),  '002', 'F' || NVL(TRRAS.AF_F_CNT, 0)  || 'L' || NVL(TRRAS.AF_L_CNT, 0))
			                                     ) FL_CNT
                   , NVL(MON_6.MON_6_RACE_CNT, 0) MON_6_RACE_CNT
                   , NVL(MON_6.MON_6_HIGH_RANK_RATIO, '0.0') MON_6_HIGH_RANK_RATIO
                   , NVL(MON_6.MON_6_RACE_REG_NO_1, '00.0/0') MON_6_RACE_REG_NO_1
                   , NVL(MON_6.MON_6_RACE_REG_NO_2, '00.0/0') MON_6_RACE_REG_NO_2
                   , NVL(MON_6.MON_6_RACE_REG_NO_3, '00.0/0') MON_6_RACE_REG_NO_3
                   , NVL(MON_6.MON_6_RACE_REG_NO_4, '00.0/0') MON_6_RACE_REG_NO_4
                   , NVL(MON_6.MON_6_RACE_REG_NO_5, '00.0/0') MON_6_RACE_REG_NO_5
                   , NVL(MON_6.MON_6_RACE_REG_NO_6, '00.0/0') MON_6_RACE_REG_NO_6
                   , NVL(MON_6.MON_6_RACE_REG_NO_7, '00.0/0') MON_6_RACE_REG_NO_7
                   , NVL(MON_6.MON_6_RACE_REG_NO_8, '00.0/0') MON_6_RACE_REG_NO_8

                   , NVL(TMRAS.AVG_RANK_SCR     , 0)   TMRAS_AVG_RANK_SCR
                   , NVL(TMRAS.HIGH_RANK_RATIO  , 0)   TMRAS_HIGH_RANK_RATIO
                   , NVL(TMRAS.HIGH_3_RANK_RATIO, 0)   TMRAS_HIGH_3_RANK_RATIO
                   , MPR  .MOT_PRE_RECE1
                   , MPR  .MOT_PRE_RECE2

                   , NVL(TBRAS.AVG_RANK_SCR     , 0)   TBRAS_AVG_RANK_SCR
                   , NVL(TBRAS.HIGH_RANK_RATIO  , 0)   TBRAS_HIGH_RANK_RATIO
                   , NVL(TBRAS.HIGH_3_RANK_RATIO, 0)   TBRAS_HIGH_3_RANK_RATIO
			       , (
                        SELECT 
                                DECODE(TR.RACE_DGRE_CD, '501', '특', '701', '특', '702', '특', '')||TODAY.RACE_NO RACE_NO
                        FROM    TBEB_ORGAN TODAY
                              , TBEB_RACE    TR
                              , TBEA_SPEC_CD TSC
                        WHERE   TODAY.STND_YEAR   = TOR.STND_YEAR  
                        AND     TODAY.MBR_CD      = TOR.MBR_CD     
                        AND     TODAY.TMS         = TOR.TMS        
                        AND     TODAY.DAY_ORD     = TOR.DAY_ORD    
                        AND     TODAY.RACE_NO    <> TOR.RACE_NO    
                        AND     TODAY.RACER_NO    = TOR.RACER_NO   
                        AND     TODAY.STND_YEAR   = TR.STND_YEAR
                        AND     TODAY.MBR_CD      = TR.MBR_CD
                        AND     TODAY.TMS         = TR.TMS
                        AND     TODAY.DAY_ORD     = TR.DAY_ORD
                        AND     TODAY.RACE_NO     = TR.RACE_NO
                        AND     TSC.CD            = TR.RACE_DGRE_CD
                        AND     TSC.GRP_CD        = 'E00005'
                     ) ETC_RACE  
                   , DECODE(?, '002', RACE .PRE_RACE)
			       , TCI  .SPEC_INFO RMK                           
				   , ?
				   , SYSDATE
				   , ?
				   , SYSDATE
				   , TOR.ST_MTHD_CD
			FROM     TBEB_RACE_TMS            TRT
			       , TBEC_RACER_MASTER        TRM
			       , TBEC_RACER_DETAIL        TRD
			       , TBEB_ORGAN               TOR
                   , TBEC_RACER_INTERVIEW     TRI
			       , (
						SELECT *
						FROM   (
						            SELECT   RANK() OVER (PARTITION BY TRRAS.RACER_NO ORDER BY APLY_DT DESC) RANK
						                   , TRRAS.*
						            FROM   TBEB_RACER_RECD_ACCU_SUM TRRAS
						            WHERE  TRRAS.APLY_DT  < (
						                                        SELECT
						                                               MIN(TRDO.RACE_DAY) RACE_DAY
						                                        FROM   TBEB_RACE_DAY_ORD TRDO
						                                        WHERE  TRDO.STND_YEAR = ?
						                                        AND    TRDO.MBR_CD    = ?
						                                        AND    TRDO.TMS       = ?
						                                    )
						            AND   MBR_CD = '000'
						            AND   TMS    = 0
						            AND   TRRAS.ST_MTHD_CD = '000' --ST방식전체설정
						       )
						WHERE  RANK = 1
			         ) TRRAS -- 선수최근성적
			       , (
						SELECT *
						FROM   (
						            SELECT   RANK() OVER (PARTITION BY TRRAS.RACER_NO ORDER BY APLY_DT DESC) RANK
						                   , TRRAS.*
						            FROM   TBEB_RACER_RECD_ACCU_SUM TRRAS
						            WHERE  TRRAS.APLY_DT  < (
						                                        SELECT
						                                               MIN(TRDO.RACE_DAY) RACE_DAY
						                                        FROM   TBEB_RACE_DAY_ORD TRDO
						                                        WHERE  TRDO.STND_YEAR = ?
						                                        AND    TRDO.MBR_CD    = ?
						                                        AND    TRDO.TMS       = ?
						                                    )
						            AND   MBR_CD = '000'
						            AND   TMS    = 0
						            AND   TRRAS.ST_MTHD_CD = '001' --ST방식 온라인
						       )
						WHERE  RANK = 1
			         ) TRRAS2 -- 선수최근성적(온라인)
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TMRAS.MOT_NO 
                                                            ORDER BY TMRAS.STND_YEAR DESC
                                                                   , TMRAS.TMS DESC 
                                                       ) RANK
                                         , TMRAS.*
                                  FROM   TBEB_MOT_RECD_ACCU_SUM TMRAS
                                  WHERE  TMRAS.MBR_CD = ?
                                  AND    TMRAS.STND_YEAR || LPAD(TMRAS.TMS, 3, '0') < ? || LPAD(?, 3, '0')
                                  AND    TMRAS.ST_MTHD_CD = '000' --ST방식전체설정
			                   )
			            WHERE  RANK = 1
			         ) TMRAS -- 모터최근성적
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TBRAS.BOAT_NO 
                                                            ORDER BY TBRAS.STND_YEAR DESC
                                                                   , TBRAS.TMS DESC 
                                                       ) RANK
                                         , TBRAS.*
                                  FROM   TBEB_BOAT_RECD_ACCU_SUM TBRAS
                                  WHERE  TBRAS.MBR_CD = ?
                                  AND    TBRAS.STND_YEAR || LPAD(TBRAS.TMS, 3, '0') < ? || LPAD(?, 3, '0')
                                  AND    TBRAS.ST_MTHD_CD = '000' --ST방식전체설정
			                   )
			            WHERE  RANK = 1
			         ) TBRAS -- 보트최근성적
                   , (
                        SELECT
                                 MOT_NO
                               , MIN(DECODE(TMS, 1, MOT_PRE_RECE)) MOT_PRE_RECE1
                               , MIN(DECODE(TMS, 2, MOT_PRE_RECE)) MOT_PRE_RECE2
                        FROM   (
                                    SELECT
                                             TOR.MOT_NO
                                           , TRM.NM_KOR || '/' || RACE MOT_PRE_RECE
                                           , RANK() OVER (PARTITION BY TOR.MOT_NO
                                                              ORDER BY TRT.STR_DT DESC) TMS
                                    FROM     TBEB_RACE_TMS     TRT
                                           , TBEC_RACER_MASTER TRM
                                           , (
                                                SELECT
                                                         TOR.STND_YEAR
                                                       , TOR.MBR_CD
                                                       , TOR.TMS
                                                       , TOR.MOT_NO
                                                       , TOR.RACER_NO
                                                       , MIN(DECODE(TOR.RACE, 1, RANK))
                                                      || MIN(DECODE(TOR.RACE, 2, RANK))
                                                      || MIN(DECODE(TOR.RACE, 3, RANK))
                                                      || MIN(DECODE(TOR.RACE, 4, RANK)) RACE
                                                FROM   (
                                                            SELECT
                                                                     TOR.STND_YEAR
                                                                   , TOR.MBR_CD
                                                                   , TOR.TMS
                                                                   , TOR.MOT_NO
                                                                   , TOR.RACER_NO
                                                                   , DECODE(TOR.IMMT_CLS_CD, '003', '', TOR.RANK) RANK
                                                                   , RANK() OVER (PARTITION BY TOR.MOT_NO, TOR.RACER_NO
                                                                                      ORDER BY TOR.RACE_DAY DESC
                                                                                             , TOR.RACE_NO  DESC) RACE
                                                            FROM     TBEB_ORGAN        TOR
                                                                   , (
                                                                        SELECT
                                                                                  STND_YEAR
                                                                                , MBR_CD
                                                                                , TMS
                                                                                , MOT_NO
                                                                                , RANK() OVER (PARTITION BY MOT_NO
                                                                                                   ORDER BY RACE_DAY DESC) TMS_2
                                                                        FROM    (
                                                                                    SELECT
                                                                                              STND_YEAR
                                                                                            , MBR_CD
                                                                                            , TMS
                                                                                            , MOT_NO
                                                                                            , MAX(RACE_DAY) RACE_DAY
                                                                                    FROM    TBEB_ORGAN
                                                                                    WHERE   RACE_DAY < (
                                                                                                            SELECT
                                                                                                                   MIN(RACE_DAY)
                                                                                                            FROM   TBEB_RACE_DAY_ORD
                                                                                                            WHERE  STND_YEAR = ?
                                                                                                            AND    MBR_CD    = ?
                                                                                                            AND    TMS       = ?
                                                                                                       )
                                                                                    AND    ABSE_CD  <> '003'
                                                                                    GROUP BY
                                                                                              STND_YEAR
                                                                                            , MBR_CD
                                                                                            , TMS
                                                                                            , MOT_NO
                                                                                )
                                                                     ) TMS_2
                                                            WHERE  TOR.STND_YEAR = TMS_2.STND_YEAR
                                                            AND    TOR.MBR_CD    = TMS_2.MBR_CD
                                                            AND    TOR.TMS       = TMS_2.TMS
                                                            AND    TOR.MOT_NO    = TMS_2.MOT_NO
                                                            AND    TMS_2.TMS_2   < 3
                                                            AND    TOR.ABSE_CD     <> '003'
                                                       ) TOR
                                                GROUP BY
                                                         TOR.STND_YEAR
                                                       , TOR.MBR_CD
                                                       , TOR.TMS
                                                       , TOR.MOT_NO
                                                       , TOR.RACER_NO
                                             ) TOR
                                    WHERE  TRT.STND_YEAR = TOR.STND_YEAR
                                    AND    TRT.MBR_CD    = TOR.MBR_CD
                                    AND    TRT.TMS       = TOR.TMS
                                    AND    TOR.RACER_NO  = TRM.RACER_NO
                               )
                        GROUP BY MOT_NO
                     ) MPR -- 모터최근승정선수및성적
                   , (
                        SELECT
                                 RACER_NO, ST_MTHD_CD  
                               , TRIM(TO_CHAR(SUM(WIN12_CNT) / SUM(RACE_CNT) * 100, 990.9)) MON_6_HIGH_RANK_RATIO
                               , SUM(RACE_CNT) MON_6_RACE_CNT
                               , MIN(DECODE(RACE_REG_NO, 1, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_1
                               , MIN(DECODE(RACE_REG_NO, 2, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_2
                               , MIN(DECODE(RACE_REG_NO, 3, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_3
                               , MIN(DECODE(RACE_REG_NO, 4, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_4
                               , MIN(DECODE(RACE_REG_NO, 5, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_5
                               , MIN(DECODE(RACE_REG_NO, 6, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_6
                               , MIN(DECODE(RACE_REG_NO, 7, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_7
                               , MIN(DECODE(RACE_REG_NO, 8, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_8
                               
                        FROM   (
                                    SELECT
                                              RACER_NO
                                            , RACE_REG_NO
                                            , ST_MTHD_CD
                                            , SUM(DECODE(RANK, 1, 1, 2, 1, 0)) WIN12_CNT
                                            , COUNT(*) RACE_CNT
                                    FROM    TBEB_ORGAN
                                    WHERE   (STND_YEAR, MBR_CD, TMS) IN (
                                                                            SELECT
                                                                                      STND_YEAR
                                                                                    , MBR_CD
                                                                                    , TMS
                                                                            FROM    TBEB_RACE_TMS
                                                                            WHERE   STR_DT > (
                                                                                                SELECT
                                                                                                       TO_CHAR(ADD_MONTHS(TO_DATE(STR_DT, 'YYYYMMDD'), -6), 'YYYYMMDD')
                                                                                                FROM   TBEB_RACE_TMS
                                                                                                WHERE  STND_YEAR = ?
                                                                                                AND    MBR_CD    = ?
                                                                                                AND    TMS       = ?
                                                                                             )
                                                                            AND     STR_DT < (
                                                                                                SELECT
                                                                                                       STR_DT
                                                                                                FROM   TBEB_RACE_TMS
                                                                                                WHERE  STND_YEAR = ?
                                                                                                AND    MBR_CD    = ?
                                                                                                AND    TMS       = ?
                                                                                             )
                                                                        )
                                    AND     ABSE_CD  <> '003'
                                    GROUP BY RACER_NO, RACE_REG_NO, ST_MTHD_CD
                                )
                        GROUP BY RACER_NO, ST_MTHD_CD
                     ) MON_6 -- 최근6개월간연대율
                   , (
			            SELECT  
			                     RACER_NO   
			                   , SUBSTR(MAX(SYS_CONNECT_BY_PATH (RACE_DESC, ', ')), 2) PRE_RACE
			            FROM   (
			            			SELECT 
			                                  TOR.RACER_NO
			                                , DECODE(TR.RACE_STTS_CD, '002', '경주불성립', '003', '경주불성립', DECODE(TOR.ST_MTHD_CD,'001','온',SUBSTR(TSC.RMK2, 1, 1)) || TOR.RACE_NO || '-' || NVL(TRVA.VOIL_NM, TOR.RANK)|| '-' ||TOR.RACE_REG_NO) RACE_DESC
			                                , RANK() OVER (PARTITION BY TOR.RACER_NO 
			                                                   ORDER BY TOR.STND_YEAR
			                                                          , TOR.MBR_CD
			                                                          , TOR.TMS
			                                                          , TOR.DAY_ORD
			                                                          , TOR.RACE_NO) RACE
			            			FROM      TBEB_ORGAN   TOR
			            			        , TBEB_RACE    TR
			            			        , TBEA_SPEC_CD TSC
			            			        , (
                                                SELECT
                         			                      TRVA.STND_YEAR                                                 
                         			                    , TRVA.MBR_CD                                                    
                         			                    , TRVA.TMS                                                       
                         			                    , TRVA.DAY_ORD                                                   
                         			                    , TRVA.RACE_NO                                                   
                         			                    , TRVA.RACE_REG_NO        
                         			                    , TRVA.VOIL_CD
                         			                    , SUBSTR(TSC .RMK,4) VOIL_NM
                                                FROM      TBEA_SPEC_CD TSC
                                                        , (
                                                            SELECT
                                     			                      TRVA.STND_YEAR                                                 
                                     			                    , TRVA.MBR_CD                                                    
                                     			                    , TRVA.TMS                                                       
                                     			                    , TRVA.DAY_ORD                                                   
                                     			                    , TRVA.RACE_NO                                                   
                                     			                    , TRVA.RACE_REG_NO        
                                     			                    , TRVA.VOIL_CD
                        			                                , RANK() OVER (PARTITION BY TRVA.STND_YEAR
                        			                                                          , TRVA.MBR_CD
                        			                                                          , TRVA.TMS
                        			                                                          , TRVA.DAY_ORD
                        			                                                          , TRVA.RACE_NO
                        			                                                          , TRVA.RACE_REG_NO
                        			                                                   ORDER BY TRVA.VOIL_CD ) RANK
                                                            FROM    TBED_RACE_VOIL_ACT TRVA
                        			            			WHERE   TRVA.STND_YEAR = ?
                        			            			AND     TRVA.MBR_CD    = ?
                        			            			AND     TRVA.TMS       = ?
                        			            			AND     TRVA.DAY_ORD   < ?
                        			            			AND     TRVA.VOIL_CD  IN ('110', '120', '125', '130', '140', '995', '996', '997', '998', '999')
                        			                      ) TRVA
                                                WHERE   TSC .CD     = TRVA.VOIL_CD
                                                AND     TSC .GRP_CD = 'E00035'
                                                AND     TRVA.RANK   = 1
			            			          ) TRVA
			            			WHERE   TOR.STND_YEAR   = TR.STND_YEAR
			            			AND     TOR.MBR_CD      = TR.MBR_CD
			            			AND     TOR.TMS         = TR.TMS
			            			AND     TOR.DAY_ORD     = TR.DAY_ORD
			            			AND     TOR.RACE_NO     = TR.RACE_NO
			            			AND     TOR.STND_YEAR   = TRVA.STND_YEAR  (+) 
			            			AND     TOR.MBR_CD      = TRVA.MBR_CD     (+)
			            			AND     TOR.TMS         = TRVA.TMS        (+)
			            			AND     TOR.DAY_ORD     = TRVA.DAY_ORD    (+)
			            			AND     TOR.RACE_NO     = TRVA.RACE_NO    (+)
                                    AND     TOR.RACE_REG_NO = TRVA.RACE_REG_NO(+)
                                    AND     TSC .CD         = TR  .RACE_DGRE_CD
                                    AND     TSC.GRP_CD      = 'E00005'
			            			AND     TOR.STND_YEAR   = ?
			            			AND     TOR.MBR_CD      = ?
			            			AND     TOR.TMS         = ?
			            			AND     TOR.DAY_ORD     < ?
			                   )            			                         
			            START WITH RACE = 1
			            CONNECT BY PRIOR RACE = RACE - 1 AND PRIOR RACER_NO = RACER_NO
			            GROUP BY RACER_NO
				     ) RACE -- 전일성적
				   , TBEB_CNF_INSP         TCI
                   , TBEB_RECD_STND_TERM   TRST   -- 성적반영분기코드
            WHERE  TOR.RACER_NO  = TRM  .RACER_NO
            AND    TOR.RACER_NO  = TRD  .RACER_NO  (+)
            AND    TOR.RACER_NO  = TRRAS.RACER_NO  (+)
            AND    TOR.RACER_NO  = TRRAS2.RACER_NO (+)
            AND    TOR.RACER_NO  = MON_6.RACER_NO  (+)
            AND    TOR.ST_MTHD_CD= MON_6.ST_MTHD_CD(+)
            AND    TOR.RACER_NO  = RACE .RACER_NO  (+)
            AND    TOR.MOT_NO    = TMRAS.MOT_NO    (+)
            AND    TOR.MOT_NO    = MPR .MOT_NO     (+)
            AND    TOR.BOAT_NO   = TBRAS.BOAT_NO   (+)
            AND    TOR.STND_YEAR = TRI  .STND_YEAR (+)
            AND    TOR.MBR_CD    = TRI  .MBR_CD    (+)
            AND    TOR.TMS       = TRI  .TMS       (+)
            AND    TOR.RACER_NO  = TRI  .RACER_NO  (+)
            AND    TOR.STND_YEAR = TCI  .STND_YEAR (+)
            AND    TOR.MBR_CD    = TCI  .MBR_CD    (+)
            AND    TOR.TMS       = TCI  .TMS       (+)
            AND    TOR.RACER_NO  = TCI  .RACER_NO  (+)
            AND    TOR.STND_YEAR = TRT  .STND_YEAR
            AND    TOR.MBR_CD    = TRT  .MBR_CD
            AND    TOR.TMS       = TRT  .TMS
            AND    TRT.STR_DT >= TRST.STR_DT
            AND    TRT.END_DT <= TRST.END_DT
            AND    TOR.STND_YEAR = ?
            AND    TOR.MBR_CD    = ?
            AND    TOR.TMS       = ?
            AND    TOR.DAY_ORD   = ?
            ORDER BY
                       TOR.STND_YEAR
                     , TOR.MBR_CD
                     , TOR.TMS
                     , TOR.DAY_ORD
                     , TOR.RACE_NO
                     , TOR.RACE_REG_NO
        ]]>
    </query>     
    
    <query id="tbeb_race_doc_ib002" desc="3일 경주 출주표저장" fetchSize="10">
        <![CDATA[
			INSERT /* tbeb_race_doc_ib002 3일 경주 출주표저장*/
			       INTO TBEB_RACE_DOC /*  tbeb_race_doc_ib001 IWORK_SFR-008 경정 선수편성 메뉴 개선  */
			(
			         STND_YEAR
			       , MBR_CD
			       , TMS
			       , DAY_ORD
			       , ORGAN_STAT_CD
			       , RACE_NO
			       , RACE_REG_NO
			       , RACE_DAY
			       , COLOR
			       , RACER_PERIO_NO
			       , RACER_GRD_CD	-- 출주표 등급추가. 2013.1.18
			       , RACER_NO
			       , RACER_NM
			       , ABSE_CD
			       , AGE
			       , WGHT
			       , BOAT_NO
			       , MOT_NO
			       , TMS_6_AVG_RANK_SCR
			       , TMS_6_AVG_ACDNT_SCR
			       , TMS_6_AVG_SCR
			       , TMS_6_WIN_RATIO
			       , TMS_6_HIGH_RANK_RATIO
			       , TMS_6_HIGH_3_RANK_RATIO
			       , TMS_6_AVG_STRT_TM
			       , TMS_8_RANK_ORD
			       , AVG_RANK_SCR
			       , AVG_ACDNT_SCR
			       , AVG_SCR
			       , WIN_RATIO
			       , HIGH_RANK_RATIO
			       , HIGH_3_RANK_RATIO
			       , AVG_STRT_TM
			       , FL_CNT
			       , MM_6_RACE_CNT
			       , MM_6_HIGH_RANK_RATIO
			       , MM_6_1_RACE_HIGH_RANK_RATIO
			       , MM_6_2_RACE_HIGH_RANK_RATIO
			       , MM_6_3_RACE_HIGH_RANK_RATIO
			       , MM_6_4_RACE_HIGH_RANK_RATIO
			       , MM_6_5_RACE_HIGH_RANK_RATIO
			       , MM_6_6_RACE_HIGH_RANK_RATIO
			       , MM_6_7_RACE_HIGH_RANK_RATIO
			       , MM_6_8_RACE_HIGH_RANK_RATIO
			       , MOT_AVG_RANK_SCR
			       , MOT_HIGH_RANK_RATIO
			       , MOT_HIGH_3_RANK_RATIO
			       , MOT_BF_RACER_NO_1
			       , MOT_BF_RACER_NO_2
			       , BOAT_AVG_RANK_SCR
			       , BOAT_HIGH_RANK_RATIO
			       , BOAT_HIGH_3_RANK_RATIO
			       , THDD_RACE
			       , BF_DD_RECD
			       , BF_DD_RECD_1
			       , BF_DD_RECD_2
			       , SPEC_INFO
			       , INST_ID
			       , INST_DTM
			       , UPDT_ID
			       , UPDT_DTM
			       , ST_MTHD_CD
			)
            SELECT
	                 TOR  .STND_YEAR
	               , TOR  .MBR_CD
	               , TOR  .TMS
	               , TOR  .DAY_ORD
	               , ?
	               , TOR  .RACE_NO
	               , TOR  .RACE_REG_NO
	               , TOR  .RACE_DAY
	               , ( SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD = 'E00009' AND CD = TOR.RACE_REG_NO ) RACE_REG_COLOR
			       , TRM  .RACER_PERIO_NO
			       , TOR  .RACER_GRD_CD 	-- 출주표 등급추가. 2013.1.18
			       , TOR  .RACER_NO                                                         -- 선수등록번호
			       , TRM  .NM_KOR
			       , TOR  .ABSE_CD
			       , TOR  .STND_YEAR - SUBSTR(TRD  .BIRTH_DT, 1, 4) AGE
			       , ROUND(NVL(TRI  .ENTRY_BODY_WGHT, TRD  .WGHT)) ENTRY_BODY_WGHT
--			       , ROUND(TRI.ENTRY_BODY_WGHT) ENTRY_BODY_WGHT
			       , TOR  .BOAT_NO                                                          -- 보트번호
			       , TOR  .MOT_NO                                                           -- 모터번호
                   
			       , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_RANK_SCR     , 0), NVL(TRRAS.TMS_6_AVG_RANK_SCR    ,  0))   TRRAS_TMS_6_AVG_RANK_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_ACDNT_SCR    , 0), NVL(TRRAS.TMS_6_AVG_ACDNT_SCR    , 0))   TRRAS_TMS_6_AVG_ACDNT_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_SCR          , 0), NVL(TRRAS.TMS_6_AVG_SCR          , 0))   TRRAS_TMS_6_AVG_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_WIN_RATIO        , 0), NVL(TRRAS.TMS_6_WIN_RATIO        , 0))   TRRAS_TMS_6_WIN_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_HIGH_RANK_RATIO  , 0), NVL(TRRAS.TMS_6_HIGH_RANK_RATIO  , 0))   TRRAS_TMS_6_HIGH_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_HIGH_3_RANK_RATIO, 0), NVL(TRRAS.TMS_6_HIGH_3_RANK_RATIO, 0))   TRRAS_TMS_6_HIGH_3_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.TMS_6_AVG_STRT_TM      , 0), NVL(TRRAS.TMS_6_AVG_STRT_TM      , 0))   TRRAS_TMS_6_AVG_STRT_TM
                   , DECODE(TOR.ST_MTHD_CD, '001',TRRAS2.TMS_8_RANK_ORD                 , TRRAS.TMS_8_RANK_ORD                 )   TRRAS_TMS_8_RANK_ORD
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.AVG_RANK_SCR           , 0), NVL(TRRAS.AVG_RANK_SCR           , 0))   TRRAS_AVG_RANK_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001'
			                                     ,NVL(DECODE(TRST.QURT_CD, '001', TRRAS2.BF_AVG_ACDNT_SCR, '002', TRRAS2.AF_AVG_ACDNT_SCR),0)
			                                     ,NVL(DECODE(TRST.QURT_CD, '001',  TRRAS.BF_AVG_ACDNT_SCR, '002',  TRRAS.AF_AVG_ACDNT_SCR),0)
			       								 ) AVG_ACDNT_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.AVG_SCR                , 0), NVL(TRRAS.AVG_SCR                , 0))   TRRAS_AVG_SCR
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.WIN_RATIO              , 0), NVL(TRRAS.WIN_RATIO              , 0))   TRRAS_WIN_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.HIGH_RANK_RATIO        , 0), NVL(TRRAS.HIGH_RANK_RATIO        , 0))   TRRAS_HIGH_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',NVL(TRRAS2.HIGH_3_RANK_RATIO      , 0), NVL(TRRAS.HIGH_3_RANK_RATIO      , 0))   TRRAS_HIGH_3_RANK_RATIO
                   , DECODE(TOR.ST_MTHD_CD, '001',TRRAS2.AVG_STRT_TM                    , TRRAS.AVG_STRT_TM                    )  TRRAS_AVG_STRT_TM
			       
 			       , DECODE(TOR.ST_MTHD_CD, '001'							 
			                                     ,DECODE(TRST.QURT_CD, '001', 'F' || NVL(TRRAS2.BF_F_CNT, 0) || 'L' || NVL(TRRAS2.BF_L_CNT, 0), '002', 'F' || NVL(TRRAS2.AF_F_CNT, 0) || 'L' || NVL(TRRAS2.AF_L_CNT, 0)) 
			                                     ,DECODE(TRST.QURT_CD, '001', 'F' || NVL(TRRAS.BF_F_CNT, 0)  || 'L' || NVL(TRRAS.BF_L_CNT, 0),  '002', 'F' || NVL(TRRAS.AF_F_CNT, 0)  || 'L' || NVL(TRRAS.AF_L_CNT, 0))
			                                     ) FL_CNT
			                                     
                   , NVL(MON_6.MON_6_RACE_CNT, 0) MON_6_RACE_CNT
                   , NVL(MON_6.MON_6_HIGH_RANK_RATIO, '0.0') MON_6_HIGH_RANK_RATIO
                   , NVL(MON_6.MON_6_RACE_REG_NO_1, '00.0/0') MON_6_RACE_REG_NO_1
                   , NVL(MON_6.MON_6_RACE_REG_NO_2, '00.0/0') MON_6_RACE_REG_NO_2
                   , NVL(MON_6.MON_6_RACE_REG_NO_3, '00.0/0') MON_6_RACE_REG_NO_3
                   , NVL(MON_6.MON_6_RACE_REG_NO_4, '00.0/0') MON_6_RACE_REG_NO_4
                   , NVL(MON_6.MON_6_RACE_REG_NO_5, '00.0/0') MON_6_RACE_REG_NO_5
                   , NVL(MON_6.MON_6_RACE_REG_NO_6, '00.0/0') MON_6_RACE_REG_NO_6
                   , NVL(MON_6.MON_6_RACE_REG_NO_7, '00.0/0') MON_6_RACE_REG_NO_7
                   , NVL(MON_6.MON_6_RACE_REG_NO_8, '00.0/0') MON_6_RACE_REG_NO_8

                   , NVL(TMRAS.AVG_RANK_SCR     , 0)   TMRAS_AVG_RANK_SCR
                   , NVL(TMRAS.HIGH_RANK_RATIO  , 0)   TMRAS_HIGH_RANK_RATIO
                   , NVL(TMRAS.HIGH_3_RANK_RATIO, 0)   TMRAS_HIGH_3_RANK_RATIO
                   , MPR  .MOT_PRE_RECE1
                   , MPR  .MOT_PRE_RECE2
                   , NVL(TBRAS.AVG_RANK_SCR     , 0)   TBRAS_AVG_RANK_SCR
                   , NVL(TBRAS.HIGH_RANK_RATIO  , 0)   TBRAS_HIGH_RANK_RATIO
                   , NVL(TBRAS.HIGH_3_RANK_RATIO, 0)   TBRAS_HIGH_3_RANK_RATIO
			       , (
                        SELECT 
                                DECODE(TR.RACE_DGRE_CD, '501', '특', '701', '특', '702', '특', '')||TODAY.RACE_NO RACE_NO
                        FROM    TBEB_ORGAN TODAY
                              , TBEB_RACE    TR
                              , TBEA_SPEC_CD TSC
                        WHERE   TODAY.STND_YEAR   = TOR.STND_YEAR  
                        AND     TODAY.MBR_CD      = TOR.MBR_CD     
                        AND     TODAY.TMS         = TOR.TMS        
                        AND     TODAY.DAY_ORD     = TOR.DAY_ORD    
                        AND     TODAY.RACE_NO    <> TOR.RACE_NO    
                        AND     TODAY.RACER_NO    = TOR.RACER_NO   
                        AND     TODAY.STND_YEAR   = TR.STND_YEAR
                        AND     TODAY.MBR_CD      = TR.MBR_CD
                        AND     TODAY.TMS         = TR.TMS
                        AND     TODAY.DAY_ORD     = TR.DAY_ORD
                        AND     TODAY.RACE_NO     = TR.RACE_NO
                        AND     TSC.CD            = TR.RACE_DGRE_CD
                        AND     TSC.GRP_CD        = 'E00005'
                     ) ETC_RACE  
                   , DECODE(?, '002', 
                            REPLACE(PRE1.PRE_RACE,' ',' 1')||
                                NVL2(PRE1.PRE_RACE,',','')||REPLACE(PRE2.PRE_RACE,' ',' 2')) AS PRE_RACE
			       , DECODE(?, '002', PRE1.PRE_RACE)
			       , DECODE(?, '002', PRE2.PRE_RACE)
			       , TCI  .SPEC_INFO RMK                           
				   , ?
				   , SYSDATE
				   , ?
				   , SYSDATE
				   , TOR.ST_MTHD_CD
			FROM     TBEB_RACE_TMS            TRT
			       , TBEC_RACER_MASTER        TRM
			       , TBEC_RACER_DETAIL        TRD
			       , TBEB_ORGAN               TOR
                   , TBEC_RACER_INTERVIEW     TRI
			       , (
						SELECT *
						FROM   (
						            SELECT   RANK() OVER (PARTITION BY TRRAS.RACER_NO ORDER BY APLY_DT DESC) RANK
						                   , TRRAS.*
						            FROM   TBEB_RACER_RECD_ACCU_SUM TRRAS
						            WHERE  TRRAS.APLY_DT  < (
						                                        SELECT
						                                               MIN(TRDO.RACE_DAY) RACE_DAY
						                                        FROM   TBEB_RACE_DAY_ORD TRDO
						                                        WHERE  TRDO.STND_YEAR = ?
						                                        AND    TRDO.MBR_CD    = ?
						                                        AND    TRDO.TMS       = ?
						                                    )
						            AND   MBR_CD = '000'
						            AND   TMS    = 0
						            AND   TRRAS.ST_MTHD_CD = '000' --ST방식전체설정
						       )
						WHERE  RANK = 1
			         ) TRRAS -- 선수최근성적
			       , (
						SELECT *
						FROM   (
						            SELECT   RANK() OVER (PARTITION BY TRRAS.RACER_NO ORDER BY APLY_DT DESC) RANK
						                   , TRRAS.*
						            FROM   TBEB_RACER_RECD_ACCU_SUM TRRAS
						            WHERE  TRRAS.APLY_DT  < (
						                                        SELECT
						                                               MIN(TRDO.RACE_DAY) RACE_DAY
						                                        FROM   TBEB_RACE_DAY_ORD TRDO
						                                        WHERE  TRDO.STND_YEAR = ?
						                                        AND    TRDO.MBR_CD    = ?
						                                        AND    TRDO.TMS       = ?
						                                    )
						            AND   MBR_CD = '000'
						            AND   TMS    = 0
						            AND   TRRAS.ST_MTHD_CD = '001' --ST방식 온라인
						       )
						WHERE  RANK = 1
			         ) TRRAS2 -- 선수최근성적(온라인)
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TMRAS.MOT_NO 
                                                            ORDER BY TMRAS.STND_YEAR DESC
                                                                   , TMRAS.TMS DESC 
                                                       ) RANK
                                         , TMRAS.*
                                  FROM   TBEB_MOT_RECD_ACCU_SUM TMRAS
                                  WHERE  TMRAS.MBR_CD = ?
                                  AND    TMRAS.STND_YEAR || LPAD(TMRAS.TMS, 3, '0') < ? || LPAD(?, 3, '0')
                                  AND    TMRAS.ST_MTHD_CD = '000' --ST방식전체설정
			                   )
			            WHERE  RANK = 1
			         ) TMRAS -- 모터최근성적
			       , (
			            SELECT *
			            FROM   (
                                  SELECT   RANK() OVER (PARTITION BY TBRAS.BOAT_NO 
                                                            ORDER BY TBRAS.STND_YEAR DESC
                                                                   , TBRAS.TMS DESC 
                                                       ) RANK
                                         , TBRAS.*
                                  FROM   TBEB_BOAT_RECD_ACCU_SUM TBRAS
                                  WHERE  TBRAS.MBR_CD = ?
                                  AND    TBRAS.STND_YEAR || LPAD(TBRAS.TMS, 3, '0') < ? || LPAD(?, 3, '0')
                                  AND    TBRAS.ST_MTHD_CD = '000' --ST방식전체설정
			                   )
			            WHERE  RANK = 1
			         ) TBRAS -- 보트최근성적
                   , (
                        SELECT
                                 MOT_NO
                               , MIN(DECODE(TMS, 1, MOT_PRE_RECE)) MOT_PRE_RECE1
                               , MIN(DECODE(TMS, 2, MOT_PRE_RECE)) MOT_PRE_RECE2
                        FROM   (
                                    SELECT
                                             TOR.MOT_NO
                                           , TRM.NM_KOR || '/' || RACE MOT_PRE_RECE
                                           , RANK() OVER (PARTITION BY TOR.MOT_NO
                                                              ORDER BY TRT.STR_DT DESC) TMS
                                    FROM     TBEB_RACE_TMS     TRT
                                           , TBEC_RACER_MASTER TRM
                                           , (
                                                SELECT
                                                         TOR.STND_YEAR
                                                       , TOR.MBR_CD
                                                       , TOR.TMS
                                                       , TOR.MOT_NO
                                                       , TOR.RACER_NO
                                                       , MIN(DECODE(TOR.RACE, 1, RANK))
                                                      || MIN(DECODE(TOR.RACE, 2, RANK))
                                                      || MIN(DECODE(TOR.RACE, 3, RANK))
                                                      || MIN(DECODE(TOR.RACE, 4, RANK)) RACE
                                                FROM   (
                                                            SELECT
                                                                     TOR.STND_YEAR
                                                                   , TOR.MBR_CD
                                                                   , TOR.TMS
                                                                   , TOR.MOT_NO
                                                                   , TOR.RACER_NO
                                                                   , DECODE(TOR.IMMT_CLS_CD, '003', '', TOR.RANK) RANK
                                                                   , RANK() OVER (PARTITION BY TOR.MOT_NO, TOR.RACER_NO
                                                                                      ORDER BY TOR.RACE_DAY DESC
                                                                                             , TOR.RACE_NO  DESC) RACE
                                                            FROM     TBEB_ORGAN        TOR
                                                                   , (
                                                                        SELECT
                                                                                  STND_YEAR
                                                                                , MBR_CD
                                                                                , TMS
                                                                                , MOT_NO
                                                                                , RANK() OVER (PARTITION BY MOT_NO
                                                                                                   ORDER BY RACE_DAY DESC) TMS_2
                                                                        FROM    (
                                                                                    SELECT
                                                                                              STND_YEAR
                                                                                            , MBR_CD
                                                                                            , TMS
                                                                                            , MOT_NO
                                                                                            , MAX(RACE_DAY) RACE_DAY
                                                                                    FROM    TBEB_ORGAN
                                                                                    WHERE   RACE_DAY < (
                                                                                                            SELECT
                                                                                                                   MIN(RACE_DAY)
                                                                                                            FROM   TBEB_RACE_DAY_ORD
                                                                                                            WHERE  STND_YEAR = ?
                                                                                                            AND    MBR_CD    = ?
                                                                                                            AND    TMS       = ?
                                                                                                       )
                                                                                    AND    ABSE_CD  <> '003'
                                                                                    GROUP BY
                                                                                              STND_YEAR
                                                                                            , MBR_CD
                                                                                            , TMS
                                                                                            , MOT_NO
                                                                                )
                                                                     ) TMS_2
                                                            WHERE  TOR.STND_YEAR = TMS_2.STND_YEAR
                                                            AND    TOR.MBR_CD    = TMS_2.MBR_CD
                                                            AND    TOR.TMS       = TMS_2.TMS
                                                            AND    TOR.MOT_NO    = TMS_2.MOT_NO
                                                            AND    TMS_2.TMS_2   < 3
                                                            AND    TOR.ABSE_CD     <> '003'
                                                       ) TOR
                                                GROUP BY
                                                         TOR.STND_YEAR
                                                       , TOR.MBR_CD
                                                       , TOR.TMS
                                                       , TOR.MOT_NO
                                                       , TOR.RACER_NO
                                             ) TOR
                                    WHERE  TRT.STND_YEAR = TOR.STND_YEAR
                                    AND    TRT.MBR_CD    = TOR.MBR_CD
                                    AND    TRT.TMS       = TOR.TMS
                                    AND    TOR.RACER_NO  = TRM.RACER_NO
                               )
                        GROUP BY MOT_NO
                     ) MPR -- 모터최근승정선수및성적
                   , (
                        SELECT
                                 RACER_NO, ST_MTHD_CD  
                               , TRIM(TO_CHAR(SUM(WIN12_CNT) / SUM(RACE_CNT) * 100, 990.9)) MON_6_HIGH_RANK_RATIO
                               , SUM(RACE_CNT) MON_6_RACE_CNT
                               , MIN(DECODE(RACE_REG_NO, 1, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_1
                               , MIN(DECODE(RACE_REG_NO, 2, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_2
                               , MIN(DECODE(RACE_REG_NO, 3, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_3
                               , MIN(DECODE(RACE_REG_NO, 4, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_4
                               , MIN(DECODE(RACE_REG_NO, 5, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_5
                               , MIN(DECODE(RACE_REG_NO, 6, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_6
                               , MIN(DECODE(RACE_REG_NO, 7, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_7
                               , MIN(DECODE(RACE_REG_NO, 8, TRIM(TO_CHAR(WIN12_CNT / RACE_CNT * 100, 990.9) || '/' || RACE_CNT))) MON_6_RACE_REG_NO_8
                               
                        FROM   (
                                    SELECT
                                              RACER_NO
                                            , RACE_REG_NO
                                            , ST_MTHD_CD
                                            , SUM(DECODE(RANK, 1, 1, 2, 1, 0)) WIN12_CNT
                                            , COUNT(*) RACE_CNT
                                    FROM    TBEB_ORGAN
                                    WHERE   (STND_YEAR, MBR_CD, TMS) IN (
                                                                            SELECT
                                                                                      STND_YEAR
                                                                                    , MBR_CD
                                                                                    , TMS
                                                                            FROM    TBEB_RACE_TMS
                                                                            WHERE   STR_DT > (
                                                                                                SELECT
                                                                                                       TO_CHAR(ADD_MONTHS(TO_DATE(STR_DT, 'YYYYMMDD'), -6), 'YYYYMMDD')
                                                                                                FROM   TBEB_RACE_TMS
                                                                                                WHERE  STND_YEAR = ?
                                                                                                AND    MBR_CD    = ?
                                                                                                AND    TMS       = ?
                                                                                             )
                                                                            AND     STR_DT < (
                                                                                                SELECT
                                                                                                       STR_DT
                                                                                                FROM   TBEB_RACE_TMS
                                                                                                WHERE  STND_YEAR = ?
                                                                                                AND    MBR_CD    = ?
                                                                                                AND    TMS       = ?
                                                                                             )
                                                                        )
                                    AND     ABSE_CD  <> '003'
                                    GROUP BY RACER_NO, RACE_REG_NO, ST_MTHD_CD
                                )
                        GROUP BY RACER_NO, ST_MTHD_CD
                     ) MON_6 -- 최근6개월간연대율
                   , (
			            SELECT  
			                     RACER_NO   
			                   , SUBSTR(MAX(SYS_CONNECT_BY_PATH (RACE_DESC, ', ')), 2) PRE_RACE
			            FROM   (
			            			SELECT 
			                                  TOR.RACER_NO
			                                , DECODE(TR.RACE_STTS_CD, '002', '경주불성립', '003', '경주불성립', DECODE(TOR.ST_MTHD_CD,'001','온',SUBSTR(TSC.RMK2, 1, 1)) || TOR.RACE_NO || '-' || NVL(TRVA.VOIL_NM, TOR.RANK)|| '-' ||TOR.RACE_REG_NO) RACE_DESC
			                                , RANK() OVER (PARTITION BY TOR.RACER_NO 
			                                                   ORDER BY TOR.STND_YEAR
			                                                          , TOR.MBR_CD
			                                                          , TOR.TMS
			                                                          , TOR.DAY_ORD
			                                                          , TOR.RACE_NO) RACE
			            			FROM      TBEB_ORGAN   TOR
			            			        , TBEB_RACE    TR
			            			        , TBEA_SPEC_CD TSC
			            			        , (
                                                SELECT
                         			                      TRVA.STND_YEAR                                                 
                         			                    , TRVA.MBR_CD                                                    
                         			                    , TRVA.TMS                                                       
                         			                    , TRVA.DAY_ORD                                                   
                         			                    , TRVA.RACE_NO                                                   
                         			                    , TRVA.RACE_REG_NO        
                         			                    , TRVA.VOIL_CD
                         			                    , SUBSTR(TSC .RMK,4) VOIL_NM
                                                FROM      TBEA_SPEC_CD TSC
                                                        , (
                                                            SELECT
                                     			                      TRVA.STND_YEAR                                                 
                                     			                    , TRVA.MBR_CD                                                    
                                     			                    , TRVA.TMS                                                       
                                     			                    , TRVA.DAY_ORD                                                   
                                     			                    , TRVA.RACE_NO                                                   
                                     			                    , TRVA.RACE_REG_NO        
                                     			                    , TRVA.VOIL_CD
                        			                                , RANK() OVER (PARTITION BY TRVA.STND_YEAR
                        			                                                          , TRVA.MBR_CD
                        			                                                          , TRVA.TMS
                        			                                                          , TRVA.DAY_ORD
                        			                                                          , TRVA.RACE_NO
                        			                                                          , TRVA.RACE_REG_NO
                        			                                                   ORDER BY TRVA.VOIL_CD ) RANK
                                                            FROM    TBED_RACE_VOIL_ACT TRVA
                        			            			WHERE   TRVA.STND_YEAR = ?
                        			            			AND     TRVA.MBR_CD    = ?
                        			            			AND     TRVA.TMS       = ?
                        			            			AND     TRVA.DAY_ORD   = ? -2
                        			            			AND     TRVA.VOIL_CD  IN ('110', '120', '125', '130', '140', '995', '996', '997', '998', '999')
                        			                      ) TRVA
                                                WHERE   TSC .CD     = TRVA.VOIL_CD
                                                AND     TSC .GRP_CD = 'E00035'
                                                AND     TRVA.RANK   = 1
			            			          ) TRVA
			            			WHERE   TOR.STND_YEAR   = TR.STND_YEAR
			            			AND     TOR.MBR_CD      = TR.MBR_CD
			            			AND     TOR.TMS         = TR.TMS
			            			AND     TOR.DAY_ORD     = TR.DAY_ORD
			            			AND     TOR.RACE_NO     = TR.RACE_NO
			            			AND     TOR.STND_YEAR   = TRVA.STND_YEAR  (+) 
			            			AND     TOR.MBR_CD      = TRVA.MBR_CD     (+)
			            			AND     TOR.TMS         = TRVA.TMS        (+)
			            			AND     TOR.DAY_ORD     = TRVA.DAY_ORD    (+)
			            			AND     TOR.RACE_NO     = TRVA.RACE_NO    (+)
                                    AND     TOR.RACE_REG_NO = TRVA.RACE_REG_NO(+)
                                    AND     TSC .CD         = TR  .RACE_DGRE_CD
                                    AND     TSC.GRP_CD      = 'E00005'
			            			AND     TOR.STND_YEAR   = ?
			            			AND     TOR.MBR_CD      = ?
			            			AND     TOR.TMS         = ?
			            			AND     TOR.DAY_ORD     = ? -2
			                   )            			                         
			            START WITH RACE = 1
			            CONNECT BY PRIOR RACE = RACE - 1 AND PRIOR RACER_NO = RACER_NO
			            GROUP BY RACER_NO
				     ) PRE1 -- 전일성적
				   ,(
			            SELECT  
			                     RACER_NO   
			                   , SUBSTR(MAX(SYS_CONNECT_BY_PATH (RACE_DESC, ', ')), 2) PRE_RACE
			            FROM   (
			            			SELECT 
			                                  TOR.RACER_NO
			                                , DECODE(TR.RACE_STTS_CD, '002', '경주불성립', '003', '경주불성립', DECODE(TOR.ST_MTHD_CD,'001','온',SUBSTR(TSC.RMK2, 1, 1)) || TOR.RACE_NO || '-' || NVL(TRVA.VOIL_NM, TOR.RANK)|| '-' ||TOR.RACE_REG_NO) RACE_DESC
			                                , RANK() OVER (PARTITION BY TOR.RACER_NO 
			                                                   ORDER BY TOR.STND_YEAR
			                                                          , TOR.MBR_CD
			                                                          , TOR.TMS
			                                                          , TOR.DAY_ORD
			                                                          , TOR.RACE_NO) RACE
			            			FROM      TBEB_ORGAN   TOR
			            			        , TBEB_RACE    TR
			            			        , TBEA_SPEC_CD TSC
			            			        , (
                                                SELECT
                         			                      TRVA.STND_YEAR                                                 
                         			                    , TRVA.MBR_CD                                                    
                         			                    , TRVA.TMS                                                       
                         			                    , TRVA.DAY_ORD                                                   
                         			                    , TRVA.RACE_NO                                                   
                         			                    , TRVA.RACE_REG_NO        
                         			                    , TRVA.VOIL_CD
                         			                    , SUBSTR(TSC .RMK,4) VOIL_NM
                                                FROM      TBEA_SPEC_CD TSC
                                                        , (
                                                            SELECT
                                     			                      TRVA.STND_YEAR                                                 
                                     			                    , TRVA.MBR_CD                                                    
                                     			                    , TRVA.TMS                                                       
                                     			                    , TRVA.DAY_ORD                                                   
                                     			                    , TRVA.RACE_NO                                                   
                                     			                    , TRVA.RACE_REG_NO        
                                     			                    , TRVA.VOIL_CD
                        			                                , RANK() OVER (PARTITION BY TRVA.STND_YEAR
                        			                                                          , TRVA.MBR_CD
                        			                                                          , TRVA.TMS
                        			                                                          , TRVA.DAY_ORD
                        			                                                          , TRVA.RACE_NO
                        			                                                          , TRVA.RACE_REG_NO
                        			                                                   ORDER BY TRVA.VOIL_CD ) RANK
                                                            FROM    TBED_RACE_VOIL_ACT TRVA
                        			            			WHERE   TRVA.STND_YEAR = ?
                        			            			AND     TRVA.MBR_CD    = ?
                        			            			AND     TRVA.TMS       = ?
                        			            			AND     TRVA.DAY_ORD   = ? -1
                        			            			AND     TRVA.VOIL_CD  IN ('110', '120', '125', '130', '140', '995', '996', '997', '998', '999')
                        			                      ) TRVA
                                                WHERE   TSC .CD     = TRVA.VOIL_CD
                                                AND     TSC .GRP_CD = 'E00035'
                                                AND     TRVA.RANK   = 1
			            			          ) TRVA
			            			WHERE   TOR.STND_YEAR   = TR.STND_YEAR
			            			AND     TOR.MBR_CD      = TR.MBR_CD
			            			AND     TOR.TMS         = TR.TMS
			            			AND     TOR.DAY_ORD     = TR.DAY_ORD
			            			AND     TOR.RACE_NO     = TR.RACE_NO
			            			AND     TOR.STND_YEAR   = TRVA.STND_YEAR  (+) 
			            			AND     TOR.MBR_CD      = TRVA.MBR_CD     (+)
			            			AND     TOR.TMS         = TRVA.TMS        (+)
			            			AND     TOR.DAY_ORD     = TRVA.DAY_ORD    (+)
			            			AND     TOR.RACE_NO     = TRVA.RACE_NO    (+)
                                    AND     TOR.RACE_REG_NO = TRVA.RACE_REG_NO(+)
                                    AND     TSC .CD         = TR  .RACE_DGRE_CD
                                    AND     TSC.GRP_CD      = 'E00005'
			            			AND     TOR.STND_YEAR   = ?
			            			AND     TOR.MBR_CD      = ?
			            			AND     TOR.TMS         = ?
			            			AND     TOR.DAY_ORD     = ? -1
			                   )            			                         
			            START WITH RACE = 1
			            CONNECT BY PRIOR RACE = RACE - 1 AND PRIOR RACER_NO = RACER_NO
			            GROUP BY RACER_NO
				     ) PRE2 -- 전일성적
				   , TBEB_CNF_INSP         TCI
                   , TBEB_RECD_STND_TERM   TRST   -- 성적반영분기코드
            WHERE  TOR.RACER_NO  = TRM  .RACER_NO
            AND    TOR.RACER_NO  = TRD  .RACER_NO (+)
            AND    TOR.RACER_NO  = TRRAS.RACER_NO (+)
            AND    TOR.RACER_NO  = TRRAS2.RACER_NO (+)
            AND    TOR.RACER_NO  = MON_6.RACER_NO (+)
            AND    TOR.ST_MTHD_CD= MON_6.ST_MTHD_CD (+)
            AND    TOR.RACER_NO  = PRE1 .RACER_NO (+)
            AND    TOR.RACER_NO  = PRE2 .RACER_NO (+)
            AND    TOR.MOT_NO    = TMRAS.MOT_NO   (+)
            AND    TOR.MOT_NO    = MPR  .MOT_NO   (+)
            AND    TOR.BOAT_NO   = TBRAS.BOAT_NO  (+)
            AND    TOR.STND_YEAR = TRI  .STND_YEAR(+)
            AND    TOR.MBR_CD    = TRI  .MBR_CD   (+)
            AND    TOR.TMS       = TRI  .TMS      (+)
            AND    TOR.RACER_NO  = TRI  .RACER_NO (+)
            AND    TOR.STND_YEAR = TCI  .STND_YEAR(+)
            AND    TOR.MBR_CD    = TCI  .MBR_CD   (+)
            AND    TOR.TMS       = TCI  .TMS      (+)
            AND    TOR.RACER_NO  = TCI  .RACER_NO (+)
            AND    TOR.STND_YEAR = TRT  .STND_YEAR
            AND    TOR.MBR_CD    = TRT  .MBR_CD
            AND    TOR.TMS       = TRT  .TMS
            AND    TRT.STR_DT >= TRST.STR_DT
            AND    TRT.END_DT <= TRST.END_DT
            AND    TOR.STND_YEAR = ?
            AND    TOR.MBR_CD    = ?
            AND    TOR.TMS       = ?
            AND    TOR.DAY_ORD   = ?
            ORDER BY
                       TOR.STND_YEAR
                     , TOR.MBR_CD
                     , TOR.TMS
                     , TOR.DAY_ORD
                     , TOR.RACE_NO
                     , TOR.RACE_REG_NO
        ]]>
    </query>     
    <query id="tbeb_race_doc_db001" desc="출주표삭제" fetchSize="10">
        <![CDATA[
			DELETE /* tbeb_race_doc_db001 */
			FROM   TBEB_RACE_DOC
			WHERE  STND_YEAR     = ?
			AND    MBR_CD        = ?
			AND    TMS           = ?
			AND    DAY_ORD       = ?
			AND    ORGAN_STAT_CD = ?
        ]]>
    </query> 
    <query id="tbeb_race_doc_fb002" desc="경주결과등록 표시가능 TMS 조회" fetchSize="10">
        <![CDATA[
            SELECT	/* tbeb_race_doc_fb002 */
                    STND_YEAR, MBR_CD, MAX(TMS) MAX_TMS
            FROM	TBEB_RACE_DOC TRD
            GROUP BY STND_YEAR, MBR_CD
            ORDER BY STND_YEAR, MBR_CD
        ]]>
    </query> 
    <query id="tbeb_race_doc_fb003" desc="홈페이지 등록 출주표건수 조회" fetchSize="10">
        <![CDATA[
			SELECT   /* tbeb_race_doc_fb003 */
			         COUNT(*) CNT
			FROM     TBEB_RACE_DOC
			WHERE    STND_YEAR     = ?
			AND      MBR_CD        = ?
			AND      TMS           = ?
			AND      DAY_ORD       = ?
			AND      ORGAN_STAT_CD = ?
        ]]>
    </query> 
</queryMap>