<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="560" Id="E07030031" Left="8" OnLoadCompleted="fcFormLoadSetting" PidAttrib="7" Title="소득증명원&#32;Report" Top="8" Ver="1.0" Width="834" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsOutMonthPay">
				<Contents>
					<colinfo id="PMT_YEAR" size="4" type="STRING"/>
					<colinfo id="PMT_MONTH" size="2" type="STRING"/>
					<colinfo id="PMT_DAY" size="2" type="STRING"/>
					<colinfo id="AID_YEAR" size="4" type="STRING"/>
					<colinfo id="SUPP_AMT" size="13" type="INT"/>
					<colinfo id="AID_RATE" size="5" type="STRING"/>
					<colinfo id="INCOME_TAX" size="13" type="INT"/>
					<colinfo id="INHAB_TAX" size="13" type="INT"/>
					<colinfo id="TAX_SUM" size="13" type="INT"/>
					<colinfo id="AID_MONTH" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutPrintMonthL">
				<Contents>
					<colinfo id="PMT_YEAR" size="6" type="STRING"/>
					<colinfo id="PMT_MONTH" size="2" type="STRING"/>
					<colinfo id="PMT_DAY" size="2" type="STRING"/>
					<colinfo id="AID_YEAR" size="4" type="STRING"/>
					<colinfo id="SUPP_AMT" size="13" type="INT"/>
					<colinfo id="AID_RATE" size="5" type="STRING"/>
					<colinfo id="INCOME_TAX" size="13" type="INT"/>
					<colinfo id="INHAB_TAX" size="13" type="INT"/>
					<colinfo id="TAX_SUM" size="13" type="INT"/>
					<colinfo id="AID_MONTH" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutPrintMonthR">
				<Contents>
					<colinfo id="PMT_YEAR" size="6" type="STRING"/>
					<colinfo id="PMT_MONTH" size="2" type="STRING"/>
					<colinfo id="PMT_DAY" size="2" type="STRING"/>
					<colinfo id="AID_YEAR" size="4" type="STRING"/>
					<colinfo id="SUPP_AMT" size="13" type="INT"/>
					<colinfo id="AID_RATE" size="5" type="STRING"/>
					<colinfo id="INCOME_TAX" size="13" type="INT"/>
					<colinfo id="INHAB_TAX" size="13" type="INT"/>
					<colinfo id="TAX_SUM" size="13" type="INT"/>
					<colinfo id="AID_MONTH" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutComInfo">
				<Contents>
					<colinfo id="COM_REG_NO" size="10" type="STRING"/>
					<colinfo id="COM_NM" size="20" type="STRING"/>
					<colinfo id="COM_OWNER_NM" size="10" type="STRING"/>
					<colinfo id="CORP_REG_NO" size="13" type="STRING"/>
					<colinfo id="COM_LOC_ADDR" size="50" type="STRING"/>
					<colinfo id="COM_ADDR" size="50" type="STRING"/>
					<colinfo id="JOB_TPE" size="20" type="STRING"/>
					<colinfo id="JOB_KINDS" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacerComInfo">
				<Contents>
					<colinfo id="RACER_NO" size="6" type="STRING"/>
					<colinfo id="NM_KOR" size="10" type="STRING"/>
					<colinfo id="COM_REG_NO" size="10" type="STRING"/>
					<colinfo id="COM_NM" size="20" type="STRING"/>
					<colinfo id="RES_NO" size="13" type="INT"/>
					<colinfo id="COM_LOC_ADDR" size="50" type="STRING"/>
					<colinfo id="ADD1_HOME" size="50" type="INT"/>
					<colinfo id="ADD2_HOME" size="50" type="INT"/>
					<colinfo id="JOB_TPE" size="20" type="INT"/>
					<colinfo id="JOB_KINDS" size="20" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Ubi Bottom="555" Height="555" Id="rptViewer" Right="829" Width="829">
			<_PersistData>&#13;&#10;/6wTkgUy/wAAAQCuVQAAd1w5APjy//7//fL4/fYLDwACBVQAWQBfUABFADD48gH+8C8DMQAyLgABNQH99S8CXgBuSQR0+vn+8C8L&#13;&#10;MgA1agAsOwBrCQRlD28FAfv0mAOmBPn2&#13;&#10;</_PersistData>
		</Ubi>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* 프로그램명 : 레코트 출력 템플릿(수평방향)                                                        *
* 설      명 : 레코트 출력 템플릿유형 처리                                                         *
* 작  성  자 : J. H. Woo                                                                           *
* 작  성  일 : 2007.10. 10                                                                         *
* 수  정  일 :                                                                                     *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/
/************************
*  공통 Script Include  *
************************/
#include "lib::boa_common_script.js";
#include "lib::boa_app_script.js";
/*-------------------------------------------------------------------------------------------------+
>>  01. 최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
	   
	var sServiceName = "e07030030-service:searchTaxMonthPay";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutComInfo=dsOutComInfo dsOutRacerComInfo=dsOutRacerComInfo dsOutMonthPay=dsOutMonthPay";
    fce_AddParam("STND_YEAR", STND_YEAR);	
    fce_AddParam("RACER_NO", RACER_NO);
    fce_AddParam("GUBUN", GUBUN);
    fce_AddParam("PMT_DT", PMT_DT);
	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);	
	
}
function fcPrintSearch(suppAmt,incomeAmt,inhabAmt) {
	var countl = 0;
	var countr = 0;
	dsOutPrintMonthL.ClearData();
	dsOutPrintMonthR.ClearData();
	
	for(var i = 1 ; i <= dsOutMonthPay.GetRowCount(); i++) {
		if(i ==1 || i == 3 || i == 5 || i == 7 || i == 9 || i == 11 || i ==13){
			dsOutPrintMonthL.AddRow(); 
			dsOutPrintMonthL.SetColumn(countl,"AID_YEAR",dsOutMonthPay.GetColumn(i-1, "AID_YEAR")+"."+dsOutMonthPay.GetColumn(i-1, "AID_MONTH"));
			dsOutPrintMonthL.SetColumn(countl,"AID_MONTH",dsOutMonthPay.GetColumn(i-1, "AID_MONTH"));			
			dsOutPrintMonthL.SetColumn(countl,"SUPP_AMT",dsOutMonthPay.GetColumn(i-1, "SUPP_AMT"));			
			dsOutPrintMonthL.SetColumn(countl,"INCOME_TAX",dsOutMonthPay.GetColumn(i-1, "INCOME_TAX"));			
			dsOutPrintMonthL.SetColumn(countl,"INHAB_TAX",dsOutMonthPay.GetColumn(i-1, "INHAB_TAX"));			
			dsOutPrintMonthL.SetColumn(countl,"PMT_YEAR",dsOutMonthPay.GetColumn(i-1, "PMT_YEAR")+"."+dsOutMonthPay.GetColumn(i-1, "PMT_MONTH"));			
			dsOutPrintMonthL.SetColumn(countl,"PMT_MONTH",dsOutMonthPay.GetColumn(i-1, "PMT_MONTH"));			
			countl++;
		}else if(i ==2 || i == 4 || i == 6 || i == 8 || i == 10 || i == 12 || i ==14){
			dsOutPrintMonthR.AddRow(); 
			dsOutPrintMonthR.SetColumn(countr,"AID_YEAR",dsOutMonthPay.GetColumn(i-1, "AID_YEAR")+"."+dsOutMonthPay.GetColumn(i-1, "AID_MONTH"));	
			dsOutPrintMonthR.SetColumn(countr,"AID_MONTH",dsOutMonthPay.GetColumn(i-1, "AID_MONTH"));			
			dsOutPrintMonthR.SetColumn(countr,"SUPP_AMT",dsOutMonthPay.GetColumn(i-1, "SUPP_AMT"));			
			dsOutPrintMonthR.SetColumn(countr,"INCOME_TAX",dsOutMonthPay.GetColumn(i-1, "INCOME_TAX"));			
			dsOutPrintMonthR.SetColumn(countr,"INHAB_TAX",dsOutMonthPay.GetColumn(i-1, "INHAB_TAX"));			
			dsOutPrintMonthR.SetColumn(countr,"PMT_YEAR",dsOutMonthPay.GetColumn(i-1, "PMT_YEAR")+"."+dsOutMonthPay.GetColumn(i-1, "PMT_MONTH"));			
			dsOutPrintMonthR.SetColumn(countr,"PMT_MONTH",dsOutMonthPay.GetColumn(i-1, "PMT_MONTH"));			
			countr++;
		}	
								
			
	}
	dsOutPrintMonthL.AddRow(); 
	dsOutPrintMonthL.SetColumn(countl,"AID_YEAR","계");
	dsOutPrintMonthL.SetColumn(countl,"SUPP_AMT",suppAmt);			
	dsOutPrintMonthL.SetColumn(countl,"INCOME_TAX",incomeAmt);			
	dsOutPrintMonthL.SetColumn(countl,"INHAB_TAX",inhabAmt);	
	
	fcPopPrint();
}

function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 조회 후
	if ( sServiceName == "e07030030-service:searchTaxMonthPay" ) {
		if(dsOutMonthPay.GetRowCount()>0){
			
			var suppAmt =0;
			var incomeAmt =0;
			var inhabAmt =0;
			for(var i = 1 ; i <= dsOutMonthPay.GetRowCount(); i++) {
				suppAmt = suppAmt+dsOutMonthPay.GetColumn(i-1, "SUPP_AMT");
				incomeAmt = incomeAmt+dsOutMonthPay.GetColumn(i-1, "INCOME_TAX");
				inhabAmt = inhabAmt+dsOutMonthPay.GetColumn(i-1, "INHAB_TAX");
			}
			fcPrintSearch(suppAmt,incomeAmt,inhabAmt);
	    }else{
			
	    }
        
	}
	//오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}

function fcPopPrint(obj) {
	var sealmgUrl = GBL_REPORT_URL+"seal2.jpg";
	var logImgUrl = GBL_REPORT_URL+"log.jpg";
	var sSubUrl   = "";                     //레포트 파일이 있는 서브디렉토리
	var sRptNm    = "e07039030_tax_report.jrf";               //레포트 파일명
	var sDataSet  = "dsOutComInfo=dsOutComInfo dsOutRacerComInfo=dsOutRacerComInfo dsOutPrintMonthL=dsOutPrintMonthL dsOutPrintMonthR=dsOutPrintMonthR";    //"UBI 쿼리명, MIP Dataset명"
	
	var sArg  = "NM_KOR="+dsOutRacerComInfo.getColumn(0, "NM_KOR");		
	sArg += " SEAL_IMG_URL="+ sealmgUrl;
	var sRptDrct  = 1;                               //출력방향(0 : 수직, 1 : 수평)
	var sRptType  = "";
	var sFileName  = "";	
	
	
	if (sRptDrct == 0){
		sFileName  = "form::E07030031.xml";
	} else {
		sFileName  = "form::E07030031.xml";
	}
	
	
	var i = 0;                                                       //Looper
	var arrDataSetList  = array();                                   //DataSet List
	var arrArgumentList = array();                                   //Argument List
	var arrArgument     = array();                                   //Argument
	arrDataSetListArray = array();

	rptViewer.ServletURL1="";                                        //SERVLET URL1
	rptViewer.setFileURL(GBL_REPORT_URL);                            //Image File Context Root
	rptViewer.setJrfFileDir(GBL_REPORT_URL + sSubUrl);               //Report Path
	rptViewer.setJrfFileName(sRptNm);                                //Report File Name

	
	arrArgumentList = split2(trim(sArg), " ", "=");                        //Argument Array List
	for (i=0; i<arrArgumentList.length(); i++) {                     //Argument List Setting
		arrArgument = split(arrArgumentList[i], ","); 
		rptViewer.SetArgument(replace(arrArgument[0],'[',''),replace(arrArgument[1],']',''));    //Argument Setting
	}
		
	if(sRptType=="" || sRptType == null || sRptType=="0"){
		rptViewer.ServletURL2="";                                        //SERVLET URL2
		arrDataSetListArray = split(trim(sDataSet), " ");   
		for(i=0; i<arrDataSetListArray.length(); i++){
			arrDataSetList = split(arrDataSetListArray[i], "=");                           //Dataset Array List
			rptViewer.SetDataset(arrDataSetList[0], arrDataSetList[1]);
		}
	}else{
		rptViewer.ServletURL2=GBL_REPORT_CONN_URL;
		rptViewer.setDatasource(GBL_REPORT_JNDI);
	}
	
	rptViewer.Retrieve();                                            //Report View
	//초기화 
	sSubUrl   = "";
	sRptNm    = "";
	sDataSet  = "";
	sArg      = "";
	
}
]]></Script>
</Window>