<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="710" Id="E02040060" Left="8" OnKeyDown="fcHotKey" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="경주출주표" Top="8" Ver="1.0" Width="1270" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" type="STRING"/>
					<colinfo id="ALL_YN" size="1" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00006</CD_GRP_ID>
						<DESCRIPTION>경정장코드</DESCRIPTION>
						<DSNAME>dsOutSMbr</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00009</CD_GRP_ID>
						<DESCRIPTION>색상</DESCRIPTION>
						<DSNAME>dsOutColor</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00119</CD_GRP_ID>
						<DESCRIPTION>편성상태코드</DESCRIPTION>
						<DSNAME>dsOutSOrganStat</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00001</CD_GRP_ID>
						<DESCRIPTION>경주종류코드</DESCRIPTION>
						<DSNAME>dsOutRaceKinds</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSStndYear">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSMbr">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="GRP_NM" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSRaceTms">
				<Contents>
					<colinfo id="Tms" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSDayOrd">
				<Contents>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRace">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" type="STRING"/>
					<colinfo id="RACE_REG_COLOR" size="256" type="STRING"/>
					<colinfo id="RACER_NOORG_RACER_NO" size="256" type="STRING"/>
					<colinfo id="RACER_RSN" size="256" type="STRING"/>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="MOT_NOORG_MOT_NO" size="256" type="STRING"/>
					<colinfo id="MOT_RSN" size="256" type="STRING"/>
					<colinfo id="MOT_NO" size="256" type="STRING"/>
					<colinfo id="VIEW_MOT_NO" size="256" type="STRING"/>
					<colinfo id="BOAT_NOORG_BOAT_NO" size="256" type="STRING"/>
					<colinfo id="BOAT_RSN" size="256" type="STRING"/>
					<colinfo id="BOAT_NO" size="256" type="STRING"/>
					<colinfo id="VIEW_BOAT_NO" size="256" type="STRING"/>
					<colinfo id="ABSE_CD" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
					<colinfo id="RACER_GRD_CD" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="RACER_STAT_CD" size="256" type="STRING"/>
					<colinfo id="FAVOR_COURSE_CD" size="256" type="STRING"/>
					<colinfo id="EMAIL_ADDR" size="256" type="STRING"/>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="NATV_PLAC_CD" size="256" type="STRING"/>
					<colinfo id="NATY_UNIV" size="256" type="STRING"/>
					<colinfo id="ENTRY_BODY_WGHT" size="256" type="STRING"/>
					<colinfo id="ETC" size="256" type="STRING"/>
					<colinfo id="AGE" size="256" type="STRING"/>
					<colinfo id="RACE_ALLOC_CNT" size="256" type="STRING"/>
					<colinfo id="SCR" size="256" type="STRING"/>
					<colinfo id="RANK" size="256" type="STRING"/>
					<colinfo id="FL_CNT" size="256" type="STRING"/>
					<colinfo id="AVG_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_RACER_RANK" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_AMU_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_AVG_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_AMU_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_AVG_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_AVG_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_WIN_RATIO" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_HIGH_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_HIGH_3_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_AVG_STRT_TM" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_8_RANK_ORD" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_RANK_1" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_RANK_2" size="256" type="STRING"/>
					<colinfo id="TRRAS_TMS_6_RANK_3" size="256" type="STRING"/>
					<colinfo id="TRRAS_AMU_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_AVG_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_AMU_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_AVG_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_AMU_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_AVG_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_AF_AMU_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_AF_AVG_ACDNT_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_AVG_SCR" size="256" type="STRING"/>
					<colinfo id="TRRAS_WIN_RATIO" size="256" type="STRING"/>
					<colinfo id="TRRAS_HIGH_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TRRAS_HIGH_3_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TRRAS_AVG_STRT_TM" size="256" type="STRING"/>
					<colinfo id="TRRAS_RUN_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RACE_DAY_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_TOT_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_AF_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RANK_1_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RANK_2_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RANK_3_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RANK_4_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RANK_5_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RANK_6_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RANK_ETC_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_DGRE_JUDG_F_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_DGRE_JUDG_L_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_F_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_AF_F_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_L_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_AF_L_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_ABSE_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RACE_ESC_1_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_RACE_ESC_2_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_FOUL_ELIM_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_ELIM_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_FOUL_WARN_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_WARN_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_ATTEN_CNT" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_TMS" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_BF_TMS" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_BF_BF_TMS" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_MBR_CD" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_BF_MBR_CD" size="256" type="STRING"/>
					<colinfo id="TRRAS_BF_BF_BF_MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMRAS_RUN_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RACE_DAY_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RANK_1_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RANK_2_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RANK_3_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RANK_4_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RANK_5_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_RANK_6_CNT" size="256" type="STRING"/>
					<colinfo id="TMRAS_AMU_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TMRAS_AVG_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TMRAS_WIN_RATIO" size="256" type="STRING"/>
					<colinfo id="TMRAS_HIGH_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TMRAS_HIGH_3_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TMRAS_TMS_3_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TMRAS_AVG_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TMRAS_MAX_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TMRAS_MIN_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TMRAS_ITRDT_RUN_TM_DVTN" size="256" type="STRING"/>
					<colinfo id="TBRAS_RUN_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RACE_DAY_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RANK_1_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RANK_2_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RANK_3_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RANK_4_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RANK_5_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_RANK_6_CNT" size="256" type="STRING"/>
					<colinfo id="TBRAS_AMU_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TBRAS_AVG_RANK_SCR" size="256" type="STRING"/>
					<colinfo id="TBRAS_WIN_RATIO" size="256" type="STRING"/>
					<colinfo id="TBRAS_HIGH_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TBRAS_HIGH_3_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="TBRAS_TMS_3_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TBRAS_AVG_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TBRAS_MAX_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TBRAS_MIN_ITRDT_RUN_TM" size="256" type="STRING"/>
					<colinfo id="TBRAS_ITRDT_RUN_TM_DVTN" size="256" type="STRING"/>
					<colinfo id="MON_6_HIGH_RANK_RATIO" size="256" type="STRING"/>
					<colinfo id="MON_6_RACE_CNT" size="256" type="STRING"/>
					<colinfo id="MON_6_RACE_REG_NO_1" size="256" type="STRING"/>
					<colinfo id="MON_6_RACE_REG_NO_2" size="256" type="STRING"/>
					<colinfo id="MON_6_RACE_REG_NO_3" size="256" type="STRING"/>
					<colinfo id="MON_6_RACE_REG_NO_4" size="256" type="STRING"/>
					<colinfo id="MON_6_RACE_REG_NO_5" size="256" type="STRING"/>
					<colinfo id="MON_6_RACE_REG_NO_6" size="256" type="STRING"/>
					<colinfo id="MOT_PRE_RECE1" size="256" type="STRING"/>
					<colinfo id="MOT_PRE_RECE2" size="256" type="STRING"/>
					<colinfo id="PRE_RACE" size="256" type="STRING"/>
					<colinfo id="ETC_RACE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSRace">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACE_DGRE_CD" size="256" type="STRING"/>
					<colinfo id="ST_MTHD_CD" size="256" type="STRING"/>
					<colinfo id="STRT_TIME" size="256" type="STRING"/>
					<colinfo id="RACE_REG_NO_CNT" size="256" type="STRING"/>
					<colinfo id="RACE_DIST" size="256" type="STRING"/>
					<colinfo id="TURN_CNT" size="256" type="STRING"/>
					<colinfo id="RACE_END_YN" size="256" type="STRING"/>
					<colinfo id="RACE_STTS_CD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutColor">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="GRP_NM" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSOrganStat">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="GRP_NM" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutFile">
				<Contents>
					<colinfo id="FILE_NAME" size="256" type="STRING"/>
					<colinfo id="FILE_URL" size="256" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacePrint"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutDayOrdPrint"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRaceKinds">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="GRP_NM" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutLastUpdate">
				<Contents>
					<colinfo id="LAST_ID" size="256" type="STRING"/>
					<colinfo id="LAST_NM" size="256" type="STRING"/>
					<colinfo id="LAST_DTM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutDocCnt" OnLoadCompleted="dsOutDocCnt_OnLoadCompleted">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMail"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutFileTitle"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRaceDay"></Dataset>
		</Datasets>
		<Shape BKColor="user2" Bottom="90" Height="28" Id="Shape4" Left="6" LineColor="user3" Right="588" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="17" Top="62" Type="RoundRect" Width="582"></Shape>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" Right="1264" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="2" Top="30" Type="RoundRect" Width="1258"></Shape>
		<Static Align="Right" Height="20" Id="Static1" Left="234" Style="snis_if_lable" TabOrder="6" Text="회차" Top="34" VAlign="Middle" Width="36"></Static>
		<Div BKColor="user0" Height="22" Id="divSearch" Left="532" TabOrder="9" Text="Div0" Top="34" Url="common::comButtonSearch.xml" Width="50">
			<Contents></Contents>
		</Div>
		<Combo Border="Flat" CodeColumn="Tms" DataColumn="Tms" Height="20" Id="cboSRaceTms" InnerDataset="dsOutSRaceTms" Left="271" OnChanged="cboSRaceTms_OnChanged" Style="snis_if_input01" TabOrder="8" Top="33" Width="70"></Combo>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboSMbr" InnerDataset="dsOutSMbr" Left="160" OnChanged="cboSStndYear_OnChanged" Style="snis_if_input01" TabOrder="11" Top="33" Width="70"></Combo>
		<Combo Border="Flat" BorderColor="user1" CodeColumn="STND_YEAR" DataColumn="STND_YEAR" Height="20" Id="cboSStndYear" InnerDataset="dsOutSStndYear" Left="48" OnChanged="cboSStndYear_OnChanged" Style="snis_m_input01" TabOrder="7" Top="33" Width="62"></Combo>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="3" Top="8" Width="17"></Image>
		<Div Height="20" Id="divBtnLst" Left="934" TabOrder="4" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static6" Left="12" Style="snis_if_lable" TabOrder="5" Text="년도" Top="34" VAlign="Middle" Width="36"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="123" Style="snis_if_lable" TabOrder="10" Text="경정장" Top="34" VAlign="Middle" Width="36"></Static>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="1" Text="조회조건" Top="6" VAlign="Middle" Width="132"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="351" Style="snis_if_lable" TabOrder="12" Text="일차" Top="34" VAlign="Middle" Width="36"></Static>
		<Combo Border="Flat" CodeColumn="DAY_ORD" DataColumn="DAY_ORD" Height="20" Id="cboSDayOrd" InnerDataset="dsOutSDayOrd" Left="388" OnChanged="cboSDayOrd_OnChanged" Style="snis_if_input01" TabOrder="13" Top="33" Width="70"></Combo>
		<Button Align="Left" ButtonStyle="TRUE" Height="20" Id="btnAntc" ImageID="btn_txt_04" Left="207" LeftMargin="15" OnClick="fcCreateFile" Style="snis_btn" TabOrder="15" Text="파일생성" Top="66" Transparent="TRUE" Width="74"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Height="20" Id="btnHomePage" ImageID="btn_txt_06" Left="283" LeftMargin="15" OnClick="fcRegistHomePage" Style="snis_btn" TabOrder="14" Text="홈페이지등록" Top="66" Transparent="TRUE" Width="98"></Button>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Enable="FALSE" Height="20" Id="cboSOrganStat" InnerDataset="dsOutSOrganStat" Left="458" Style="snis_if_input01" TabOrder="16" Top="33" Width="70"></Combo>
		<Static Align="Right" Border="Flat" Height="20" Id="Static19" Left="10" Style="snis_m_lable" TabOrder="18" Text="편성상태" Top="66" VAlign="Middle" Width="124"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboOrganStat" InnerDataset="dsOutSOrganStat" Left="136" Style="snis_if_input01" TabOrder="19" Top="65" Width="70"></Combo>
		<Checkbox Height="20" Id="chkHomepage" Left="386" Style="snis_if_check" TabOrder="20" Text="홈페이지내용조회" Top="66" Value="FALSE" Width="114"></Checkbox>
		<Static Color="user21" Height="13" Id="Static3" Left="967" TabOrder="21" Text="최종수정" Top="72" Width="60"></Static>
		<Edit BindDataset="dsOutLastUpdate" Column="LAST_NM" Height="21" Id="Edit0" Left="1029" Readonly="TRUE" TabOrder="22" Top="67" Width="67"></Edit>
		<Edit BindDataset="dsOutLastUpdate" Column="LAST_DTM" Height="21" Id="Edit1" Left="1101" Readonly="TRUE" TabOrder="23" Top="67" Width="139"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Height="20" Id="btnHomePageDel" ImageID="btn_txt_08" Left="807" LeftMargin="15" OnClick="fcDeleteHomePage" Style="snis_btn" TabOrder="24" Text="홈페이지등록취소" Top="5" Transparent="TRUE" Width="125"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Height="20" Id="btnSendMail" ImageID="btn_txt_04" Left="507" LeftMargin="15" OnClick="fcSendMail" Style="snis_btn" TabOrder="25" Text="메일발송" Top="66" Transparent="TRUE" Visible="FALSE" Width="74"></Button>
		<File Bottom="32" Height="24" Id="File0" Left="642" Right="666" TabOrder="26" Top="8" Width="24"></File>
		<FileDialog Bottom="32" Height="24" Id="FileDialog0" Left="510" Right="534" TabOrder="26" Top="8" Width="24"></FileDialog>
		<Static Height="13" Id="stRaceInfo" Left="753" TabOrder="26" Top="39" Width="503"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::boa_common_script.js";
#include "lib::boa_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'E02040060';
var sBUTTONLIST   = 'TFFFTT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var oLastDs       = null;
var oLastDsRow    = 0;

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
//	sBUTTONLIST   = 'T' + sInpt + 'FFTT';
	if ( sInpt == "T" ) {
        btnHomePage.Visible = true;
        btnAntc.Visible = true;
        btnHomePageDel.Visible = true;
		btnSendMail.Visible = true;
	} else {
        btnHomePage.Visible = false;
        btnAntc.Visible = false;
        btnHomePageDel.Visible = false;
		btnSendMail.Visible = false;
	}
	
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	//초기 화면 BK Color설정 
	fnc_SetBKColor(this);

    //년도조회
    fce_SetStndYear(dsOutSStndYear, toInteger(fce_GetSysdate("YYYY")));
    cboSStndYear.Index = 0;

    // 현재 회차 조회
    fce_GetCurTms();

	//공통코드 조회
	fce_GetComboDs(dsInComCd);


	for ( var i = 1; i <= 18; i++ ) {
		CreateDataset(i);
	}
	// 화면 초기화
	//fcInit();

	// 조회
	//fcSearch();
	
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "";
	if ( !fnc_FormUnloadCheck(sDataset , sFormId) ) return false;
}

/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}

    // Control + F
    if ( bControl == true && (nChar == 70 || nChar == 102) ) {
        var sArg  = " ";
        var sReturn = Dialog("common::comRacerFind.xml", sArg, 700, 360, "");
        if ( sReturn == false ) return;

        var asObjGrid = Array(dsOutSRace.GetRowCount());
        
        for ( var i = 1; i <= dsOutSRace.GetRowCount(); i++ ) {
            asObjGrid[i - 1] = "divRaceDoc.grdRace" + i;
        }
    
        vg_FindGrid  = "";
        vg_FindRow   = -1;
        vg_FindValue = sReturn;
        fce_findRacer(asObjGrid, vg_FindValue);
    }

    // F3
    if ( nChar == 114 ) {
        if ( fnc_IsNull(vg_FindValue) ) return;
    
        var asObjGrid = Array(dsOutSRace.GetRowCount());
        for ( var i = 1; i <= dsOutSRace.GetRowCount(); i++ ) {
            asObjGrid[i - 1] = "divRaceDoc.grdRace" + i;
        }

        fce_findRacer(asObjGrid, vg_FindValue);
    }
    
	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
    for ( var i = 1; i <= dsOutSRace.GetRowCount(); i++ ) {
        object("dsOutRace" + i).ClearData();
        //object("stRaceNm" + i).Value = i + "경주";
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {

	fcInit(obj);
	
	return true;
}

function fcSearch(obj) {
    if ( !fcSearchCheck(obj) ) return;

	var sServiceName = "e02040060-service:searchRace";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRace1=dsOutRace1 "
                     + "dsOutRace2=dsOutRace2 "
                     + "dsOutRace3=dsOutRace3 "
                     + "dsOutRace4=dsOutRace4 "
                     + "dsOutRace5=dsOutRace5 "
                     + "dsOutRace6=dsOutRace6 "
                     + "dsOutRace7=dsOutRace7 "
                     + "dsOutRace8=dsOutRace8 "
                     + "dsOutRace9=dsOutRace9 "
                     + "dsOutRace10=dsOutRace10 "
                     + "dsOutRace11=dsOutRace11 "
                     + "dsOutRace12=dsOutRace12 "
                     + "dsOutRace13=dsOutRace13 "
                     + "dsOutRace14=dsOutRace14 "
                     + "dsOutRace15=dsOutRace15 "
                     + "dsOutRace16=dsOutRace16 "
                     + "dsOutRace17=dsOutRace17 "
                     + "dsOutRace18=dsOutRace18 "
                     + "dsOutLastUpdate=dsOutLastUpdate ";		//최종수정자 정보
    
	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value     );
	fce_AddParam(Trim("TMS          "), cboSRaceTms.Value );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value  );
	fce_AddParam(Trim("DB_SERVER    "), chkHomepage.Value );
	fce_AddParam(Trim("ORGAN_STAT_CD"), cboOrganStat.Value);

	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
}


/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {

}

function fcSave(obj) {

}

/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
    //fnc_OpenExcelExport("tbScore.tb1.grdAcdntScr");        //입력 첫 항목으로 Focus
}

/*-------------------------------------------------------------------------------------------------+
>>  인쇄 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcPrint(obj) {

	var sServiceName = "e02040060-service:searchRacePrint";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRacePrint=dsOutRacePrint ";
    
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr.Value     );
	fce_AddParam(Trim("TMS      "), cboSRaceTms.Value );
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd.Value  );

	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {
	
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj) {

}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	fnc_GridSort(obj, object(obj.BindDataset), nCell);	
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {

}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex){
	
}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

	if ( !fnc_Result(ErrorCode, ErrorMSG) ) return;
	
	// 공통코드 조회시
	if ( sServiceName == "common-service:searchCode" ) {
        cboSMbr.Index = 0;
        cboSMbr.Value = fce_GetUserInfo("MBR_CD");

        fce_GetRaceTms(cboSStndYear.Value, cboSMbr.Value, "", "dsOutSRaceTms");
		return;
	}

	// 회차 리스트 조회시
	if ( sServiceName == "common_race-service:searchRaceTms" ) {
        cboSRaceTms.Index = 0;
        if ( cboSStndYear.Value == fce_GetCurRaceInfo("STND_YEAR") ) {
            var nIndexRow = fnc_GetExistValue(dsOutSRaceTms, "TMS", fce_GetCurRaceInfo("TMS"));
            if ( nIndexRow > -1 ) cboSRaceTms.Index = nIndexRow;
        }

        fce_GetRaceDayOrd(cboSStndYear.Value, cboSMbr.Value, cboSRaceTms.Value, "dsOutSDayOrd");
		return;
	}

	// 일차 리스트 조회시
	if ( sServiceName == "common_race-service:searchRaceDayOrd" ) {
        cboSDayOrd.Index = 0;
        cboSOrganStat.Index = 0;
        
        if ( cboSStndYear.Value == fce_GetCurRaceInfo("STND_YEAR") 
         && cboSRaceTms.Value == fce_GetCurRaceInfo("TMS") ) {
            var nIndexRow = fnc_GetExistValue(dsOutSDayOrd, "DAY_ORD", fce_GetCurRaceInfo("DAY_ORD"));
            if ( nIndexRow > -1 ) cboSDayOrd.Index = nIndexRow;
        }

        cboSDayOrd_OnChanged();

		return;
	}

	// 일차 리스트 조회시
	if ( sServiceName == "common_race-service:searchRace" ) {
        CreateDiv();   
		return;
	}

	// 조회 후
	if ( sServiceName == "e02040060-service:searchRace" ) {

		return;
	}

	// 인쇄조회 후
	if ( sServiceName == "e02040060-service:searchRacePrint" ) {
        if ( dsOutRacePrint.GetRowCount() == 0 ) {
            fnc_Message(SNIS_BOA_B008, "N", "편성작업");
            return;
        }
	
        dsOutDayOrdPrint.Copy(dsOutSDayOrd);
        dsOutDayOrdPrint.ClearData();
        dsOutDayOrdPrint.AddRow();
        
        var nRow = fnc_GetExistValue(dsOutSDayOrd, "DAY_ORD", cboSDayOrd.Value);
        dsOutDayOrdPrint.CopyRow(0, dsOutSDayOrd, nRow);
        
        dsOutDayOrdPrint.AddColumn("RACE_KINDS_NM");
        dsOutDayOrdPrint.AddColumn("RACE_STAT_NM");
        nRow = fnc_GetExistValue(dsOutSRaceTms, "TMS", cboSRaceTms.Value);
        var sRaceKindsCd = dsOutSRaceTms.GetColumn(nRow, "RACE_KINDS_CD");
        nRow = fnc_GetExistValue(dsOutRaceKinds, "CD", sRaceKindsCd);
        dsOutDayOrdPrint.SetColumn(0, "RACE_KINDS_NM", dsOutRaceKinds.GetColumn(nRow, "CD_NM"));
        dsOutDayOrdPrint.SetColumn(0, "RACE_STAT_NM", cboOrganStat.Text);
        
        var logImgUrl = GBL_REPORT_URL + "log.jpg";
        var sSubUrl   = "";                     //레포트 파일이 있는 서브디렉토리
        var sRptNm    = "e02049060_race_doc.jrf";               //레포트 파일명
        var sDataSet  = "race_day=dsOutDayOrdPrint race_info=dsOutSRace race=dsOutRacePrint";   //"UBI 쿼리명, MIP Dataset명"
        var sArg      = " IMG_URL="+logImgUrl; 
            sArg     += " ASSO_NM="+gdsUser.GetColumn(0, "ASSO_NM");
            sArg     += " DEPT_NM="+gdsUser.GetColumn(0, "DEPT_NM");
            sArg     += " TEAM_NM="+gdsUser.GetColumn(0, "TEAM_NM");
            sArg     += " USER_NM="+gdsUser.GetColumn(0, "USER_NM");
            sArg     += " ORGAN_STAT_CD="+cboOrganStat.Value;

        var sRptDrct  = 1;                               //출력방향(0 : 수직, 1 : 수평)

        fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);

		return;
	}

	// 일차 리스트 조회시
	if ( sServiceName == "e02040060-service:createFile" ) {
        var sArg = " sArr_StndYear="    + quote(cboSStndYear.Value)
                 + " sArr_MbrCd="       + quote(cboSMbr.Value)
                 + " sArr_MbrNm="       + quote(cboSMbr.Text)
                 + " sArr_Tms="         + quote(cboSRaceTms.Value)
                 + " sArr_DayOrd="      + quote(cboSDayOrd.Value)
                 + " sArr_RaceDay="     + quote(dsOutSDayOrd.GetColumn(dsOutSDayOrd.row, "RACE_DAY"))
                 + " sArr_OrganStatCd=" + quote(cboOrganStat.Value)
                 + " sArr_OrganStatNm=" + quote(cboOrganStat.Text)
                 + " sArr_Type="        + quote("PRINT");
        Dialog("form::E02040052.xml", sArg, 250, 250, "");        

		return;
	}

	// 일차 리스트 조회시
	if ( sServiceName == "e02040060-service:registHomePage" ) {
		//확정 자료만 보낸다.
		if (cboSOrganStat.Value == "001") {
			if (fnc_message("홈페이지 고객에게 메일을 발송하시겠습니까?", "Y")) {
				fcSendMail(obj);
			}
		}
		return;
	}

	if ( sServiceName == "e02040060-service:checkMail" ) {// 메일발송 여부 체크
	
		var nMailCnt = dsMail.GetRowCount();
		//trace("nMailCnt========:"+nMailCnt);
		if ( nMailCnt > 0 ) {
			if( confirm("***이미 메일발송을 " + nMailCnt + "번 하셨습니다.***\n\n다시 메일발송을 하시겠습니까?") ){
				fcRecordMail();
			}
		}
		else {
			if( confirm("메일발송을 하시겠습니까?") ){
				fcRecordMail();
			}
		}
		return;
	}
	
	
	if ( sServiceName == "e02040060-service:saveMailHist" ) {// 메일발송 여부 체크	
		fcMail();
		return;
	}
	
	//오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {

}

/*-------------------------------------------------------------------------------------------------+
>>  코드나 명 입력 후 Lost Focus 시 해당 정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcCodeNameDisplay(obj) {

}

/*-------------------------------------------------------------------------------------------------+
>>  년도변경시
+-------------------------------------------------------------------------------------------------*/
function cboSStndYear_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    fce_GetRaceTms(cboSStndYear.Value, cboSMbr.Value, "", "dsOutSRaceTms");
}

/*-------------------------------------------------------------------------------------------------+
>>  회차변경시
+-------------------------------------------------------------------------------------------------*/
function cboSRaceTms_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fce_GetRaceDayOrd(cboSStndYear.Value, cboSMbr.Value, cboSRaceTms.Value, "dsOutSDayOrd");
}

/*-------------------------------------------------------------------------------------------------+
>>  일차변경시
+-------------------------------------------------------------------------------------------------*/
function cboSDayOrd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    fcInit();
    dsOutSDayOrd.row = fnc_GetExistValue(dsOutSDayOrd, "DAY_ORD", cboSDayOrd.Value);
    cboSOrganStat.Value = dsOutSDayOrd.GetColumn(dsOutSDayOrd.row, "ORGAN_STAT_CD");
    cboOrganStat .Value = dsOutSDayOrd.GetColumn(dsOutSDayOrd.row, "ORGAN_STAT_CD");
    
    fce_GetRace(cboSStndYear.Value, cboSMbr.Value, cboSRaceTms.Value, cboSDayOrd.Value, "dsOutSRace");

	var sServiceName = "e02040060-service:searchDocCnt";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutDocCnt=dsOutDocCnt ";
    
	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value );
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value      );
	fce_AddParam(Trim("TMS          "), cboSRaceTms.Value  );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value   );
	fce_AddParam(Trim("ORGAN_STAT_CD"), cboSOrganStat.Value);

	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");

}

/*-------------------------------------------------------------------------------------------------+
>>  홈페이지 등록 버튼 클릭시 
+-------------------------------------------------------------------------------------------------*/
function fcRegistHomePageCheck(obj) {

    if ( !fnc_message("홈페이지에 등록 하시겠습니까?", "Y") ) {
        return false;
    }
    
	return true;
}

/*-------------------------------------------------------------------------------------------------+
>>  홈페이지 등록  
+-------------------------------------------------------------------------------------------------*/
function fcRegistHomePage(obj)
{
    if ( !fcRegistHomePageCheck(obj) ) return;

	var sServiceName = "e02040060-service:registHomePage";
    var sInDataSet   = "";
    var sOutDataSet  = "";
    
	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value );
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value      );
	fce_AddParam(Trim("TMS          "), cboSRaceTms.Value  );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value   );
	fce_AddParam(Trim("ORGAN_STAT_CD"), cboOrganStat.Value );

	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
}

/*-------------------------------------------------------------------------------------------------+
>>  홈페이지 등록 취소(삭제)
+-------------------------------------------------------------------------------------------------*/
function fcDeleteHomePage(obj)
{
    if ( !fnc_message("홈페이지에 등록된 출주표를 삭제하시겠습니까?", "Y") ) return;

	var sServiceName = "e02040060-service:deleteHomePage";
    var sInDataSet   = "";
    var sOutDataSet  = "";
    
	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value );
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value      );
	fce_AddParam(Trim("TMS          "), cboSRaceTms.Value  );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value   );
	fce_AddParam(Trim("ORGAN_STAT_CD"), cboOrganStat.Value );

	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");

}

/*-------------------------------------------------------------------------------------------------+
>>  첨부파일생성버튼 클릭시
+-------------------------------------------------------------------------------------------------*/
function fcCreateFileCheck(obj) {

    if ( !fnc_message("파일을 생성 하시겠습니까?", "Y") ) {
        return false;
    }

    dsOutFile.ClearData();
    dsOutSDayOrd.row = fnc_GetExistValue(dsOutSDayOrd, "DAY_ORD", cboSDayOrd.Value);
    
	return true;
}

/*-------------------------------------------------------------------------------------------------+
>>  파일생성
+-------------------------------------------------------------------------------------------------*/
function fcCreateFile(obj)
{
    if ( !fcCreateFileCheck(obj) ) return;

	var sServiceName = "e02040060-service:createFile";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutFile=dsOutFile ";
    
	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value );
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value      );
	fce_AddParam(Trim("TMS          "), cboSRaceTms.Value  );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value   );
	fce_AddParam(Trim("RACE_DAY     "), dsOutSDayOrd.GetColumn(dsOutSDayOrd.row, "RACE_DAY"));
	fce_AddParam(Trim("ORGAN_STAT_CD"), cboOrganStat.Value );

	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
}

/*-------------------------------------------------------------------------------------------------+
>>  화면에 그려질 DIV 생성
+-------------------------------------------------------------------------------------------------*/
function CreateDiv() {
    Destroy("divRaceDoc");

    // 테두리 생성
    // var nHeight = 50;
    // var nWidth  = 54;
    // var nLeft   = 4;
    // var nTop    = ((nObjNo - 1) * 52) + 36;

    var sDivType = "";
    sDivType += ' Height="730"    ';
    sDivType += ' Id="divRaceDoc" ';
    sDivType += ' Left="6"        ';
    sDivType += ' scroll="true"   ';
    sDivType += ' Top="100"       ';
    sDivType += ' Width="1256"    ';

    Create("Div","divRaceDoc", sDivType);
    
    
    var sContents = "";
    var divTop = 0;	
    var gridTop1 = 0;
    var gridTop2 = 0;
    var gridHeight = 150;
    
    curNum = 2;	// 최초 시작 높이

    sContents += "<Contents>";
    for ( var i = 1; i <= dsOutSRace.GetRowCount(); i++ ) {
    
		// 경주의 정번정보를 이용하여 높이를 계산한다.
		
		gridHeight = 150;
		
		if(toInteger(dsOutSRace.GetColumn(i-1, "RACE_REG_NO_CNT"))==7){
			gridHeight = 167;
			
		}else if(toInteger(dsOutSRace.GetColumn(i-1, "RACE_REG_NO_CNT"))==8){
			gridHeight = 185;
		}
		
		divTop = curNum;	// 경주정보의 높이
		curNum += 20;
		gridTop1 = curNum;	// 첫번째 그리드의 높이
		curNum += gridHeight + 8;
		gridTop2 = curNum;	// 두번째 그리드의 높이
		curNum += gridHeight + 22;
		
        sContents += GetObjectContent(i, divTop, gridTop1, gridTop2, gridHeight, toInteger(dsOutSRace.GetColumn(i-1, "RACE_REG_NO_CNT")));
        
    }
    sContents += "</Contents>";
    
    object("divRaceDoc").contents = sContents;
}

/*-------------------------------------------------------------------------------------------------+
>>  Dataset 생성
+-------------------------------------------------------------------------------------------------*/
function CreateDataset(nDsNo) {
    Create("Dataset","dsOutRace" + nDsNo);
}

/*-------------------------------------------------------------------------------------------------+
>>  경주정보 생성
+-------------------------------------------------------------------------------------------------*/
function GetObjectContent(nObjNo, divTop, gridTop1, gridTop2, gridHeight, regCnt) {
    
    var sContents = "";

    var nHeight = 13;
    var nWidth  = 28;
    var nLeft   = 23;
    //var nTop    = ((nObjNo - 1) * 340) + 2;
    var nTop    = divTop;
    
    var nRow = toInteger(nObjNo - 1);
    
    var sStartType = "플라잉";
    if(dsOutSRace.GetColumn(nRow, "ST_MTHD_CD") == "001") sStartType = "온라인"; 
    
    var sWrite  = "제【 " + toInteger(dsOutSRace.GetColumn(nRow, "RACE_NO")) + " 】경주";
        sWrite += " " + dsOutSRace.GetColumn(nRow, "RACE_DGRE_NM") + "경주 " +sStartType;
        sWrite += " " + dsOutSRace.GetColumn(nRow, "TURN_CNT") + "주회";
        sWrite += "(  " + NumFormat(dsOutSRace.GetColumn(nRow, "RACE_DIST")) + "m )";
        sWrite += " 출발시간 " + substr(dsOutSRace.GetColumn(nRow, "STRT_TIME"), 0, 2) + ":" + substr(dsOutSRace.GetColumn(nRow, "STRT_TIME"), 2, 4);
        
    var stRaceNm = sWrite;
    
    sContents += '    <Image Height="20" Id="Image' + nObjNo + '" ImageID="m_titleblet" Left="0" TabOrder="16" Top="' + nTop + '" Width="17"></Image>';
	sContents += '	  <Static Height="22" Id="stRaceNm' + nObjNo + '" Left="22" Style="snis_m_title" TabOrder="15" Text="' + sWrite + '" Top="' + nTop + '" VAlign="Middle" Width="700"></Static>';
    sContents += GetGridContent1(nObjNo, gridTop1, gridHeight);
    sContents += GetGridContent2(nObjNo, gridTop2, gridHeight, regCnt);


    return sContents;
}

/*-------------------------------------------------------------------------------------------------+
>>  경주별 첫번째 Grid생성
+-------------------------------------------------------------------------------------------------*/
function GetGridContent1(nObjNo, gridTop1, gridHeight) {
    
    var sGridContents = "";

    var nHeight = 13;
    var nWidth  = 28;
    var nLeft   = 23;
    //var nTop    = ((nObjNo - 1) * 340) + 22;
    var nTop    = gridTop1;
    
    var sBkColor = "expr:iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==2,&quot;#000000&quot;,"
                      + "iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==3,&quot;#FF0000&quot;,"
                      + "iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==4,&quot;#0000FF&quot;,"
                      + "iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==5,&quot;#FFFF00&quot;,"
                      + "iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==6,&quot;#00FF00&quot;,"
                      + "iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==7,&quot;" + GBL_REG_COLOR_7 + "&quot;,"
                      + "iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==8,&quot;" + GBL_REG_COLOR_8 + "&quot;,"
                      + "&quot;#FFFFFF&quot;)))))))";
    var sColor   = "expr:iif(dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==2||dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==3||dsOutRace" + nObjNo + ".GetColumn(row,&apos;RACE_REG_NO&apos;)==4,&quot;#FFFFFF&quot;,&quot;#000000&quot;)";
    
    sGridContents += '<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutRace' + nObjNo + '" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="272" DragMode="TRUE"        ';
    sGridContents += '      DropMode="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="20" Height="' + gridHeight + '" Id="grdRace' + nObjNo + '" InputPanel="FALSE" Left="0" LineColor="user18" MinWidth="100"            ';
    sGridContents += '      OnHeadClick="fcGridSort" Right="1264" SelColor="user19" Style="snis_grid" TabOrder="5" TabStop="true" Top="' + nTop + '" UseDBuff="true" UsePopupMenu="true" UseSelColor="false" Visible="true" VLineColor="default" '; 
    sGridContents += '      WheelScrollRow="1" Width="1236">                                                                                                                                                                           ';
    sGridContents += '	<contents>                                                                                                                                                                                                     ';
    sGridContents += '		<format id="Default">                                                                                                                                                                                      ';
    sGridContents += '			<columns>                                                                                                                                                                                              ';
    if (cboSDayOrd.Value == "3") {
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="50"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="30"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="55"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="50"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="50"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="50"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="50"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="50"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="79"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="40"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="45"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="153"/>                                                                                                                                                                                  ';
    } else {
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="55"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="25"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="30"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="79"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="40"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="60"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="45"/>                                                                                                                                                                                  ';
		sGridContents += '				<col width="93"/>                                                                                                                                                                                  ';
    }
    sGridContents += '			</columns>                                                                                                                                                                                             ';
    sGridContents += '			<head>                                                                                                                                                                                                 ';
    sGridContents += '				<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="번호" wordwrap="word"/>                                                                               ';
    sGridContents += '				<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="등급" wordwrap="word"/>                                                                               ';
    sGridContents += '				<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="기수" wordwrap="word"/>                                                                               ';
    sGridContents += '				<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="선수명" wordwrap="word"/>                                                                             ';
    sGridContents += '				<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="성별" wordwrap="word"/>                                                                             ';
    sGridContents += '				<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="나이" wordwrap="word"/>                                                                               ';
    sGridContents += '				<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="체중" wordwrap="word"/>                                                                               ';
    sGridContents += '				<cell bkcolor="user20" col="7" color="user21" colspan="6" display="text" font="굴림,9" text="최근6회차성적" wordwrap="word"/>                                                                      ';
    sGridContents += '				<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" row="1" text="평균착순점" wordwrap="word"/>                                                                                            ';
    sGridContents += '				<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" row="1" text="평균득점" wordwrap="word"/>                                                                                              ';
    sGridContents += '				<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" row="1" text="승률" wordwrap="word"/>                                                                                                  ';
    sGridContents += '				<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" row="1" text="연대율" wordwrap="word"/>                                                                                                ';
    sGridContents += '				<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9" row="1" text="3연대율" wordwrap="word"/>                                                                                              ';
    sGridContents += '				<cell bkcolor="user20" col="12" color="user21" display="text" font="굴림,9" row="1" text="ST/OST" wordwrap="word"/>                                                                                               ';
    sGridContents += '				<cell bkcolor="user20" col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="최근&#32;8경주착순" wordwrap="word"/>                                                                ';
    sGridContents += '				<cell bkcolor="user20" col="14" color="user21" colspan="2" display="text" expr="cboSStndYear.Value&#32;+&#32;&quot;년&#32;누적성적&quot;" font="굴림,9" text="년&#32;누적성적" wordwrap="word"/>   ';
    sGridContents += '				<cell bkcolor="user20" col="14" color="user21" display="text" font="굴림,9" row="1" text="평균착순점" wordwrap="word"/>                                                                            ';
    sGridContents += '				<cell bkcolor="user20" col="15" color="user21" display="text" font="굴림,9" row="1" text="연대율" wordwrap="word"/>                                                                                ';
    sGridContents += '				<cell bkcolor="user20" col="16" color="user21" display="text" font="굴림,9" rowspan="2" text="F/L" wordwrap="word"/>                                                                               ';
    sGridContents += '				<cell bkcolor="user20" col="17" color="user21" display="text" font="굴림,9" rowspan="2" text="평균사고점" wordwrap="word"/>                                                                        ';
    sGridContents += '				<cell bkcolor="user20" col="18" color="user21" display="text" font="굴림,9" rowspan="2" text="금일&#32;출주경주" wordwrap="word"/>                                                                 ';
    sGridContents += '				<cell bkcolor="user20" col="19" color="user21" display="text" font="굴림,9" rowspan="2" text="전일성적" wordwrap="word"/>                                                                          ';
    sGridContents += '			</head>                                                                                                                                                                                                ';
    sGridContents += '			<body>                                                                                                                                                                                                 ';
    sGridContents += '				<cell col="0" align="center" colid="RACE_REG_NO" combocol="CD" combodataset="dsOutColor" combotext="CD_NM" display="text" bkColor="' + sBkColor + '" color="' + sColor + '"/>                                                                                                                                                 ';
    sGridContents += '				<cell col="1" align="center" colid="RACER_GRD_CD" display="text"/>                                                                                      ';
    sGridContents += '				<cell col="2" align="center" colid="RACER_PERIO_NO" display="text"/>                                                                                                                                              ';
    sGridContents += '				<cell col="3" align="center" colid="NM_KOR" display="text"/>                                                                                                                                                      ';
    sGridContents += '				<cell col="4" align="center" colid="RACER_SEX" display="text"/>                                                                                                                                                      ';
    sGridContents += '				<cell col="5" align="center" colid="AGE" display="text"/>                                                                                                                                                         ';
    sGridContents += '				<cell col="6" align="center" colid="ENTRY_BODY_WGHT" display="text"/>                                                                                                                                             ';
    sGridContents += '				<cell col="7" align="center" colid="TRRAS_TMS_6_AVG_RANK_SCR" display="text"/>                                                                                                                                    ';
    sGridContents += '				<cell col="8" align="center" colid="TRRAS_TMS_6_AVG_SCR" display="text"/>                                                                                                                                         ';
    sGridContents += '				<cell col="9" align="center" colid="TRRAS_TMS_6_WIN_RATIO" display="text"/>                                                                                                                                       ';
    sGridContents += '				<cell col="10" align="center" colid="TRRAS_TMS_6_HIGH_RANK_RATIO" display="text"/>                                                                                                                                 ';
    sGridContents += '				<cell col="11" align="center" colid="TRRAS_TMS_6_HIGH_3_RANK_RATIO" display="text"/>                                                                                                                              ';
    sGridContents += '				<cell col="12" align="center" colid="TRRAS_TMS_6_AVG_STRT_TM" display="text"/>                                                                                                                                    ';
    sGridContents += '				<cell col="13" align="center" colid="TRRAS_TMS_8_RANK_ORD" display="text" Mask="@@@@&#32;@@@@"/>                                                                                                                  ';
    sGridContents += '				<cell col="14" align="center" colid="TRRAS_AVG_RANK_SCR" display="text"/>                                                                                                                                         ';
    sGridContents += '				<cell col="15" align="center" colid="TRRAS_HIGH_RANK_RATIO" display="text"/>                                                                                                                                            ';
    sGridContents += '				<cell col="16" align="center" colid="FL_CNT" display="text"/>                                                                                                                                                     ';
    sGridContents += '				<cell col="17" align="center" colid="AVG_ACDNT_SCR" display="text"/>                                                                                                                                              ';
    sGridContents += '				<cell col="18" align="center" colid="ETC_RACE" display="text"/>                                                                                                                                                   ';
    sGridContents += '				<cell col="19" align="left"   colid="PRE_RACE" display="text"/>                                                                                                                                                   ';
    sGridContents += '			</body>                                                                                                                                                                                                ';
    sGridContents += '		</format>                                                                                                                                                                                                  ';
    sGridContents += '	</contents>                                                                                                                                                                                                    ';
    sGridContents += '</Grid>                                                                                                                                                                                                          ';

    return sGridContents;
}

/*-------------------------------------------------------------------------------------------------+
>>  경주별 두번째 Grid생성
+-------------------------------------------------------------------------------------------------*/
function GetGridContent2(nObjNo, gridTop1, gridHeight, regCnt) {
    
    var sGridContents = "";

    var nHeight = 13;
    var nWidth  = 28;
    var nLeft   = 23;
    //var nTop    = ((nObjNo - 1) * 340) + 180;
    var nTop    = gridTop1;
    
    sGridContents += '<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutRace' + nObjNo + '" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true"               ';
    sGridContents += '      Border="Flat" BorderColor="user22" Bottom="428" DragMode="TRUE" DropMode="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE"              ';
    sGridContents += '      HeadBorder="Flat" HeadHeight="20" Height="' +  gridHeight + '" Id="grdRaceInfo' + nObjNo + '" InputPanel="FALSE" Left="0" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort"  ';
    sGridContents += '      Right="1264" SelColor="user19" Style="snis_grid" TabOrder="17" TabStop="true" Top="' + nTop + '" UseDBuff="true" UsePopupMenu="true" UseSelColor="false"    ';
    sGridContents += '      Visible="true" VLineColor="default" WheelScrollRow="1" Width="1236" OnCellDBLClick="fcgrdOnCellDBLClick">                                                                              ';
    sGridContents += '			<contents>                                                                                                                                    ';
    sGridContents += '				<format id="Default">                                                                                                                     ';
    sGridContents += '					<columns>                                                                                                                             ';
    sGridContents += '						<col width="27"/>                                                                                                                 ';
    sGridContents += '						<col width="72"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    if(regCnt >= 7) sGridContents += '						<col width="60"/>                                                                                                                 ';
    if(regCnt == 8) sGridContents += '						<col width="60"/>                                                                                                                 ';
    
    sGridContents += '						<col width="45"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="85"/>                                                                                                                 ';
    sGridContents += '						<col width="84"/>                                                                                                                 ';
    sGridContents += '						<col width="44"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="60"/>                                                                                                                 ';
    sGridContents += '						<col width="117"/>                                                                                                                ';
    sGridContents += '					</columns>                                                                                                                            ';
    sGridContents += '					<head>                                                                                                                                 ';
    var coli = 0;
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" rowspan="2" text="번호"/>                              ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" rowspan="2" text="선수명"/>                            ';
    var colspan1 = 8;
    if(regCnt == 7) colspan1 = 9;
    if(regCnt == 8) colspan1 = 10;
    sGridContents += '						<cell bkcolor="user20" col="' + coli + '" color="user21" colspan="' + colspan1 + '" display="text" font="굴림,9" text="6개월코스별연대율/코스별출주횟수"/>  ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="연대율"/>                                               ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="출주횟수"/>                                             ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="1코스"/>                                                ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="2코스"/>                                                ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="3코스"/>                                                ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="4코스"/>                                                ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="5코스"/>                                                ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="6코스"/>                                                ';
    if(regCnt >= 7) sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="7코스"/>                                                ';
    if(regCnt == 8) sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="8코스"/>                                                ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli + '" color="user21" colspan="4" display="text" font="굴림,9" text="모터성적"/>                         ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="번호"/>                                 ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="평균착순점"/>                           ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="연대율"/>                               ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="삼연대율"/>                             ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" colspan="2" display="text" font="굴림,9" rowspan="2" text="직전탑승선수/착순"/>    ';
    coli++;
    sGridContents += '						<cell bkcolor="user20" col="' + coli + '" color="user21" colspan="3" display="text" font="굴림,9" text="보트성적"/>                         ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="번호"/>                                 ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="평균착순점"/>                           ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" row="1" text="연대율"/>                               ';
    sGridContents += '						<cell bkcolor="user20" col="' + coli++ + '" color="user21" display="text" font="굴림,9" rowspan="2" text="특이사항"/>                         ';
    sGridContents += '					</head>                                                                                                                               ';
    sGridContents += '					<body>                                                                                                                                ';
    coli = 0;
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="RACE_REG_NO" display="text"/>                                                                                ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="NM_KOR" display="text"/>                                                                                     ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_HIGH_RANK_RATIO" display="text"/>                                                                      ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_CNT" display="text"/>                                                                             ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_1" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_2" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_3" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_4" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_5" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_6" display="text"/>                                                                        ';
    if(regCnt >= 7) sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_7" display="text"/>                                                                        ';
    if(regCnt == 8) sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MON_6_RACE_REG_NO_8" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" cursor="hand" colid="VIEW_MOT_NO" display="text"/>                                                                               ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="TMRAS_AVG_RANK_SCR" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="TMRAS_HIGH_RANK_RATIO" display="text"/>                                                                     ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="TMRAS_HIGH_3_RANK_RATIO" display="text"/>                                                                   ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MOT_PRE_RECE1" display="text"/>                                                                             ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="MOT_PRE_RECE2" display="text"/>                                                                             ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" cursor="hand" colid="VIEW_BOAT_NO" display="text"/>                                                                              ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="TBRAS_AVG_RANK_SCR" display="text"/>                                                                        ';
    sGridContents += '						<cell col="' + coli++ + '" align="center" colid="TBRAS_HIGH_RANK_RATIO" display="text"/>                                                                     ';
    sGridContents += '						<cell col="' + coli++ + '" colid="RMK" display="text"/>                                                                                       ';
    sGridContents += '					</body>                                                                                                                               ';
    sGridContents += '				</format>                                                                                                                                 ';
    sGridContents += '			</contents>                                                                                                                                   ';
    sGridContents += '		</Grid>                                                                                                                                           ';

    return sGridContents;
}

function dsOutDocCnt_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	if (dsOutDocCnt.GetColumn(0, "CNT") > 0)	btnHomePageDel.Enable = true;
	else										btnHomePageDel.Enable = false;
}

function fcgrdOnCellDBLClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if (Mid(obj.id,0,11) != "grdRaceInfo") return;
	var dsObj = Object(obj.BindDataset);

	if (nCell == 10) {
		// 모터 성적
		gdsParam.clear();
		gdsParam.AddColumn("MOT_NO", "String");
		gdsParam.AddRow(0);
		gdsParam.SetColumn(0, "MOT_NO", SubStr(dsObj.GetColumn(nRow, "MOT_NO"),5,3));
		global.FrameBottom.fcOpenMdiForm("E02050030", "회차별 성적현황", "form::E02050030.xml");
	} else if (nCell == 16) {
		// 보트 성적
		gdsParam.clear();
		gdsParam.AddColumn("BOAT_NO", "String");
		gdsParam.AddRow(0);
		gdsParam.SetColumn(0, "BOAT_NO", SubStr(dsObj.GetColumn(nRow, "BOAT_NO"),5,3));
		global.FrameBottom.fcOpenMdiForm("E02050030", "회차별 성적현황", "form::E02050030.xml");
	}
}
function fcSendMail(obj)
{
	/* 
	1. 메일 발송여부 체크(fcCheckMail)
	2. 메일로 보낼 파일을 생성한다.(fcCreateFile)
	3. 파일에서 자료를 읽어온다.(파일:신문사제목)
	4. 메일 전송여부를 저장한다.(fcRecordMail)
	5. 서버로 전송하여 메일을 발송한다.
	*/
	
	//확정 자료만 보낸다.
	if (cboSOrganStat.Value == "001") {
		fnc_message("확정자료만 메일로 발송이 가능합니다.","N");
		return;
	}
	 
	// 파일생성 여부 확인
	fcSearchFile();
	fcCheckMail();
}


/*-------------------------------------------------------------------------------------------------+
>>  파일생성 여부 체크
+-------------------------------------------------------------------------------------------------*/
function fcSearchFile() {
	var sServiceName = "e02040060-service:searchFile";
	var sInDataSet   = "";
	var sOutDataSet  = "dsOutFileTitle=dsOutFileTitle ";  
	var sRaceTms = cboSRaceTms.value;
    if (Length(sRaceTms) < 2) sRaceTms = "0" + sRaceTms;
    if (Length(sRaceTms) = 3) sRaceTms = SubStr(sRaceTms, 1,2); //36회차의 길이를 0으로 리턴하는 오류 해결 

	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value     );
	fce_AddParam(Trim("TMS          "), sRaceTms );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value  );
	fce_AddParam(Trim("CFM_YN       "), cboOrganStat.Value);
	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
	
}


/*-------------------------------------------------------------------------------------------------+
>>  메일발송여부 체크
+-------------------------------------------------------------------------------------------------*/
function fcCheckMail() {
	var sServiceName = "e02040060-service:checkMail";
	var sInDataSet   = "";
	var sOutDataSet  = "dsMail=dsMail ";    

	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value     );
	fce_AddParam(Trim("TMS          "), cboSRaceTms.Value );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value  );
	fce_AddParam(Trim("CFM_YN       "), cboOrganStat.Value);
	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}


/*-------------------------------------------------------------------------------------------------+
>>  메일발송 기록
+-------------------------------------------------------------------------------------------------*/
function fcRecordMail() {

	if (dsOutFileTitle.rowcount() == 0) {
		fnc_message("파일이 생성되지 않았습니다. 파일 생성을 먼저 하세요!", "N");
		return;
	}
	
	var sServiceName = "e02040060-service:saveMailHist";
	var sInDataSet   = "";
	var sOutDataSet  = "";    

	fce_AddParam(Trim("STND_YEAR    "), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD       "), cboSMbr.Value     );
	fce_AddParam(Trim("TMS          "), cboSRaceTms.Value );
	fce_AddParam(Trim("DAY_ORD      "), cboSDayOrd.Value  );
	fce_AddParam(Trim("CFM_YN       "), cboOrganStat.Value);
	//fce_AddParam("ORGAN_WORK_ID"  , gdsUser.GetColumn(0, "USER_ID"));
	
	//trace("fcRecordMail================:"+gdsUser.GetColumn(0, "USER_ID"));
	
	//http.Sync = true;
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
	//http.Sync = false;
}


/*-------------------------------------------------------------------------------------------------+
>>  메일발송용 파일 가져오기
+-------------------------------------------------------------------------------------------------*/
function fcMail() {

	// 서버에 저장된 파일을 가져오기
	var localfile = AliasToRealPath("%UserApp%") + "\\" + "sendmail820.txt";
	if (file0.IsExistFile(localfile)) file0.Delete(localfile);
	var serverfile = dsOutFileTitle.GetColumn(0, "FILE_URL");
    var sFileSize = dsOutFileTitle.GetColumn(0, "FILE_SIZE");
    var ret = fnc_FileRead(divBtnLst.HttpFile, localfile, serverfile, sFileSize, 0, "PROG_BAR", dsOutFileTitle);


	// 가져온 파일에서 내용 읽기
	var sRet = "";
	file0.FileName = localfile;
	file0.open("rt");
	sRet = file0.Read();
	file0.Close();
	file0.Delete(localfile);	

	// 메일 발송
	var sMail = sRet;
	//alert(sMail);
				
	if (fnc_IsNull(sMail)) {
		fnc_message("메일을 발송할 출주표정보가 없습니다.\n\n파일생성후 메일발송이 가능합니다.", "N");
		return;
	}
	
    var sRaceDay = fcGetRaceDay(cboSStndYear.Value, cboSMbr.Value, cboSRaceTms.Value, cboSDayOrd.Value, "dsOutRaceDay");
	var sRadeDayName = dsOutRaceDay.GetColumn(0, "DY_HAN");
	var subject = "경정 " + cboSStndYear.Value + "년" + ToNumber(Substr(sRaceDay, 4, 2)) + "월" + ToNumber(Substr(sRaceDay, 6, 2)) + "일 " +
				  "출주표(" + sRadeDayName + "요일 " +
				  cboSRaceTms.Value + "회 " +
				  cboSDayOrd.Value + "일차 " + iif(cboSOrganStat=="001","미확정","확정") + ")";
	stRaceInfo.text = subject;
	fnc_SendMailList(subject, "<pre style='COLOR: #000000; FONT-FAMILY: 굴림체; FONT-SIZE: 9pt'>" + sMail + "</pre>");
}


/**************************************************************************************************
*  함   수  명				: fnc_GetRaceDay
*  설       명				: 해당 경주회차의 일차의 경주일자를 조회
*  return Type				: 없음
*  return 내용				: 경주일자
**************************************************************************************************/
function fcGetRaceDay(sStndYear, sMbrCd, sTms, sDayOrd, sDatasetName)
{
	var sServiceName = "common_race-service:searchRaceDay";
    var sInDataSet   = "";
    var sOutDataSet  = sDatasetName + "=dsOutSRaceDay ";
    
	fce_AddParam(Trim("STND_YEAR    "), sStndYear);
	fce_AddParam(Trim("TMS          "), sTms     );
	fce_AddParam(Trim("DAY_ORD      "), sDayOrd  );
	
    if ( sMbrCd == null ) sMbrCd = fce_GetUserInfo("MBR_CD");
	fce_AddParam(Trim("MBR_CD"), sMbrCd);
    
    http.sync = true;
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
    http.sync = false;
    
    var dsObj = object(sDatasetName);
    var sRaceDay = "";
    if (dsObj.rowcount() > 0) {
		sRaceDay = dsObj.GetColumn(0, "RACE_DAY");
    }
    return sRaceDay;
}


]]></Script>
</Window>