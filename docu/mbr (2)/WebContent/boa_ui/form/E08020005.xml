<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="E08020005" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="내부심사자료" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsOutIsoBord">
				<Contents>
					<colinfo id="ROW_ID" size="256" type="STRING"/>
					<colinfo id="SEQ_NO" size="256" type="INT"/>
					<colinfo id="GRP_NO" size="256" type="INT"/>
					<colinfo id="GRP_RANK_NO" size="256" type="INT"/>
					<colinfo id="GRP_LOW_NO" size="256" type="INT"/>
					<colinfo id="MAKE_MAN" size="256" type="STRING"/>
					<colinfo id="SBJT" size="256" type="STRING"/>
					<colinfo id="BORD_DESC" size="256" type="STRING"/>
					<colinfo id="SRCH_CNT" size="256" type="INT"/>
					<colinfo id="PROG_STAT" size="256" type="STRING"/>
					<colinfo id="DEL_YN" size="256" type="STRING"/>
					<colinfo id="INST_ID" size="256" type="STRING"/>
					<colinfo id="INST_DTM" size="256" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" type="STRING"/>
					<colinfo id="UPDT_DTM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutIsoBordCount">
				<Contents>
					<colinfo id="TOTCOUNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutPageIsoBord">
				<Contents>
					<colinfo id="TOTCOUNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSelect">
				<Contents>
					<colinfo id="SEL_CD" size="256" type="STRING"/>
					<colinfo id="SEL_NM" size="256" type="STRING"/>
					<record>
						<SEL_CD>SBJT</SEL_CD>
						<SEL_NM>제목</SEL_NM>
					</record>
					<record>
						<SEL_CD>BORD_DESC</SEL_CD>
						<SEL_NM>내용</SEL_NM>
					</record>
					<record>
						<SEL_CD>MAKE_MAN</SEL_CD>
						<SEL_NM>작성자</SEL_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsLog">
				<Contents>
					<colinfo id="MENU_ID" size="256" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutIsoBord" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="574" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="478" Id="grdIsoBord" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" MultiSelect="TRUE" OnCellDBLClick="grdIsoBord_OnCellDblClick" Right="1008" SelColor="user19" Style="snis_grid" TabOrder="2" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1000">
			<contents>
				<format id="Default">
					<columns>
						<col width="28"/>
						<col width="369"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkcolor="user0" button3d="false" col="0" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell bkcolor="user0" button3d="false" col="1" color="user21" display="text" font="굴림,9" text="제목"/>
						<cell bkcolor="user0" button3d="false" col="2" color="user21" display="text" font="굴림,9" text="작성자"/>
						<cell bkcolor="user0" button3d="false" col="3" color="user21" display="text" font="굴림,9" text="등록일"/>
					</head>
					<body>
						<cell align="center" col="0" colid="ROW_ID" display="text"/>
						<cell col="1" colid="SBJT" display="text"/>
						<cell align="center" col="2" colid="MAKE_MAN" display="text"/>
						<cell align="center" col="3" colid="UPDT_DTM" display="date"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Combo Border="Flat" CodeColumn="TOTCOUNT" DataColumn="TOTCOUNT" Height="20" Id="isoPageCombo" ImeMode="none" InnerDataset="dsOutPageIsoBord" Left="888" OnChanged="isoPageCombo_OnChanged" Style="snis_if_input01" TabOrder="3" Top="72" Width="54"></Combo>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="18" TabOrder="6" Top="11" Width="17"></Image>
		<Static Height="22" Id="stFormTitle" Left="40" Style="snis_m_title" TabOrder="5" Top="9" VAlign="Middle" Width="330"></Static>
		<Div Height="20" Id="divBtnLst" Left="672" TabOrder="7" Text="Div0" Top="5" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape1" Left="6" LineColor="user1" Right="1008" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="8" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Static Align="Right" Color="blue" Height="20" Id="stTotCnt" Left="960" Style="snis_txt" TabOrder="11" Top="72" VAlign="Middle" Width="28"></Static>
		<Static Align="Right" Border="None" Height="20" Id="Static15" Left="822" Style="snis_txt" TabOrder="9" Text="페이지&#32;" Top="72" VAlign="Middle" Width="65"></Static>
		<Static Align="Center" Height="20" Id="Static25" Left="956" Style="snis_txt" TabOrder="10" Text="/" Top="72" VAlign="Middle" Width="12"></Static>
		<Combo Border="Flat" CodeColumn="SEL_CD" DataColumn="SEL_NM" Height="20" Id="searchNoticeCombo" INDEX="0" InnerDataset="dsSelect" Left="87" Style="snis_if_input01" TabOrder="1" Top="34" Width="113"></Combo>
		<Edit Border="Flat" CheckLength="Byte" Height="20" Id="edSearchNoticeText" Left="206" MaxLength="40" Style="snis_if_input01" TabOrder="4" Top="35" Width="197"></Edit>
		<Div BKColor="user0" Height="22" Id="divSearch" Left="409" TabOrder="12" Text="Div0" Top="34" Url="common::comButtonSearch.xml" Width="50">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Height="20" Id="Button1" ImageID="btn_pop_txt_03" Left="954" OnClick="Button1_OnClick" Style="snis_btn" TabOrder="13" Text="글쓰기" Top="34" Transparent="TRUE" Width="50"></Button>
		<Image Height="20" Id="Image2" ImageID="m_titleblet" Left="13" TabOrder="14" Top="74" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="Static2" Left="35" Style="snis_m_title" TabOrder="14" Text="세부사항" Top="72" VAlign="Middle" Width="136"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="27" Style="snis_if_lable" TabOrder="15" Text="검색조건" Top="36" VAlign="Middle" Width="56"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::boa_common_script.js";
#include "lib::boa_app_script.js";
#include "lib::boa_isolog_script.js";
/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'E08020005';
var sBUTTONLIST   = 'TTFFFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트
var sPAGENUM      = "20";

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
    sBUTTONLIST   = 'FFFFFT';
	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";
	
	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	fce_insertIsoLog(sFormId,gdsUser.GetColumn(0,"TEAM_CD"));
	//공통코드 조회
	//fce_GetComboDs(dsInComCd);
	// 공지사항 조회
	fcSearch(1);
		
	// 화면 초기화
	//fcInit();

}
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UnLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	if ( !fnc_FormUnloadCheck("" , sFormId) ) return false;
}

function fcInit(){

}

function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	switch(sServiceName){
	
	case "e08020005-service:searchCheckBoardList" :
			fcSetPageCombo();
			break;
    default : break;
    }
	//오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}

function fcSetPageCombo() {
    var pIsoComboIndex   = 0;
   
    if(isoPageCombo.index > -1) pIsoComboIndex = isoPageCombo.index;
    dsOutPageIsoBord.ClearData();
    var nTotalCountIso = ceil(toInteger(dsOutIsoBordCount.getColumn(0, "TOTCOUNT")) / toInteger(sPageNum));
    if(nTotalCountIso <= 0) isoPageCombo.visible = true;
    else {
        for ( var i = 0; i < nTotalCountIso; i++ ) {
            dsOutPageIsoBord.addRow();
            dsOutPageIsoBord.setColumn(i, "TOTCOUNT", toString(i + toInteger(1)));
        } // end for
        
        isoPageCombo.index = pIsoComboIndex;
    }
     stTotCnt.text = nTotalCountIso;
}

function fcSearch(page){

	if(page > 999999) page = 1;
	var sServiceName = "e08020005-service:searchCheckBoardList";
    var sInDataSet   = "";
    var sOutDataSet  = "";
   
	fce_AddParam(Trim("DEL_YN") , "N"   );
	
	fce_AddParam(Trim("ROWNUM1"), page  ); 
    fce_AddParam(Trim("ROWNUM3"), page  ); 
    
	fce_AddParam(Trim("ROWNUM2"), sPAGENUM   ); 
	fce_AddParam(Trim("ROWNUM4"), sPAGENUM   ); 
	
	var searchKey = "";
	
	sOutDataSet  = "dsOutIsoBord=dsOutIsoBord ";
    sOutDataSet += "dsOutIsoBordCount=dsOutIsoBordCount ";
        
        switch ( searchNoticeCombo.index ) {
            case 0 : searchKey = "SBJT";        break;
            case 1 : searchKey = "BORD_DESC";   break;
            case 2 : searchKey = "MAKE_MAN";     break;
        }
        fce_AddParam(searchKey, edSearchNoticeText.text);   
                    
        fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
}
function fcEnd(){
	Close();
}
/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {

}

function fcSearchBtnPress() {
    fcSearch("1");
}

function isoPageCombo_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    fcSearch(obj.value);
}

function grdIsoBord_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	 var seqNo       = "";
	 seqNo   = dsOutIsoBord.getColumn(nRow, "SEQ_NO");
	 if ( fnc_IsNull(seqNo) ) return;
	  // Content로 넘겨지는 arguements

     var sArg    = "Arg_seqNo="  + quote(seqNo);
     if ( Dialog("form::E08020011.xml", sArg, 250, 250, "") ) fcSearch(isoPageCombo.Value);
     
}

function Button1_OnClick(obj)
{
	    // Content로 넘겨지는 arguements
	var sArg  = "";
	
    if ( Dialog("form::E08020011.xml", sArg, 250, 250, "") ) fcSearch(isoPageCombo.Value);
}
]]></Script>
</Window>