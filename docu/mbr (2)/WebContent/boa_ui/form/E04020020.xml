<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="632" Id="E04020020" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="경주결과입력" Top="8" Ver="1.0" Width="1024" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00063</CD_GRP_ID>
						<DESCRIPTION>전법코드</DESCRIPTION>
						<DSNAME>dsOutStrategyCd</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00045</CD_GRP_ID>
						<DESCRIPTION>주회수코드</DESCRIPTION>
						<DSNAME>dsOutCircuitCntCd</DSNAME>
						<QUERY_ID>sort_common_code</QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00034</CD_GRP_ID>
						<DESCRIPTION>장소코드</DESCRIPTION>
						<DSNAME>dsOutAcdntLocCd</DSNAME>
						<QUERY_ID>sort_common_code</QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00048</CD_GRP_ID>
						<DESCRIPTION>조코드</DESCRIPTION>
						<DSNAME>dsOutVoilJoCd</DSNAME>
						<QUERY_ID>sort_common_code</QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00035</CD_GRP_ID>
						<DESCRIPTION>위반코드</DESCRIPTION>
						<DSNAME>dsOutVoilCd</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00062</CD_GRP_ID>
						<DESCRIPTION>사고코드</DESCRIPTION>
						<DSNAME>dsOutAcdntTpeCd</DSNAME>
						<QUERY_ID>sort_common_code</QUERY_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRace">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACE_DGRE_NM" size="256" type="STRING"/>
					<colinfo id="STRT_TIME" size="256" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" type="STRING"/>
					<colinfo id="RACE_WEEK" size="256" type="STRING"/>
					<colinfo id="LAPTIME_1" size="256" type="STRING"/>
					<colinfo id="LAPTIME_2" size="256" type="STRING"/>
					<colinfo id="LAPTIME_3" size="256" type="STRING"/>
					<colinfo id="INTRO_NOTI_YN" size="256" type="STRING"/>
					<colinfo id="RANK_NOTI_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutOrgan">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" type="STRING"/>
					<colinfo id="RANK" size="256" type="STRING"/>
					<colinfo id="RACE_TM" size="256" type="STRING"/>
					<colinfo id="TIME_DIFF" size="256" type="STRING"/>
					<colinfo id="STRATEGY_CD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutStrategyCd">
				<Contents>
					<colinfo id="CD" size="10" type="STRING"/>
					<colinfo id="CD_NM" size="40" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutCircuitCntCd">
				<Contents>
					<colinfo id="CD" size="10" type="STRING"/>
					<colinfo id="CD_NM" size="40" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutAcdntLocCd">
				<Contents>
					<colinfo id="CD" size="10" type="STRING"/>
					<colinfo id="CD_NM" size="40" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutVoilJoCd">
				<Contents>
					<colinfo id="CD" size="10" type="STRING"/>
					<colinfo id="CD_NM" size="40" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutVoilCd">
				<Contents>
					<colinfo id="CD" size="10" type="STRING"/>
					<colinfo id="CD_NM" size="40" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutAcdntTpeCd">
				<Contents>
					<colinfo id="CD" size="10" type="STRING"/>
					<colinfo id="CD_NM" size="40" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="dsOutVoilAct" OnColumnChanged="dsOutVoilAct_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MBR_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CIRCUIT_CNT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACDNT_LOC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="VOIL_JO" size="256" summ="default" type="STRING"/>
					<colinfo id="VOIL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACDNT_TPE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="VOIL_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="SANC_ISSUE_NO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="dsOutAcdntStts" OnColumnChanged="dsOutAcdntStts_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" type="STRING"/>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="RACER_NM" size="256" type="STRING"/>
					<colinfo id="SEQ" size="256" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" type="STRING"/>
					<colinfo id="CIRCUIT_CNT_CD" size="256" type="STRING"/>
					<colinfo id="ACDNT_LOC_CD" size="256" type="STRING"/>
					<colinfo id="ACDNT_ITEM" size="256" type="STRING"/>
					<colinfo id="ACDNT_TPE_CD" size="256" type="STRING"/>
					<colinfo id="ACDNT_DESC" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
					<colinfo id="INST_ID" size="256" type="STRING"/>
					<colinfo id="INST_DTM" size="256" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" type="STRING"/>
					<colinfo id="UPDT_DTM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacerNo">
				<Contents>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="RACER_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsUploadFile">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="FILE_SEQ" size="256" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" type="STRING"/>
					<colinfo id="FILE_URL" size="256" type="STRING"/>
					<colinfo id="FILE_SIZE" size="256" type="STRING"/>
					<colinfo id="INST_ID" size="256" type="STRING"/>
					<colinfo id="INST_DTM" size="256" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" type="STRING"/>
					<colinfo id="UPDT_DTM" size="256" type="STRING"/>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutNextSeqNo">
				<Contents>
					<colinfo id="NEXTSEQNO" size="256" type="INT"/>
					<colinfo id="NEXTFILESEQNO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutOrgan1">
				<Contents>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MBR_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTRY_COURSE" size="256" summ="default" type="STRING"/>
					<colinfo id="STAR_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutOrgan2">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" type="STRING"/>
					<colinfo id="INTRO_RUN_TM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="57" Height="28" Id="Shape0" Left="3" LineColor="user1" Right="1005" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="7" Top="29" Type="RoundRect" Width="1002"></Shape>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="9" Text="조회조건" Top="6" VAlign="Middle" Width="132"></Static>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="10" Top="8" Width="17"></Image>
		<Div Height="20" Id="divBtnLst" Left="678" TabOrder="11" Text="Div0" Top="3" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="stLabel2" Left="677" Style="snis_txt" TabOrder="13" Text="년도" Top="33" VAlign="Middle" Width="28"></Static>
		<Static Align="Right" Height="20" Id="stLable1" Left="85" Style="snis_txt" TabOrder="15" Text="일자" Top="33" VAlign="Middle" Width="32"></Static>
		<Static Height="20" Id="stLabel6" Left="971" Style="snis_txt" TabOrder="17" Text="분" Top="33" VAlign="Middle" Width="26"></Static>
		<Static Align="Right" Height="20" Id="stLabel5" Left="829" Style="snis_txt" TabOrder="19" Text="경주" Top="33" VAlign="Middle" Width="22"></Static>
		<Static Align="Right" Height="20" Id="stLabel4" Left="777" Style="snis_txt" TabOrder="21" Text="일째" Top="33" VAlign="Middle" Width="24"></Static>
		<Static Align="Right" Height="20" Id="stLabel3" Left="727" Style="snis_txt" TabOrder="23" Text="회차" Top="33" VAlign="Middle" Width="24"></Static>
		<Shape BKColor="#ff8500" Bottom="70" Height="6" Id="Shape2" Left="12" LineKind="Vertical" LineWidth="0" Right="18" RoundHeight="10" RoundWidth="10" TabOrder="26" Top="64" Type="Ellipse" Width="6"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutRace" BKColor="user15" BkColor2="user16" BkSelColor="user15" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="120" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="20" Height="40" Id="grdRace" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" OnEnterDown="grdRace_OnEnterDown" Right="478" RowHeight="20" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="80" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="474">
			<contents>
				<format id="Default">
					<columns>
						<col width="80"/>
						<col width="70"/>
						<col width="80"/>
						<col width="70"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="주회수"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="1"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="2"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="3"/>
					</head>
					<body>
						<cell align="center" bkcolor="user20" celltype="head" col="0" color="user21" display="text" text="랩시간"/>
						<cell align="center" col="1" colid="LAPTIME_1" display="text" edit="mask" limit="6" Mask="9.99.999"/>
						<cell align="center" col="2" colid="LAPTIME_2" display="text" edit="mask" limit="6" Mask="9.99.999"/>
						<cell align="center" col="3" colid="LAPTIME_3" display="text" edit="mask" limit="6" Mask="9.99.999"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="20" Id="Static32" Left="24" Style="snis_m_stitle" TabOrder="25" Text="랩시간&#32;등록" Top="58" VAlign="Middle" Width="92"></Static>
		<Static Height="20" Id="Static16" Left="512" Style="snis_m_stitle" TabOrder="27" Text="판정사진등록" Top="58" VAlign="Middle" Width="92"></Static>
		<Shape BKColor="#ff8500" Bottom="70" Height="6" Id="Shape1" Left="500" LineKind="Vertical" LineWidth="0" Right="506" RoundHeight="10" RoundWidth="10" TabOrder="28" Top="64" Type="Ellipse" Width="6"></Shape>
		<Static Height="20" Id="Static20" Left="20" Style="snis_m_stitle" TabOrder="29" Text="착순결과등록" Top="120" VAlign="Middle" Width="92"></Static>
		<Shape BKColor="#ff8500" Bottom="132" Height="6" Id="Shape4" Left="8" LineKind="Vertical" LineWidth="0" Right="14" RoundHeight="10" RoundWidth="10" TabOrder="30" Top="126" Type="Ellipse" Width="6"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="dsOutOrgan" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="294" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="155" Id="grdOrgan" InputPanel="FALSE" Left="4" LineColor="user18" OnEnterDown="grdOrgan_OnEnterDown" OnEnterEdit="grdOrgan_OnEnterEdit" Right="472" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="139" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="468">
			<contents>
				<format id="Default">
					<columns>
						<col width="50"/>
						<col width="50"/>
						<col width="80"/>
						<col width="100"/>
						<col width="188"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="순위"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="정번"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="경주시간"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="시간차"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="전법"/>
					</head>
					<body>
						<cell align="center" col="0" colid="RANK" display="number" edit="integer" expr='DECODE(RANK,0,&quot;&quot;,RANK)' limit="1"/>
						<cell align="center" col="1" colid="RACE_REG_NO" display="number" edit="integer" limit="1"/>
						<cell align="center" col="2" colid="RACE_TM" display="text" edit="mask" limit="6" Mask="#.##.###"/>
						<cell align="center" col="3" colid="TIME_DIFF" display="text" expr='DECODE(RANK,1,&quot;0.00.000&quot;,TIME_DIFF)' limit="6" Mask="#.##.###"/>
						<cell align="center" col="4" colid="STRATEGY_CD" combocol="CD" combodataset="dsOutStrategyCd" combotext="CD_NM" display="combo" edit="combo"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutVoilAct" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="472" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="152" Id="grdVoilAct" InputPanel="FALSE" Left="4" LineColor="user18" OnEnterDown="grdVoilAct_OnEnterDown" OnMouseOver="grdVoilAct_OnMouseOver" Right="1016" RowHeight="30" SelColor="user19" Style="snis_grid" TabOrder="5" TabStop="true" Top="320" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1012">
			<contents>
				<format id="Default">
					<columns>
						<col width="23"/>
						<col width="29"/>
						<col width="51"/>
						<col width="46"/>
						<col width="43"/>
						<col width="61"/>
						<col width="103"/>
						<col width="80"/>
						<col width="217"/>
						<col width="194"/>
						<col width="70"/>
						<col width="76"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="선택"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="정번"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="등록번호"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="선수명"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="주회수"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="장소"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="조"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="위반판정"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="내용"/>
						<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" text="상세내용(홈페이지)"/>
						<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" text="사고종류"/>
						<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9" text="심판제재번호"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="RACE_REG_NO" display="text" edit="number" limit="1"/>
						<cell align="center" col="2" colid="RACER_NO" display="text"/>
						<cell align="center" col="3" colid="RACER_NM" display="text"/>
						<cell align="center" col="4" colid="CIRCUIT_CNT_CD" combocol="CD" combodataset="dsOutCircuitCntCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="5" colid="ACDNT_LOC_CD" combocol="CD" combodataset="dsOutAcdntLocCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="6" colid="VOIL_JO" combocol="CD" combodataset="dsOutVoilJoCd" combotext="CD_NM" display="combo" edit="combo" limit="3"/>
						<cell align="center" col="7" colid="VOIL_CD" combocol="CD" combodataset="dsOutVoilCd" combodisplayrowcnt="10" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="left" col="8" colid="VOIL_DESC" display="text" edit="normal" limit="200" wordwrap="word"/>
						<cell align="left" col="9" colid="RMK" display="text" edit="normal" limit="4000" scrollbar="vert" wordwrap="word"/>
						<cell align="center" col="10" colid="ACDNT_TPE_CD" combocol="CD" combodataset="dsOutAcdntTpeCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="11" colid="SANC_ISSUE_NO" display="text" edit="normal" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="20" Id="Static17" Left="13" Style="snis_m_stitle" TabOrder="31" Text="위반행위/사고행위&#32;등록" Top="296" VAlign="Middle" Width="143"></Static>
		<Shape BKColor="#ff8500" Bottom="306" Height="6" Id="Shape5" Left="4" LineKind="Vertical" LineWidth="0" Right="10" RoundHeight="10" RoundWidth="10" TabOrder="32" Top="300" Type="Ellipse" Width="6"></Shape>
		<Div Height="20" Id="voilActBtnRow" Left="916" TabOrder="33" Text="Div0" Top="294" Url="common::comButtonRow.xml" Width="88">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutAcdntStts" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="587" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="112" Id="grdAcdntStts" InputPanel="FALSE" Left="4" LineColor="user18" OnMouseOver="grdAcdntStts_OnMouseOver" Right="1016" RowHeight="30" SelColor="user19" Style="snis_grid" TabOrder="6" TabStop="true" Top="475" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1012">
			<contents>
				<format id="Default">
					<columns>
						<col width="28"/>
						<col width="48"/>
						<col width="39"/>
						<col width="58"/>
						<col width="58"/>
						<col width="96"/>
						<col width="93"/>
						<col width="300"/>
						<col width="263"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="정번"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="등록번호"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="선수명"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="주회수"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="장소"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="조"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="사고종류"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="내용"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="상세내용(홈페이지)"/>
					</head>
					<body>
						<cell align="center" col="0" colid="RACE_REG_NO" display="text" edit="number" limit="1"/>
						<cell align="center" col="1" colid="RACER_NO" display="text"/>
						<cell align="center" col="2" colid="RACER_NM" display="text"/>
						<cell align="center" col="3" colid="CIRCUIT_CNT_CD" combocol="CD" combodataset="dsOutCircuitCntCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="4" colid="ACDNT_LOC_CD" combocol="CD" combodataset="dsOutAcdntLocCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="5" colid="ACDNT_ITEM" combocol="CD" combodataset="dsOutVoilJoCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="6" colid="ACDNT_TPE_CD" combocol="CD" combodataset="dsOutAcdntTpeCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="left" col="7" colid="ACDNT_DESC" display="text" edit="normal" limit="200" wordwrap="word"/>
						<cell align="left" col="8" colid="RMK" display="text" edit="normal" limit="4000" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" BindDataset="dsOutRace" Column="MBR_CD" Height="20" Id="stndMbrCd" Left="120" Style="snis_txt" TabOrder="35" Text="001" Top="-1" VAlign="Middle" Visible="FALSE" Width="40"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutRacerNo" BKColor="user15" BkColor2="user16" BkSelColor="user15" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="16" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="20" Height="16" Id="grdRaceNo" InputPanel="FALSE" Left="240" LineColor="user18" MinWidth="100" Right="456" RowHeight="20" SelColor="user19" Style="snis_grid" TabOrder="36" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="216">
			<contents>
				<format id="Default">
					<columns>
						<col width="70"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="1"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="2"/>
					</head>
					<body>
						<cell col="0" colid="RACER_NO" display="text" edit="normal" limit="6" LimitDec="0"/>
						<cell col="1" colid="RACER_NM" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="stRowNo" Left="168" Style="snis_txt" TabOrder="37" Text="1" VAlign="Middle" Visible="FALSE" Width="24"></Static>
		<Div Height="20" Id="divBtnRow" Left="932" TabOrder="38" Text="Div0" Top="57" Url="common::comButtonRow.xml" Width="88">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="stGubun" Left="208" Style="snis_txt" TabOrder="39" Text="1" VAlign="Middle" Visible="FALSE" Width="32"></Static>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsUploadFile" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="135" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="20" Height="58" Id="grdViewFile" InputPanel="FALSE" Left="488" LineColor="user18" MinWidth="100" OnCellDBLClick="btnDownFile_OnClick" Right="1008" SelColor="user19" Style="snis_grid" TabOrder="40" TabStop="true" Top="77" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="520">
			<contents>
				<format id="Default">
					<columns>
						<col width="57"/>
						<col width="374"/>
						<col width="201"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="파일"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="진행상태"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell col="1" colid="FILE_NAME" display="text"/>
						<cell align="left" col="2" colid="prog_bar" color="red" display="bar"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsUploadFile" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="135" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="20" Height="58" Id="grdUploadFile" InputPanel="FALSE" Left="487" LineColor="user18" MinWidth="100" Right="1007" SelColor="user19" Style="snis_grid" TabOrder="8" TabStop="true" Top="77" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="520">
			<contents>
				<format id="Default">
					<columns>
						<col width="57"/>
						<col width="802"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="파일"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell col="1" colid="FILE_URL" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<FileDialog Bottom="24" Height="24" Id="fdSaveAs" Left="104" Right="128" TabOrder="41" Width="24"></FileDialog>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="dsOutOrgan1" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="294" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="155" Id="grdOrgan1" InputPanel="FALSE" Left="486" LineColor="user18" OnEnterDown="grdOrgan1_OnEnterDown" OnEnterEdit="grdOrgan1_OnEnterEdit" Right="883" SelColor="user19" Style="snis_grid" TabOrder="4" TabStop="true" Top="139" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="397">
			<contents>
				<format id="Default">
					<columns>
						<col width="80"/>
						<col width="50"/>
						<col width="101"/>
						<col width="162"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="진입코스"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="정번"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="스타트타임"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" colid="ENTRY_COURSE" display="number" edit="integer" expr='DECODE(ENTRY_COURSE,0,&quot;&quot;,ENTRY_COURSE)' limit="1"/>
						<cell align="center" col="1" colid="RACE_REG_NO" display="number" edit="integer" limit="1"/>
						<cell align="center" col="2" colid="STAR_TM" display="text" edit="mask" limit="1" LimitDec="2" Mask="##.##"/>
						<cell align="center" col="3" colid="RMK" display="text" edit="normal" limit="4000"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="dsOutOrgan2" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="294" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="155" Id="grdOrgan2" InputPanel="FALSE" Left="884" LineColor="user18" OnEnterDown="grdOrgan2_OnEnterDown" OnEnterEdit="grdOrgan2_OnEnterEdit" Right="1012" SelColor="user19" Style="snis_grid" TabOrder="2" TabStop="true" Top="139" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="128">
			<contents>
				<format id="Default">
					<columns>
						<col width="50"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="정번"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="소개항주"/>
						<cell bkcolor="user20" col="1" color="user24" display="text" font="굴림,9" row="1" text="TIME"/>
					</head>
					<body>
						<cell align="center" col="0" colid="RACE_REG_NO" display="number" edit="integer" limit="1"/>
						<cell align="center" col="1" colid="INTRO_RUN_TM" display="text" edit="mask" limit="1" LimitDec="2" Mask="#.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Height="20" Id="btnIntro" ImageID="btn_pop_txt_11" Left="400" OnClick="btnIntro_OnClick" Style="snis_btn" TabOrder="41" Text="소개항주&#32;홈페이지&#32;공지" Top="5" Transparent="TRUE" Width="150"></Button>
		<Button ButtonStyle="TRUE" Height="20" Id="btnRank" ImageID="btn_pop_txt_08" Left="552" OnClick="btnRank_OnClick" Style="snis_btn" TabOrder="42" Text="순위&#32;홈페이지&#32;공지" Top="5" Transparent="TRUE" Width="110"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Height="20" Id="btnSearch" ImageID="btn_txt_02" Left="347" LeftMargin="15" OnClick="btnSearchOnClick" Style="snis_btn" TabOrder="43" Text="조회" Top="5" Transparent="TRUE" Width="50"></Button>
		<Static Align="Right" BindDataset="dsOutRace" Column="RACE_DAY" Height="20" Id="stRaceDay" Left="3" Style="snis_txt" TabOrder="14" Text="99" Top="33" VAlign="Middle" Width="84"></Static>
		<Static Align="Right" BindDataset="dsOutRace" Column="RACE_WEEK" Height="20" Id="stRaceWeek" Left="125" Style="snis_txt" TabOrder="16" Text="요일" Top="33" VAlign="Middle" Width="48"></Static>
		<Static Font="굴림,9" Height="20" Id="Static1" Left="201" Style="snis_txt" TabOrder="45" Text="소개항주공지여부&#32;:&#32;" Top="32" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" BindDataset="dsOutRace" Color="red" Column="INTRO_NOTI_YN" Font="굴림,9,Bold" Height="20" Id="Static0" Left="325" Style="snis_txt" TabOrder="44" Text="공지" Top="32" VAlign="Middle" Width="40"></Static>
		<Static Font="굴림,9" Height="20" Id="Static2" Left="401" Style="snis_txt" TabOrder="47" Text="홈페이지&#32;순위&#32;공지여부&#32;:&#32;" Top="32" VAlign="Middle" Width="152"></Static>
		<Static Align="Right" BindDataset="dsOutRace" Color="red" Column="RANK_NOTI_YN" Font="굴림,9,Bold" Height="20" Id="Static3" Left="557" Style="snis_txt" TabOrder="46" Text="공지" Top="32" VAlign="Middle" Width="40"></Static>
		<Static Align="Right" BindDataset="dsOutRace" Column="STND_YEAR" Height="20" Id="stStndYear" Left="638" Style="snis_txt" TabOrder="12" Text="9999" Top="33" VAlign="Middle" Width="40"></Static>
		<Static Align="Right" BindDataset="dsOutRace" Column="TMS" Height="20" Id="stTms" Left="701" Style="snis_txt" TabOrder="24" Text="99" Top="33" VAlign="Middle" Width="24"></Static>
		<Static Align="Right" BindDataset="dsOutRace" Column="DAY_ORD" Height="20" Id="stDayOrd" Left="753" Style="snis_txt" TabOrder="22" Text="9" Top="33" VAlign="Middle" Width="20"></Static>
		<Static Align="Right" BindDataset="dsOutRace" Column="RACE_NO" Height="20" Id="stRaceNo" Left="801" Style="snis_txt" TabOrder="20" Text="01" Top="33" VAlign="Middle" Width="24"></Static>
		<Static BindDataset="dsOutRace" Column="STRT_TIME" Height="20" Id="stStrtTime" Left="933" Style="snis_txt" TabOrder="34" Text="12:10" Top="33" VAlign="Middle" Width="32"></Static>
		<Static Align="Right" Column="RACE_DGRE_NM" Height="20" Id="stRaceDgreNm" Left="855" Style="snis_txt" TabOrder="18" Text="일반경주" Top="33" VAlign="Middle" Width="56"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::boa_common_script.js";
#include "lib::boa_app_script.js";
/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
/*
clear,저장,삭제,엑셀,인쇄,닫기
*/
var sFormId       = 'E04020020';
var sBUTTONLIST   = 'FTFFFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트
var oLastDs       = null;
var oLastDsRow    = 0;

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {

	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정

   if(Arg_bEnableTF == "F"){
	   btnIntro.Visible       = false;
	   btnRank.Visible       = false;
//	   sBUTTONLIST   = 'FFFFFT'; //clear,저장,삭제,엑셀,인쇄,닫기
	   fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
   } else {
	   fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
   }	
	//초기 화면 BK Color설정 
	fnc_SetBKColor(this);
    
    fcInit();
    
	//공통코드 조회
	fce_GetComboDs(dsInComCd);
	
	http.sync= false; 
	// 화면 초기화
	
	 
}
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	if ( !fnc_FormUnloadCheck("dsOutRace|dsOutOrgan|dsOutVoilAct|dsOutAcdntStts|dsUploadFile" ,sFormId) ) return false;
}

/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}
	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
   
   
   
   dsOutRace.ClearData();
   dsOutOrgan.ClearData();
   dsOutOrgan1.ClearData();
   dsOutOrgan2.ClearData();
   dsOutVoilAct.ClearData();
   dsOutAcdntStts.ClearData();
   dsUploadFile.ClearData();

}
/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {

	fcInit(obj);
	
	return true;
}

function fcSearch(cboSStndYear,cboSMbr,cboSRaceTms,cboSDayOrd,cboSRaceNo) {
   //경주결과조회(랩시간)
	var sServiceName = "e04020020-service:searchRace";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRace=dsOutRace";
    dsOutRace.ClearData();
   
    fce_AddParam(Trim("STND_YEAR"), cboSStndYear	);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr    		);
	fce_AddParam(Trim("TMS      "), cboSRaceTms 	);
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd  	);
    fce_AddParam(Trim("RACE_NO  "), cboSRaceNo  	);
  
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false); 
    
    
    //경주결과조회(순위)
    var sServiceName = "e04020020-service:searchOrgan";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutOrgan=dsOutOrgan";
    dsOutOrgan.ClearData();
    
    fce_AddParam(Trim("STND_YEAR"), cboSStndYear	);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr    		);
	fce_AddParam(Trim("TMS      "), cboSRaceTms 	);
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd  	);
    fce_AddParam(Trim("RACE_NO  "), cboSRaceNo  	);
    
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
    
    //경주결과조회(진입코스)
    var sServiceName = "e04020020-service:searchOrgan1";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutOrgan1=dsOutOrgan1";
    dsOutOrgan1.ClearData();
    
    fce_AddParam(Trim("STND_YEAR"), cboSStndYear	);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr    		);
	fce_AddParam(Trim("TMS      "), cboSRaceTms 	);
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd  	);
    fce_AddParam(Trim("RACE_NO  "), cboSRaceNo  	);
    
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
    
    //경주결과조회(소개항주)
    var sServiceName = "e04020020-service:searchOrgan2";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutOrgan2=dsOutOrgan2";
    dsOutOrgan2.ClearData();
    
    fce_AddParam(Trim("STND_YEAR"), cboSStndYear	);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr    		);
	fce_AddParam(Trim("TMS      "), cboSRaceTms 	);
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd  	);
    fce_AddParam(Trim("RACE_NO  "), cboSRaceNo  	);
    
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
    
    
    //경주결과조회 (위반사항)
    var sServiceName = "e04020020-service:searchVoilAct";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutVoilAct=dsOutVoilAct";
    dsOutOrgan.ClearData();
    
    fce_AddParam(Trim("STND_YEAR"), cboSStndYear	);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr    		);
	fce_AddParam(Trim("TMS      "), cboSRaceTms 	);
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd  	);
    fce_AddParam(Trim("RACE_NO  "), cboSRaceNo  	);
    
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
    
    
    //경주결과조회 (사고사항)
    var sServiceName = "e04020020-service:searchAcdntStts";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutAcdntStts=dsOutAcdntStts";
    dsOutOrgan.ClearData();
    
    fce_AddParam(Trim("STND_YEAR"), cboSStndYear	);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr    		);
	fce_AddParam(Trim("TMS      "), cboSRaceTms 	);
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd  	);
    fce_AddParam(Trim("RACE_NO  "), cboSRaceNo  	);
    
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
    
    //경주결과조회 (첨부파일조회)
    var sServiceName = "e04020020-service:searchFile";
    var sInDataSet   = "";
    var sOutDataSet  = "dsUploadFile=dsUploadFile";
    dsUploadFile.ClearData();
    
    fce_AddParam(Trim("STND_YEAR"), cboSStndYear	);
	fce_AddParam(Trim("MBR_CD   "), cboSMbr    		);
	fce_AddParam(Trim("TMS      "), cboSRaceTms 	);
	fce_AddParam(Trim("DAY_ORD  "), cboSDayOrd  	);
    fce_AddParam(Trim("RACE_NO  "), cboSRaceNo  	);
   
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
}
/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {
   
   //변경된 자료가 있는지 체크
	if ( !fnc_DatasetChangeCheck(dsOutRace) 
	    && !fnc_DatasetChangeCheck(dsUploadFile)
	    && !fnc_DatasetChangeCheck(dsOutOrgan)
	    && !fnc_DatasetChangeCheck(dsOutOrgan1)
	    && !fnc_DatasetChangeCheck(dsOutOrgan2)
	    && !fnc_DatasetChangeCheck(dsOutVoilAct)) {
        //저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");	
		return false;
	}
	
	
	
	// 필수항목체크
	//oDataSet          = dsOutRace;
	//sMandatoryColID   = "LAPTIME_1|LAPTIME_2|LAPTIME_3";
	//sMandatoryColName = "랩시간1|랩시간2|랩시간3";
	//oGrid             = grdRace;
	//if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	//    return false;
	//}
	
	// 필수항목체크(순위)
	oDataSet          = dsOutOrgan;
	sMandatoryColID   = "RACE_REG_NO";
	sMandatoryColName = "정번";
	oGrid             = grdOrgan;
	if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	    return false;
	}
	// 경주시간체크(순위)
	if ( !fnc_IsTimeCheck() ) {
	    fnc_Message(SNIS_COM_1034, "N", "경주시간"); 
		return false;
	}
	
    // 필수항목체크(진입코스)
	oDataSet          = dsOutOrgan1;
	sMandatoryColID   = "RACE_REG_NO";
	sMandatoryColName = "정번";
	oGrid             = grdOrgan1;
	if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	    return false;
	}
    // 필수항목체크(소개항주)
	oDataSet          = dsOutOrgan2;
	sMandatoryColID   = "RACE_REG_NO";
	sMandatoryColName = "정번";
	oGrid             = grdOrgan2;
	if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	    return false;
	}
    // 필수항목체크
	oDataSet          = dsOutVoilAct;
	sMandatoryColID   = "RACE_REG_NO|RACER_NO|RACER_NM|CIRCUIT_CNT_CD|ACDNT_LOC_CD|VOIL_JO|VOIL_CD|VOIL_DESC";
	sMandatoryColName = "정번|등록번호|선수명|주회수| 장소|조|위반판정|내용";
	oGrid             = grdVoilAct;
	if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	    return false;
	}
	
	var raceDay = SubStr(dsOutRace.getColumn(0, "RACE_DAY"), 0, 4 ) + SubStr(dsOutRace.getColumn(0, "RACE_DAY"), 5, 2 )  + SubStr(dsOutRace.getColumn(0, "RACE_DAY"), 8, 2 )  ;
	
	//위반행위
	if( dsOutVoilAct.GetRowCount() > 0 ) {
		for ( i = 0; i < dsOutVoilAct.GetRowCount(); i++ ) {         
			dsOutVoilAct.SetColumn(i, "STND_YEAR", stStndYear.text	); 
			dsOutVoilAct.SetColumn(i, "MBR_CD"   , stndMbrCd.text 	); 
			dsOutVoilAct.SetColumn(i, "TMS"      , stTms.text 	 	); 
			dsOutVoilAct.SetColumn(i, "DAY_ORD"  , stDayOrd.text 	); 
			dsOutVoilAct.SetColumn(i, "RACE_NO"  , stRaceNo.text 	); 
			dsOutVoilAct.SetColumn(i, "RACE_DAY"  , raceDay			);  
		} 
	} 	
	
	// 발매시스템의 착순순위와 비교
	Trace(dsRsltCnt.savexml());
	var sRank  = "";
	var sRegNo = "";
	var sRaceRegNo = "";
	var ifindRow = -1;
	for (var nRow=0;nRow<dsOutOrgan.RowCount();nRow++) {
		sRank = dsOutOrgan.GetColumn(nRow, "RANK");
		if (toNumber(sRank) < 4) {
			sRaceRegNo = dsOutOrgan.GetColumn(nRow, "RACE_REG_NO");
			ifindRow = dsRsltCnt.searchRow("RANK='"+sRank+"'");
			if (ifindRow >= 0) {
				sRegNo = dsRsltCnt.GetColumn(ifindrow, "REG_NO");
				if (sRaceRegNo != sRegNo) {
					if (fnc_message("착순순위를 확인하세요!!\n발매시스템에는 "+sRank+"순위는 "+sRegNo+"번으로 되어 있습니다.\n무시하고 등록하시겠습니다.?", "Y") == false) {
						return false;
					}
				}
			}
		}		
	}
	
	return true;
}

function fcSave(obj) {
	
	if ( !fcSaveCheck() ) return;
	
	var ServiceName = "e04020020-service:saveOrgan";
    var sInDataSet   = "dsOutRace=dsOutRace:u dsOutOrgan=dsOutOrgan:u dsOutOrgan1=dsOutOrgan1:u dsOutOrgan2=dsOutOrgan2:u  dsOutVoilAct=dsOutVoilAct:u dsUploadFile=dsUploadFile:u " ;
    var sOutDataSet  = "dsOutRace=dsOutRace   dsOutOrgan=dsOutOrgan   dsOutOrgan1=dsOutOrgan1   dsOutOrgan2=dsOutOrgan2    dsOutVoilAct=dsOutVoilAct   dsUploadFile=dsUploadFile" ;
    
    if( dsUploadFile.GetRowCount() > 0 ) {
        for ( i = 0; i < dsUploadFile.GetRowCount(); i++ ) {
            if(dsUploadFile.getColumn(i, "CHK") == "1" ) {
                var rtn_arr = fnc_FileWrite(  divBtnLst.HttpFile 
                                            , dsUploadFile.GetColumn(i, "FILE_URL" )
                                            , dsUploadFile.GetColumn(i, "FILE_NAME") 
                                            , "REFEREE");
                
                var fileSize = divBtnLst.HttpFile.GetFileSizeLocal(dsUploadFile.GetColumn(i, "FILE_URL" ));
                
                if ( rtn_arr[0] != "SUCC" ) {
                    alert("파일 업로드 에러발생");
                    return false;
                }
                dsUploadFile.SetColumn(i, "STND_YEAR"   , stStndYear.text );          
                dsUploadFile.SetColumn(i, "MBR_CD"      , stndMbrCd.text );
                dsUploadFile.SetColumn(i, "TMS"      	, stTms.text ); 
                dsUploadFile.SetColumn(i, "DAY_ORD"     , stDayOrd.text  );
                dsUploadFile.SetColumn(i, "RACE_NO"     , stRaceNo.text  ); 
                dsUploadFile.SetColumn(i, "FILE_SEQ"    , toInteger(dsOutNextSeqNo.getColumn(0,"NEXTFILESEQNO")) + toInteger(i) );
                dsUploadFile.SetColumn(i, "FILE_URL"    , rtn_arr[1] );
                dsUploadFile.SetColumn(i, "FILE_SIZE"   , fileSize );
            } // end if
        } // end for   
    } // end if
    
    fce_SendTransaction(ServiceName, sInDataSet, sOutDataSet, "fcCallBack");  
}

/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
	
}

/*-------------------------------------------------------------------------------------------------+
>>  인쇄 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcPrint(obj) {
}
/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close(true);	
}

function fcAddRow(obj) {
	switch ( obj.GetForm().id ) {
		case "voilActBtnRow" :			
            dsOutVoilAct.addRow();
            break;
		case "divBtnRow" :
            sResponse = fce_GetSelectFile();	
            row = dsUploadFile.addRow();
        
            if ( !fnc_IsNull(sResponse) ) {
                dsUploadFile.SetColumn(row, "CHK"       , "1"         );
                dsUploadFile.SetColumn(row, "FILE_URL"  , sResponse[0] + "\\" + sResponse[1]);
                dsUploadFile.SetColumn(row, "FILE_NAME" , sResponse[1]);
            }	
            
            if ( dsUploadFile.getColumn(row, "CHK") != "1") {
                dsUploadFile.rowcount = dsUploadFile.DeleteRow(row);
            }
            break;	 
			 
    } // end switch.case
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj) {
	switch ( obj.GetForm().id ) {
		case "voilActBtnRow" :
          	if ( !fnc_DeleteCheck(dsOutVoilAct, "chk", "1") ) return;
          	break;
		case "divBtnRow" :
			if ( !fnc_DeleteCheck(dsUploadFile, "chk", "1") ) return;
			
			var splitArr    = (dsUploadFile.getColumn(dsUploadFile.currow, "FILE_URL")).split("\\");
            var lenSplitArr = toInteger(length(splitArr)) - toInteger(1);
            //파일삭제
            if( dsUploadFile.GetRowCount() > 0 ) {
				for ( i = 0; i < dsUploadFile.GetRowCount(); i++ ) {         
						if(dsUploadFile.getColumn(i, "CHK") == 1) {
							dsUploadFile.deleteRow(i);
						} 
				} 
			 }   
			fnc_FileDelete(splitArr[lenSplitArr]);
			break;
	 } // end switch.case
}
//**************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
	fnc_EditFocus(obj);
}
*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	fnc_GridSort(obj, object(obj.BindDataset), nCell);	
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {

}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex){
	
}
/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
    
    // 공통코드 조회시
	if ( sServiceName == "common-service:searchCode" ) {
	    dsOutStrategyCd.InsertRow(0); //전법코드 빈로우 생성
	    dsOutAcdntTpeCd.InsertRow(0); //사고종류 빈로우 생성
	    //이전화면에서 받은 인자값으로 조회
	    trace(Arg_cboSRaceNo);
	     fcSearch(Arg_cboSStndYear,Arg_cboSMbr,Arg_cboSRaceTms,Arg_cboSDayOrd,Arg_cboSRaceNo);
    }
    
    
	if ( !fnc_Result(ErrorCode, ErrorMSG) ) return;
	//경주결과조회(랩시간)파일조회 완료후
	if ( sServiceName == "e04020020-service:searchRace" ) {
        stRaceDay.Text = dsOutRace.GetColumn(0, "RACE_DAY");
    }  
    //경주결과조회(순위)파일조회 완료후
	if ( sServiceName == "e04020020-service:searchOrgan" ) {
        setLocation();
    }
    //경주결과조회(진입코스)파일조회 완료후
	if ( sServiceName == "e04020020-service:searchOrgan1" ) {
        
    }
    //경주결과조회(소개항주)파일조회 완료후
	if ( sServiceName == "e04020020-service:searchOrgan2" ) {
        
    }
    
    //경주결과조회(위반사항)파일조회 완료후
	if ( sServiceName == "e04020020-service:searchVoilAct" ) {
        dsOutVoilAct.AddColumn("chk");  
    } 
     //경주결과조회(사고사항)파일조회 완료후
	if ( sServiceName == "e04020020-service:searchAcdntStts" ) {
        
    }  
	 // 경주결과조회(첨부파일)파일조회 완료후
    if ( sServiceName == "e04020020-service:searchFile" ) {
        
        grdUploadFile.visible   =   false;
        grdViewFile.visible     =   true;
        
        dsUploadFile.AddColumn("PROG_BAR");
          
    }   
	
	// 위반행위 row가 변경후
	if ( sServiceName == "e04020020-service:searchRacerNo" ) {
		if ( Trim(stGubun.text) == "dsOutVoilAct") {
			dsOutVoilAct.SetColumn(stRowNo.text, "RACER_NO"      , dsOutRacerNo.getColumn(0, "RACER_NO") ); 
			dsOutVoilAct.SetColumn(stRowNo.text, "RACER_NM"      , dsOutRacerNo.getColumn(0, "RACER_NM") );  
		} 
		
	}
	// 저장 후
	if ( sServiceName == "e04020020-service:saveOrgan" ) {
        //조회루틴 호출
        fcSearch(stStndYear.text,stndMbrCd.text, stTms.text,stDayOrd.text,stRaceNo.text);
		return;
	}
	// 소개항주공지후
	if ( sServiceName == "e04020020-service:saveIntro" ) {
        //조회루틴 호출
        fcSearch(stStndYear.text,stndMbrCd.text, stTms.text,stDayOrd.text,stRaceNo.text);
		return;
	}
	
	// 홈페이지순위공지후
	if ( sServiceName == "e04020020-service:saveRank" ) {
        //조회루틴 호출
        fcSearch(stStndYear.text,stndMbrCd.text, stTms.text,stDayOrd.text,stRaceNo.text);
		return;
	}
	//오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {

}

/*-------------------------------------------------------------------------------------------------+
>>  코드나 명 입력 후 Lost Focus 시 해당 정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcCodeNameDisplay(obj) {

}

/*-------------------------------------------------------------------------------------------------+
>>  위반행위 정번 row가 변경으로 인한 조회
+-------------------------------------------------------------------------------------------------*/
function dsOutVoilAct_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	 
	if ( Trim(strColumnID) == "RACE_REG_NO") { 
		 stRowNo.text = ToString(nRow);
		 stGubun.text = ToString("dsOutVoilAct");
		 var raceRegNo = dsOutVoilAct.getColumn(nRow, "RACE_REG_NO");
		 if(raceRegNo == "" || raceRegNo == null) return ;
	
		
		var sServiceName = "e04020020-service:searchRacerNo";
		var sInDataSet   = "";
		var sOutDataSet  = "dsOutRacerNo=dsOutRacerNo";
		dsOutRacerNo.ClearData();
		
		fce_AddParam(Trim("STND_YEAR"), stStndYear.text	);
		fce_AddParam(Trim("MBR_CD   "), stndMbrCd.text  );
		fce_AddParam(Trim("TMS      "), stTms.text 		);
		fce_AddParam(Trim("DAY_ORD  "), stDayOrd.text  	);
		fce_AddParam(Trim("RACE_NO  "), stRaceNo.text  	);
		fce_AddParam(Trim("RACE_REG_NO  "), raceRegNo  	);
		
		fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
   }
    
}


/*-------------------------------------------------------------------------------------------------+
>>  첨부파일내려받기
+-------------------------------------------------------------------------------------------------*/


function btnDownFile_OnClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
    var sLocalFileName  = fce_GetSelectFile("Save", dsUploadFile.GetColumn(nRow, "FILE_NAME"));
    var sServerFileName = dsUploadFile.GetColumn(nRow, "FILE_URL");
    var sFileSize       = dsUploadFile.GetColumn(nRow, "FILE_SIZE");
    if ( sLocalFileName == null ) return;
    
    fnc_DatasetPrint(dsUploadFile);
    dsUploadFile.AddColumn("PROG_BAR");
	fnc_FileRead(divBtnLst.HttpFile, sLocalFileName[0] + "\\" + sLocalFileName[1], sServerFileName, sFileSize, nRow, "PROG_BAR", dsUploadFile);
	setReg("LastDir", sLocalFileName[0]); //현재 저장폴더 레지스트리에 저장하기
/*
	fdSaveAs.Type = "SAVE";
    fdSaveAs.FileName = dsUploadFile.getColumn(dsUploadFile.currow, "FILE_NAME");
	//마지막 저장 폴더 가져오기
	fdSaveAs.FilePath = getReg("LastDir"); // HKEY_CURRENT_USER\Software\ToBeSoft\MiPlatform310\KTO_MP\LastDir
	
	var splitArr    = (dsUploadFile.getColumn(dsUploadFile.currow, "FILE_URL")).split("\\");
	var fileOpen = fdSaveAs.Open();
	var rtn_arr = Array(3);
	var lenSplitArr = toInteger(length(splitArr)) - toInteger(1);
	
	if (fileOpen == 1)
	{
		ret = fnc_FileReadAndProgress (
                      divBtnLst.HttpFile
                    , fdSaveAs.FilePath + "\\"  + fdSaveAs.FileName
                    , splitArr[lenSplitArr]
                    , dsUploadFile.getColumn(dsUploadFile.currow, "FILE_SIZE")
                    , dsUploadFile.currow
                    , "PROG_BAR"
                    , grdViewFile) ;
	} else {
		return;
	}
	
	setReg("LastDir", fdSaveAS.FilePath); //현재 저장폴더 레지스트리에 저장하기
*/	
}
/****************************************************************************************************
* <p> 사용자가 선택한 파일을 서버로부터 다운로드하는 메소드</p>
* @param1   CyHttpFile 컴포넌트의 ID
* @param2   사용자가 로컬에 다운받고자하는 파일경로 및 파일명(예:C:\TEMP\example.jpg)
* @param3   사용자가 다운받고자하는 서버의 물리적 파일명(해당 DataSet ID.getColumn(i,"DataSet의 fileName ID"))
* @param4   선택한 현재 Row 위치
* @param5   Grid 컴포넌트에서 파일 진행상태 표시하는 컬럼의 ID
* @param6   Grid 컴포넌트 ID
* @return   파일다운로드가 성공했을 경우 rtn_arr = [SUCC] 리턴
*           파일다운로드가 실패했을 경우 rtn_arr = [FAIL, 에러메시지] 리턴
*****************************************************************************************************/

function fnc_FileReadAndProgress(httpfileObj, file_url, str_cookie, str_size, nRow, strCol, objState) {
	var rtn_arr = Array(3);
	rtn_arr[0] = "FAIL";

	if (length(file_url) < 7) {
		rtn_arr[1] = "Not Found Seleced File!";
		return rtn_arr;
	}
	
	if (length(str_cookie) < 1) {
		rtn_arr[1] = "Not Found CookieParam!";
		return rtn_arr;
	}
trace("1. rtn_arr : " + rtn_arr);
	remote_url =  GBL_FILE_UPDNLOAD_URL+"?mode=download";
	var read_size;
	var tot_read_size;
	var file_size;

	httpfileObj.CookieParam = str_cookie;
trace("2. httpfileObj.CookieParam : " + httpfileObj.CookieParam);	
	file_size = str_size;

	
trace("2-1.remote_url : " +remote_url);	
trace("2-2.file_url : " +file_url);		
	ret = httpfileObj.OpenFile(remote_url, file_url, "GET");
trace("3. ret : " + ret);		
	if( ret < 0 ) {
		rtn_arr[0] = "FAIL";
		rtn_arr[1] = "OpenFile Fail ::" + httpfileObj.ErrorMsg;
		return rtn_arr;
	}
	
	tot_read_size = 0;	

	if (IsValidObject(objState)){
		var objDs = objState.BindDataset;
trace("4-1. objDs = " + objDs);		
		var readpercent;
trace("httpfileObj = " + httpfileObj);
		while(1) {
			read_size = httpfileObj.ReadFile(download_packetSize);
			tot_read_size += read_size;
			
trace("4-2. read_size = " + read_size +", tot_read_size = " + tot_read_size);			
			readpercent = truncate((toNumber(tot_read_size) / toNumber(file_size)) * 100,1);
			
			object(objDs).SetColumn(nRow, strCol, readpercent+"%"); 
			
			if( (read_size == 0) || ( read_size == -1) ) break;
		} // end while
		
		object(objDs).SetColumn(nRow, strCol, "100%"); 
	} else {
		while(1) {
			read_size = httpfileObj.ReadFile(download_packetSize);
			if( (read_size == 0) || ( read_size == -1) ) break;
		}
	}
trace("5. httpfileObj.CookieParam : " + httpfileObj.CookieParam);	
	httpfileObj.CloseFile();
	
	if ( ( read_size == -1) )	{
		rtn_arr[0] = "FAIL";
		rtn_arr[1] = httpfileObj.ErrorMsg;
		return rtn_arr;
	}
	
	var rtn_val = httpfileObj.CookieParam;
	
trace("6. read function rtn_val : " + rtn_val);
	var str_sp = split2(rtn_val,"&","^");
	
	var tmp_a;
	
	for ( var i = 0 ; i < str_sp.length() ; i++ )
	{
		tmp_a = str_sp[i];

		if (tmp_a[1] == "FAIL")
		{
			rtn_arr[1] = tmp_a[1];
			return;
		}
		else
		{
			rtn_arr[i+0] = tmp_a[1];
		}
	}
trace("read function rtn_arr: " + rtn_arr);	
	return rtn_arr;
} 

function grdRace_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	grdRace.MoveToNextCell();

}
//순위등록 키엔터
function grdOrgan_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	//순위,정번,경주시간,(시간차),전법
	if ( nCell == 0) {
	    if ( nRow == dsOutOrgan.lastrow ) {
			nCell = 1;
			dsOutOrgan.row = 0; 
			grdOrgan.SetCellPos(0);
		} else {	 
		     grdOrgan.SetCellPos(4);
		}
	    grdOrgan.MoveToNextCell();
		grdOrgan.SetFocus();
	} else if ( nCell == 1) {
	    if ( nRow == dsOutOrgan.lastrow ) {
			nCell = 2;
			dsOutOrgan.row = 0; 
			grdOrgan.SetCellPos(1);
		} else {	 
		    dsOutOrgan.row = nRow + 1 ;
			grdOrgan.SetCellPos(0);
		} 
	    grdOrgan.MoveToNextCell();
		grdOrgan.SetFocus();
		
	} else if ( nCell == 2) {
	    if ( nRow == dsOutOrgan.lastrow ) {
			nCell = 3;
			dsOutOrgan.row = 0; 
			grdOrgan.SetCellPos(2);
		} else {	 
		    dsOutOrgan.row = nRow + 1 ;
			grdOrgan.SetCellPos(1);
		}
		grdOrgan.MoveToNextCell();
		grdOrgan.SetFocus();
	} else if ( nCell == 4) {
	    if ( nRow == dsOutOrgan.lastrow ) {
			dsOutOrgan1.row = -1; 
			grdOrgan1.SetCellPos(3);
			grdOrgan1.MoveToNextCell();
			grdOrgan1.SetFocus();
		} else {	 
		    dsOutOrgan.row = nRow + 1 ; 
			grdOrgan.SetCellPos(3);
			grdOrgan.MoveToNextCell();
			grdOrgan.SetFocus();
		}
	} 
}
//진입코스 키엔터
function grdOrgan1_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	//진입코스,정번,스타트타임,비고
	if ( nCell == 0) {
	    if ( nRow == dsOutOrgan1.lastrow ) {
			nCell = 1;
			dsOutOrgan1.row = 0; 
			grdOrgan1.SetCellPos(0);
		} else {	 
		     grdOrgan1.SetCellPos(3);
		}
	    grdOrgan1.MoveToNextCell();
		grdOrgan1.SetFocus();
	} else if ( nCell == 1) {
	    if ( nRow == dsOutOrgan1.lastrow ) {
			nCell = 2;
			dsOutOrgan1.row = 0; 
			grdOrgan1.SetCellPos(1);
		} else {	 
		    dsOutOrgan1.row = nRow + 1 ;
			grdOrgan1.SetCellPos(0);
		} 
	    grdOrgan1.MoveToNextCell();
		grdOrgan1.SetFocus();
		
	} else if ( nCell == 2) {
	    if ( nRow == dsOutOrgan1.lastrow ) {
			nCell = 3;
			dsOutOrgan1.row = 0; 
			grdOrgan1.SetCellPos(2);
		} else {	 
		    dsOutOrgan1.row = nRow + 1 ;
			grdOrgan1.SetCellPos(1);
		}
		grdOrgan1.MoveToNextCell();
		grdOrgan1.SetFocus();
	} else if ( nCell == 3) {
	    if ( nRow == dsOutOrgan1.lastrow ) {
			dsOutOrgan2.row = -1; 
			grdOrgan2.SetCellPos(1);
			grdOrgan2.MoveToNextCell();
			grdOrgan2.SetFocus();
		} else {	 
		    dsOutOrgan1.row = nRow + 1 ; 
			grdOrgan1.SetCellPos(2);
			grdOrgan1.MoveToNextCell();
			grdOrgan1.SetFocus();
		}
	} 
}

//소개항주 키엔터
function grdOrgan2_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	//정번,소개항주타임
	if ( nCell == 0) {
	    if ( nRow == dsOutOrgan2.lastrow ) {
			nCell = 1;
			dsOutOrgan2.row = 0; 
			grdOrgan2.SetCellPos(0);
		} else {	 
		     grdOrgan2.SetCellPos(1);
		}
	    grdOrgan2.MoveToNextCell();
		grdOrgan2.SetFocus();
	} else if ( nCell == 1) {
	    if ( nRow == dsOutOrgan2.lastrow ) {
			dsOutOrgan.row = -1; 
			grdOrgan.SetCellPos(1);
			grdOrgan.MoveToNextCell();
			grdOrgan.SetFocus();
		} else {	 
		    dsOutOrgan2.row = nRow + 1 ; 
			grdOrgan2.SetCellPos(0);
			grdOrgan2.MoveToNextCell();
			grdOrgan2.SetFocus();
		}
	} 
}
//위반사항키엔터 
function grdVoilAct_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	 
	if ( nCell == 10) {
	    if ( nRow == dsOutVoilAct.lastrow ) {
		    dsOutVoilAct.addRow();
		    dsOutVoilAct.row = nRow + 1 ; 
	        grdVoilAct.SetCellPos(0);
		    grdVoilAct.MoveToNextCell();
		    grdVoilAct.SetFocus();
		    break; 
		} else {
		    dsOutVoilAct.row = nRow + 1 ; 
	        grdVoilAct.SetCellPos(0);
		    grdVoilAct.MoveToNextCell();
		    grdVoilAct.SetFocus();
		    break;
		}
	 
	} else {
	   grdVoilAct.MoveToNextCell();
	}
}



//경주시간 check
function fnc_IsTimeCheck()
{
 var lsOK 	    = false;
 var li01  	= 0;
 var li02  	= 0;
 var li03  	= 0;
 var li04  	= 0;
 var li05  	= 0;
 var li06  	= 0;


	for ( i = 0; i < dsOutOrgan.GetRowCount(); i++ ) {   
		 //1위
		 if(dsOutOrgan.getColumn(i, "RANK") == "1" ) {
		    li01  = toNumber(dsOutOrgan.getColumn(i, "RACE_TM"));
		 }
		 //2위
		 if(dsOutOrgan.getColumn(i, "RANK") == "2" ) {
		    li02  = toNumber(dsOutOrgan.getColumn(i, "RACE_TM"));
		 }	
		 //3위
		 if(dsOutOrgan.getColumn(i, "RANK") == "3" ) {
		    li03  = toNumber(dsOutOrgan.getColumn(i, "RACE_TM"));
		 }	
		 //4위
		 if(dsOutOrgan.getColumn(i, "RANK") == "4" ) {
		    li04  = toNumber(dsOutOrgan.getColumn(i, "RACE_TM"));
		 }	
		 //5위
		 if(dsOutOrgan.getColumn(i, "RANK") == "5" ) {
		    li05  = toNumber(dsOutOrgan.getColumn(i, "RACE_TM"));
		 }	
		 //6위
		 if(dsOutOrgan.getColumn(i, "RANK") == "6" ) {
		    li06  = toNumber(dsOutOrgan.getColumn(i, "RACE_TM"));
		 }
	} 
	if(li02 <> 0) { 
        if ( li01 >= li02 ) {
            return false;
        }
    }   
    if(li03 <> 0) { 
        if ( li02 >= li03 ) {
            return false;
        }
    }   
    if(li04 <> 0) { 
        if ( li03 >= li04 ) {
            return false;
        }
    }  
    if(li05 <> 0) { 
        if ( li04 >= li05 ) {
            return false;
        }
    } 
    if(li06 <> 0) { 
        if ( li05 >= li06 ) {
            return false;
        }
    } 
    return true;
 
}


function grdVoilAct_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	//위반내용
	if ( nCell == 8) {
	    grdVoilAct.ToolTipText = dsOutVoilAct.GetColumn(nRow, "VOIL_DESC" );
	//상세내용(홈페이지)
	} else if ( nCell == 9) {
	  grdVoilAct.ToolTipText = dsOutVoilAct.GetColumn(nRow, "RMK" );
	}
}

function grdAcdntStts_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	//사고내용
	if ( nCell == 7) {
	  grdAcdntStts.ToolTipText = dsOutAcdntStts.GetColumn(nRow, "ACDNT_DESC" );
	//상세내용(홈페이지)
	} else if ( nCell == 8) {
	  grdAcdntStts.ToolTipText = dsOutAcdntStts.GetColumn(nRow, "RMK" );
	}
}
//키엔터시 값전체 선택
function grdOrgan_OnEnterEdit(obj,nRow,nCell,nPivotIndex)
{
	grdOrgan.SetEditSel(0,-1);
}
//키엔터시 값전체 선택
function grdOrgan1_OnEnterEdit(obj,nRow,nCell,nPivotIndex)
{
	grdOrgan1.SetEditSel(0,-1);
}
//키엔터시 값전체 선택
function grdOrgan2_OnEnterEdit(obj,nRow,nCell,nPivotIndex)
{
	grdOrgan2.SetEditSel(0,-1);
}

function btnSearchOnClick(obj)
{
	 fcSearch(stStndYear.text,stndMbrCd.text, stTms.text,stDayOrd.text,stRaceNo.text);
}

//소개항주 홈페이지 공지
function btnIntro_OnClick(obj)
{
	var confirmMsg = Confirm("소개항주를 홈페이지에 공지 하시겠습니까?");
	if ( confirmMsg ) {
	    
	    var ServiceName = "e04020020-service:saveIntro";
		var sInDataSet   = "dsOutRace=dsOutRace";
		var sOutDataSet  = "dsOutRace=dsOutRace";
        
        fce_SendTransaction(ServiceName, sInDataSet, sOutDataSet, "fcCallBack");
	    
	}
}

//홈페이지순위공지
function btnRank_OnClick(obj)
{
	var confirmMsg = Confirm("순위를 홈페이지에 공지 하시겠습니까?");
	if ( confirmMsg ) {
	    
	    var ServiceName = "e04020020-service:saveRank";
		var sInDataSet   = "dsOutRace=dsOutRace";
		var sOutDataSet  = "dsOutRace=dsOutRace";
        
        fce_SendTransaction(ServiceName, sInDataSet, sOutDataSet, "fcCallBack");
	    
	}
}


/*-------------------------------------------------------------------------------------------------+
>>  최고정번수에 따른 그리드 사이즈 조절
+-------------------------------------------------------------------------------------------------*/
function setLocation(){

	var oriBottom = grdOrgan.Bottom;
	var extHeight = 0;
	var rowHeight = 19;
	var rowCnt = dsOutOrgan.GetRowCount();
	var gap = 3;
	
	
	if(rowCnt < 6) rowCnt = 6;
	
	grdOrgan.Height = (rowCnt + 2) * rowHeight;
	grdOrgan1.Height = (rowCnt + 2) * rowHeight;
	grdOrgan2.Height = (rowCnt + 2) * rowHeight;
	
	Shape5.Top = grdOrgan.Bottom + gap + 6;
	
	Static17.Top = grdOrgan.Bottom + gap;
	grdVoilAct.Top = Static17.Bottom + gap;
	grdAcdntStts.Top = grdVoilAct.Bottom + gap;
	
	voilActBtnRow.Top = grdOrgan.Bottom + gap;
}]]></Script>
</Window>