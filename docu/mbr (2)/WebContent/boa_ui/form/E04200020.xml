<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="608" Id="E04200020" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="사고분석&#32;및&#32;일차별&#32;교육생&#32;선별" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>159</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsArticleStatus</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>157</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsDownRisk</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsList" OnColumnChanged="dsList_OnColumnChanged">
				<Contents>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMain" OnColumnChanged="dsMain_OnColumnChanged" OnRowPosChanged="dsMain_OnRowPosChanged">
				<Contents>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CYCLE_KD_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_GRD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_LEN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV1_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU1_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV2_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU2_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO3" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM3" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV3_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU3_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO4" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM4" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV4_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU4_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO5" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM5" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV5_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU5_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO6" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM6" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV6_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU6_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO7" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM7" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV7_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU7_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO8" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM8" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV8_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU8_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO9" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM9" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAV9_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_INDU9_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="REFE_CMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="REPORT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYMENT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_ACDNT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_ACDNT_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="EVAC_WALK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EVAC_WALK_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOWN_ACDNT_CNTNT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE2" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_PATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_IMG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_IMG2" size="256" summ="default" type="STRING"/>
					<colinfo id="RTNFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER1" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER2" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER3" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER4" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER5" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER6" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER7" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER8" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_TYPE_RACER9" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER1" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER2" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER3" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER4" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER5" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER6" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER7" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER8" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK_RACER9" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER1" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER2" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER3" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER4" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER5" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER6" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER7" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER8" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_TYPE_RACER9" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER1" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER2" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER3" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER4" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER5" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER6" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER7" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER8" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK_RACER9" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER1" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER2" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER3" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER4" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER5" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER6" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER7" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER8" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TARGET_RACER9" size="256" summ="default" type="STRING"/>
					<colinfo id="JUDGE_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="ANALY_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="JUST_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="JUDGE_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="ANALY_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="JUST_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT1" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT3" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT4" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT5" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT6" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT7" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT8" size="256" summ="default" type="STRING"/>
					<colinfo id="CAUSER_CNT9" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT1" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT3" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT4" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT5" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT6" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT7" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT8" size="256" summ="default" type="STRING"/>
					<colinfo id="VICTIM_CNT9" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT1" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT3" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT4" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT5" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT6" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT7" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT8" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNT9" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_TYPE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsArticleStatus"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsDownRisk"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsSeq">
				<Contents>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="13" Top="8" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="stFormTitle" Left="24" Style="snis_m_title" TabOrder="12" Text="사고상황분석" Top="8" VAlign="Middle" Width="359"></Static>
		<Div Height="22" Id="divBtnLst" Left="628" TabOrder="1" TabStop="FALSE" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="374">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" LineKind="Vertical" Right="1008" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="7" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Static Align="Right" Border="None" Height="20" Id="Static5" Left="16" Style="snis_if_lable" TabOrder="8" Text="년도" Top="32" VAlign="Middle" Width="24"></Static>
		<Combo Border="Flat" CodeColumn="STND_YEAR" DataColumn="STND_YEAR" Height="20" Id="cboStndYear" ImeMode="none" Left="47" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="2" Top="33" Width="72"></Combo>
		<Static Align="Right" Border="None" Height="20" Id="Static0" Left="111" Style="snis_if_lable" TabOrder="9" Text="회차" Top="35" VAlign="Middle" Width="47"></Static>
		<Combo BindDataset="dsTms" Border="Flat" CodeColumn="TMS" DataColumn="TMS" Height="20" Id="cboTms" ImeMode="none" Left="160" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="3" Top="33" Width="50"></Combo>
		<Static Align="Right" Border="None" Height="20" Id="Static2" Left="191" Style="snis_if_lable" TabOrder="10" Text="일차" Top="35" VAlign="Middle" Width="47"></Static>
		<Combo BindDataset="dsTms" Border="Flat" CodeColumn="DAY_ORD" DataColumn="DAY_ORD" Height="20" Id="cboDayOrd" ImeMode="none" Left="238" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="4" Top="33" Width="50"></Combo>
		<Static Align="Right" Border="None" Height="20" Id="Static3" Left="295" Style="snis_if_lable" TabOrder="11" Text="경주번호" Top="35" VAlign="Middle" Width="47"></Static>
		<Combo BindDataset="dsTms" Border="Flat" CodeColumn="RACE_NO" DataColumn="RACE_NO" Height="20" Id="cboRaceNo" ImeMode="none" Left="350" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="5" Top="33" Width="50"></Combo>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="dsList" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="256" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="160" Id="grdList" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" OnCellDBLClick="grdList_OnCellDblClick" OnHeadClick="fcGridSort" Right="1000" RowHeight="28" SelColor="user19" Style="snis_grid" TabOrder="6" TabStop="true" Top="96" UseAutoSizing="Row" UseDBuff="true" UseExSizing="Row" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="992">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="34"/>
						<col width="66"/>
						<col width="66"/>
						<col width="34"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="350"/>
						<col width="60"/>
						<col width="60"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="년도"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" edit="uppernum" font="굴림,9" text="정번"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="등록번호"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="선수명"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="순위"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="가해건수"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="피해건수"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="교육건수"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="사고내용"/>
						<cell bkcolor="user30" col="9" color="user21" display="text" font="굴림,9" text="교육대상"/>
						<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" text="위험지수"/>
					</head>
					<body>
						<cell col="0" display="combo"/>
						<cell align="center" checklength="Byte" col="1" colid="BACK_NO" combodisplayrowcnt="10" display="normal" imemode="english" limit="6" useime="false"/>
						<cell align="center" checklength="Byte" col="2" colid="RACER_NM" display="text" limit="10"/>
						<cell align="center" checklength="Byte" col="3" colid="RACER_NO" display="text" limit="8"/>
						<cell align="center" checklength="Byte" col="4" colid="RANK_RACER" combodisplayrowcnt="10" display="normal" limit="40"/>
						<cell align="center" checklength="Byte" col="5" colid="CAUSER_CNT" cursor="hand" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="6" colid="vICTIM_CNT" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="7" colid="EDU_CNT" cursor="hand" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="8" colid="RMK_RACER" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell checklength="Byte" col="9" colid="EDU_TARGET_RACER" display="checkbox" edit="checkbox" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="10" colid="VIOL_TYPE_RACER" combocol="CD" combodataset="dsDownRisk" combotext="CD_TERM1" display="combo" limit="40" multiline="true" Valign="Center" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Tab Height="140" Id="TabDown" Left="8" TabOrder="14" Top="456" Width="994">
			<Contents>
				<TabPage BorderColor="black" Height="116" Id="tab1" ImageID="m_tab_05" Left="2" TabOrder="16" Text="심판" Top="22" Width="990">
					<TextArea BindDataset="dsmain" Border="Flat" Column="JUDGE_DESC" Height="110" Id="txaJudge" Left="5" MaxLength="1000" Style="snis_m_input01" TabOrder="1" Top="3" VScroll="TRUE" Width="889"></TextArea>
					<Combo BindDataset="dsMain" Border="Flat" CodeColumn="CD" Column="JUDGE_STATUS" DataColumn="CD_NM" Height="20" Id="cboJudge" ImeMode="none" InnerDataset="dsArticleStatus" Left="897" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="2" Top="26" Width="90"></Combo>
					<Static Align="Center" Border="None" Height="20" Id="Static6" Left="898" Style="snis_if_lable" TabOrder="3" Text="분석상태" Top="4" VAlign="Middle" Width="87"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="116" Id="tab2" ImageID="m_tab_05" Left="2" TabOrder="16" Text="분석" Top="22" Width="990">
					<TextArea BindDataset="dsmain" Border="Flat" Column="ANALY_DESC" Height="110" Id="txaAnaly" Left="5" Style="snis_m_input01" TabOrder="1" Top="3" VScroll="TRUE" Width="889"></TextArea>
					<Combo BindDataset="dsmain" Border="Flat" CodeColumn="CD" Column="ANALY_STATUS" DataColumn="CD_NM" Height="20" Id="cboAnaly" ImeMode="none" InnerDataset="dsArticleStatus" Left="897" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="2" Top="26" Width="90"></Combo>
					<Static Align="Center" Border="None" Height="20" Id="Static2" Left="898" Style="snis_if_lable" TabOrder="3" Text="분석상태" Top="4" VAlign="Middle" Width="87"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="116" Id="tab3" ImageID="m_tab_05" Left="2" TabOrder="16" Text="공정" Top="22" Width="990">
					<TextArea BindDataset="dsmain" Border="Flat" Column="jusT_DESC" Height="110" Id="txaJust" Left="5" Style="snis_m_input01" TabOrder="1" Top="3" VScroll="TRUE" Width="889"></TextArea>
					<Combo BindDataset="dsmain" Border="Flat" CodeColumn="CD" Column="JUST_STATUS" DataColumn="CD_NM" Height="20" Id="cboJust" ImeMode="none" InnerDataset="dsArticleStatus" Left="897" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="2" Top="26" Width="90"></Combo>
					<Static Align="Center" Border="None" Height="20" Id="Static2" Left="898" Style="snis_if_lable" TabOrder="3" Text="분석상태" Top="4" VAlign="Middle" Width="87"></Static>
				</TabPage>
			</Contents>
		</Tab>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnVideoPlay" ImageID="btn_txt_07" Left="504" OnClick="btnVideoPlay_OnClick" Style="snis_btn" TabOrder="15" Text="경주동영상" Top="34" Transparent="TRUE" Width="80"></Button>
		<Combo Border="Flat" CodeColumn="seq" DataColumn="seq" Height="20" Id="cboSeq" ImeMode="none" InnerDataset="dsseq" Left="446" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="16" Top="33" Width="50"></Combo>
		<Static Align="Right" Border="None" Height="20" Id="Static6" Left="394" Style="snis_if_lable" TabOrder="17" Text="순번" Top="35" VAlign="Middle" Width="47"></Static>
		<Static Color="darkblue" Font="Default,9,Bold" Height="17" Id="Static7" Left="692" TabOrder="18" Text="※&#32;가해/피해/교육건수는&#32;최근&#32;1년간의&#32;건수입니다." Top="40" Width="305"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="dsList" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="416" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="128" Id="Grid0" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" OnCellDBLClick="grdList_OnCellDblClick" OnHeadClick="fcGridSort" Right="1000" RowHeight="28" SelColor="user19" Style="snis_grid" TabOrder="19" TabStop="true" Top="288" UseAutoSizing="Row" UseDBuff="true" UseExSizing="Row" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="992">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="34"/>
						<col width="66"/>
						<col width="66"/>
						<col width="57"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="280"/>
						<col width="60"/>
						<col width="60"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="년도"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" edit="uppernum" font="굴림,9" text="정번"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="등록번호"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="선수명"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="주회수"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="장소"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="조"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="위반판정"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="내용"/>
						<cell bkcolor="user30" col="9" color="user21" display="text" font="굴림,9" text="사고유발"/>
						<cell bkcolor="user30" col="10" color="user21" display="text" font="굴림,9" text="위험구분"/>
					</head>
					<body>
						<cell col="0" display="combo"/>
						<cell align="center" checklength="Byte" col="1" colid="BACK_NO" combodisplayrowcnt="10" display="normal" imemode="english" limit="6" useime="false"/>
						<cell align="center" checklength="Byte" col="2" colid="RACER_NM" display="text" limit="10"/>
						<cell align="center" checklength="Byte" col="3" colid="RACER_NO" display="text" limit="8"/>
						<cell align="center" checklength="Byte" col="4" colid="RANK_RACER" combodisplayrowcnt="10" display="normal" limit="40"/>
						<cell align="center" checklength="Byte" col="5" colid="CAUSER_CNT" cursor="hand" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="6" colid="vICTIM_CNT" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="7" colid="EDU_CNT" cursor="hand" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="8" colid="RMK_RACER" display="text" limit="40" multiline="true" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="9" colid="VIOL_TYPE_RACER" combocol="CD" combodataset="dsDownRisk" combotext="CD_TERM1" display="combo" limit="40" multiline="true" Valign="Center" wordwrap="word"/>
						<cell align="center" checklength="Byte" col="10" colid="VIOL_TYPE_RACER" combocol="CD" combodataset="dsDownRisk" combotext="CD_TERM1" display="combo" limit="40" multiline="true" Valign="Center" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Font="Default,10,Bold" Height="27" Id="Static4" Left="8" TabOrder="20" Text="[&#32;업무별&#32;경주&#32;분석&#32;]" Top="432" VAlign="Middle" Width="128"></Static>
		<Static Font="Default,10,Bold" Height="27" Id="Static1" Left="9" TabOrder="21" Text="[&#32;선수별&#32;요약정보&#32;]" Top="72" VAlign="Middle" Width="150"></Static>
		<Static Font="Default,10,Bold" Height="27" Id="Static8" Left="8" TabOrder="22" Text="[&#32;선수별&#32;사고정보&#32;입력&#32;]" Top="264" VAlign="Middle" Width="220"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::cra_common_script.js";
#include "lib::cra_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'E04200010';
var sBUTTONLIST   = 'TTTTTTT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보

var iRacerCnt = 7;

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>> 최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
	sBUTTONLIST   = 'FT' + sInpt + 'FFFT';

	// 화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	// 화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);

	// 경주정보 조회
	fcd_GetRaceInfo(sFormId, cboStndYear, NULL, cboTms, cboDayOrd, cboRaceNo);

	// 공통코드 조회
	fcd_GetComboDs(dsInComCd);

	// 초기 화면 BK Color설정
	fnc_SetBKColor(this);

	fcSearch(obj);	
}

/*-------------------------------------------------------------------------------------------------+
>> 최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	// 자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "dsMain";
	if (!fnc_FormUnloadCheck(sDataset, sFormId)) return false;
}

/*-------------------------------------------------------------------------------------------------+
>> 단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj, objSenderObj, nChar, bShift, bControl, bAlt, nLLParam, nHLParam) {
	// Return Key Press時 Next Component focus
	if (nChar == 13) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}
}
/*-------------------------------------------------------------------------------------------------+
>> 초기화 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {

}

/*-------------------------------------------------------------------------------------------------+
>> 부서별 권한 처리
+-------------------------------------------------------------------------------------------------*/
function fc_DeptAuth() {
	//alert(gdsUser.GetColumn(0,"TEAM_CD"));

//var sUserType = 'JG';  	// 부서별 타입  심판 JG, 운영 AN,  공정  JS

	//disable 처리
	grdList.Editable = false;
	
	tabDown.tab1.txaJudge.Readonly = true;
	tabdown.tab1.cboJudge.Enable = false;

	tabDown.tab2.txaAnaly.Readonly = true;
	tabdown.tab2.cboAnaly.Enable = false;

	tabDown.tab3.txaJust.Readonly = true;
	tabdown.tab3.cboJust.Enable = false;

	switch (gdsUser.GetColumn(0,"TEAM_CD") )
	{
		case "GA124970": //정보지원팀
			grdList.Editable = true;
			tabDown.tab1.txaJudge.Readonly = false;
			tabDown.tab2.txaAnaly.Readonly = false;
			tabDown.tab3.txaJust.Readonly = false;
			tabdown.tab1.cboJudge.Enable = true;
			tabdown.tab2.cboAnaly.Enable = true;
			tabdown.tab3.cboJust.Enable = true;
			break;
		
		case "GA124700": // 심판
			grdList.Editable = true;
			if(tabdown.tab1.cboJudge.Value <>"003") {
				tabDown.tab1.txaJudge.Readonly = false;
				tabdown.tab1.cboJudge.Enable = true;
			}
			break;
		case "GA124130": // 분석-운영
			if(tabdown.tab2.cboAnaly.Value <>"003") {
				tabDown.tab2.txaAnaly.Readonly = false;
				tabdown.tab2.cboAnaly.Enable = true;	
			}
			break;
		case "GA123510": // 공정
			if(tabdown.tab3.cboJust.Value <>"003") {
				tabDown.tab3.txaJust.Readonly = false;		
				tabdown.tab3.cboJust.Enable = true;
			}
			break;
		default : 
			break;
	}	
	
}


/*-------------------------------------------------------------------------------------------------+
>> 닫기 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	Close();
}

/*-------------------------------------------------------------------------------------------------+
>> 년도, 경륜장, 회차, 일차, 경주정보 OnChanged Event
+-------------------------------------------------------------------------------------------------*/
function fcCboOnChanged(obj, strCode, strText, nOldIndex, nNewIndex) {
	//if (!fcConfirmToChangeRace(obj, nOldIndex)) return;

	switch (obj.Id) {
		case "cboStndYear" :
			fcd_GetTms(sFormId, cboTms, cboStndYear.Value, GBL_MEET_CD, false, cboDayOrd, cboRaceNo);
			fcSearch(obj);
			break;

		case "cboTms" :
			fcd_GetDayOrd(sFormId, cboTms, cboDayOrd, cboRaceNo);
			fcSearch(obj);
			break;

		case "cboDayOrd" :
			fcd_GetRaceNoEx(sFormId, cboTms, cboRaceNo);
			fcSearch(obj);
			break;

		case "cboRaceNo" :
			fcSearch(obj);
			break;
			
		case "cboSeq" : 
			dsMain.row = cboSeq.Index;
			fcSetList();
			fc_DeptAuth();
			break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>> 그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj, nCell, nX, nY, nPivotIndex) {
	fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/*-------------------------------------------------------------------------------------------------+
>> 그리드 더블클릭  -- 처리 필요
+-------------------------------------------------------------------------------------------------*/
function grdList_OnCellDblClick(obj, nRow, nCell, nX, nY, nPivotIndex) {

	strParam = "";
	if (nCell == 5)  {	
		//alert(nCell);
		strParam += " sRacerNo=" + dsList.GetColumn(nRow,"RACER_NO");
		strParam += " sRacerNm=" + dsList.GetColumn(nRow,"RACER_NM");
		strParam += " sFrDt=" + fnc_calDate(fnc_currDate(),365,true);
		strParam += " sToDt=" + fnc_currDate();
		strParam += " sMeetCd=''" ;
		GBL_FRM_REL_VALUE = strParam;
		
		global.FrameBottom.fcOpenMdiForm("JRM0004", "개인별별 낙차현황", "frm_jju::JRM0004.xml");
	}	
	else if(nCell = 7) {

		strParam += " sRacerNo=" + dsList.GetColumn(nRow,"RACER_NO");
		strParam += " sRacerNm=" + dsList.GetColumn(nRow,"RACER_NM");
		strParam += " sFrDt=" + fnc_calDate(fnc_currDate(),365,true);
		strParam += " sToDt=" + fnc_currDate();
		strParam += " sMeetCd=''" ;
		GBL_FRM_REL_VALUE = strParam;

		global.FrameBottom.fcOpenMdiForm("JRM0003", "교육현황관리", "frm_jju::JRM0003.xml");		
	}
/* 화면 연계 처리 (sample)

strParam +=" MEET_CD="+dsRaceDayInfo.GetColumn(0,"MEET_CD");
strParam +=" COMM_NO="+COMM_NO;			
GBL_RET_VALUE=strParam; // 값 생성				
global.FrameBottom.fcOpenMdiForm("RSM2011", "매출액비교", "frm_rsm::RSM2011.xml");
*/
	
}
/*-------------------------------------------------------------------------------------------------+
>> 조회
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {	
	return true;
}

function fcSearch(obj) {
	if ( !fcSearchCheck(obj) ) return;	
	
	var sServiceName = "jju0004-service:searchMainAnaly";
    var sInDataSet   = "";
    var sOutDataSet  = "dsMain=dsMain "; 
	
	fcd_AddParam("STND_YEAR", cboStndYear.Value); 
	fcd_AddParam("MEET_CD", GBL_MEET_CD);	
	fcd_AddParam("TMS", 	cboTms.Value );
	fcd_AddParam("DAY_ORD", cboDayOrd.Value );
	fcd_AddParam("RACE_NO", cboRaceNo.Value );
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);		
}

/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {  

	// 저장할 자료가 있는지 체크
	if ( !fnc_DatasetChangeCheck(this.dsMain)) {
		//저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");	
		return false;
	}

	return true;
}

function fcSave(obj) {
	if ( !fcSaveCheck() ) return;

    var sServiceName = "jju0004-service:saveDownAcdntAnaly";
    var sInDataSet   = "dsMain=dsMain:u ";    
    var sOutDataSet  = "";    
    
	fcd_AddParam("STND_YEAR", cboStndYear.Value); 
	fcd_AddParam("MEET_CD", GBL_MEET_CD);	
	fcd_AddParam("TMS", cboTms.Value );
	fcd_AddParam("DAY_ORD", cboDayOrd.Value );
	fcd_AddParam("RACE_NO", cboRaceNo.Value );
	fcd_AddParam("SEQ", dsMain.GetColumn(dsMain.currow, "SEQ") );
	    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);		
}


function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 조회 완료 후
	switch (sServiceName) {				
		case "jju0004-service:searchMainAnaly":
					
			if( dsMain.rowcount > 0  ) {
				iSEQ = dsMain.GetColumn(0, "MAX_SEQ");
				
				dsSeq.ClearData();
				for(i=0;i<dsMain.rowcount();i++) {
					dsSeq.AddRow();
					dsSeq.SetColumn(dsSeq.currow,"SEQ", i+1); //dsMain.GetColumn(i,"SEQ")
				}
				cboSeq.Index = dsMain.row;
				
				fcSetList();
				fc_DeptAuth(); //부서별 권한설정
				
			}
			break;		
			
		case "jju0004-service:saveDownAcdntAnaly":
			fcSearch( NULL );
			break;

			
			
	}
}


//dsMain 에 있는 데이터를 dsList 에 넣는다
function fcSetList() {
	var idx = 1;
	var nRow = 0;
	var racer = "";

	grdList.Redraw = false;
	
	dsList.DeleteAll();	
	
	for( var i=0; i<iRacerCnt; i++ ) {	
	
		racer = dsMain.GetColumn(dsMain.currow, "RACER_NO"+idx);
		
		if( !fnc_IsNull(racer) ) {
		
			nRow = dsList.AddRow();             //Record Add
			dsList.SetColumn( nRow, "BACK_NO", "0"+idx );
			dsList.SetColumn( nRow, "RACER_NO", dsMain.GetColumn(dsMain.currow, "RACER_NO"+idx) );
			dsList.SetColumn( nRow, "RACER_NM", dsMain.GetColumn(dsMain.currow, "RACER_NM"+idx) );
			dsList.SetColumn( nRow, "LEAV_CD", dsMain.GetColumn(dsMain.currow, "LEAV"+idx+"_CD") );
			dsList.SetColumn( nRow, "DOWN_INDU_YN", dsMain.GetColumn(dsMain.currow, "DOWN_INDU"+idx+"_YN") );
			dsList.SetColumn( nRow, "VIOL_TYPE_RACER", dsMain.GetColumn(dsMain.currow, "VIOL_TYPE_RACER"+idx) );
			dsList.SetColumn( nRow, "RMK_RACER", dsMain.GetColumn(dsMain.currow, "RMK_RACER"+idx) );
			dsList.SetColumn( nRow, "RANK_RACER", dsMain.GetColumn(dsMain.currow, "RANK_RACER"+idx) );
			dsList.SetColumn( nRow, "EDU_TARGET_RACER", dsMain.GetColumn(dsMain.currow, "EDU_TARGET_RACER"+idx) );
			dsList.SetColumn( nRow, "CAUSER_CNT", dsMain.GetColumn(dsMain.currow, "CAUSER_CNT"+idx) );
			dsList.SetColumn( nRow, "VICTIM_CNT", dsMain.GetColumn(dsMain.currow, "VICTIM_CNT"+idx) );
			dsList.SetColumn( nRow, "EDU_CNT", dsMain.GetColumn(dsMain.currow, "EDU_CNT"+idx) );
		}
		
		idx++;
		
		dsList.SetColumn( nRow, "STND_YEAR", dsMain.GetColumn(dsMain.currow, "STND_YEAR"));
		dsList.SetColumn( nRow, "MEET_CD", dsMain.GetColumn(dsMain.currow, "MEET_CD"));
		dsList.SetColumn( nRow, "TMS", dsMain.GetColumn(dsMain.currow, "TMS"));
		dsList.SetColumn( nRow, "DAY_ORD", dsMain.GetColumn(dsMain.currow, "DAY_ORD"));
		dsList.SetColumn( nRow, "RACE_NO", dsMain.GetColumn(dsMain.currow, "RACE_NO"));
		dsList.SetColumn( nRow, "SEQ", dsMain.GetColumn(dsMain.currow, "SEQ"));

	}
	grdList.redraw = true;
	grdList.Redraw();
}

function dsList_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var idx = nRow+1;
	var columnNM = "";
	
	if( strColumnID == "EDU_TARGET_RACER" ) {
		
		columnNM = "EDU_TARGET_RACER"+idx;		
		dsMain.SetColumn( dsMain.currow, columnNM, varNewValue);
	}
}

function dsMain_OnRowPosChanged(obj,nOldRow,nRow)
{
	fcSetList();
}

function btnVideoPlay_OnClick(obj)
{	
	if(length(dsMain.GetColumn(dsMain.currow,"RACE_DAY")) > 0) {
		var sURL = "http://www.kcycle.or.kr/contents/infoPopup/raceVideoPop.do?videoType=F&meetCd=001&stndYear="+cboStndYear.Value
				 +"&tms="+cboTms.Value
				 +"&dayOrd="+cboDayOrd.Value
				 +"&raceNo="+cboRaceNo.Value
				 +"&raceDt="+dsMain.GetColumn(dsMain.currow,"RACE_DAY");
		ExecBrowser(sURL);
	}
}

function dsMain_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID ="JUST_DESC" or strColumnID ="JUST_STATUS") {
		dsMain.SetColumn(nRow,"USER_TYPE","JS");
	}
	else if (strColumnID ="ANALY_DESC" or strColumnID ="ANALY_STATUS") {
		dsMain.SetColumn(nRow,"USER_TYPE","AN");
	}
	else {
		dsMain.SetColumn(nRow,"USER_TYPE","JG");
	}
}]]></Script>
</Window>