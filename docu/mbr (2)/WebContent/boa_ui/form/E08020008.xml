<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="E08020008" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="ISO&#32;접속로그" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsDeptListValue">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsIsoLog">
				<Contents>
					<colinfo id="CONN_DATE" size="256" type="STRING"/>
					<colinfo id="CONN_TIME" size="256" type="STRING"/>
					<colinfo id="USER_ID" size="256" type="STRING"/>
					<colinfo id="USER_NAME" size="256" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" type="STRING"/>
					<colinfo id="TEAM_NM" size="256" type="STRING"/>
					<colinfo id="MENU_ID" size="256" type="STRING"/>
					<colinfo id="MENU_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsLog">
				<Contents>
					<colinfo id="MENU_ID" size="256" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="2" Text="조회조건" Top="6" VAlign="Middle" Width="132"></Static>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="3" Top="8" Width="17"></Image>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" Right="1008" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="1" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Div Height="20" Id="divBtnLst" Left="678" TabOrder="4" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Div BKColor="user0" Height="22" Id="divSearch" Left="634" TabOrder="7" Text="Div0" Top="34" Url="common::comButtonSearch.xml" Width="50">
			<Contents></Contents>
		</Div>
		<Edit Border="Flat" Height="20" Id="edUser" Left="512" Style="snis_if_input01" TabOrder="6" Top="34" Width="116"></Edit>
		<Calendar Border="Flat" Height="20" Id="CalStDt" Left="80" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="8" Top="35" Width="86"></Calendar>
		<Calendar Border="Flat" Height="20" Id="CalEdDt" Left="184" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="9" Top="35" Width="86"></Calendar>
		<Static Align="Right" Height="20" Id="Static0" Left="12" Style="snis_if_lable" TabOrder="10" Text="조회기간" Top="34" VAlign="Middle" Width="56"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="170" Style="snis_if_lable" TabOrder="11" Text="~" Top="34" VAlign="Middle" Width="10"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboTeam" ImeMode="none" InnerDataset="dsDeptListValue" Left="326" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="12" Top="34" Width="114"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="290" Style="snis_if_lable" TabOrder="13" Text="부서" Top="35" VAlign="Middle" Width="30"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsIsoLog" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="584" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="20" Height="518" Id="grdIsoLog" InputPanel="FALSE" Left="7" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="1000" SelColor="user19" Style="snis_grid" TabOrder="14" TabStop="true" Top="66" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="993">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="92"/>
						<col width="94"/>
						<col width="507"/>
						<col width="150"/>
						<col width="144"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="년도"/>
						<cell bkcolor="user20" col="1" color="user21" colspan="2" display="text" edit="uppernum" font="굴림,9" text="최종접속일시"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="메뉴명"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="부서명"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="접속자"/>
					</head>
					<body>
						<cell col="0" display="combo"/>
						<cell align="center" checklength="Byte" col="1" colid="CONN_DATE" display="text" edit="normal" imemode="english" limit="3" useime="false"/>
						<cell align="center" col="2" colid="CONN_TIME" display="text"/>
						<cell checklength="Byte" col="3" colid="MENU_NM" display="text" edit="normal" limit="40"/>
						<cell align="center" col="4" colid="TEAM_CD" combocol="CD" combodataset="dsDeptListValue" combotext="CD_NM" display="combo"/>
						<cell align="center" checklength="Byte" col="5" colid="USER_NAME" display="text" edit="normal" limit="40"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="Static6" Left="452" Style="snis_if_lable" TabOrder="5" Text="접속자" Top="34" VAlign="Middle" Width="56"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::boa_common_script.js";
#include "lib::boa_app_script.js";
#include "lib::boa_isolog_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'E08020008';
var sBUTTONLIST   = 'FFFFFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트
var sPAGENUM      = "20";

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
    sBUTTONLIST   = 'FFFFTT';
	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";
	
	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
 
   // fce_insertIsoLog(sFormId,gdsUser.GetColumn(0,"TEAM_CD"));
    
    CalStDt.Text = Today();
    CalEdDt.Text = Today();
    
    fc_combo();
}
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UnLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	if ( !fnc_FormUnloadCheck("" , sFormId) ) return false;
}
function fcEnd(){
	Close();
}
function fc_combo(){
	var sServiceName = "e08010001-service:searchbranchcode";
    var sInDataSet   = "";
    var sOutDataSet  = "dsDeptListValue=dsDeptListValue ";  
		
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
}
function fcSearch(){
	
	var sServiceName = "e08020008-service:searchIsoLog";
    var sInDataSet   = "";
    var sOutDataSet  = "dsIsoLog=dsIsoLog "; 
    
		fce_AddParam("ST_YEAR", CalStDt.Value); 
		fce_AddParam("ED_YEAR", CalEdDt.Value); 
		fce_AddParam("USER_NM", edUser.Text); 
		fce_AddParam("TEAM_CD", cboTeam.Value); 
			
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
}
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	if ( sServiceName == "e08010001-service:searchbranchcode" ) {
		cboTeam.Index = 0;
	    fcSearch();
        return;
	}
	if ( sServiceName == "e08020008-service:searchIsoLog" ) {
        return;
	}
	
}

function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	fnc_GridSort(obj, object(obj.BindDataset), nCell);
}
function fcPrint(){

	var logImgUrl = GBL_REPORT_URL+"log.jpg";
	var sSubUrl   = "";                    
	var	sRptNm    = "e08020008.jrf";               //레포트 파일명
	var sDataSet  = "dsIsoLog=dsIsoLog";    //"UBI 쿼리명, MIP Dataset명"
	var sArg      =  "ST_YEAR="  + CalStDt.Value;
	    sArg      += " ED_YEAR=" + CalEdDt.Value;
	    sArg      += " USER_NM=" + edUser.Text;
	    sArg      += " TEAM_CD=" + cboTeam.Text;
		var sRptDrct  = 1;                               //출력방향(0 : 수직, 1 : 수평)	
		fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
}]]></Script>
</Window>