<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="E03080010" Left="8" OnKeyDown="fcHotKey" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="선수상벌점등록" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset CanColumnChange="fcTitlDisplay" DataSetType="Dataset" Id="dsOutPrzGubn">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="GRP_NM" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSStndYear">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutTitl">
				<Contents>
					<colinfo id="RWNPT_CD" size="256" type="STRING"/>
					<colinfo id="TITL" size="256" type="STRING"/>
					<colinfo id="RWNPT_GBN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSRaceTms">
				<Contents>
					<colinfo id="TMS" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutScr"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSRacer"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutGrdTitl" OnColumnChanged="fcSearchScr">
				<Contents>
					<colinfo id="RWNPT_CD" size="256" type="STRING"/>
					<colinfo id="TITL" size="256" type="STRING"/>
					<colinfo id="APLY_GBN" size="256" type="STRING"/>
					<colinfo id="RWNPT_GBN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" type="STRING"/>
					<colinfo id="ALL_YN" size="1" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00091</CD_GRP_ID>
						<DESCRIPTION>상벌구분</DESCRIPTION>
						<DSNAME>dsOutPrzGubn</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00006</CD_GRP_ID>
						<DESCRIPTION>경정장코드</DESCRIPTION>
						<DSNAME>dsOutMbr</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacerPoint" OnColumnChanged="fcFilterTitl">
				<Contents>
					<colinfo id="SEQ" size="256" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="RWNPT_CD" size="256" type="STRING"/>
					<colinfo id="RWNPT_GBN" size="256" type="STRING"/>
					<colinfo id="TITL" size="256" type="STRING"/>
					<colinfo id="SCR" size="256" type="STRING"/>
					<colinfo id="GRNT_DT" size="256" type="STRING"/>
					<colinfo id="RSN" size="256" type="STRING"/>
					<colinfo id="chk" size="256" type="STRING"/>
					<colinfo id="ALLRACER_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutMbr">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="GRP_NM" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacerPointStat">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="RWNPT_CD" size="256" type="STRING"/>
					<colinfo id="TITL" size="256" type="STRING"/>
					<colinfo id="RACER_NM" size="256" type="STRING"/>
					<colinfo id="SCR1" size="256" type="STRING"/>
					<colinfo id="SCR2" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSRaceDayOrd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacerPoint_rpt" OnColumnChanged="fcFilterTitl">
				<Contents>
					<colinfo id="SEQ" size="256" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="RWNPT_CD" size="256" type="STRING"/>
					<colinfo id="RWNPT_GBN" size="256" type="STRING"/>
					<colinfo id="TITL" size="256" type="STRING"/>
					<colinfo id="SCR" size="256" type="STRING"/>
					<colinfo id="GRNT_DT" size="256" type="STRING"/>
					<colinfo id="ALLRACER_YN" size="256" type="STRING"/>
					<colinfo id="RWNPT_GBN_NM" size="256" type="STRING"/>
					<colinfo id="MBR_CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSumRacerPoint" OnColumnChanged="fcFilterTitl">
				<Contents>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="SCR1" size="256" type="STRING"/>
					<colinfo id="SCR2" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacerTmsPoint">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
					<colinfo id="MBR_CD" size="256" type="STRING"/>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="TMS" size="256" type="STRING"/>
					<colinfo id="RWNPT_GBN" size="256" type="STRING"/>
					<colinfo id="SCR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataObject="dsOutRacerTmsPoint" DataSetType="Pivot" GroupKey="STND_YEAR:MBR_CD:RACER_NO:NM_KOR" Id="dsOutRacerTmsPointPivot" PivotKey="TMS,RWNPT_GBN"></Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" Right="1008" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="6" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="8" Top="8" Width="17"></Image>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="7" Text="조회조건" Top="6" VAlign="Middle" Width="132"></Static>
		<Div Height="20" Id="divBtnLst" Left="678" TabOrder="2" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Edit Border="Flat" Height="20" Id="edSRacerName" Left="880" Style="snis_if_input01" TabOrder="4" Top="34" Width="65"></Edit>
		<Static Align="Right" Height="20" Id="Static1" Left="834" Style="snis_if_lable" TabOrder="9" Text="선수명" Top="34" VAlign="Middle" Width="44"></Static>
		<Shape BKColor="#ff8500" Bottom="84" Height="6" Id="Shape2" Left="12" LineKind="Vertical" LineWidth="0" Right="18" RoundHeight="10" RoundWidth="10" TabOrder="12" Top="78" Type="Ellipse" Width="6"></Shape>
		<Static Height="20" Id="Static20" Left="24" Style="snis_m_stitle" TabOrder="11" Text="선수상벌점리스트" Top="72" VAlign="Middle" Width="150"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutRacerPoint" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="585" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="490" Id="grdRacerPoint" InputPanel="FALSE" Left="5" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" OnHeadClick="fcGridSort" Right="1007" SelColor="user19" Style="snis_grid" TabOrder="10" TabStop="true" Top="95" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1002">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="22"/>
						<col width="76"/>
						<col width="72"/>
						<col width="68"/>
						<col width="106"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="140"/>
						<col width="78"/>
						<col width="100"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="년도"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="경정장"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="회차"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="회차전원부여"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="등록번호"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="선수명"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="상벌구분"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="사유"/>
						<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" text="점수"/>
						<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" text="부여일"/>
					</head>
					<body>
						<cell col="0" colid="chk" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="STND_YEAR" combocol="STND_YEAR" combodataset="dsOutSStndYear" combotext="STND_YEAR" display="combo" edit='expr:iif(dsOutRacerPoint.GetRowType(row)&#32;==&#32;&quot;normal&quot;,&#32;&quot;none&quot;,&quot;combo&quot;)'/>
						<cell align="center" col="2" colid="MBR_CD" combocol="CD" combodataset="dsOutMbr" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="3" colid="TMS" combocol="TMS" combodataset="dsOutSRaceTms" combotext="TMS" display="combo" edit="combo"/>
						<cell align="center" col="4" colid="ALLRACER_YN" display="checkbox" edit="expr:Iif(dsOutRacerPoint.GetRowType(dsOutRacerPoint.rowposition)==&apos;normal&apos;,&apos;none&apos;,&apos;checkbox&apos;)"/>
						<cell align="center" col="5" colid="RACER_NO" display="text"/>
						<cell align="center" col="6" colid="NM_KOR" display="text" edit="normal"/>
						<cell align="center" col="7" colid="RWNPT_GBN" combocol="CD" combodataset="dsOutPrzGubn" combotext="CD_NM" display="combo" edit="combo"/>
						<cell col="8" colid="RWNPT_CD" combocol="RWNPT_CD" combodataset="dsOutGrdTitl" combotext="TITL" display="combo" edit="combo"/>
						<cell align="center" col="9" colid="SCR" display="number"/>
						<cell align="center" col="10" colid="GRNT_DT" display="date" edit="date" expandimage="btn_list_search" expandshow="true"/>
					</body>
					<summary>
						<cell col="0" color="user26" display="text"/>
						<cell align="center" col="1" color="user26" display="text" text="소계"/>
						<cell col="2" display="text"/>
						<cell col="3" color="user26" display="text"/>
						<cell col="4" display="text"/>
						<cell col="5" color="user26" display="text"/>
						<cell col="6" color="user26" display="text"/>
						<cell col="7" color="user26" display="text"/>
						<cell col="8" color="user26" display="text"/>
						<cell align="right" col="9" color="user26" display="text" expr='dsOutRacerPoint.Sum(&quot;SCR&quot;)+&quot;점&quot;'/>
						<cell col="10" color="user26" display="text"/>
						<cell col="11" color="user26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="Static2" Left="418" Style="snis_if_lable" TabOrder="13" Text="상벌구분" Top="35" VAlign="Middle" Width="56"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboSRwnptGbn" InnerDataset="dsOutPrzGubn" Left="476" OnChanged="fcFilterTitl" Style="snis_if_input01" TabOrder="2" Top="33" Width="84"></Combo>
		<Static Align="Right" Height="20" Id="Static3" Left="556" Style="snis_if_lable" TabOrder="14" Text="명칭" Top="34" VAlign="Middle" Width="36"></Static>
		<Combo Border="Flat" CodeColumn="RWNPT_CD" DataColumn="TITL" Height="20" Id="cboSTitl" InnerDataset="dsOutTitl" Left="595" Style="snis_if_input01" TabOrder="3" Top="33" Width="237"></Combo>
		<Static Align="Right" Height="20" Id="Static6" Left="8" Style="snis_if_lable" TabOrder="15" Text="년도" Top="35" VAlign="Middle" Width="40"></Static>
		<Combo Border="Flat" BorderColor="user1" CodeColumn="STND_YEAR" DataColumn="STND_YEAR" Height="20" Id="cboSStndYear" InnerDataset="dsOutSStndYear" Left="52" OnChanged="cboSStndYear_OnChanged" Style="snis_m_input01" TabOrder="5" Top="33" Width="62"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="243" Style="snis_if_lable" TabOrder="16" Text="회차" Top="34" VAlign="Middle" Width="40"></Static>
		<Div Height="20" Id="divBtnRow" Left="962" TabOrder="17" Text="Div0" Top="70" Url="common::comButtonRow.xml" Width="42">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static7" Left="120" Style="snis_if_lable" TabOrder="18" Text="경정장" Top="35" VAlign="Middle" Width="40"></Static>
		<Combo Border="Flat" BorderColor="user1" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboSMbr" InnerDataset="dsOutMbr" Left="163" OnChanged="cboSStndYear_OnChanged" Style="snis_m_input01" TabOrder="19" Top="33" Width="84"></Combo>
		<Div BKColor="user0" Height="22" Id="divSearch" Left="951" TabOrder="20" Text="Div0" Top="33" Url="common::comButtonSearch.xml" Width="50">
			<Contents></Contents>
		</Div>
		<Combo Border="Flat" CodeColumn="Tms" DataColumn="Tms" Height="20" Id="cboSRaceTms1" InnerDataset="dsOutSRaceTms" Left="287" OnChanged="cboSRaceTms1_OnChanged" Style="snis_if_input01" TabOrder="22" Top="33" Width="55"></Combo>
		<Static Align="Center" Height="20" Id="Static39" Left="342" Style="snis_txt" TabOrder="21" Text="~" Top="34" VAlign="Middle" Width="16"></Static>
		<Combo Border="Flat" CodeColumn="Tms" DataColumn="Tms" Height="20" Id="cboSRaceTms2" InnerDataset="dsOutSRaceTms" Left="359" OnChanged="cboSRaceTms2_OnChanged" Style="snis_if_input01" TabOrder="23" Top="33" Width="55"></Combo>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnPrtPointStat" ImageID="btn_txt_05" Left="871" LeftMargin="15" OnClick="btnPrtPointStat_OnClick" Style="snis_btn" TabOrder="24" Text="상벌점현황" Top="70" Transparent="TRUE" Width="89"></Button>
		<Combo Border="Flat" CodeColumn="DAY_ORD" DataColumn="DAY_ORD" Height="20" Id="cboSRaceDayOrd" InnerDataset="dsOutSRaceDayOrd" Left="136" Style="snis_if_input01" TabOrder="25" Top="69" Visible="FALSE" Width="111"></Combo>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnPrtRacerPoint" ImageID="btn_txt_10" Left="720" LeftMargin="15" OnClick="btnPrtRacerPoint_OnClick" Style="snis_btn" TabOrder="26" Text="선수회차별&#32;상벌점현황" Top="70" Transparent="TRUE" Width="147"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnPrtAllRacerPoint" ImageID="btn_txt_10" Left="568" LeftMargin="15" OnClick="btnPrtAllRacerPoint_OnClick" Style="snis_btn" TabOrder="27" Text="전체선수별&#32;상벌점현황" Top="70" Transparent="TRUE" Width="148"></Button>
		<Grid BindDataset="dsOutRacerTmsPointPivot" BkColor2="default" BoldHead="true" BorderColor="user22" Bottom="808" Enable="true" EndLineColor="default" Height="208" Id="grdOutRacerTmsPointPivot" InputPanel="FALSE" Left="8" LineColor="default" Right="984" TabOrder="28" TabStop="true" Top="600" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="976">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="74"/>
						<col fix="left" width="74"/>
						<col width="74"/>
						<col fix="right" width="74"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" rowspan="2" text="등록번호"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" rowspan="2" text="선수명"/>
						<cell bkcolor="user20" col="2" colid="TMS" color="user21" display="text" expr="tms+&apos;회차&apos;" suppress="-1" SuppressAlign="Middle"/>
						<cell bkcolor="user20" col="2" colid="RWNPT_GBN" color="user21" display="text" expr="DECODE(RWNPT_GBN,&apos;001&apos;,&apos;상점&apos;,&apos;벌점&apos;)" row="1"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" rowspan="2" text="합계"/>
					</head>
					<body>
						<cell align="center" bkcolor="user15" bkcolor2="user16" celltype="head" col="0" colid="RACER_NO" display="text" subsumexpr="iif(rowlevel&lt;2,RACER_NO,&apos;Subtotal&apos;)" suppress="3"/>
						<cell align="center" bkcolor="user15" bkcolor2="user16" celltype="head" col="1" colid="NM_KOR" display="text" subsumtext="Subtotal"/>
						<cell align="center" bkcolor="user15" bkcolor2="user16" col="2" colid="SCR" display="number"/>
						<cell align="center" bkcolor="user15" bkcolor2="user16" celltype="summary" col="3" display="number" expr="pivotSum(&apos;SCR&apos;,currow)" Mask="#,##0"/>
					</body>
					<summary>
						<cell align="center" col="0" colspan="2" display="text" text="합계"/>
						<cell align="center" col="2" display="number" expr="Sum(&apos;SCR&apos;,pivotindex)" Mask="#,##0"/>
						<cell align="center" col="3" display="number" expr="sum(&apos;SCR&apos;)" Mask="#,##0"/>
					</summary>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::boa_common_script.js";
#include "lib::boa_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'E03080010';
var sBUTTONLIST   = 'TTFFFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var CURR_DT = fce_GetSysdate("YYYYMMDD");
var CURR_STND_YEAR = gdsRace.GetColumn(gdsRace.rowposition, "STND_YEAR");   //현재 년도 
var CURR_USER_MBR_CD = gdsRace.GetColumn(gdsRace.rowposition, "MBR_CD");	//현재 User의 경정장 코드 
var CURR_TMS = gdsRace.GetColumn(gdsRace.rowposition, "TMS");			    //현재 회차  
var CURR_DAY_ORD = gdsRace.GetColumn(gdsRace.rowposition, "DAY_ORD");		//현재 일차 
var CURR_RACE_NO = gdsRace.GetColumn(gdsRace.rowposition, "RACE_NO");		//현재 경주번호 
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj)
{
    sBUTTONLIST   = 'T'+sInpt+'FTTT';
    	
    //화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";
	
	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	//초기 화면 BK Color설정 
	fnc_SetBKColor(this);

    //년도조회
    fce_SetStndYear(dsOutSStndYear, toInteger(fce_GetSysdate("YYYY")));
    cboSStndYear.Index = 0;
    
	//공통코드 조회
	fce_GetComboDs(dsInComCd);
        
}

/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj)
{
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "dsOutRacerPoint";
	if ( !fnc_FormUnloadCheck(sDataset , sFormId) ) return false;
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
    if ( obj.id == "btnboacel" || obj.id == "btnSearch" ) {
		dsOutRacerPoint.ClearData();
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {

	fcInit(obj);
    if ( cboSRaceTms1.Value > cboSRaceTms2.Value)
    {
        fnc_Message(SNIS_BOA_C006, "N");
        return false;
    }
	
	return true;
}

function fcSearch(obj) {
    if ( !fcSearchCheck(obj) ) return;
    
	var sServiceName = "e03080010-service:searchRacerPoint";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRacerPoint=dsOutRacerPoint ";
    
	fce_AddParam(Trim("RWNPT_GBN"), cboSRwnptGbn.Value);
	fce_AddParam(Trim("TITL"), cboSTitl.Value);
	fce_AddParam(Trim("NM_KOR"), edSRacerName.Text);
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD"), cboSMbr.Value);
	fce_AddParam(Trim("TMS1"), cboSRaceTms1.Value);	
    fce_AddParam(Trim("TMS2"), cboSRaceTms2.Value);
    
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}


/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) { 

	//변경된 자료가 있는지 체크
	if ( !fnc_DatasetChangeCheck(dsOutRacerPoint       ) )
	{
		//저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");
		return false;
	}

	// 필수항목체크
	oDataSet          = dsOutRacerPoint;
	sMandatoryColID   = "STND_YEAR||TMS||RACER_NO||RWNPT_GBN||RWNPT_CD||GRNT_DT";
	sMandatoryColName = "년도||회차||등록번호||상벌구분||사유||부여일";
	oGrid             = grdRacerPoint;
	if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	    return false;
	}

	return true;
}

function fcSave(obj) {

    if ( !fcSaveCheck(obj) ) return;

	var sServiceName = "e03080010-service:SaveRacerPointInfo";
    var sInDataSet   = "dsOutRacerPoint=dsOutRacerPoint:u ";
    var sOutDataSet  = "dsOutRacerPoint=dsOutRacerPoint";
    
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
}

/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
	fnc_OpenExcelExport("grdRacerPoint");         //입력 첫 항목으로 Focus
}

/*-------------------------------------------------------------------------------------------------+
>>  인쇄 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcPrint(obj) {
    fcSearchReportData();
	
	var logImgUrl = GBL_REPORT_URL+"log.jpg";
	var sSubUrl   = "";                     //레포트 파일이 있는 서브디렉토리
	var sRptNm    = "e03089010_racer_pointlist.jrf";               //레포트 파일명
	var sDataSet  = "racer_pointlist=dsOutRacerPoint_rpt";    //"UBI 쿼리명, MIP Dataset명"
	
	var sArg   = " STND_YEAR="+cboSStndYear.Value;
        sArg  += " TMS="+cboSRaceTms1.Value;	
		sArg  += " IMG_URL="+logImgUrl; 
	var sRptDrct  = 1;                               //출력방향(0 : 수직, 1 : 수평)
	
	fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
}

/*-------------------------------------------------------------------------------------------------+
>>  레포트를 위한 선수상벌점 리스트 가져오기
+-------------------------------------------------------------------------------------------------*/
function fcSearchReportData(obj) {
	var sServiceName = "e03080010-service:searchRacerPoint_rpt";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRacerPoint_rpt=dsOutRacerPoint_rpt  ";
    
	fce_AddParam(Trim("RWNPT_GBN"), cboSRwnptGbn.Value);
	fce_AddParam(Trim("TITL"), cboSTitl.Value);
	fce_AddParam(Trim("NM_KOR"), edSRacerName.Text);
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD"), cboSMbr.Value);
	fce_AddParam(Trim("TMS1"), cboSRaceTms1.Value);	
    fce_AddParam(Trim("TMS2"), cboSRaceTms2.Value);

    http.sync = true;
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	http.sync = false;
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {
Trace(dsOutRacerPoint.savexml());
	dsOutRacerPoint.AddRow();

	var stnd_year =  CURR_STND_YEAR;
    var mbr_cd = CURR_USER_MBR_CD;
    var tms = CURR_TMS;
    var przGbn = dsOutPrzGubn.GetColumnNF(dsOutPrzGubn.rowposition,"CD");
    var titl = dsOutTitl.GetColumnNF(dsOutTitl.rowposition,"RWNPT_CD");
    
    dsOutRacerPoint.SetColumn(dsOutRacerPoint.rowposition,"STND_YEAR",stnd_year);
    dsOutRacerPoint.SetColumn(dsOutRacerPoint.rowposition,"MBR_CD",mbr_cd);
    dsOutRacerPoint.SetColumn(dsOutRacerPoint.rowposition,"TMS",cboSRaceTms2.Value);
    dsOutRacerPoint.SetColumn(dsOutRacerPoint.rowposition,"RWNPT_GBN",przGbn);
    dsOutRacerPoint.SetColumn(dsOutRacerPoint.rowposition,"RWNPT_CD",titl);
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj) {
    if ( !fnc_DeleteCheck(dsOutRacerPoint, "chk", "1") ) return;
    
    grdOutRacerPoint.SetFocus();                                  //Record 삭제 후 Grid로 Focus
}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	fnc_GridSort(obj, object(obj.BindDataset), nCell);	
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {
    /*switch ( obj.id ) {
		case "imgCfrntCd" :
		    if ( dsOutRaceTms.GetRowCount() == "0" ) return;
		    var asReturn = Dialog("form::E02010031.xml", "", 834, 450, "");
		    
		    dsOutRaceTms.SetColumn(dsOutRaceTms.currow, "CFRNT_CD"     , asReturn[0]);
		    dsOutRaceTms.SetColumn(dsOutRaceTms.currow, "RACE_KINDS_CD", asReturn[1]);
		    
		    fcSearchCfrnt();
			break;
	}*/
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex){
	
	var sColIdx     = objGrd.GetCellText("HEAD", nRow, nCell);  //해당 HEAD명 
	                                            //Popup에서 받을 결과 값
	switch (sColIdx){
		case "부여일" : // 부여일
			fnc_SetPopupDivCalendar(objGrd, nRow, nCell);
			break;
		default :
			break;
	}	
}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
	if ( !fnc_Result(ErrorCode, ErrorMSG) ) return;
	
	// 공통코드 조회시
	if ( sServiceName == "common-service:searchCode" ) {
        fce_AddCodeRow(dsOutPrzGubn, "전체", "", cboSRwnptGbn);
        
        cboSMbr.Index = 0;
        cboSMbr.Value = fce_GetUserInfo("MBR_CD");        
        
        fce_GetRaceTms(cboSStndYear.Value,cboSMbr.Value,"","dsOutSRaceTms");
		return;
	}

    // 회차 리스트 조회시
	if ( sServiceName == "common_race-service:searchRaceTms" ) {
        cboSRaceTms1.Index = 0;
        cboSRaceTms2.Index = 0;
        if ( cboSStndYear.Value == CURR_STND_YEAR ) {
            var nIndexRow = fnc_GetExistValue(dsOutSRaceTms, "TMS", CURR_TMS);
            if ( nIndexRow > -1 ) cboSRaceTms1.Index = nIndexRow;
            if ( nIndexRow > -1 ) cboSRaceTms2.Index = nIndexRow;
        }       
        //일차가져오기
        fce_GetRaceDayOrd(cboSStndYear.Value, cboSMbr.Value, cboSRaceTms1.Value, "dsOutSRaceDayOrd");    

        //명칭조회
        fcTitlDisplay(dsOutTitl);

		return;
	}    

    // 조회 후
	if ( sServiceName == "e03080010-service:searchRacerPoint" ) {
        dsOutRacerPoint.AddColumn("chk");
        
        fnc_SetStatus(SNIS_BOA_0003, dsOutRacerPoint.GetRowCount());
	    if ( dsOutRacerPoint.GetColumn(dsOutRacerPoint.currow, "STND_YEAR") == 0 ) {
            return;
	    }
        
		return;
	}
	
	// 명칭 전체 조회 후
	if ( sServiceName == "e03080010-service:searchTitl" ) {
        /*if(dsOutTitl == null){
            dsOutTitl.AddColumn("")
        }*/
Trace(dsOutGrdTitl.savexml());        
        dsOutGrdTitl.Copy(dsOutTitl);
Trace(dsOutTitl.savexml());        
        fce_AddCodeRow(dsOutTitl, "전체", "", cboSTitl);
        //조회
        fcSearch();
	}
	
	// 명칭별 점수 조회 후
	if ( sServiceName == "e03080010-service:searchScr" ) {
        dsOutRacerPoint.SetColumn(dsOutRacerPoint.currow,"SCR", dsOutScr.GetColumn(0,"SCR"));
        return;
	}

	// 저장 후
	if ( sServiceName == "e03080010-service:SaveRacerPointInfo" ) {
        fcSearch();
		return;
	}

	// 일차 리스트 조회 후
	if ( sServiceName == "common_race-service:searchRaceDayOrd" ) {
        var beforeDate = fnc_calDate(dsOutSRaceDayOrd.GetColumn("0","RACE_DAY"),1,"Y");
        dsOutSRaceDayOrd.row = fnc_GetExistValue(dsOutSRaceDayOrd, "DAY_ORD", cboSRaceDayOrd.Value);

        //코드값 추가, 경기전일자 날짜 세팅---------------------------------------------------//
        var nRow = 0;
        bFirst = "";
        
        if ( !bFirst ) {
            dsOutSRaceDayOrd.InsertRow(nRow);
        } else {
            nRow = dsOutSRaceDayOrd.GetRowCount();
            dsOutSRaceDayOrd.AddRow();
        }

        dsOutSRaceDayOrd.SetColumn(nRow, "DAY_ORD" , "0");
        dsOutSRaceDayOrd.SetColumn(nRow, "RACE_DAY" , beforeDate);
        //---------------------------------------------------------------//
 	}
	//오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {

}

/*-------------------------------------------------------------------------------------------------+
>>  코드나 명 입력 후 Lost Focus 시 해당 정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcCodeNameDisplay(objGrd, nRow, nCell, nOldRow, nOldCell, strVal) {

}

function fcRacerDisplay(objGrd,nOldRow, nOldCell){

}

/*-------------------------------------------------------------------------------------------------+
>>  상벌점의 명칭 정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcTitlDisplay(obj){
    
    var sServiceName = "e03080010-service:searchTitl";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutTitl=dsOutTitl ";
    
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드의 상벌점의 명칭 정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcFilterTitl(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex){
    switch (obj.id){
        case "cboSRwnptGbn" :
            //상벌구분 조건에 맞는 명칭만 필터링
            var sFilter = "";
            dsOutTitl.UnFilter();
            if (cboSRwnptGbn.Value != "") {
                sFilter = "RWNPT_GBN='"+cboSRwnptGbn.Value+"'";
            }
            dsOutTitl.Filter(sFilter);
            break;
        case "dsOutRacerPoint" :
            //선수명 입력시 등록번호 SEARCH
            if(strColumnID == "NM_KOR"){
                dsOutRacerPoint_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex);
            }
            if(strColumnID == "ALLRACER_YN"){
                fcAllRacerchk(obj,nRow,strColumnID);
            }            
            if(strColumnID == "RWNPT_GBN"){
                //상벌구분 조건에 맞는 명칭만 필터링
                var strRWNPT_GBN = obj.GetColumn(obj.currow,"RWNPT_GBN");
                dsOutGrdTitl.UnFilter();
                var sFilter = "RWNPT_GBN='"+strRWNPT_GBN+"'";
                dsOutGrdTitl.Filter(sFilter);
            }
            //점수 가져오기
            if(strColumnID == "RWNPT_CD"){
                fcSearchScr(obj);
            }
            break;
         default :
			break;
    }   
}

/*-------------------------------------------------------------------------------------------------+
>>  명칭별 점수정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcSearchScr(obj) {
    var sServiceName = "e03080010-service:searchScr";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutScr=dsOutScr";
    
    fce_AddParam(Trim("STND_YEAR"), obj.GetColumn(obj.currow,"STND_YEAR"));
	fce_AddParam(Trim("RWNPT_GBN"), obj.GetColumn(obj.currow,"RWNPT_GBN"));
	fce_AddParam(Trim("RWNPT_CD"), obj.GetColumn(obj.currow,"RWNPT_CD"));
	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

/*-------------------------------------------------------------------------------------------------+
>>  선수명 입력시 등록번호를 가져와 세팅
+-------------------------------------------------------------------------------------------------*/
function dsOutRacerPoint_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID != "NM_KOR") return;
	
    var sRacerNo  = obj.GetColumn(nRow, "RACER_NO");
    var sRacerNm  = obj.GetColumn(nRow, "NM_KOR");

    if ( fnc_IsNull(sRacerNm) ) return;
    
    //등록번호가 입력안되었을때는 성명을 가지고 등록번호를 search
    if (!fnc_IsNull(sRacerNm) && fnc_IsNull(sRacerNo)) {            
        var sServiceName = "e03010010-service:searchRacer";
        var sInDataSet   = "";
        var sOutDataSet  = "dsOutSRacer=dsOutSRacer";
    
        fce_AddParam(Trim("NM_KOR       "), sRacerNm);
        
        http.sync = true;
        fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "", false);
        http.sync = false;

        var sRelaRacerNo = dsOutSRacer.GetColumn(dsOutSRacer.currow, "RACER_NO");
        //검색결과가 없거나 1건 이상이라면 선수검색창을 보여줌.
        if ( dsOutSRacer.GetRowCount() == 1 ) {
            obj.SetColumn(nRow, "RACER_NO"  , sRelaRacerNo);
        }else{
            obj.SetColumn(nRow, "RACER_NO"  , "");
            // Content로 넘겨지는 arguements
            var sArg = "Arg_sRacerNm=" + quote(sRacerNm);
            var sResponse = Dialog("form::E03010012.xml", sArg, 834, 450, "");
            
            if ( !fnc_IsNull(sResponse) ) {
                obj.SetColumn(nRow, "RACER_NO", sResponse[0]);
                obj.SetColumn(nRow, "NM_KOR"  , sResponse[1]);
            }
        }                
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  회차전원부여여부 처리
+-------------------------------------------------------------------------------------------------*/
function fcAllRacerchk(obj,nRow,strColumnID)
{
	if (strColumnID != "ALLRACER_YN") return;
    var sRacerNo  = obj.GetColumn(nRow, "RACER_NO");
	
	if (obj.GetColumn(nRow, "ALLRACER_YN")  == 1) {
        obj.SetColumn(nRow, "RACER_NO", "ALL");
    }else if (obj.GetColumn(nRow, "ALLRACER_YN")  == 0) {
        obj.SetColumn(nRow, "RACER_NO", "");
        obj.SetColumn(nRow, "NM_KOR", "");
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  년도, 분기 변경시
+-------------------------------------------------------------------------------------------------*/
function cboSStndYear_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    fcInit();
    fce_GetRaceTms(cboSStndYear.Value, cboSMbr.Value, "", "dsOutSRaceTms");
}

/*-------------------------------------------------------------------------------------------------+
>>  회차변경시
+-------------------------------------------------------------------------------------------------*/
function cboSRaceTms1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    var nRow = fnc_GetExistValue(dsOutSRaceTms, "Tms", cboSRaceTms1.Value);
    //일차가져오기
    fce_GetRaceDayOrd(cboSStndYear.Value, cboSMbr.Value, cboSRaceTms1.Value, "dsOutSRaceDayOrd");    

    fcSearch();	
}

function cboSRaceTms2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	var nRow = fnc_GetExistValue(dsOutSRaceTms, "Tms", cboSRaceTms2.Value);
    //일차가져오기
    fce_GetRaceDayOrd(cboSStndYear.Value, cboSMbr.Value, cboSRaceTms1.Value, "dsOutSRaceDayOrd");    
    
    fcSearch();	
}

/*-------------------------------------------------------------------------------------------------+
>>   상벌점현황 인쇄 버튼 클릭 시
+-------------------------------------------------------------------------------------------------*/
function btnPrtPointStat_OnClick(obj)
{
    if ( cboSRaceTms1.Value != cboSRaceTms2.Value)
    {
        fnc_Message(SNIS_BOA_C007, "N");
        return false;
    }	    
    fcPointStatData();
	
	var logImgUrl = GBL_REPORT_URL+"log.jpg";
	var sSubUrl   = "";                     //레포트 파일이 있는 서브디렉토리
	var sRptNm    = "e03089020_racer_pointstat.jrf";               //레포트 파일명
	var sDataSet  = "racer_pointstat=dsOutRacerPointStat";    //"UBI 쿼리명, MIP Dataset명"
	
	var calstDay = dsOutSRaceDayOrd.GetColumn("0","RACE_DAY");
	var caledDay = dsOutSRaceDayOrd.GetColumn(dsOutSRaceDayOrd.GetRowCount()-1,"RACE_DAY");
	var nstDay = GetDay(calstDay);
	var nedDay = GetDay(caledDay);
	var strstDay = Decode( nstDay, 0, "일", 1, "월", 2, "화", 
		3, "수", 4, "목", 5, "금", 6, "토" );
	var stredDay = Decode( nedDay, 0, "일", 1, "월", 2, "화", 
		3, "수", 4, "목", 5, "금", 6, "토" );
    
	var sArg   = " STND_YEAR="+cboSStndYear.Value;
        sArg  += " TMS="+cboSRaceTms1.Value;
		sArg  += " STRT_DATE="+calstDay;
		sArg  += " END_DATE="+caledDay;
		sArg  += " STRT_DAY="+strstDay;
		sArg  += " END_DAY="+stredDay;		
		sArg  += " IMG_URL="+logImgUrl; 
	var sRptDrct  = 1;                               //출력방향(0 : 수직, 1 : 수평)
	
	fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);	
}

/*-------------------------------------------------------------------------------------------------+
>>  레포트를 위한 상벌점현황정보 가져오기
+-------------------------------------------------------------------------------------------------*/
function fcPointStatData(obj) {
	var sServiceName = "e03080010-service:searchPointStat_rpt";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRacerPointStat=dsOutRacerPointStat  ";
    
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD"), cboSMbr.Value);
	fce_AddParam(Trim("TMS"), cboSRaceTms1.Value);

    http.sync = true;
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	http.sync = false;
}

/*-------------------------------------------------------------------------------------------------+
>>   선수별 상벌점현황 인쇄 버튼 클릭 시
+-------------------------------------------------------------------------------------------------*/
function btnPrtAllRacerPoint_OnClick(obj)
{
    var sTitle = "";
    if(obj.id == "btnPrtAllRacerPoint"){
        fcAllRacerPoint();
        sTitle = "전체선수별";        
    }else if(obj.id == "btnPrtRacerPoint"){
        fcRacerPoint();
        sTitle = "주선선수별";
	}
	
	var logImgUrl = GBL_REPORT_URL+"log.jpg";
	var sSubUrl   = "";                     //레포트 파일이 있는 서브디렉토리
	var sRptNm    = "e03089030_racerpoint_sum.jrf";               //레포트 파일명
	var sDataSet  = "racerpoint_sum=dsOutSumRacerPoint";    //"UBI 쿼리명, MIP Dataset명"
	
	var sArg   = " STND_YEAR="+cboSStndYear.Value;
        sArg  += " TMS1="+cboSRaceTms1.Value;
		sArg  += " TMS2="+cboSRaceTms2.Value;	
		sArg  += " TITLE="+sTitle;
		sArg  += " IMG_URL="+logImgUrl; 
	var sRptDrct  = 1;                               //출력방향(0 : 수직, 1 : 수평)
	
	fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
}

/*-------------------------------------------------------------------------------------------------+
>>  레포트를 위한 주선선수별 상벌점현황 가져오기
+-------------------------------------------------------------------------------------------------*/
function fcRacerPoint(obj) {
	var sServiceName = "e03080010-service:searchSumRacerPoint_rpt";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutSumRacerPoint=dsOutSumRacerPoint  ";
    
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD"), cboSMbr.Value);
	fce_AddParam(Trim("TMS1"), cboSRaceTms1.Value);
    fce_AddParam(Trim("TMS2"), cboSRaceTms2.Value);
    
    http.sync = true;
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	http.sync = false;
}

/*-------------------------------------------------------------------------------------------------+
>>  레포트를 위한 전체선수별 상벌점현황 가져오기
+-------------------------------------------------------------------------------------------------*/
function fcAllRacerPoint(obj) {
	var sServiceName = "e03080010-service:searchSumAllRacerPoint_rpt";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutSumRacerPoint=dsOutSumRacerPoint  ";
    
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD"), cboSMbr.Value);
	fce_AddParam(Trim("TMS1"), cboSRaceTms1.Value);
    fce_AddParam(Trim("TMS2"), cboSRaceTms2.Value);
    
    http.sync = true;
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	http.sync = false;
}

/*-------------------------------------------------------------------------------------------------+
>>  전체선수 회차별 상벌점현황 가져오기
+-------------------------------------------------------------------------------------------------*/
function btnPrtRacerPoint_OnClick(obj)
{
	var sServiceName = "e03080010-service:searchRacerTmsPoint";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRacerTmsPoint=dsOutRacerTmsPoint ";
    
	fce_AddParam(Trim("STND_YEAR"), cboSStndYear.Value);
	fce_AddParam(Trim("MBR_CD"), cboSMbr.Value);
	fce_AddParam(Trim("TMS1"), cboSRaceTms1.Value);
    fce_AddParam(Trim("TMS2"), cboSRaceTms2.Value);
    
    http.sync = true;
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	http.sync = false;
	
	grdOutRacerTmsPointPivot.ExportExcelEx("선수회차별상벌점("+cboSRaceTms1.Value+"_"+cboSRaceTms2.Value+").xls");

}
]]></Script>
</Window>