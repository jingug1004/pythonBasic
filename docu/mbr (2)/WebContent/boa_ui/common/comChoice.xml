<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="202" Id="comChoice" Left="8" OnKeyDown="fcFormOnKeyDown" OnLoadCompleted="fcFormLoadSetting" PidAttrib="7" Title="선택&#32;공통화면" Top="8" Ver="1.0" Width="468" WorkArea="true">
		<Static Height="20" Id="Static0" Left="6" Style="snis_txt" TabOrder="2" Text="*&#32;더블클릭&#32;또는&#32;Enter&#32;Key를&#32;누르시면&#32;선택&#32;됩니다!&#32;*" Top="177" VAlign="Middle" Width="324"></Static>
		<Grid AreaSelect="true" AutoFit="TRUE" BindDataset="gdsSelectItem" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="174" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadHeight="20" Height="170" Id="grdSelect" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" MultiSelect="TRUE" OnCellDBLClick="fcGridOnCellDblClick" OnKeyDown="fcGridOnKeyDown" Right="463" SelColor="user19" Style="styGrid01" TabOrder="0" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="459">
			<contents>
				<format id="Default">
					<columns>
						<col width="155"/>
						<col width="305"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" text="부서코드"/>
						<cell bkcolor="user20" col="1" colid="sGrdTit" color="user21" display="text" text="부서명"/>
					</head>
					<body>
						<cell col="0" display="text"/>
						<cell col="1" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="22" Id="divBtnConfirm" Left="357" TabOrder="3" Text="Div0" Top="175" Url="common::comButtonConfirm.xml" Width="108">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  01. 최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
	var iColumnCount   = gdsSelectItem.GetColCount();   //DataSet Column Count
	var sDataSetColumn = Array(iColumnCount);          //DataSet Column Count
	var sGridTitle     = split (sGrdTit,":");          //Grid Head Coulm Title
	var sContents      = '';                           //Grid Contents String
	var i              = 0;                            //Looper
	var iTotalWidth    = 0;                            //Grid Column Width Total
	var iTempWidth     = 0;                            //임시변수(Column Width를 구하기 위한)
	var sMaxData       = '';                           //특정 필드의  Max Data
	
	//Grid Head Title & DataSet Bind Column ID 구하기
	for (i=0; i<iColumnCount; i++) {
		sDataSetColumn[i] = gdsSelectItem.GetColID(i);
	}
	sContents  = ' <contents>' + chr(13);
	sContents += ' <columns>'  + chr(13);
	
	//Grid Column Width Setting
	for (i=0; i<iColumnCount; i++) {
		
		sMaxData = gdsSelectItem.Max(sDataSetColumn[i]);      //해당 컬럼의 최대값 구하기
		iTempWidth = iif(lengthb(sMaxData) > lengthb(sGridTitle[i]),
		                 lengthb(sMaxData)*10 ,
		                 lengthb(sGridTitle[i])*10);
		sContents   += '<col width='+quote(iTempWidth)+'/>'+chr(13);
		iTotalWidth += iTempWidth;
	}

	sContents += ' </columns>' + chr(13);
	sContents += ' <head>'     + chr(13);

	//Grid Column Head Title Display
	for (i=0; i<iColumnCount; i++) {
		sContents += ' <cell col='+quote(i)+' text='+quote(sGridTitle[i])+'/>'+chr(13);
	}
	
	sContents += ' </head>'    + chr(13);
	sContents += ' <body>'     + chr(13);

	//Grid Column DatsSet Bind
	for (i=0; i<iColumnCount; i++) {
		sContents += ' <cell col='+quote(i)+' colid='+quote(sDataSetColumn[i])+' display="text"/>'+chr(13);
	}

	sContents += ' </body>'     + chr(13);
    sContents += ' </contents>' + chr(13);
	
	//Grid Contents Setting & Column Width 
	grdSelect.Contents = sContents;
	if (iTotalWidth < grdSelect.Width) grdSelect.AutoFit = true;
	
}

/*-------------------------------------------------------------------------------------------------+
>>  02. Key Down (ESC)
+-------------------------------------------------------------------------------------------------*/
function fcFormOnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam){
	//ESC키 누르면 화면 종료
	if (nChar==27) Close(false);
}

/*-------------------------------------------------------------------------------------------------+
>>  03. Grid에서 Enter key
+-------------------------------------------------------------------------------------------------*/
function fcGridOnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {
	
	if (nChar==13) 	Close(true);
	
}

/*-------------------------------------------------------------------------------------------------+
>>  04. Grid에서 Double Click
+-------------------------------------------------------------------------------------------------*/
function fcGridOnCellDblClick(obj,nRow,nCell,nX,nY){
	Close(true);
}

/*-------------------------------------------------------------------------------------------------+
>>  05.확인 버튼 클릭
+-------------------------------------------------------------------------------------------------*/
function fcChoice(obj){
	Close(true);
}

/*-------------------------------------------------------------------------------------------------+
>>  06.취소 버튼 클릭
+-------------------------------------------------------------------------------------------------*/
function fcClose(obj){
	Close(false);
}]]></Script>
</Window>