<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbec_appo_exerc_organ(지정연습편성)">
      
    <query id="tbec_appo_exerc_fd001" desc="지정연습편성조회" fetchSize="10">
        <![CDATA[
				SELECT   A.STND_YEAR  				STND_YEAR,
				         A.MBR_CD     				MBR_CD,
				         A.TMS        				TMS,
				         A.DAY_ORD    				DAY_ORD,
				         A.RACE_NO    				RACE_NO,
				         A.RACER_NO   				RACER_NO,
				         B.NM_KOR     				RACER_NM,
				         A.RACE_REG_NO				RACE_REG_NO,
				         A.MOT_NO     				MOT_NO,
				         A.BOAT_NO    				BOAT_NO,
				         TO_CHAR(RUN_TM_0,'0.00')   RUN_TM_0,
				         TO_CHAR(RUN_TM,'0.00')     RUN_TM,
   				         TO_CHAR(OST_TM_0,'00.00')   OST_TM_0,
				         TO_CHAR(OST_TM,'00.00')     OST_TM,
				         NVL(A.FLYING_CNT_0,'') 	FLYING_CNT_0,
				         NVL(A.FLYING_CNT,'') 		FLYING_CNT,
				         NVL(A.LATE_CNT_0,'') 		LATE_CNT_0,
				         NVL(A.LATE_CNT,'') 		LATE_CNT,
				         A.RMK_0        			RMK_0,
				         A.RMK        				RMK,
				         C.DAY0_RUN_TM_0            DAY0_RUN_TM_0,
				         C.DAY0_RUN_TM              DAY0_RUN_TM,
				         C.DAY1_RUN_TM              DAY1_RUN_TM,
				         C.DAY2_RUN_TM              DAY2_RUN_TM,
				         A.INST_ID    				INST_ID,
				         A.INST_DTM   				INST_DTM,
				         A.UPDT_ID    				UPDT_ID,
				         A.UPDT_DTM  				UPDT_DTM
				  FROM   TBEC_APPO_EXERC_ORGAN A,
				         TBEC_RACER_MASTER B,
				         (SELECT RACER_NO,
				                 MAX(DECODE(DAY_ORD, 0, TO_CHAR(RUN_TM_0 ,'0.00'),'')) DAY0_RUN_TM_0,
				                 MAX(DECODE(DAY_ORD, 0, TO_CHAR(RUN_TM ,'0.00'),'')) DAY0_RUN_TM,
				                 MAX(DECODE(DAY_ORD, 1, TO_CHAR(RUN_TM ,'0.00'),'')) DAY1_RUN_TM,
				                 MAX(DECODE(DAY_ORD, 2, TO_CHAR(RUN_TM ,'0.00'),'')) DAY2_RUN_TM
				            FROM TBEC_APPO_EXERC_ORGAN
				           WHERE STND_YEAR   = ?
				             AND MBR_CD      = ?
				             AND TMS         = ?
				           GROUP BY RACER_NO ) C
				 WHERE   A.RACER_NO  	= B.RACER_NO
				   AND A.RACER_NO  	= C.RACER_NO
				   AND A.STND_YEAR 	= ?
				   AND A.MBR_CD    	= ?
				   AND A.TMS 		= ?
				   AND A.DAY_ORD	= ?
			     ORDER BY A.STND_YEAR,
				       A.MBR_CD,
				       A.TMS,
				       A.DAY_ORD,
				       A.RACE_NO,
				       A.RACE_REG_NO
        ]]>
    </query>
   
    
    <query id="tbec_appo_exerc_ud001" desc="지정연습편성수정" fetchSize="10">
        <![CDATA[
			UPDATE TBEC_APPO_EXERC_ORGAN SET
			      RUN_TM_0        =  CASE WHEN INSTR(NVL(?,0),'.') > 0  THEN ? ELSE DECODE(LENGTH(?),NULL,NULL,1,?,2,? /10,3,? /100)  END
			    , RUN_TM          =  CASE WHEN INSTR(NVL(?,0),'.') > 0  THEN ? ELSE DECODE(LENGTH(?),NULL,NULL,1,?,2,? /10,3,? /100)  END
			    , OST_TM_0        =  CASE WHEN INSTR(NVL(?,0),'.') > 0  THEN ? ELSE DECODE(LENGTH(?),NULL,NULL,1,?,2,? /10,? /100)  END
			    , OST_TM          =  CASE WHEN INSTR(NVL(?,0),'.') > 0  THEN ? ELSE DECODE(LENGTH(?),NULL,NULL,1,?,2,? /10,? /100)  END
			    , FLYING_CNT_0    = ?
			    , FLYING_CNT      = ?
			    , LATE_CNT_0      = ?
			    , LATE_CNT        = ?
			    , RMK_0   		  = ?
			    , RMK     		  = ?
			    , UPDT_ID         = ?
			    , UPDT_DTM        = SYSDATE
			WHERE STND_YEAR 	  = ?
			  AND MBR_CD    	  = ?
			  AND TMS 			  = ?
			  AND DAY_ORD		  = ?
			  AND RACE_NO		  = ?
			  AND RACER_NO     	  = ?
			  AND RACE_REG_NO     = ?
        ]]>
    </query>
    
</queryMap>