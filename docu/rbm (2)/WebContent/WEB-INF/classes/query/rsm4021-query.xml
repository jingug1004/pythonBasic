<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="RSM4021(°æÁÖ,½Â½Äº°½ÇÀû)">
	<query id="rsm4021_s01" desc="°æÁÖÀÏ Á¤º¸" fetchSize="10">
        <![CDATA[        
			 SELECT /* rsm4021_s01 */
			 		MEET_CD,
				   TO_CHAR(TO_DATE(RACE_DAY,'YYYYMMDD'),'YYYY-MM-DD') RACE_DAY,
				   RACE_YOIL,
				   DECODE(RACE_YOIL,'MON','¿ù','TUE','È­','WED','¼ö','THU','¸ñ','FRI','±Ý','SAT','Åä','SUN','ÀÏ') AS RACE_YOIL_KOR,
		           TMS||'È¸Â÷ '||DAY_ORD||'ÀÏÂ÷' AS RACE_DAY_INFO
		      FROM VW_SDL_INFO A
		      WHERE 1=1
		        AND MEET_CD		= ?
		        AND RACE_DAY	= ?                                                                                                     
        ]]>
    </query>


	<query id="rsm4021_s02" desc="Á¦¼¼±Ý" fetchSize="10">
        <![CDATA[        
			 SELECT  /* rsm4021_s02 */                                                     
			    P.MEET_CD,                                               
			    CASE                                                                    
			        WHEN P.SELL_CD='01' THEN '°æ·û'                         
			        WHEN P.SELL_CD='02' THEN 'Ã¢¿ø'                         
			        WHEN P.SELL_CD='03' THEN '°æÁ¤'                         
			        WHEN P.SELL_CD='04' THEN 'ºÎ»ê'                   
			   END MEET_NM,                                                         	    
			    DECODE(P.SELL_CD,NULL,'TOTAL',P.SELL_CD) SELL_CD,        
			    SUM(COMMI_1+COMMI_2+COMMI_3+COMMI_4+COMMI_5+COMMI_6) TOT,
			    SUM(NET_AMT) NET_AMT,                                    
			    SUM(COMMI_1) COMMI_1,                                    
			    SUM(COMMI_2) COMMI_2,                                    
			    SUM(COMMI_3) COMMI_3,                                    
			    SUM(COMMI_4) COMMI_4,                                    
			    SUM(POSI_BREAK-NEGA_BREAK) POSI_BREAK,                   
			    SUM(COMMI_5) COMMI_5,                                    
			    SUM(COMMI_6) COMMI_6                                     
			 FROM                                                          
			     VW_SDL_INFO V,		-- °æÁÖÀÏ Á¤º¸                                            
			     VW_PC_PAYOFFS P 	-- ¼¼±Ý°ü·Ã³»¿ª                                                   
			 WHERE 1=1                                                         
			     AND V.RACE_DAY		= ?	-- 0:RACE_DAY °æÁÖÀÏ                                    
			     AND V.MEET_CD		= ? -- 1:MEET_CD °æ·û ±¸ºÐ ÄÚµå                              
			     AND P.MEET_CD=V.MEET_CD                                   
			     AND P.STND_YEAR=V.STND_YEAR                               
			     AND P.TMS=V.TMS                                           
			     AND P.DAY_ORD=V.DAY_ORD                                 
			 GROUP BY                                                      
			     P.MEET_CD,P.SELL_CD                                              
			     -- ROLLUP(P.SELL_CD)                                       
			 ORDER BY SELL_CD                                                                                                     
        ]]>
    </query>
    

	<query id="rsm4021_s03" desc="°æÁÖº°/½Â½Äº° ¸ÅÃâ¾×" fetchSize="10">
        <![CDATA[        
			  SELECT	/* rsm4021_s03 */                                                                          
				   P.MEET_CD,                                                                    
				   DECODE(P.RACE_NO,NULL,0,P.RACE_NO) RACE_NO,                                   
				   DECODE(P.RACE_NO,NULL,'TOTAL',P.RACE_NO) RACE,	-- °æÁÖ                                
				
				   SUM(CASE WHEN POOL_CD='001' THEN P.NET_AMT END) TOT_001,	-- ÀüÃ¼ ´Ü½Â
				   SUM(CASE WHEN POOL_CD='002' THEN P.NET_AMT END) TOT_002,	-- ÀüÃ¼ ¿¬½Â
				   SUM(CASE WHEN POOL_CD='004' THEN P.NET_AMT END) TOT_004,	-- ÀüÃ¼ ½Ö½Â
				   SUM(CASE WHEN POOL_CD='005' THEN P.NET_AMT END) TOT_005, -- ÀüÃ¼ º¹½Â
				   SUM(CASE WHEN POOL_CD='006' THEN P.NET_AMT END) TOT_006, -- ÀüÃ¼ »ïº¹½Â
				   SUM(CASE WHEN POOL_CD='007' THEN P.NET_AMT END) TOT_007, -- ÀüÃ¼ »ï½Ö½Â
				   --SUM(CASE WHEN POOL_CD='008' THEN P.NET_AMT END) TOT_008, -- ÀüÃ¼ ½Öº¹½Â
				
				   SUM(CASE WHEN P.SELL_CD='01' AND POOL_CD='001' THEN P.NET_AMT END) TOT_01_001,	-- ±¤¸í ´Ü½Â
				   SUM(CASE WHEN P.SELL_CD='01' AND POOL_CD='002' THEN P.NET_AMT END) TOT_01_002,	-- ±¤¸í ¿¬½Â
				   SUM(CASE WHEN P.SELL_CD='01' AND POOL_CD='004' THEN P.NET_AMT END) TOT_01_004,	-- ±¤¸í ½Ö½Â
				   SUM(CASE WHEN P.SELL_CD='01' AND POOL_CD='005' THEN P.NET_AMT END) TOT_01_005,	-- ±¤¸í º¹½Â
				   SUM(CASE WHEN P.SELL_CD='01' AND POOL_CD='006' THEN P.NET_AMT END) TOT_01_006,	-- ±¤¸í »ïº¹½Â
				   SUM(CASE WHEN P.SELL_CD='01' AND POOL_CD='007' THEN P.NET_AMT END) TOT_01_007,	-- ±¤¸í »ï½Ö½Â
				   --SUM(CASE WHEN P.SELL_CD='01' AND POOL_CD='008' THEN P.NET_AMT END) TOT_01_008,	-- ±¤¸í ½Öº¹½Â
				   
				   SUM(CASE WHEN P.SELL_CD='02' AND POOL_CD='001' THEN P.NET_AMT END) TOT_02_001,	-- Ã¢¿ø ´Ü½Â
				   SUM(CASE WHEN P.SELL_CD='02' AND POOL_CD='002' THEN P.NET_AMT END) TOT_02_002,	-- Ã¢¿ø ¿¬½Â
				   SUM(CASE WHEN P.SELL_CD='02' AND POOL_CD='004' THEN P.NET_AMT END) TOT_02_004,	-- Ã¢¿ø ½Ö½Â
				   SUM(CASE WHEN P.SELL_CD='02' AND POOL_CD='005' THEN P.NET_AMT END) TOT_02_005,	-- Ã¢¿ø º¹½Â
				   SUM(CASE WHEN P.SELL_CD='02' AND POOL_CD='006' THEN P.NET_AMT END) TOT_02_006, 	-- Ã¢¿ø »ïº¹½Â
				   SUM(CASE WHEN P.SELL_CD='02' AND POOL_CD='007' THEN P.NET_AMT END) TOT_02_007, 	-- Ã¢¿ø »ï½Ö½Â
				   --SUM(CASE WHEN P.SELL_CD='02' AND POOL_CD='008' THEN P.NET_AMT END) TOT_02_008, 	-- Ã¢¿ø ½Öº¹½Â
				   
				   SUM(CASE WHEN P.SELL_CD='03' AND POOL_CD='001' THEN P.NET_AMT END) TOT_03_001,	-- °æÁ¤ ´Ü½Â
				   SUM(CASE WHEN P.SELL_CD='03' AND POOL_CD='002' THEN P.NET_AMT END) TOT_03_002,	-- °æÁ¤ ¿¬½Â
				   SUM(CASE WHEN P.SELL_CD='03' AND POOL_CD='004' THEN P.NET_AMT END) TOT_03_004,	-- °æÁ¤ ½Ö½Â
				   SUM(CASE WHEN P.SELL_CD='03' AND POOL_CD='005' THEN P.NET_AMT END) TOT_03_005,	-- °æÁ¤ º¹½Â
				   SUM(CASE WHEN P.SELL_CD='03' AND POOL_CD='006' THEN P.NET_AMT END) TOT_03_006, 	-- °æÁ¤ »ïº¹½Â
				   SUM(CASE WHEN P.SELL_CD='03' AND POOL_CD='007' THEN P.NET_AMT END) TOT_03_007, 	-- °æÁ¤ »ï½Ö½Â
				   --SUM(CASE WHEN P.SELL_CD='03' AND POOL_CD='008' THEN P.NET_AMT END) TOT_03_008, 	-- °æÁ¤ ½Öº¹½Â
				   
				   SUM(CASE WHEN P.SELL_CD='04' AND POOL_CD='001' THEN P.NET_AMT END) TOT_04_001,	-- ºÎ»ê ´Ü½Â
				   SUM(CASE WHEN P.SELL_CD='04' AND POOL_CD='002' THEN P.NET_AMT END) TOT_04_002,	-- ºÎ»ê ¿¬½Â
				   SUM(CASE WHEN P.SELL_CD='04' AND POOL_CD='004' THEN P.NET_AMT END) TOT_04_004,	-- ºÎ»ê ½Ö½Â
				   SUM(CASE WHEN P.SELL_CD='04' AND POOL_CD='005' THEN P.NET_AMT END) TOT_04_005,	-- ºÎ»ê º¹½Â
				   SUM(CASE WHEN P.SELL_CD='04' AND POOL_CD='006' THEN P.NET_AMT END) TOT_04_006,   -- ºÎ»ê »ïº¹½Â
				   SUM(CASE WHEN P.SELL_CD='04' AND POOL_CD='007' THEN P.NET_AMT END) TOT_04_007   -- ºÎ»ê »ï½Ö½Â
				   --SUM(CASE WHEN P.SELL_CD='04' AND POOL_CD='008' THEN P.NET_AMT END) TOT_04_008    -- ºÎ»ê ½Öº¹½Â                              
				 FROM                                                                            
				     VW_SDL_INFO V,                                                              
				     VW_PC_PAYOFFS P                                                           
				 WHERE 1=1                                                                            
				     AND V.RACE_DAY	= ? -- 0:RACE_DAY °æÁÖÀÏ                                                        
				     AND V.MEET_CD	= ? -- 1:MEET_CD °æ·û °æÁ¤ ±¸ºÐ ÄÚµå                                                      
				     AND P.MEET_CD=V.MEET_CD                                                     
				     AND P.STND_YEAR=V.STND_YEAR                                                 
				     AND P.TMS=V.TMS                                                             
				     AND P.DAY_ORD=V.DAY_ORD                                                     
				 GROUP BY                                                                        
				     P.MEET_CD,P.RACE_NO                                                                  
--				     ROLLUP(P.RACE_NO)                                                           
				 ORDER BY 2                                                                                                                                                                                                                                    
        ]]>
    </query>
    
    
    <query id="rsm4021_s04" desc="±³Â÷ °æÁÖ ½Â½Äº° ¸ÅÃâ¾×" fetchSize="10">
        <![CDATA[        
			 SELECT /* rsm4021_s04 */                                                                           
			   P.MEET_CD,	-- ±¸ºÐ ÄÚµå                                                                     
			   CASE                                                                                          
			        WHEN P.MEET_CD='002' THEN 'Ã¢¿ø±³Â÷'                                              
			        WHEN P.MEET_CD='004' THEN 'ºÎ»ê±³Â÷'                        
			   END MEET_NM,									-- ±¸ºÐ                                                        
			   DECODE(P.RACE_NO,NULL,0,P.RACE_NO) RACE_NO,  -- °æÁÖ¹øÈ£                            
			   DECODE(P.RACE_NO,NULL,'TOTAL',P.RACE_NO) RACE,	-- °æÁÖ                        
			   SUM(CASE WHEN POOL_CD='001' THEN P.NET_AMT END) TOT_01_001,	-- ´Ü½Â 
			   SUM(CASE WHEN POOL_CD='002' THEN P.NET_AMT END) TOT_01_002,	-- ¿¬½Â
			   SUM(CASE WHEN POOL_CD='004' THEN P.NET_AMT END) TOT_01_004,	-- ½Ö½Â
			   SUM(CASE WHEN POOL_CD='005' THEN P.NET_AMT END) TOT_01_005,	-- º¹½Â
			   SUM(CASE WHEN POOL_CD='006' THEN P.NET_AMT END) TOT_01_006,  -- »ïº¹½Â
			   SUM(CASE WHEN POOL_CD='007' THEN P.NET_AMT END) TOT_01_007  -- »ï½Ö½Â
			   --SUM(CASE WHEN POOL_CD='008' THEN P.NET_AMT END) TOT_01_008   -- ½Öº¹½Â                            
			 FROM                                                                             
			     VW_SDL_INFO V,         -- °æÁÖÀÏ Á¤º¸                                                      
			     VW_PC_PAYOFFS P     	-- ¼¼±Ý°ü·Ã³»¿ª                                                            
			 WHERE 1=1                                                                           
			     AND V.RACE_DAY	= ? -- 0:RACE_DAY                                                         
			     AND V.MEET_CD NOT IN ('001','003')                                           
			     AND P.MEET_CD=V.MEET_CD                                                      
			     AND P.STND_YEAR=V.STND_YEAR                                                  
			     AND P.TMS=V.TMS                                                              
			     AND P.DAY_ORD=V.DAY_ORD                                                      
			 GROUP BY                                                                         
			     P.MEET_CD,P.RACE_NO                                                                   
			     -- ROLLUP(P.RACE_NO)                                                            
			 ORDER BY MEET_CD,RACE_NO                                                                                                                                                              
        ]]>
    </query>
</queryMap>