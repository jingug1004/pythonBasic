<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="REM1010" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="입장거부자" Top="8" Ver="1.0" Width="816" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsBrncCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>018</CD_GRP_ID>
						<DESCRIPTION>지점코드</DESCRIPTION>
						<DSNAME>dsBrncCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>018</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsBrncCdSearch</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>014</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsEntRefuCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>014</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsEntRefuCdSearch</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>016</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsEntRefuTyCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>016</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsEntRefuTyCdSearch</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>017</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsAgeCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>044</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsSex</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>070</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsMeetCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsBrncCdSearch"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsEntRefuMana" OnColumnChanged="fcDsOnColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEX" size="256" summ="default" type="STRING"/>
					<colinfo id="AGE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TERM_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TERM_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="FACE_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_CNTNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TY_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="AGE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEX_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE1" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE2" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE3" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE4" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEntRefuCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsEntRefuCdSearch"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsEntRefuTyCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsEntRefuTyCdSearch"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsAgeCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsSex"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsUploadFile" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CLS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_URL" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="CONTENT" size="256" summ="default" type="BLOB"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="5" summ="default" type="INT"/>
					<colinfo id="SEQ" size="5" summ="default" type="INT"/>
					<colinfo id="TBL_NM" size="50" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="100" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="100" summ="default" type="STRING"/>
					<colinfo id="REAL_FILE_NM" size="200" summ="default" type="STRING"/>
					<colinfo id="ORD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInUploadFile">
				<Contents>
					<colinfo id="CLS_CD" size="256" type="STRING"/>
					<colinfo id="SEQ_NO" size="256" type="STRING"/>
					<colinfo id="FILE_SEQ" size="256" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" type="STRING"/>
					<colinfo id="FILE_URL" size="256" type="STRING"/>
					<colinfo id="FILE_SIZE" size="256" type="STRING"/>
					<colinfo id="INST_ID" size="256" type="STRING"/>
					<colinfo id="INST_DTM" size="256" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" type="STRING"/>
					<colinfo id="UPDT_DTM" size="256" type="STRING"/>
					<colinfo encrypt="base64" id="CONTENT" size="256" type="BLOB"/>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" type="STRING"/>
					<colinfo id="MAKE_MAN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFileMana">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="5" summ="default" type="INT"/>
					<colinfo id="SEQ" size="5" summ="default" type="INT"/>
					<colinfo id="TBL_NM" size="50" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="100" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="100" summ="default" type="STRING"/>
					<colinfo id="REAL_FILE_NM" size="200" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="10" summ="default" type="INT"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsTms"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsMeetCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsEntRefuManaPrint" OnColumnChanged="fcDsOnColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEX" size="256" summ="default" type="STRING"/>
					<colinfo id="AGE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TERM_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TERM_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="FACE_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="DTL_CNTNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_REFU_TY_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="AGE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEX_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE1" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE2" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE3" size="256" summ="default" type="STRING"/>
					<colinfo id="IMG_FILE4" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Font="굴림,9,Bold" Height="343" Id="Static0" Left="8" TabOrder="28" Top="223" Type="Groupbox" Width="801"></Static>
		<Shape BKColor="user0" Bottom="86" Height="56" Id="Shape1" Left="8" LineColor="user1" LineKind="Vertical" Right="809" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="0" Top="30" Type="RoundRect" Width="801"></Shape>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="0" Top="2" Width="11"></Image>
		<Static Align="Right" Height="22" Id="stFormLocation" Left="209" Style="styFormLocation" TabOrder="23" Top="4" VAlign="Middle" Width="288"></Static>
		<Div Height="28" Id="divBtnLst" Left="437" TabOrder="0" Text="Div0" Url="common::comButtonType.xml" Width="374">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsEntRefuMana" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="208" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="104" Id="grdEntRefuMana" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="809" SelColor="user19" Style="snis_grid" TabOrder="25" TabStop="true" Top="104" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="801">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="57"/>
						<col width="54"/>
						<col width="45"/>
						<col width="70"/>
						<col width="55"/>
						<col width="54"/>
						<col width="68"/>
						<col width="68"/>
						<col width="37"/>
						<col width="54"/>
						<col width="115"/>
						<col width="112"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="checkbox" edit="checkbox"/>
						<cell col="1" color="user21" display="text" font="굴림,9,Bold" text="지점"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="회차"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" text="시행처"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="경주일"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="구분"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9,Bold" text="유형"/>
						<cell bkcolor="user20" col="7" color="user21" colspan="2" display="text" font="굴림,9,Bold" text="입장거부기간"/>
						<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9,Bold" text="성별"/>
						<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9,Bold" text="연령대"/>
						<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9,Bold" text="인상착의"/>
						<cell bkcolor="user20" col="12" color="user21" display="text" font="굴림,9,Bold" text="주요내용"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="BRNC_CD" combocol="CD" combodataset="dsBrncCd" combotext="CD_NM" display="combo" suppress="1" SuppressAlign="Middle"/>
						<cell align="center" col="2" colid="TMS" display="number" limit="2" suppress="2" SuppressAlign="Middle"/>
						<cell align="center" col="3" colid="MEET_NM" display="text"/>
						<cell align="center" col="4" colid="RACE_DT" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' display="date"/>
						<cell align="center" col="5" colid="ENT_REFU_CD" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' combocol="CD" combodataset="dsEntRefuCd" combotext="CD_NM" display="combo"/>
						<cell align="center" col="6" colid="ENT_REFU_TY_CD" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' combocol="CD" combodataset="dsEntRefuTyCd" combotext="CD_NM" display="combo"/>
						<cell align="center" col="7" colid="ENT_REFU_TERM_FROM" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' display="date"/>
						<cell align="center" checklength="Byte" col="8" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' combodisplaynltext="true" display='expr:iif(&#32;dsEntRefuMana.GetColumn(row,&#32;&quot;ENT_REFU_TERM_TO&quot;).length&#32;&gt;&#32;0&#32;,&#32;&quot;date&quot;,&#32;&quot;text&quot;)' expr='iif(&#32;dsEntRefuMana.GetColumn(row,&#32;&quot;ENT_REFU_TERM_TO&quot;).length&#32;&gt;&#32;0&#32;,&#32;dsEntRefuMana.GetColumn(row,&#32;&quot;ENT_REFU_TERM_TO&quot;),&#32;&quot;영구&quot;)'/>
						<cell align="center" col="9" colid="SEX" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' combocol="CD" combodataset="dsSex" combotext="CD_NM" display="combo"/>
						<cell col="10" colid="AGE_CD" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' combocol="CD" combodataset="dsAgeCd" combotext="CD_NM" display="combo"/>
						<cell col="11" colid="FACE_DESC" color='expr:DECODE(NEW_FLAG,&#32;&quot;01&quot;,&#32;&quot;RED&quot;,&#32;&quot;02&quot;,&#32;&quot;BLUE&quot;,&#32;&quot;DEFAULT&quot;)' display="text" multiline="true"/>
						<cell col="12" colid="DTL_CNTNT" display="text" multiline="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Border="None" Height="20" Id="Static1" Left="14" Style="snis_if_lable" TabOrder="26" Text="인상착의" Top="61" VAlign="Middle" Width="54"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" CheckLength="Byte" Height="20" Id="edFaceDescSearch" Left="74" LeftMargin="2" MaxLength="1000" OnKeyDown="fcEdOnKeyDown" Style="snis_if_input01" TabOrder="6" Top="61" Width="336"></Edit>
		<Div Height="20" Id="entBtnRow" Left="771" Style="snis_grid" TabOrder="27" Text="Div0" ToolTipText="그룹코드" Top="87" Url="common::comButtonRow.xml" Width="40">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Border="Flat" Height="21" Id="Static4" Left="17" Style="snis_m_lable" TabOrder="29" Text="지점" Top="237" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Border="Flat" Height="21" Id="Static11" Left="207" Style="snis_m_lable" TabOrder="30" Text="경주일" Top="237" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Border="Flat" Height="21" Id="Static7" Left="398" Style="snis_m_lable" TabOrder="31" Text="구분" Top="259" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static8" Left="207" Style="snis_m_lable" TabOrder="32" Text="연령대" Top="259" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static14" Left="17" Style="snis_m_lable" TabOrder="33" Text="성별" Top="259" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Border="Flat" Height="51" Id="Static21" Left="17" Style="snis_m_lable" TabOrder="34" Text="인상착의" Top="282" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="dsEntRefuMana" Border="Flat" CodeColumn="CD" Column="SEX" DataColumn="CD_NM" Height="22" Id="cboSex" InnerDataset="dsSex" Left="105" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="11" Top="258" UserData="S" Width="102"></Combo>
		<Combo BindDataset="dsEntRefuMana" Border="Flat" CodeColumn="CD" Column="ENT_REFU_CD" DataColumn="CD_NM" Height="21" Id="cboEntRefuCd" InnerDataset="dsEntRefuCd" Left="486" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="13" Top="258" UserData="S" Width="105"></Combo>
		<Calendar BindDataset="dsEntRefuMana" Border="Flat" Column="RACE_DT" Height="21" Id="calRaceDt" Left="296" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="8" Top="237" UserData="S" Width="100"></Calendar>
		<TextArea BindDataset="dsEntRefuMana" Border="Flat" CheckLength="Byte" Column="FACE_DESC" Height="51" Id="taFaceDesc" Left="106" MaxLength="1000" Style="snis_if_input01" TabOrder="15" Top="282" UserData="S" Width="693"></TextArea>
		<Static Align="Right" Border="Flat" Height="22" Id="Static2" Left="529" Style="snis_m_lable" TabOrder="35" Text="입장거부기간" Top="236" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Border="Flat" Height="51" Id="Static3" Left="17" Style="snis_m_lable" TabOrder="36" Text="주요내용" Top="334" VAlign="Middle" Width="88"></Static>
		<TextArea BindDataset="dsEntRefuMana" Border="Flat" CheckLength="Byte" Column="DTL_CNTNT" Height="51" Id="taDtlCntnt" Left="106" MaxLength="2000" Style="snis_if_input01" TabOrder="16" Top="334" UserData="S" Width="693"></TextArea>
		<Calendar BindDataset="dsEntRefuMana" Border="Flat" Column="ENT_REFU_TERM_FROM" Height="22" Id="calEntRefuTermFrom" Left="619" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="9" Top="236" UserData="S" Width="90"></Calendar>
		<Calendar BindDataset="dsEntRefuMana" Border="Flat" Column="ENT_REFU_TERM_TO" Height="22" Id="calEntRefuTermTo" Left="710" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="10" Top="236" UserData="S" Width="90"></Calendar>
		<Static Align="Right" BKColor="user0" Border="None" Color="user5" Height="20" Id="Static5" Left="14" Style="snis_if_lable" TabOrder="37" Text="지점" Top="36" VAlign="Middle" Width="55"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboBrncCdSearch" ImeMode="none" InnerDataset="dsBrncCdSearch" Left="73" OnChanged="fcCboOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="1" Top="36" Width="117">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Static Align="Right" BKColor="user0" Border="None" Color="user5" Height="20" Id="Static6" Left="198" Style="snis_if_lable" TabOrder="38" Text="구분" Top="36" VAlign="Middle" Width="32"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboEntRefuCdSearch" ImeMode="none" InnerDataset="dsEntRefuCdSearch" Left="236" OnChanged="fcCboOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="2" Top="36" Width="117">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Static Align="Right" Border="None" Height="20" Id="Static9" Left="421" Style="snis_if_lable" TabOrder="39" Text="주요내용" Top="61" VAlign="Middle" Width="54"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" CheckLength="Byte" Height="20" Id="edDtlCntntSearch" Left="478" LeftMargin="2" MaxLength="2000" OnKeyDown="fcEdOnKeyDown" Style="snis_if_input01" TabOrder="7" Top="61" Width="287"></Edit>
		<Static Align="Right" Border="None" Height="20" Id="Static10" Left="519" Style="snis_if_lable" TabOrder="40" Text="발생일자" Top="36" VAlign="Middle" Width="54"></Static>
		<Calendar BindDataset="dsList" Border="Flat" Height="22" Id="calFromDt" Left="576" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="4" Top="36" Width="90"></Calendar>
		<Calendar BindDataset="dsList" Border="Flat" Height="22" Id="calToDt" Left="675" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="5" Top="36" Width="90"></Calendar>
		<Static Height="20" Id="stFormTitle" Left="19" Style="snis_m_title" TabOrder="41" Text="입장거부자관리" VAlign="Middle" Width="430"></Static>
		<Combo BindDataset="dsEntRefuMana" Border="Flat" CodeColumn="CD" Column="AGE_CD" DataColumn="CD_NM" Height="22" Id="cboAgeCd" InnerDataset="dsAgeCd" Left="295" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="12" Top="258" UserData="S" Width="102"></Combo>
		<Static Align="Right" Border="Flat" Height="21" Id="Static12" Left="594" Style="snis_m_lable" TabOrder="42" Text="유형" Top="259" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="dsEntRefuMana" Border="Flat" CodeColumn="cD" Column="ENT_REFU_TY_CD" DataColumn="CD_NM" Height="21" Id="cboEntRefuTyCd" InnerDataset="dsEntRefuTyCd" Left="682" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="14" Top="258" UserData="S" Width="119"></Combo>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboEntRefuTyCdSearch" ImeMode="none" InnerDataset="dsEntRefuTyCdSearch" Left="395" OnChanged="fcCboOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="3" Top="36" Width="117">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Static Align="Right" BKColor="user0" Border="None" Color="user5" Height="20" Id="Static13" Left="358" Style="snis_if_lable" TabOrder="43" Text="유형" Top="36" VAlign="Middle" Width="32"></Static>
		<Image Border="Flat" BorderColor="user3" FillType="STRETCH" Height="144" Hilight3dColor="user5" Id="img1" Left="17" OnClick="fcImgOnClick" OnLoadCompleted="fcImgOnLoadCompleted" Static="FALSE" TabOrder="17" Top="408" Width="192"></Image>
		<Image Border="Flat" BorderColor="user3" FillType="STRETCH" Height="144" Hilight3dColor="user5" Id="img2" Left="214" OnClick="fcImgOnClick" OnLoadCompleted="fcImgOnLoadCompleted" Static="FALSE" TabOrder="18" Top="408" Width="192"></Image>
		<Image Border="Flat" BorderColor="user3" FillType="STRETCH" Height="144" Hilight3dColor="user5" Id="img3" Left="410" OnClick="fcImgOnClick" OnLoadCompleted="fcImgOnLoadCompleted" Static="FALSE" TabOrder="19" Top="408" Width="192"></Image>
		<Image Border="Flat" BorderColor="user3" FillType="STRETCH" Height="144" Hilight3dColor="user5" Id="img4" Left="606" OnClick="fcImgOnClick" OnLoadCompleted="fcImgOnLoadCompleted" Static="FALSE" TabOrder="20" Top="408" Width="192"></Image>
		<Div Height="18" Id="imgBtnRow" Left="758" TabOrder="44" Text="Div0" Top="387" Url="common::comButtonRow.xml" UserData="S" Width="40">
			<Contents></Contents>
		</Div>
		<FileDialog Bottom="24" Filter="All(*.*)|*.*|JPEG(*.jpeg)|*.jpeg|BMP(*.bmp)|*.bmp|GIF(*.gif)|*.gif|" Height="24" Id="fdSaveAs" Left="408" Right="432" TabOrder="48" Width="24"></FileDialog>
		<Combo BindDataset="dsEntRefuMana" Border="Flat" CodeColumn="CD" Column="BRNC_CD" DataColumn="CD_NM" Enable="FALSE" Height="21" Id="cboBrncCd" InnerDataset="dsBrncCd" Left="105" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="44" Top="236" Width="102"></Combo>
		<Static Align="Right" Border="Flat" Height="21" Id="Static15" Left="398" Style="snis_m_lable" TabOrder="46" Text="시행처" Top="237" VAlign="Middle" Width="68"></Static>
		<Edit AutoSelect="TRUE" BindDataset="dsEntRefuMana" Border="Flat" CheckLength="Byte" Column="MEET_NM" Enable="FALSE" Height="20" Id="edMeetCd" Left="469" LeftMargin="2" MaxLength="1000" Readonly="TRUE" Style="snis_if_input01" TabOrder="47" Top="237" Width="56"></Edit>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         수정 사항                                                
* 2012.06.10(일)
* 요청자 : 안전관리팀 이욱
* 수정사항
* 1) 지점 및 입장관리관련 부서 직원은 로그인시 최근 48시가내에 입장거부자 등록 여부를 체크하여
*    대메뉴의 입장관리 부분에 "New"표시를 한다.
*     -> 지점코드로 구분하며, 지점이 광명으로 된 경우 공통코드 130에 등록된 팀코드로 구분한다.
* 2) 각 담당자가 입장관리화면에서 조회를 하면 깜빡이는 것이 사라짐
* 3) 또한 30분 간격으로 추가 등록 또는 변경 여부를 체크한다.
* 4) 입장관리화면에서는 최근 48시간 이내 신규 등록의 경우 빨간색, 변경인 경우 파란색으로 표시한다.
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = this.GetForm().id;
var sBUTTONLIST   = 'FFFFTFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var sMenuGrpNum     = "0";                         	   // 메뉴그룹의 갯수보관
var sMenuListNum    = "0";                             // 메뉴리스트의 갯수보관
var sMenuUpId       = "";
var sMenuUpNm       = "";
var sMsg            = "";								// 삭제 불가능 row 보관

var BORDER_DEF      = "flat";
var BORDER_SET		= "Raised";

var BORDER_COLOR_DEF = "User3";
var BORDER_COLOR_SET = "User5";

var imgcomp_width = 192;
var imgcomp_height = 144;

//var BORDER_DEF      = "Flat";
//var BORDER_SET		= "RaisedEdge";


var sCurDate = fcd_GetSysdate("YYYYMMDD");				// 시스템의 오늘날짜
var sCurYear = substr(sCurDate, 0, 4);					// 시스템의 현재년도
var sUserBrncCd = fcd_GetUserBrncCd();

/***************************************************************************************************
*                                         Form 처리 부분                                           *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'TTTFTTT';
  
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
    
    //공통코드 조회
    fcd_GetComboDs(dsInComCd);
    
    // 조회 조건의 날짜(올해 1월1일 ~ today)
    calToDt  .Value = sCurDate;
    calFromDt.Value = sCurYear + '0101';
    
    
    //조회 조건의 지점에는 '전체'를 추가한다.
    if( dsBrncCdSearch.rowcount > 0 ) {
		dsBrncCdSearch.InsertRow(0);
		dsBrncCdSearch.SetColumn(0, "CD_NM", "전체");
		//cboBrncCdSearch.index = 0;
		
		cboBrncCdSearch.value = sUserBrncCd;
	}
	//조회 조건의 구분에는 '전체'를 추가한다.
	if( dsEntRefuCdSearch.rowcount > 0 ) {
		dsEntRefuCdSearch.InsertRow(0);
		dsEntRefuCdSearch.SetColumn(0, "CD_NM", "전체");
		cboEntRefuCdSearch.index = 0;
	}
	
	//조회 조건의 유형에는 '전체'를 추가한다.
	if( dsEntRefuTyCdSearch.rowcount > 0 ) {
		dsEntRefuTyCdSearch.InsertRow(0);
		dsEntRefuTyCdSearch.SetColumn(0, "CD_NM", "전체");
		cboEntRefuTyCdSearch.index = 0;
	}
	
	fcSearch();	//시작시 조회
	
	
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는 DataSet Object를 넘긴다.
	var sDataset = "dsEntRefuMana|dsUploadFile";
	if ( !fnc_FormUnloadCheck(sDataset, sFormId) ) return false;
}

/***************************************************************************************************
*                                      업무화면 공통 버튼 Event 처리 부분                          *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  초기화 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
    dsEntRefuMana.ClearData();
    dsUploadFile .ClearData();
    
    img1.ImageID = "";
	img2.ImageID = "";
	img3.ImageID = "";
	img4.ImageID = "";
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
    edFaceDescSearch.Text = Trim(edFaceDescSearch.Text);
    edDtlCntntSearch.Text = Trim(edDtlCntntSearch.Text);
	fcInit(obj);
	
	return true;
}

function fcSearch(obj) {
    if ( !fcSearchCheck(obj) ) return;
    
	var sServiceName = "rem1010-service:searchEntRefuMana";
    var sInDataSet   = "";
    var sOutDataSet  = "dsEntRefuMana=dsEntRefuMana ";     
    
    //조회조건
    fcd_AddParam("BRNC_CD"       , cboBrncCdSearch.Value);			//지점
    fcd_AddParam("RACE_DT_FROM"  , calFromDt.Value);				//경주일자From
	fcd_AddParam("RACE_DT_TO"    , calToDt.Value);					//경주일자To
    fcd_AddParam("ENT_REFU_CD"   , cboEntRefuCdSearch.Value);		//구분
    fcd_AddParam("ENT_REFU_TY_CD", cboEntRefuTyCdSearch.Value);		//유형      
	fcd_AddParam("FACE_DESC"     , Trim(edFaceDescSearch.Text));	//인상착의
	fcd_AddParam("DTL_CNTNT"     , Trim(edDtlCntntSearch.Text));	//주요내용
	fcd_AddParam("FILE_PATH"     , GBL_SERVER_UPLOAD_DIR + SubStr(GBL_MENUID,0,3) + "/");//파일경로
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

//첨부파일 조회
function fcSearchFile(sAttFileKey){

	var sServiceName = "common_file-service:searchFileMana";
	var sInDataSet   = "";
	var sOutDataSet  = "dsUploadFile=dsUploadFile ";
	
	//입장거부자에 존재하는 첨부파일키
	fcd_AddParam("ATT_FILE_KEY", sAttFileKey);
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/

// 저장 전에 체크
function fcSaveCheck(obj) {  
	//변경된 자료가 있는지 체크
	if ( !fnc_DatasetChangeCheck(dsEntRefuMana) &&
	     !fnc_DatasetChangeCheck(dsUploadFile)) {
		//저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");	
		return false;
	}
	
	// 필수항목체크
	oDataSet          = dsEntRefuMana;
	sMandatoryColID   = "RACE_DT|ENT_REFU_CD|ENT_REFU_TY_CD|AGE_CD|ENT_REFU_TERM_FROM|FACE_DESC|DTL_CNTNT";
	sMandatoryColName = "경주일|구분|유형|연령대|입장거부기간(FROM)|인상착의|주요내용";
	oGrid             = grdEntRefuMana;
	
	if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	    return false;
	}
	
	for(var i = 0; i < dsUploadFile.rowcount; i++) {
		dsUploadFile.SetColumn(i, "ORD_NO", toInteger(i)+1);
	}
	return true;
}

function fcSave(obj) {

    if ( !fcSaveCheck() ) return;   
    
    if(fnc_Message(SNIS_COM_1012, "Y")) {           
		var sServiceName = "rem1010-service:saveEntRefuMana";
		var sInDataSet   = "dsEntRefuMana=dsEntRefuMana:u  dsUploadFile=dsUploadFile:u ";
		var sOutDataSet  = "dsEntRefuMana=dsEntRefuMana ";
	
		//첨부파일 서버 업로드 
		if( dsUploadFile.GetRowCount() > 0 ) {
			for (var i = 0 ; i < dsUploadFile.GetRowCount() ; i++ ) {
				if(dsUploadFile.GetRowType(i) == "insert" ) {
					var rtn_arr = fnc_FileWrite(  divBtnLst.HttpFile 
												, dsUploadFile.GetColumn(i, "FILE_PATH" )
												, dsUploadFile.GetColumn(i, "FILE_NM" ) 
												,"");
		
					var fileSize = divBtnLst.HttpFile.GetFileSizeLocal(dsUploadFile.GetColumn(i, "FILE_PATH" ));
					
					if ( rtn_arr[0] != "SUCC" ) {
						fnc_Message(SNIS_COM_1050, "N", rtn_arr[1]);
						return false;
					}
					
					dsUploadFile.SetColumn(i, "FILE_PATH", rtn_arr[1] );
					dsUploadFile.SetColumn(i, "FILE_SIZE", fileSize );
					dsUploadFile.SetColumn(i, "REAL_FILE_NM", rtn_arr[3]  );

					
				
				} // end if
			}
		} // end 
		
		//첨부파일 변경시, 입장거부자 정보 같이 넘겨줌
		fcd_AddParam("BRNC_CD" , dsEntRefuMana.GetColumn(dsEntRefuMana.currow, "BRNC_CD"));
		fcd_AddParam("SEQ"     , dsEntRefuMana.GetColumn(dsEntRefuMana.currow, "SEQ"));

		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDeleteCheck(obj) { 	
	return true;
}

function fcDelete(obj) {
		
}

/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
    var sExcelList = "grdEntRefuMana:입장거부자관리";
    fcd_OpenExcelListExport(sExcelList,1);
}

/*-------------------------------------------------------------------------------------------------+
>>  프린트 인쇄 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcPrint(obj) {
	
	var sFilePath ="";
	var nCtn = 0;
	dsEntRefuManaPrint.ClearData();
	
	
	for(var i = 0 ; i < dsEntRefuMana.rowcount; i++) {
		if( dsEntRefuMana.GetColumn(i, "CHK") == "1" ) nCtn++;
	}
	
	if( nCtn == 0 ) {
		fnc_Message(SNIS_COM_1061, "N");
		return;
	}
	
	dsEntRefuManaPrint.Copy(dsEntRefuMana);
	
	for(var i =  dsEntRefuManaPrint.rowcount ; i >= 0; i--) {
		if( dsEntRefuManaPrint.GetColumn(i, "CHK") == "0" ) dsEntRefuManaPrint.DeleteRow(i);
	}


	
	sSubUrl   = "";                                             // 레포트 파일이 있는 서브디렉토리
	sRptNm    = "rem/rem1010.jrf";                                // 레포트 파일명
	sDataSet  = "dsEntRefuMana=dsEntRefuManaPrint";					//UBI 쿼리명, MIP Dataset명"
	sArg      = "";		
	sRptDrct  = 0;                                              // 출력방향(0 : 수직, 1 : 수평)                                      // 출력방향(0 : 수직, 1 : 수평)

	fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}


/***************************************************************************************************
*                                      Grid 삽입, 추가, 삭제 처리                                  *
***************************************************************************************************/

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {

	switch( obj.GetForm().id ) {
		case "entBtnRow" :
			//DataSet의 Header 정보가 있을 때  Add 처리
			if ( fnc_DatasetChangeCheck(dsEntRefuMana) ) {
				fnc_Message(SNIS_COM_1051, "N");
				return;
			}
		
			nRow = dsEntRefuMana.AddRow();
			
			dsEntRefuMana.SetColumn(nRow, "BRNC_CD", sUserBrncCd);	
			dsEntRefuMana.SetColumn(nRow, "TMS", "1");	//추후, 삭제(매출에서 회차 가져올 시)
			dsEntRefuMana.SetColumn(nRow, "SEX", "M");
			
			calRaceDt.SetFocus(); // 입력 첫 항목으로 Focus
			break;
		
		case "imgBtnRow" :
			if( dsEntRefuMana.currow == -1 ) {
				fnc_Message(SNIS_RBM_A001, "N", "입장거부자", "이미지");
				return;
			}
		
			var nNo;
			
			if( fcGetImgRow() >= 0 &&
			    fcGetImgRow() > dsUploadFile.rowcount ) {
			    fnc_Message(SNIS_RBM_C002, "N");
				return;
			}
			
			if( dsUploadFile.row >= 0 ) {
				nNo = dsUploadFile.row;
			} else {
				nNo = dsUploadFile.rowcount;
			}
			
			//rowcount가 5를 넘어갈 경우
			if(nNo > 3) {
				fnc_Message(SNIS_RBM_C003, "N");
				return;
			}
			
			fcImgUpload(nNo);
			break;
	}

}

function fcImgUpload(nNo) {
	var sResponse = fcd_GetSelectFile();
	var nRow;
	var sRowSel = "";
	
	if( sResponse.length == 0 ) return;	//File을 선택 않했을 경우 return

	//선택한 이미지가 이미 존재할 경우 삭제 후, 다시 insert	
	if( dsUploadFile.FindRowNF("ORD_NO", nNo+1) >= 0 ) {
		fcImgDelete();
	}

	if( dsUploadFile.rowcount > nNo ) {
		nRow = dsUploadFile.InsertRow(nNo);
	} else {
		nRow = dsUploadFile.addRow();
	}
	
	dsUploadFile.SetColumn(nRow, "ATT_FILE_KEY", dsEntRefuMana.GetColumn(dsEntRefuMana.row,"ATT_FILE_KEY"));
	
	if ( !fnc_IsNull(sResponse) ) {
		dsUploadFile.SetColumn(nRow, "FILE_PATH", sResponse[0] + "\\" + sResponse[1]);
		dsUploadFile.SetColumn(nRow, "FILE_NM"  , sResponse[1]);
		dsUploadFile.SetColumn(nRow, "ORD_NO"   , toInteger(nNo)+1);
	}
			
	switch(toInteger(nNo)+1) {
		case 1:	img1.ImageID = sResponse[0] + "\\" + sResponse[1]; break;
		case 2: img2.ImageID = sResponse[0] + "\\" + sResponse[1]; break;
		case 3: img3.ImageID = sResponse[0] + "\\" + sResponse[1]; break;
		case 4: img4.ImageID = sResponse[0] + "\\" + sResponse[1]; break;
	}
	
	dsUploadFile.row = fcGetImgRow();

}
/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj) {
	//직접 버튼을 클릭한 경우
	switch( obj.GetForm().id ) {
		case "entBtnRow" :
			if ( !fnc_DeleteCheck(dsEntRefuMana, "CHK", "1") ) return;
			fcSearchFile(dsEntRefuMana.GetColumn(dsEntRefuMana.currow, "ATT_FILE_KEY"));
			break;
		case "imgBtnRow" :
			fcImgDelete();
			break;
	}	
}

function fcImgDelete() {	
	//이미지가 없는 컬럼은 삭제버튼 클릭시, 메세지
	var nRow = fcGetImgRow();
	var nDelRow;
	
	if( nRow == -1 ) {
		fnc_Message(SNIS_RBM_C004, "N");
		return;
	}
	
	nDelRow = dsUploadFile.FindRowNF("ORD_NO", toInteger(nRow)+1);
	
	if( nDelRow < 0 ) {
		fnc_Message(SNIS_RBM_C005, "N");
		return;
	}
	
	dsUploadFile.DeleteRow(nDelRow);
	
	switch(toInteger(nRow)+1) {
		case 1:img1.ImageID = ""; break;
		case 2:img2.ImageID = ""; break;
		case 3:img3.ImageID = ""; break;
		case 4:img4.ImageID = ""; break;
	}
	
	fcImgBorderSet();
	dsUploadFile.row = -1;
}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
//	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	if ( nCell == 0 ) {
		if (grdEntRefuMana.GetCellProp("head",0,"text") == 1){
			grdEntRefuMana.SetCellProp("head",0,"text", "0");
			for ( var i = 0; i< dsEntRefuMana.RowCount(); i++) {
				dsEntRefuMana.SetColumn(i, "CHK" , 0);
			}
		} else {
			grdEntRefuMana.SetCellProp("head",0,"text", "1");
			for ( var i = 0; i< dsEntRefuMana.RowCount(); i++) {
				dsEntRefuMana.SetColumn(i, "CHK" , 1);
			}
		}
	} else {
		fnc_GridSort(obj, object(obj.BindDataset), nCell);
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {

}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex){
	
}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 조회 완료 후
	if ( sServiceName == "rem1010-service:searchEntRefuMana" ) {
		// 입장관리 변경자료 존재여부체크 해제
		fcd_SetRefuEntNew(false);
	}
	
	// 조회 완료 후
	if ( sServiceName == "rbo1010-service:searchTms" ) {		
		if( dsTms.rowcount > 0 ) {
			dsEntRefuMana.SetColumn(dsEntRefuMana.currow, "TMS", dsTms.GetColumn(dsTms.currow, "TMS"));
			dsEntRefuMana.SetColumn(dsEntRefuMana.currow, "MEET_NM", dsTms.GetColumn(dsTms.currow, "MEET_NM"));

		} else {
			dsEntRefuMana.SetColumn(dsEntRefuMana.currow, "TMS", "");
			fnc_Message(SNIS_RBM_B002, "N", "경주일"); 
		}
	}
	
	// 첨부파일 조회 완료 후
	if ( sServiceName == "common_file-service:searchFileMana" ) {

		var sFilePath;
		
		img1.ImageID = "";
		img2.ImageID = "";
		img3.ImageID = "";
		img4.ImageID = "";
			
		for(var i = 0 ; i < dsUploadFile.rowcount ; i++ ) {
			
			sFilePath = GBL_SERVER_UPLOAD_DIR + SubStr(GBL_MENUID,0,3) + "/"+ dsUploadFile.GetColumn(i, "REAL_FILE_NM");
			//sFilePath = dsUploadFile.GetColumn(i, "FILE_PATH");

			
			if(i=0)	img1.ImageID = sFilePath;
			if(i=1)	img2.ImageID = sFilePath;
			if(i=2)	img3.ImageID = sFilePath;
			if(i=3)	img4.ImageID = sFilePath;
		}
		
		//조회시 첨부파일 선택 않되도록 Setting
		fcImgBorderSet();
		dsUploadFile.row = -1;
	}
	
	// 저장 완료 후
	if ( sServiceName == "rem1010-service:saveEntRefuMana" ) {
		fcSearch();		
	}	
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {
	if ( sServiceName == "rem1010-service:searchEntRefuMana" ) {

	}
	
}

/*-------------------------------------------------------------------------------------------------+
>>  코드나 명 입력 후 Lost Focus 시 해당 정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcCodeNameDisplay(obj) {

}

/*-------------------------------------------------------------------------------------------------+
>>  Column의 값이 변경된 경우
+-------------------------------------------------------------------------------------------------*/


/*-------------------------------------------------------------------------------------------------+
>>  상세코드 조회
+-------------------------------------------------------------------------------------------------*/

/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == ENTER_KEY ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}
	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}

function fcDsOnRowPosChanged(obj,nOldRow,nRow)
{
	switch ( obj.id ) {
		case "dsEntRefuMana" : // 첨부파일 조회	
				var imgobj;
				for(var icmp=1;icmp<=4;icmp++) {
					imgobj = object("img"+icmp);
					imgobj.imageId = "";
					imgobj.width  = imgcomp_width;
					imgobj.height = imgcomp_height;
				}
				if(dsEntRefuMana.GetRowType(dsEntRefuMana.row) ==  "insert") {
				dsUploadFile.ClearData();
				
				// img1.ImageID = "";
				// img2.ImageID = "";
				// img3.ImageID = "";
				// img4.ImageID = "";				
				fcd_SetFormObjByBrnc(this,sUserBrncCd);
				
			} else {
				calRaceDt.SetFocus(); 
				
				fcd_SetFormObjByBrnc(this,dsEntRefuMana.GetColumn(nRow,"BRNC_CD"));
				
				fcSearchFile(dsEntRefuMana.GetColumn(dsEntRefuMana.row, "ATT_FILE_KEY"));
			}
			
			
			break;
	}
}

//이미지 선택
function fcImgOnClick(obj,nX,nY)
{	
	var nRow = substr(obj.id, (obj.id.length-1), obj.id.length);
	
	fcImgBorderSet();
	
	switch( nRow ) { //imgae버튼의 마지막 한 글자를 가져욤 
		case 1: 
			img1.Border = BORDER_SET; 
			break;
		case 2: 
			img2.Border = BORDER_SET; 

			break;
		case 3: 
			img3.Border = BORDER_SET; 

			break;
		case 4: 
			img4.Border = BORDER_SET; 

			break;	
	}
	
	//선택된 Img와 Dataset의 row를 일치시킨다.
	if( nRow <= dsUploadFile.rowcount) {
		dsUploadFile.row = toInteger(nRow) - 1;
	} else {
		dsUploadFile.row = -1;
	}
}

//이미지 아무것도 선택 않된 것으로 Setting
function fcImgBorderSet() {
	img1.Border = BORDER_DEF;
	img2.Border = BORDER_DEF;
	img3.Border = BORDER_DEF;
	img4.Border = BORDER_DEF;
	
	
}

//선택된 첨부파일 row 구하기
function fcGetImgRow() {	
	var nSelectImg = -1;
	
	if( img1.Border == BORDER_SET ) nSelectImg = 0;
	if( img2.Border == BORDER_SET ) nSelectImg = 1;
	if( img3.Border == BORDER_SET ) nSelectImg = 2;
	if( img4.Border == BORDER_SET ) nSelectImg = 3;
	
	return nSelectImg;
}

function fcDsOnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	//회차 구하기
	if( strColumnID == "RACE_DT") {
		
		dsTms.ClearData();
		
		var sServiceName = "rbo1010-service:searchTms";
		var sInDataSet   = "";
		var sOutDataSet  = "dsTms=dsTms ";     
		
		//조회조건
		fcd_AddParam("RACE_DT", varNewValue);
		
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	}
}

function fcCboOnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
		switch ( obj.id ) {
			case "cboBrncCdSearch" : 
				fcSearch();
				break;
			case "cboEntRefuCdSearch" : 
				fcSearch();
				break;
			case "cboEntRefuTyCdSearch" : 
				fcSearch();
				break;
		}
	
}
function fcEdOnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
		switch ( obj.id ) {
			case "edDtlCntntSearch" : 
				if ( nChar == ENTER_KEY ) {		
					fcSearch();		
				
				}
				break;
			case "edFaceDescSearch" : 
				if ( nChar == ENTER_KEY ) {		
					fcSearch();		
				
				}
				break;
		}
}

function fcImgOnLoadCompleted(obj)
{
	
	var aImgSize = split(obj.GetImageSize(),"[,]");

	var img_width = toNumber(aImgSize[1]);
	var img_height = toNumber(aImgSize[2]);
	//trace("img_width = " + img_width.type + " / " + img_width);
	//trace("img_height = " + img_height.type + " / " + img_height); 
	if (img_height/img_width > imgcomp_height/imgcomp_width) {	// 세로가 긴 경우
		obj.width = img_width / img_height * imgcomp_height;	
		obj.height = imgcomp_height;			
	} else {
		obj.height = img_height / img_width * imgcomp_width;			
		obj.width = imgcomp_width;			
	}
}
]]></Script>
</Window>