<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="600" Id="MULTIGRD" Left="8" OnLoadCompleted="MULTIGRD_OnLoadCompleted" PidAttrib="7" Title="여러개의그리드export" Top="8" Ver="1.0" Width="800" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_0">
				<Contents>
					<colinfo id="col01" size="256" summ="default" type="STRING"/>
					<colinfo id="col02" size="256" summ="default" type="STRING"/>
					<colinfo id="col03" size="256" summ="default" type="STRING"/>
					<colinfo id="col04" size="256" summ="default" type="STRING"/>
					<colinfo id="col05" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_1">
				<Contents>
					<colinfo id="col01" size="256" summ="default" type="STRING"/>
					<colinfo id="col02" size="256" summ="default" type="STRING"/>
					<colinfo id="col03" size="256" summ="default" type="STRING"/>
					<colinfo id="col04" size="256" summ="default" type="STRING"/>
					<colinfo id="col05" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_2">
				<Contents>
					<colinfo id="col01" size="256" summ="default" type="STRING"/>
					<colinfo id="col02" size="256" summ="default" type="STRING"/>
					<colinfo id="col03" size="256" summ="default" type="STRING"/>
					<colinfo id="col04" size="256" summ="default" type="STRING"/>
					<colinfo id="col05" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_3">
				<Contents>
					<colinfo id="col01" size="256" summ="default" type="STRING"/>
					<colinfo id="col02" size="256" summ="default" type="STRING"/>
					<colinfo id="col03" size="256" summ="default" type="STRING"/>
					<colinfo id="col04" size="256" summ="default" type="STRING"/>
					<colinfo id="col05" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_4">
				<Contents>
					<colinfo id="col01" size="256" summ="default" type="STRING"/>
					<colinfo id="col02" size="256" summ="default" type="STRING"/>
					<colinfo id="col03" size="256" summ="default" type="STRING"/>
					<colinfo id="col04" size="256" summ="default" type="STRING"/>
					<colinfo id="col05" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_5">
				<Contents>
					<colinfo id="col01" size="256" summ="default" type="STRING"/>
					<colinfo id="col02" size="256" summ="default" type="STRING"/>
					<colinfo id="col03" size="256" summ="default" type="STRING"/>
					<colinfo id="col04" size="256" summ="default" type="STRING"/>
					<colinfo id="col05" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid BindDataset="ds_0" BoldHead="true" Bottom="182" Enable="true" EndLineColor="default" Height="162" Id="grd0" InputPanel="FALSE" Left="8" LineColor="default" Right="388" TabOrder="1" TabStop="true" Top="20" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="380">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="col01"/>
					<cell col="1" display="text" text="col02"/>
					<cell col="2" display="text" text="col03"/>
					<cell col="3" display="text" text="col04"/>
					<cell col="4" display="text" text="col05"/>
				</head>
				<body>
					<cell col="0" colid="col01" display="text"/>
					<cell col="1" colid="col02" display="text"/>
					<cell col="2" colid="col03" display="text"/>
					<cell col="3" colid="col04" display="text"/>
					<cell col="4" colid="col05" display="text"/>
				</body>
			</contents>
		</Grid>
		<Grid BindDataset="ds_2" BkColor2="default" BoldHead="true" Bottom="354" Enable="true" EndLineColor="default" Height="162" Id="grd2" InputPanel="FALSE" Left="8" LineColor="default" Right="388" TabOrder="2" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="380">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="col01"/>
					<cell col="1" display="text" text="col02"/>
					<cell col="2" display="text" text="col03"/>
					<cell col="3" display="text" text="col04"/>
					<cell col="4" display="text" text="col05"/>
				</head>
				<body>
					<cell col="0" colid="col01" display="text"/>
					<cell col="1" colid="col02" display="text"/>
					<cell col="2" colid="col03" display="text"/>
					<cell col="3" colid="col04" display="text"/>
					<cell col="4" colid="col05" display="text"/>
				</body>
			</contents>
		</Grid>
		<Grid BindDataset="ds_4" BkColor2="default" BoldHead="true" Bottom="522" Enable="true" EndLineColor="default" Height="162" Id="grd4" InputPanel="FALSE" Left="8" LineColor="default" Right="388" TabOrder="3" TabStop="true" Top="360" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="380">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="col01"/>
					<cell col="1" display="text" text="col02"/>
					<cell col="2" display="text" text="col03"/>
					<cell col="3" display="text" text="col04"/>
					<cell col="4" display="text" text="col05"/>
				</head>
				<body>
					<cell col="0" colid="col01" display="text"/>
					<cell col="1" colid="col02" display="text"/>
					<cell col="2" colid="col03" display="text"/>
					<cell col="3" colid="col04" display="text"/>
					<cell col="4" colid="col05" display="text"/>
				</body>
			</contents>
		</Grid>
		<Grid BindDataset="ds_5" BkColor2="default" BoldHead="true" Bottom="524" Enable="true" EndLineColor="default" Height="162" Id="grd5" InputPanel="FALSE" Left="400" LineColor="default" Right="788" TabOrder="4" TabStop="true" Top="362" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="388">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="col01"/>
					<cell col="1" display="text" text="col02"/>
					<cell col="2" display="text" text="col03"/>
					<cell col="3" display="text" text="col04"/>
					<cell col="4" display="text" text="col05"/>
				</head>
				<body>
					<cell col="0" colid="col01" display="text"/>
					<cell col="1" colid="col02" display="text"/>
					<cell col="2" colid="col03" display="text"/>
					<cell col="3" colid="col04" display="text"/>
					<cell col="4" colid="col05" display="text"/>
				</body>
			</contents>
		</Grid>
		<Grid BindDataset="ds_3" BkColor2="default" BoldHead="true" Bottom="356" Enable="true" EndLineColor="default" Height="162" Id="grd3" InputPanel="FALSE" Left="400" LineColor="default" Right="788" TabOrder="6" TabStop="true" Top="194" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="388">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="col01"/>
					<cell col="1" display="text" text="col02"/>
					<cell col="2" display="text" text="col03"/>
					<cell col="3" display="text" text="col04"/>
					<cell col="4" display="text" text="col05"/>
				</head>
				<body>
					<cell col="0" colid="col01" display="text"/>
					<cell col="1" colid="col02" display="text"/>
					<cell col="2" colid="col03" display="text"/>
					<cell col="3" colid="col04" display="text"/>
					<cell col="4" colid="col05" display="text"/>
				</body>
			</contents>
		</Grid>
		<Grid BindDataset="ds_1" BkColor2="default" BoldHead="true" Bottom="181" Enable="true" EndLineColor="default" Height="162" Id="grd1" InputPanel="FALSE" Left="400" LineColor="default" Right="788" TabOrder="5" TabStop="true" Top="19" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="388">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="col01"/>
					<cell col="1" display="text" text="col02"/>
					<cell col="2" display="text" text="col03"/>
					<cell col="3" display="text" text="col04"/>
					<cell col="4" display="text" text="col05"/>
				</head>
				<body>
					<cell col="0" colid="col01" display="text"/>
					<cell col="1" colid="col02" display="text"/>
					<cell col="2" colid="col03" display="text"/>
					<cell col="3" colid="col04" display="text"/>
					<cell col="4" colid="col05" display="text"/>
				</body>
			</contents>
		</Grid>
		<Button Height="21" Id="Button0" Left="648" OnClick="Button0_OnClick" TabOrder="7" Text="EXPORT" Top="556" Width="104"></Button>
	</Form>
	<Script><![CDATA[
function MULTIGRD_OnLoadCompleted(obj)
{
	// 임시 데이타 생성
	var objGrd;
	var objDs;
	var nRow;
	for(var i=0; i<6;i++){
		objDs = object("ds_"+i);
		objDs.fireEvent = false;
		for( var j=0; j<50; j++){
			nRow = objDs.addRow();
			for( var k=1; k<=5;k++){ 
				objDs.setColumn(nRow,"col0"+k,random(1,99999) );
			}
		
		}
		objDs.fireEvent = true;
	}
	
}

function Button0_OnClick(obj)
{
	var ExportObject1;
	var sXML;
	var arrCnt = array(-1);		
	arrCnt[0] = 3;
	arrCnt[1] = arrCnt[0] + ds_0.rowcount + 3;
	arrCnt[2] = arrCnt[1] + ds_1.rowcount + 3;
	arrCnt[3] = arrCnt[2] + ds_2.rowcount + 3;
	arrCnt[4] = arrCnt[3] + ds_3.rowcount + 3;
	arrCnt[5] = arrCnt[4] + ds_4.rowcount + 3;
		
	ExportObject1 = CreateExportObject();
	ExportObject1.ExportType		= "Excel";
	ExportObject1.ExportFileName	= "c:\\grdExport.xls";
	ExportObject1.ActiveSheetName   = "MultiGRID";	
	ExportObject1.MakeEmptyFileWhenNotExist = true;			
	ExportObject1.AddExportGrid("MultiGRID" + "!" + "B"+arrCnt[0]	, grd0, true, false);
	ExportObject1.AddExportGrid("MultiGRID" + "!" + "B"+arrCnt[1]	, grd1, true, false);
	ExportObject1.AddExportGrid("MultiGRID" + "!" + "B"+arrCnt[2]	, grd2, true, false);
	ExportObject1.AddExportGrid("MultiGRID" + "!" + "B"+arrCnt[3]	, grd3, true, false);
	ExportObject1.AddExportGrid("MultiGRID" + "!" + "B"+arrCnt[4]	, grd4, true, false);
	ExportObject1.AddExportGrid("MultiGRID" + "!" + "B"+arrCnt[5]	, grd5, true, false);
	ExportObject1.Export();
	ExportObject1.Close();
	ExportObject1 = null;		

}
]]></Script>
</Window>