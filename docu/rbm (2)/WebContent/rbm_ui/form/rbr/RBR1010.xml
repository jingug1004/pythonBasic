<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="RBR1010" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="지점현황" Top="8" Ver="1.0" Width="816" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsBrncCd" OnLoadCompleted="fcDsOnLoadCompleted"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsYear">
				<Contents>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>018</CD_GRP_ID>
						<DESCRIPTION>지점코드</DESCRIPTION>
						<DSNAME>dsBrncCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>001</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsServCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>003</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsJobTitCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>002</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsWorkTpyCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>004</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsEquipCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>005</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsFacGbnCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>006</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsFacCd</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>006</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsFacCdSearch</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsLastYear">
				<Contents>
					<colinfo id="COMM_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOOR_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SERV_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUIP_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FAC_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCommDesc">
				<Contents>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="OP_GOAL" size="256" summ="default" type="STRING"/>
					<colinfo id="POST_CD" size="256" summ="default" type="INT"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="DETL_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="INSTALL_ALOW_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="OPEN_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_FIX_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_GOAL_CRA" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_GOAL_MRA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsHistMana">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="YM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEmpStat">
				<Contents>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_GRP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CAP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSaleMana">
				<Contents>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_GOAL_CRA" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_GOAL_MRA" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_CRA" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_MRA" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE_CRA" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE_MRA" size="256" summ="default" type="STRING"/>
					<colinfo id="CRACNT" size="256" summ="default" type="STRING"/>
					<colinfo id="MRACNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFacStat">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="FAC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="FAC_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_SQMT" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_PY" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEquipFaci">
				<Contents>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUIP_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUIP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsBrncNm">
				<Contents>
					<colinfo id="BRNC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT_FIX_NUM" size="256" summ="default" type="STRING"/>
					<record>
						<BRNC_NM></BRNC_NM>
						<ENT_FIX_NUM></ENT_FIX_NUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFloorMana_0">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_AREA_SQMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_AREA_PY" size="256" summ="default" type="STRING"/>
					<colinfo id="ONLY_AREA_SQMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ONLY_AREA_PY" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_COT_MANNED" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_COT_MANLESS" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_MACH_MANNED" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_MACH_MANLESS" size="256" summ="default" type="STRING"/>
					<colinfo id="GRN_CRD_LOC" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="DELETE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_AREA_SQMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_AREA_PY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFloorMana">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_AREA_SQMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_AREA_PY" size="256" summ="default" type="STRING"/>
					<colinfo id="ONLY_AREA_SQMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ONLY_AREA_PY" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_COT_MANNED" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_COT_MANLESS" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_MACH_MANNED" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_MACH_MANLESS" size="256" summ="default" type="STRING"/>
					<colinfo id="GRN_CRD_LOC" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="DELETE_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsServMana">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="SERV_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_TPY_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSN_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFloorCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsServCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsJobTitCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsWorkTpyCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsEquipCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsFacGbnCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsFacCd"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsFacCdSearch"></Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="61" Height="31" Id="Shape1" Left="7" LineColor="user1" LineKind="Vertical" Right="808" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="5" Top="30" Type="RoundRect" Width="801"></Shape>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="5" Top="2" Width="17"></Image>
		<Static Align="Right" Height="22" Id="stFormLocation" Left="201" Style="styFormLocation" TabOrder="8" Top="4" VAlign="Middle" Width="288"></Static>
		<Static Height="22" Id="st_FormTitle" Left="-264" Style="styFormTitle" TabOrder="9" Top="24" VAlign="Middle" Width="451"></Static>
		<Static Height="22" Id="stFormTitle" Left="19" Style="snis_m_title" TabOrder="5" Text="지점현황" VAlign="Middle" Width="430"></Static>
		<Div Height="28" Id="divBtnLst" Left="437" TabOrder="5" Text="Div0" Url="common::comButtonType.xml" Width="374">
			<Contents></Contents>
		</Div>
		<Static BKColor="user0" Border="None" Color="user5" Height="20" Id="Static1" Left="133" Style="snis_if_lable" TabOrder="11" Text="지점" Top="36" VAlign="Middle" Width="32"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboBrncCdSearch" ImeMode="none" INDEX="9" InnerDataset="dsBrncCd" Left="163" OnChanged="fcCboOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="2" Top="35" Width="108">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnViolScr" ImageID="btn_txt_10" Left="709" OnClick="fcBtnOnClick" TabOrder="4" Text="전년도현황복사" Top="67" UserData="S" Width="102"></Button>
		<Combo Border="Flat" CodeColumn="STND_YEAR" DataColumn="STND_YEAR" Height="20" Id="cboStndYearSearch" ImeMode="none" InnerDataset="dsYear" Left="47" OnChanged="fcCboOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="1" Top="35" Width="72"></Combo>
		<Static Align="Right" BKColor="user0" Border="None" Color="user5" Height="20" Id="Static0" Left="16" Style="snis_if_lable" TabOrder="12" Text="년도" Top="36" VAlign="Middle" Width="27"></Static>
		<Tab Border="SunkenEdge" Height="478" Id="tab" Left="8" TabOrder="3" Top="91" Width="801">
			<Contents>
				<TabPage BorderColor="black" Height="454" Id="tbCommDesc" ImageID="m_tab_07" Left="2" TabOrder="19" Text="일반사항" Top="22" Url="frm_rbr::RBR1011.xml" Width="797"></TabPage>
				<TabPage BorderColor="black" Height="454" Id="tbHistMana" ImageID="m_tab_07" Left="2" TabOrder="19" Text="연혁" Top="22" Url="frm_rbr::RBR1012.xml" Width="797"></TabPage>
				<TabPage BorderColor="black" Height="454" Id="tbEmpStat" ImageID="m_tab_07" Left="2" TabOrder="13" Text="직원현황" Top="22" Url="frm_rbr::RBR1013.xml" Width="797"></TabPage>
				<TabPage BorderColor="black" Height="454" Id="tbServMana" ImageID="m_tab_07" Left="2" TabOrder="13" Text="용역관리" Top="22" Url="frm_rbr::RBR1014.xml" Width="797"></TabPage>
				<TabPage BorderColor="black" Height="454" Id="tbSalesMana" ImageID="m_tab_07" Left="2" TabOrder="13" Text="매출액,입장인원" Top="22" Url="frm_rbr::RBR1015.xml" Width="797"></TabPage>
				<TabPage BorderColor="black" Height="454" Id="tbEquipFaci" ImageID="m_tab_07" Left="2" TabOrder="13" Text="장비&#32;및&#32;설비" Top="22" Url="frm_rbr::RBR1016.xml" Width="797"></TabPage>
				<TabPage BorderColor="black" Height="454" Id="tbFacStat" ImageID="m_tab_07" Left="2" TabOrder="13" Text="시설현황" Top="22" Url="frm_rbr::RBR1017.xml" Width="797"></TabPage>
			</Contents>
		</Tab>
	</Form>
	<Script><![CDATA[
/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = this.GetForm().id;
var sBUTTONLIST   = 'FFFFTFT';                         //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       = "";                                //현재 LOST FOCUS 오브젝트

var sMenuGrpNum     = "0";                         	   // 메뉴그룹의 갯수보관
var sMenuListNum    = "0";                             // 메뉴리스트의 갯수보관
var sMenuUpId       = "";
var sMenuUpNm       = "";
var nCloseFlag      = 0;

var sUserBrncCd 	= gdsUser.GetColumn(0,"BRNC_CD");
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'TTTFTTT';
  
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
    
    //공통코드 조회
    fcd_GetComboDs(dsInComCd);
    
    //조회조건의 년도 Setting
	fcd_SetStndYear(dsYear, 2009, substr(fcd_GetSysdate("YYYYMMDD"), 0, 4)); 
	
	// 개발편하기 위한 초기값 나중에 삭제(광명지점 강제 선택)
	//cboBrncCdSearch.Value= '20';	
	
	for( var i = Tab.TabCount-1; i >= 0 ; i--) {
		Tab.TabIndex = i;
	}
	
	/*
	tab.GetItem(1).Url = "frm_rbr::RBR1012.xml";
	tab.GetItem(2).Url = "frm_rbr::RBR1013.xml";
	tab.GetItem(3).Url = "frm_rbr::RBR1014.xml";
	tab.GetItem(4).Url = "frm_rbr::RBR1015.xml";
	tab.GetItem(5).Url = "frm_rbr::RBR1016.xml";
	tab.GetItem(6).Url = "frm_rbr::RBR1017.xml";*/
	//fcSearch();		//시작시 조회
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	nCloseFlag = 0;
	
	for( var i = 0; i < Tab.TabCount ; i++) {
		if( nCloseFlag == 1 ) {
			break;
		}
		
		if( tab.GetItem(i).fcFormUnloadProcess() ) {			
			return false;
		} else {
			nCloseFlag = 1;
		}		
	}
	
	if ( global.FrameBottom != null ) {
		global.FrameBottom.fcDeleteTab(sFormID);
	}
}

/***************************************************************************************************
*                                      업무화면 공통 버튼 Event 처리 부분                          *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  초기화 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
	for( var i = 0; i < Tab.TabCount ; i++) {
		tab.GetItem(i).fcInit();
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearch(obj) {	
	for( var i = 0; i < Tab.TabCount ; i++) {
		tab.GetItem(i).fcSearch();	
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
// 저장 전에 체크
function fcSaveCheck(obj) {  
	
	//변경된 자료가 있는지 체크
	if ( !fnc_DatasetChangeCheck(tab.GetItem(0).dsCommDesc)  && 
		 !fnc_DatasetChangeCheck(tab.GetItem(0).dsFloorMana) &&       
		 !fnc_DatasetChangeCheck(tab.GetItem(1).dsHistMana)  &&
		 !fnc_DatasetChangeCheck(tab.GetItem(2).dsEmpStat)   &&
		 !fnc_DatasetChangeCheck(tab.GetItem(3).dsServMana)  &&
		 !fnc_DatasetChangeCheck(tab.GetItem(5).dsEquipFaci) &&
		 !fnc_DatasetChangeCheck(tab.GetItem(6).dsFacStat) ) {
		//저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");	
		return false;
	}

	return true;
}

function fcSave(obj) {

	if ( !fcSaveCheck() ) return false;  
	
	if(fnc_Message(SNIS_COM_1012, "Y")) {	
		for( var i = 0; i < Tab.TabCount ; i++) {			
			if( !tab.GetItem(i).fcSave() ) 	{
				tab.TabIndex = i;
				break;
			}
		}
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelete(obj) {
	tab.GetItem(tab.TabIndex).fcDelete();
}


/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) { 


	
	fcGetTabDsCopy();

    var strGrid = "tab.tbFacStat.grdFacStat|1"//
				+",tab.tbEquipFaci.grdEquipFaci|1"//
				+",tab.tbSalesMana.grdSaleMana"
				+",tab.tbServMana.grdServMana|1"//
				+",tab.tbEmpStat.grdEmpStat"
				+",tab.tbHistMana.grdHistMana|1"//
				+",tab.tbCommDesc.grdFloorMana|1";//
				
    var strSheet = "시설현황,장비및설비현황,매출현황,용역현황,직원현황,연혁,층현황";
    var strFileNm = "지점현황";
    fcd_topGfnExport(strSheet,strGrid,strFileNm,this) ;
    

	//tab.GetItem(tab.TabIndex).fcToExcel();
	
}

/*-------------------------------------------------------------------------------------------------+
>>  프린트 인쇄 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcPrint(obj) {

	dsBrncNm.SetColumn(0, "BRNC_NM", cboBrncCdSearch.Text );
	dsBrncNm.SetColumn(0, "ENT_FIX_NUM", tab.GetItem(0).mskEntFixNum.Text);
	dsCommDesc .Copy(tab.GetItem(0).dsCommDesc);
	dsFloorMana.Copy(tab.GetItem(0).dsFloorMana);
	dsHistMana .Copy(tab.GetItem(1).dsHistMana);
	dsEmpStat  .Copy(tab.GetItem(2).dsEmpStat);
	dsSaleMana .Copy(tab.GetItem(4).dsSaleMana);
	dsFacStat  .Copy(tab.GetItem(6).dsFacStat);
	dsEquipFaci  .Copy(tab.GetItem(5).dsEquipFaci);
	
	sSubUrl   = "";                                             // 레포트 파일이 있는 서브디렉토리
	sRptNm    = "rbr/rbr1010.jrf";                                // 레포트 파일명
	sDataSet  = "dsCommDesc=dsCommDesc "
	          + "dsHistMana=dsHistMana "
	          + "dsEmpStat=dsEmpStat "
	          + "dsFloorMana=dsFloorMana "
	          + "dsSaleMana=dsSaleMana "
	          + "dsFacStat=dsFacStat "
	          + "dsEquipFaci=dsEquipFaci "
	          + "dsBrncNm=dsBrncNm ";							//UBI 쿼리명, MIP Dataset명"
	sArg      = "";		
	sRptDrct  = 0;                                              // 출력방향(0 : 수직, 1 : 수평)                                      // 출력방향(0 : 수직, 1 : 수평)

	fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
//	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {

}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	if( sServiceName == "rbr1010-service:saveLastYear" ) {
		fcSearch();
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {
	
}

/*-------------------------------------------------------------------------------------------------+
>>  코드나 명 입력 후 Lost Focus 시 해당 정보 Display
+-------------------------------------------------------------------------------------------------*/
function fcCodeNameDisplay(obj) {

}

/*-------------------------------------------------------------------------------------------------+
>>  Column의 값이 변경된 경우
+-------------------------------------------------------------------------------------------------*/
// 조회 조건 Combo가 변경된 경우
function fcCboOnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	switch( obj.id ) {
		//case "cboStndYearSearch" :    // 과거년도 수정못하게 처리(목표매출액 관련하여 임시로 해제..
		case "cboBrncCdSearch"   :	//Form의 조회 조건 변경시(년도/지점)
			fcSearch();
			
			fcd_SetFormObjByBrnc(this, obj.value);
			fcTabSetFormObjByBrnc(obj.value);

			break;
	}
}

function fcTabSetFormObjByBrnc(sBrncCd) {
	for( var i = 0; i < Tab.TabCount ; i++) {	
		tab.GetItem(i).fcSetFormObjByBrnc(sBrncCd);	
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  상세코드 조회
+-------------------------------------------------------------------------------------------------*/

/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == ENTER_KEY ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}
	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}

//전년도 현황복사
function fcBtnOnClick(obj)
{
	var sServiceName = "rbr1010-service:saveLastYear";
	var sInDataSet   = "";
	var sOutDataSet  = ""; 
	
	var sCurrYear = cboStndYearSearch.Value;
	var sLastYear = toInteger(sCurrYear) - 1 ;
	
	fcd_AddParam("BRNC_CD"  , cboBrncCdSearch.Value);	//지점코드
	fcd_AddParam("LAST_YEAR", sLastYear);				//작년도
	fcd_AddParam("STND_YEAR", sCurrYear);				//현재년도
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}


function fcDsOnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
		switch ( obj.id ) {
			case "dsBrncCd" :
				
				if(Length(sUserBrncCd) >0){
					cboBrncCdSearch.Value = sUserBrncCd;
				}
				break;

		}
}


function fcGetTabDsCopy(){

	dsCommDesc .Copy(tab.GetItem(0).dsCommDesc);
	dsFloorMana.Copy(tab.GetItem(0).dsFloorMana);
	dsHistMana .Copy(tab.GetItem(1).dsHistMana);
	dsEmpStat  .Copy(tab.GetItem(2).dsEmpStat);
	dsServMana .Copy(tab.GetItem(3).dsServMana);
	dsSaleMana .Copy(tab.GetItem(4).dsSaleMana);
	dsFloorCd .Copy(tab.GetItem(5).dsFloorCd );
	dsEquipFaci.Copy(tab.GetItem(5).dsEquipFaci);
	dsFacStat  .Copy(tab.GetItem(6).dsFacStat);
	
}
]]></Script>
</Window>