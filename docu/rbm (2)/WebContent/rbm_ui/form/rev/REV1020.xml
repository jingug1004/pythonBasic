<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="REV1020" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="평가항목생성" Top="8" Ver="1.0" Width="824" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsEstmYear" OnLoadCompleted="fcDsOnLoadCompleted">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>사업상태코드</DESCRIPTION>
						<DSNAME>dsEstmYear</DSNAME>
						<QUERY_ID>rev1030_cb</QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>107</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsNfGbn</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>101</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsEstnGbn</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>164</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsEstmLitemType</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPrmLItm" OnColumnChanged="fsDsColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_RT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPrmMItm" OnColumnChanged="fsDsColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPrmSItm" OnColumnChanged="fsDsColumnChanged">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_RATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMnrLItm" OnColumnChanged="fsDsColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_SCR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMnrSItm" OnColumnChanged="fsDsColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_SCR" size="256" summ="default" type="STRING"/>
					<colinfo id="HI_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_SCR" size="256" summ="default" type="STRING"/>
					<colinfo id="BEST_SCR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMnrMItm">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BEST_SCR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSvrLItm" OnColumnChanged="fsDsColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_RATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSvrMItm">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSvrSItm" OnColumnChanged="fsDsColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_RATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsItmGrdPrm">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="S_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="A_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="B_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="C_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsItmGrdMult">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="S_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="A_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="B_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="C_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEstnGbn">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsNfGbn">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMultLItm" OnColumnChanged="fsDsColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_JOB_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMultMItm">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_IN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_LITEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_RATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsItm1">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_DTL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsItm2">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_DTL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsItm3">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_DTL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsItm4">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ITEM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNTR_ITM_DTL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsConst">
				<Contents>
					<colinfo id="UPDATE_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEstmLitemType"></Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="61" Height="31" Id="Shape1" Left="8" LineColor="user1" LineKind="Vertical" Right="809" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="0" Top="30" Type="RoundRect" Width="801"></Shape>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="0" Width="17"></Image>
		<Static Align="Right" Height="22" Id="stFormLocation" Left="176" Style="styFormLocation" TabOrder="4" Top="4" VAlign="Middle" Width="321"></Static>
		<Div Height="28" Id="divBtnLst" Left="442" TabOrder="0" Text="Div0" Url="common::comButtonType.xml" Width="374">
			<Contents></Contents>
		</Div>
		<Static Font="굴림,10,Bold" Height="22" Id="stFormTitle" Left="24" Style="snis_m_title" TabOrder="6" Text="평가항목생성" VAlign="Middle" Width="430"></Static>
		<Static Align="Right" Border="None" Height="20" Id="Static10" Left="32" Style="snis_if_lable" TabOrder="7" Text="년도/차수" Top="37" VAlign="Middle" Width="54"></Static>
		<Tab Border="Flat" BorderColor="user3" Height="499" Id="tab" Left="8" TabOrder="2" Top="67" Width="801">
			<Contents>
				<TabPage BorderColor="black" Height="475" Id="tabPrm" ImageID="m_tab_09" Left="2" TabOrder="19" Text="역량평가항목" Top="22" Width="797">
					<Div Height="20" Id="grpBtnPrmLItm" Left="290" Style="snis_grid" TabOrder="2" Text="Div0" Top="21" Url="common::comButtonRow.xml" Width="40">
						<Contents></Contents>
					</Div>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsPrmLItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="172" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="130" Id="grdPrmLItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" Right="334" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="328">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="214"/>
									<col width="79"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="No."/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="직종/보직&#32;항목"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="평가비율(%)"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="row+1"/>
									<cell align="center" col="1" colid="CNTR_ITM_NM" display="text" expandimage="btn_pop_search" expandshow="true"/>
									<cell align="right" col="2" colid="TOT_RT" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsPrmSItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="172" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="130" Id="grdPrmSItm" InputPanel="FALSE" Left="342" LineColor="user18" MinWidth="100" Right="790" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="448">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="126"/>
									<col width="70"/>
									<col width="74"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="직종보직항목"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="평가&#32;대항목"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="평가자"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="평가비율(%)"/>
								</head>
								<body>
									<cell align="center" col="0" colid="CNTR_ITM_NM" display="text"/>
									<cell align="center" col="1" colid="ESTM_LITEM_NM" display="text" imemode="native"/>
									<cell align="center" col="2" colid="FST_SND_GBN" combocol="CD" combodataset="dsEstnGbn" combotext="CD_NM" display="combo"/>
									<cell align="right" col="3" colid="ESTM_RATE" display="number" edit="lowernum"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsPrmMItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="423" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="229" Id="grdPrmMItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" Right="790" SelColor="user19" Style="snis_grid" TabOrder="4" TabStop="true" Top="194" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="784">
						<contents>
							<format id="Default">
								<columns>
									<col width="25"/>
									<col width="114"/>
									<col width="74"/>
									<col width="162"/>
									<col width="245"/>
									<col width="226"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="No."/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="직종보직항목"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="구분"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="평가&#32;대항목"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="역량&#32;정의"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="평가시&#32;고려요소"/>
								</head>
								<body>
									<cell align="center" col="0" display="number" expr="currow+1" imemode="native"/>
									<cell align="center" col="1" colid="CNTR_ITM_NM" display="text"/>
									<cell col="2" colid="ESTM_LITEM_TYPE" combocol="CD" combodataset="dsEstmLitemType" combotext="CD_NM" display="combo" edit="combo" imemode="native"/>
									<cell col="3" colid="ESTM_LITEM_NM" display="text" edit="normal" imemode="native"/>
									<cell align="center" col="4" colid="LITEM_DEF" display="text" edit="normal" imemode="native"/>
									<cell align="center" col="5" colid="LITEM_CNDR" display="text" edit="normal" imemode="native"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Div Height="20" Id="grpBtnPrmMItm" Left="750" Style="snis_grid" TabOrder="5" Text="Div0" Top="173" Url="common::comButtonRow.xml" Width="40">
						<Contents></Contents>
					</Div>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsItmGrdPrm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="469" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="39" Id="grdPrmGrdItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" Right="790" SelColor="user19" Style="snis_grid" TabOrder="6" TabStop="true" Top="430" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="784">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="등급"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="S등급"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="A등급"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="B등급"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="C등급"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="D등급"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" text="비율(%)"/>
									<cell align="center" col="1" colid="S_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="2" colid="A_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="3" colid="B_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="4" colid="C_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="5" colid="D_RATE" display="number" edit="number" limit="3"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Height="23" Id="Static0" Left="22" TabOrder="7" Text='※&#32;보직별로&#32;1/2차&#32;역량평가점수가&#32;다를&#32;경우,&#32;화면에서&#32;기준점수(평가비율)를&#32;입력&#32;후,&#32;그룹코드&#32;&quot;180&quot;에&#32;조정점수를&#32;입력한다.' Top="7" Width="699"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="475" Id="tabMnr" ImageID="m_tab_09" Left="2" TabOrder="19" Text="근무실적평가항목" Top="22" Width="797">
					<Div Height="20" Id="grpBtnMnrLItm" Left="290" Style="snis_grid" TabOrder="2" Text="Div0" Top="21" Url="common::comButtonRow.xml" Width="48">
						<Contents></Contents>
					</Div>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsMnrLItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="167" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="125" Id="grdMnrLItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" Right="334" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="328">
						<contents>
							<format id="Default">
								<columns>
									<col width="132"/>
									<col width="68"/>
									<col width="62"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="직종/보직&#32;항목"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="평가비율"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="기준점수"/>
								</head>
								<body>
									<cell align="center" col="0" colid="CNTR_ITM_NM" display="text" expandimage="btn_pop_search" expandshow="true"/>
									<cell align="center" col="1" colid="ESTM_RATE" display="number" edit="lowernum" limit="2"/>
									<cell align="center" col="2" colid="STND_SCR" display="number" edit="lowernum" limit="2"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsMnrSItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="469" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="427" Id="grdMnrSItm" InputPanel="FALSE" Left="342" LineColor="user18" MinWidth="100" Right="790" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="448">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="86"/>
									<col width="53"/>
									<col width="126"/>
									<col width="84"/>
									<col width="70"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="√"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="직종/보직그룹"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="구분"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="평가&#32;대항목"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="평가배점(건)"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="최대건수"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" colid="CNTR_ITM_NM" display="text"/>
									<cell align="center" col="2" colid="FST_SND_GBN" combocol="CD" combodataset="dsNfGbn" combotext="CD_NM" display="combo" edit="combo"/>
									<cell align="left" col="3" colid="ESTM_LITEM_NM" display="text" edit="normal" imemode="native"/>
									<cell align="center" col="4" colid="ESTM_SCR" color='expr:iif(&#32;dsMnrSItm.GetColumn(row,&#32;&quot;FST_SND_GBN&quot;)&#32;==&#32;&quot;002&quot;,&#32;&quot;#F53C3C&quot;)' display="number" edit="masknumber" limit="2" LimitDec="2"/>
									<cell align="center" col="5" colid="HI_CNT" display="number" edit="lowernum" limit="2"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Div Height="20" Id="grpBtnMnrSItm" Left="742" Style="snis_grid" TabOrder="4" Text="Div0" Top="21" Url="common::comButtonRow.xml" Width="48">
						<Contents></Contents>
					</Div>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsMnrMItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="469" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="299" Id="grdMnrMItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" Right="334" SelColor="user19" Style="snis_grid" TabOrder="5" TabStop="true" Top="170" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="328">
						<contents>
							<format id="Default">
								<columns>
									<col width="90"/>
									<col width="80"/>
									<col width="66"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="직종/보직그룹"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="구분"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="최고점수"/>
								</head>
								<body>
									<cell align="center" col="0" colid="CNTR_ITM_NM" display="text" imemode="native"/>
									<cell align="center" col="1" colid="FST_SND_GBN" combocol="CD" combodataset="dsNfGbn" combotext="CD_NM" display="combo"/>
									<cell align="center" col="2" colid="BEST_SCR" display="number" edit="lowernum" limit="2"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="475" Id="tabSvr" ImageID="m_tab_09" Left="2" TabOrder="13" Text="서비스평가항목" Top="22" Width="797">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsSvrLItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="167" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="125" Id="grdSvrLItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" Right="334" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="328">
						<contents>
							<format id="Default">
								<columns>
									<col width="132"/>
									<col width="68"/>
									<col width="62"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="직종/보직&#32;항목"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="평가비율"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="기준점수"/>
								</head>
								<body>
									<cell align="center" col="0" colid="CNTR_ITM_NM" display="text" expandimage="btn_pop_search" expandshow="true"/>
									<cell align="center" col="1" colid="ESTM_RATE" display="number" edit="lowernum" limit="2"/>
									<cell align="center" col="2" colid="STND_SCR" display="number" edit="lowernum" limit="2"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsSvrMItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="469" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="299" Id="grdSvrMItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" Right="334" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="170" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="328">
						<contents>
							<format id="Default">
								<columns>
									<col width="90"/>
									<col width="80"/>
									<col width="66"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="직종/보직그룹"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="구분"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="최고점수"/>
								</head>
								<body>
									<cell align="center" col="0" colid="CNTR_ITM_NM" display="text"/>
									<cell align="center" col="1" colid="FST_SND_GBN" combocol="CD" combodataset="dsNfGbn" combotext="CD_NM" display="combo"/>
									<cell align="center" col="2" colid="BEST_SCR" display="number" edit="lowernum" limit="2"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsSvrSItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="469" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="427" Id="grdSvrSItm" InputPanel="FALSE" Left="342" LineColor="user18" MinWidth="100" Right="790" SelColor="user19" Style="snis_grid" TabOrder="2" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="448">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="86"/>
									<col width="53"/>
									<col width="126"/>
									<col width="84"/>
									<col width="70"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="√"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="직종/보직그룹"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="구분"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="평가&#32;대항목"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="평가배점(건)"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="최대건수"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" colid="CNTR_ITM_NM" display="text"/>
									<cell align="center" col="2" colid="FST_SND_GBN" combocol="CD" combodataset="dsNfGbn" combotext="CD_NM" display="combo" edit="combo"/>
									<cell align="left" col="3" colid="ESTM_LITEM_NM" display="text" edit="normal" imemode="native"/>
									<cell align="center" col="4" colid="ESTM_SCR" color='expr:iif(&#32;dsSvrSItm.GetColumn(row,&#32;&quot;FST_SND_GBN&quot;)&#32;==&#32;&quot;002&quot;,&#32;&quot;#F53C3C&quot;)' display="number" edit="masknumber" limit="2" LimitDec="2"/>
									<cell align="center" col="5" colid="HI_CNT" display="number" edit="lowernum" limit="2"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Div Height="20" Id="grpBtnSvrLItm" Left="290" Style="snis_grid" TabOrder="4" Text="Div0" Top="21" Url="common::comButtonRow.xml" Width="48">
						<Contents></Contents>
					</Div>
					<Div Height="20" Id="grpBtnSvrSItm" Left="742" Style="snis_grid" TabOrder="5" Text="Div0" Top="21" Url="common::comButtonRow.xml" Width="48">
						<Contents></Contents>
					</Div>
				</TabPage>
				<TabPage BorderColor="black" Height="475" Id="tabMult" ImageID="m_tab_09" Left="2" TabOrder="13" Text="다면평가항목" Top="22" Width="797">
					<Div Height="20" Id="grpBtnMultLItm" Left="328" Style="snis_grid" TabOrder="2" Text="Div0" Top="21" Url="common::comButtonRow.xml" Width="40">
						<Contents></Contents>
					</Div>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsMultLItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="423" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="381" Id="grdMultLItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" Right="370" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="364">
						<contents>
							<format id="Default">
								<columns>
									<col width="34"/>
									<col width="100"/>
									<col width="197"/>
									<col width="92"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="No."/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="보직분야명"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="직종/보직&#32;항목"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="평가비율(%)"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="row+1"/>
									<cell align="center" col="1" colid="CNTR_JOB_NM" display="text" edit="normal" imemode="native"/>
									<cell align="center" col="2" colid="CNTR_ITM_NM" display="text" expandimage="btn_pop_search" expandshow="true"/>
									<cell align="right" col="3" colid="ESTM_RATE" display="number" edit="lowernum" limit="2"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsMultMItm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="423" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="381" Id="grdMultSItm" InputPanel="FALSE" Left="374" LineColor="user18" MinWidth="100" Right="790" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="42" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="416">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="157"/>
									<col width="224"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="√"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="직종보직항목"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="평가&#32;대항목"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" colid="CNTR_ITM_NM" display="text"/>
									<cell align="center" col="2" colid="ESTM_LITEM_NM" display="text" edit="normal" imemode="native"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Div Height="20" Id="grpBtnMultMItm" Left="742" Style="snis_grid" TabOrder="4" Text="Div0" Top="21" Url="common::comButtonRow.xml" Width="46">
						<Contents></Contents>
					</Div>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsItmGrdMult" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="469" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="39" Id="grdMultGrdItm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" Right="790" SelColor="user19" Style="snis_grid" TabOrder="5" TabStop="true" Top="430" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="784">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="등급"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="S등급"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="A등급"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="B등급"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="C등급"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="D등급"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" text="비율(%)"/>
									<cell align="center" col="1" colid="S_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="2" colid="A_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="3" colid="B_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="4" colid="C_RATE" display="number" edit="number" limit="3"/>
									<cell align="center" col="5" colid="D_RATE" display="number" edit="number" limit="3"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="19" Id="cbEstmYear" ImeMode="none" InnerDataset="dsEstmYear" Left="110" OnChanged="fcOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="8" Top="36" Width="108">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = this.GetForm().id;
var sBUTTONLIST   = 'FFFFTFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       = "";                                //현재 LOST FOCUS 오브젝트
 
var sMenuGrpNum     = "0";                         	   // 메뉴그룹의 갯수보관
var sMenuListNum    = "0";                             // 메뉴리스트의 갯수보관
var sMenuUpId       = "";
var sMenuUpNm       = "";
var sPAGENUM        = "20";

var sEvalYear = "";
var sEvalNum  = "";

var xRow          = "";
var nCal          = "";
var sSplitCntrItm = "";
var sCntrItm      = "";
var sCntrItmCurr  = "";

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'FTTFFFT';
  
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	//공통코드 조회
	fcd_GetComboDs(dsInComCd);

    fcSearch();  // 목록 조회 

}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "dsPrmLItm|dsPrmMItm|dsPrmSItm|dsMnrLItm|dsMnrMItm|dsMnrSItm|"
	             + "dsSvrLItm|dsSvrMItm|dsSvrSItm|dsMultLItm|dsMultMItm";
	if (!fnc_FormUnloadCheck(sDataset  , sFormId)) return false;
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  초기화 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj)
{
    dsPrmLItm.ClearData(); 
	dsPrmMItm.ClearData(); 
	dsPrmSItm.ClearData(); 
	dsMnrLItm.ClearData(); 
	dsMnrSItm.ClearData(); 
	dsMnrMItm.ClearData(); 
	dsSvrLItm.ClearData(); 
	dsSvrMItm.ClearData(); 
	dsSvrSItm.ClearData(); 
	dsMultLItm.ClearData(); 
	dsMultMItm.ClearData(); 
	dsItmGrdPrm.ClearData(); 
	dsItmGrdMult.ClearData(); 
	dsItm1.ClearData(); 
	dsItm2.ClearData(); 
	dsItm3.ClearData(); 
	dsItm4.ClearData(); 
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
    fcInit(obj);
	return true;
}

function fcSearch(obj)
{
    if ( !fcSearchCheck(obj) ) return;

	var sServiceName = "rev1020-service:searchItems";
    var sInDataSet   = "";
    var sOutDataSet  = "dsPrmLItm=dsPrmLItm "
					 + "dsPrmMItm=dsPrmMItm "
					 + "dsPrmSItm=dsPrmSItm "
                     + "dsSvrLItm=dsSvrLItm "
                     + "dsSvrMItm=dsSvrMItm "
                     + "dsSvrSItm=dsSvrSItm "
                     + "dsMnrLItm=dsMnrLItm "
                     + "dsMnrMItm=dsMnrMItm "
                     + "dsMnrSItm=dsMnrSItm "
                     + "dsMultLItm=dsMultLItm "
                     + "dsMultMItm=dsMultMItm "
                     + "dsItmGrdPrm=dsItmGrdPrm "
                     + "dsItmGrdMult=dsItmGrdMult "
                     + "dsConst=dsConst";
    	
    fcEstmYearValue();	
    
	fcd_AddParam("ESTM_YEAR", sEvalYear);	
	fcd_AddParam("ESTM_NUM" , sEvalNum);	
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj)
{
	//변경된 자료가 있는지 체크
    if ( !fnc_DatasetChangeCheck(dsPrmLItm)   && 
         !fnc_DatasetChangeCheck(dsPrmMItm)   &&
         !fnc_DatasetChangeCheck(dsPrmSItm)   &&
         !fnc_DatasetChangeCheck(dsSvrLItm)   &&
         !fnc_DatasetChangeCheck(dsSvrMItm)   &&
         !fnc_DatasetChangeCheck(dsSvrSItm)   &&
         !fnc_DatasetChangeCheck(dsMnrLItm)   &&
         !fnc_DatasetChangeCheck(dsMnrMItm)   &&
         !fnc_DatasetChangeCheck(dsMnrSItm)   &&
         !fnc_DatasetChangeCheck(dsMultLItm)  &&
         !fnc_DatasetChangeCheck(dsMultMItm)  &&
         !fnc_DatasetChangeCheck(dsItmGrdPrm) &&
         !fnc_DatasetChangeCheck(dsItmGrdMult) ) {
        //저장 할 자료가 없음
        fnc_Message(SNIS_COM_1006, "N");    
        return false;
    }
    
    /*-----------------------------+
	>>  업무수행평가 필수항목 체크
	+-----------------------------*/
	var sFilter  = "";
	var nFindRow = -1;
	
    oDataSet          = dsPrmLItm;
    sMandatoryColID   = "CNTR_ITM_NM";
    sMandatoryColName = "직종/보직 항목";
    oGrid             = tab.tabPrm.grdPrmLItm;
    if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
		tab.TabIndex = 0;
		return false;
    }
	
	dsPrmMItm.UnFilter();
	dsPrmMItm.FireEvent = false;
    
    for(var i=0;i< dsPrmLItm.rowcount; i++) {
		//업무수행평가 왼쪽 하단의 rowcount 체크(0이면 저장 불가능)
		if( dsPrmMItm.FindRow("CNTR_ITM_CD", dsPrmLItm.GetColumn(i, "CNTR_ITM_CD")) == -1 ) {
			sFilter = "CNTR_ITM_CD=='" 
			        + dsPrmLItm.GetColumn(i, "CNTR_ITM_CD") + "'";
			dsPrmMItm.Filter(sFilter);
			dsPrmMItm.FireEvent = true;
			tab.TabIndex = 0;
			dsPrmLItm.row = i;
			fnc_Message(SNIS_RBM_F044, "N");
			return false;
		}	
    }
	
	//왼쪽 하단의 데이터셋의 필수항목 체크
	for(var j=0;j<dsPrmMItm.rowcount;j++) {
		if( fnc_IsNull(dsPrmMItm.GetColumn(j, "ESTM_LITEM_NM")) ) {
			nFindRow = dsPrmLItm.FindRow("CNTR_ITM_CD", dsPrmMItm.GetColumn(j, "CNTR_ITM_CD"));
			sFilter = "CNTR_ITM_CD=='" + dsPrmLItm.GetColumn(dsPrmLItm.currow, "CNTR_ITM_CD") + "'";
			dsPrmMItm.Filter(sFilter);
			dsPrmMItm.FireEvent = true;
			tab.TabIndex = 0;
			dsPrmLItm.row = nFindRow;
			fnc_Message(SNIS_COM_1035, "N", "평가대항목");
			return false;
		}
	}	
    sFilter = "CNTR_ITM_CD=='" + dsPrmLItm.GetColumn(dsPrmLItm.currow, "CNTR_ITM_CD") + "'";
	dsPrmMItm.Filter(sFilter);
	dsPrmMItm.FireEvent = true;

    oDataSet          = dsPrmSItm;
    sMandatoryColID   = "ESTM_LITEM_NM|ESTM_RATE";
    sMandatoryColName = "평가 대항목|평가비율";
    oGrid             = tab.tabPrm.grdPrmSItm;
    if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
        tab.TabIndex = 0;
        return false;
    }
    
    if( dsPrmLItm.rowcount > 0 ) {
		if( fnc_IsNull(dsItmGrdPrm.GetColumn(0, "S_RATE")) ) {
			tab.TabIndex = 0;
			tab.tabPrm.grdPrmGrdItm.SetFocus();
			tab.tabPrm.grdPrmGrdItm.SetCellPos(tab.tabPrm.grdPrmGrdItm.GetBindCellIndex("body", "S_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "S등급");
			return false;
		}
		
		if( fnc_IsNull(dsItmGrdPrm.GetColumn(0, "A_RATE")) ) {
			tab.TabIndex = 0;
			tab.tabPrm.grdPrmGrdItm.SetFocus();
			tab.tabPrm.grdPrmGrdItm.SetCellPos(tab.tabPrm.grdPrmGrdItm.GetBindCellIndex("body", "A_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "A등급");
			return false;
		}
		
		if( fnc_IsNull(dsItmGrdPrm.GetColumn(0, "B_RATE")) ) {
			tab.TabIndex = 0;
			tab.tabPrm.grdPrmGrdItm.SetFocus();
			tab.tabPrm.grdPrmGrdItm.SetCellPos(tab.tabPrm.grdPrmGrdItm.GetBindCellIndex("body", "B_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "B등급");
			return false;
		}
		
		if( fnc_IsNull(dsItmGrdPrm.GetColumn(0, "C_RATE")) ) {
			tab.TabIndex = 0;
			tab.tabPrm.grdPrmGrdItm.SetFocus();
			tab.tabPrm.grdPrmGrdItm.SetCellPos(tab.tabPrm.grdPrmGrdItm.GetBindCellIndex("body", "C_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "C등급");
			return false;
		}
		
		if( fnc_IsNull(dsItmGrdPrm.GetColumn(0, "D_RATE")) ) {
			tab.TabIndex = 0;
			tab.tabPrm.grdPrmGrdItm.SetFocus();
			tab.tabPrm.grdPrmGrdItm.SetCellPos(tab.tabPrm.grdPrmGrdItm.GetBindCellIndex("body", "D_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "D등급");
			return false;
		}
	}
	
    /*-----------------------------+
	>>  근무태도평가 필수항목 체크
	+-----------------------------*/
    oDataSet          = dsMnrLItm;
    sMandatoryColID   = "CNTR_ITM_NM|ESTM_RATE|STND_SCR";
    sMandatoryColName = "직종/보직 항목|평가비율|기준점수";
    oGrid             = tab.tabMnr.grdMnrLItm;
    if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
        tab.TabIndex = 1;
        return false;
    }
    
    //왼쪽 하단의 데이터셋의 필수항목 체크
	for(var i=0;i<dsMnrMItm.GetCountNF();i++) {
		if( fnc_IsNull(dsMnrMItm.GetColumnNF(i, "BEST_SCR")) ) {
			sFilter = "CNTR_ITM_CD=='" + dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_CD") + "'";
			tab.TabIndex = 1;
			dsMnrLItm.row = dsMnrLItm.FindRow("CNTR_ITM_CD", dsMnrMItm.GetColumnNF(i, "CNTR_ITM_CD"));
			fnc_Message(SNIS_COM_1035, "N", "최고점수");
			return false;
		}
	}

    //오른쪽의 데이터셋 필수항목 체크
    for(var i=0;i<dsMnrLItm.rowcount;i++) {
		//가점항목 체크
		var sItemCd = dsMnrLItm.GetColumn(i, "CNTR_ITM_CD");
		var sCond   = "CNTR_ITM_CD=" + quote(sItemCd) + " AND "
		            + "FST_SND_GBN=" + quote("001");
		nFindRow = dsMnrSItm.SearchRowNF(sCond);
		if( nFindRow == -1 ) {
			fnc_Message(SNIS_RBM_F045, "N", dsNfGbn.GetColumn(dsNfGbn.FindRow("CD","001"), "CD_NM"));
			tab.TabIndex = 1;
			dsMnrLItm.row = i;
			return false;
		}
		//감점항목 체크
		var sCond   = "CNTR_ITM_CD=" + quote(sItemCd) + " AND "
		            + "FST_SND_GBN=" + quote("002");
		nFindRow = dsMnrSItm.SearchRowNF(sCond);
		if( nFindRow == -1 ) {
			fnc_Message(SNIS_RBM_F045, "N", dsNfGbn.GetColumn(dsNfGbn.FindRow("CD","002"), "CD_NM"));
			tab.TabIndex = 1;
			dsMnrLItm.row = i;
			return false;
		}          
	}
    
	/*-----------------------------+
	>>  서비스평가 필수항목 체크
	+-----------------------------*/
    oDataSet          = dsSvrLItm;
    sMandatoryColID   = "CNTR_ITM_NM|ESTM_RATE|STND_SCR";
    sMandatoryColName = "직종/보직 항목|평가비율|기준점수";
    oGrid             = tab.tabSvr.grdSvrLItm;
    if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
        tab.TabIndex = 2;
        return false;
    }
    
    //왼쪽 하단의 데이터셋의 필수항목 체크
	for(var i=0;i<dsSvrMItm.GetCountNF();i++) {
		if( fnc_IsNull(dsSvrMItm.GetColumnNF(i, "BEST_SCR")) ) {
			sFilter = "CNTR_ITM_CD=='" + dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_CD") + "'";
			dsSvrLItm.row = dsSvrLItm.FindRow("CNTR_ITM_CD", dsSvrMItm.GetColumnNF(i, "CNTR_ITM_CD"));
			fnc_Message(SNIS_COM_1035, "N", "최고점수");
			tab.TabIndex = 2;
			return false;
		}
	}

    //오른쪽의 데이터셋 필수항목 체크
    for(var i=0;i<dsSvrLItm.rowcount;i++) {
		//가점항목 체크
		var sItemCd = dsSvrLItm.GetColumn(i, "CNTR_ITM_CD");
		var sCond   = "CNTR_ITM_CD=" + quote(sItemCd) + " AND "
		            + "FST_SND_GBN=" + quote("001");
		nFindRow = dsSvrSItm.SearchRowNF(sCond);
		if( nFindRow == -1 ) {
			fnc_Message(SNIS_RBM_F045, "N", dsNfGbn.GetColumn(dsNfGbn.FindRow("CD","001"), "CD_NM"));
			dsSvrLItm.row = i;
			tab.TabIndex = 2;
			return false;
		}
		//감점항목 체크
		var sCond   = "CNTR_ITM_CD=" + quote(sItemCd) + " AND "
		            + "FST_SND_GBN=" + quote("002");
		nFindRow = dsSvrSItm.SearchRowNF(sCond);
		if( nFindRow == -1 ) {
			fnc_Message(SNIS_RBM_F045, "N", dsNfGbn.GetColumn(dsNfGbn.FindRow("CD","002"), "CD_NM"));
			tab.TabIndex = 2;
			dsSvrLItm.row = i;
			return false;
		}          
	}
    
    /*-----------------------------+
	>>  다면평가 필수항목 체크
	+-----------------------------*/
    oDataSet          = dsMultLItm;
    sMandatoryColID   = "CNTR_JOB_NM|CNTR_ITM_NM|ESTM_RATE";
    sMandatoryColName = "보직분야명|직종/보직 항목|평가비율";
    oGrid             = tab.tabMult.grdMultLItm;
    if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
        tab.TabIndex = 3;
        return false;
    }

    if( dsMultLItm.rowcount > 0 ) {
		if( fnc_IsNull(dsItmGrdMult.GetColumn(0, "S_RATE")) ) {
			tab.TabIndex = 3;
			tab.tabMult.grdMultGrdItm.SetFocus();
			tab.tabMult.grdMultGrdItm.SetCellPos(tab.tabMult.grdMultGrdItm.GetBindCellIndex("body", "S_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "S등급");
			return false;
		}
		
		if( fnc_IsNull(dsItmGrdMult.GetColumn(0, "A_RATE")) ) {
			tab.TabIndex = 3;
			tab.tabMult.grdMultGrdItm.SetFocus();
			tab.tabMult.grdMultGrdItm.SetCellPos(tab.tabMult.grdMultGrdItm.GetBindCellIndex("body", "A_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "A등급");
			return false;
		}
		
		if( fnc_IsNull(dsItmGrdMult.GetColumn(0, "B_RATE")) ) {
			tab.TabIndex = 3;
			tab.tabMult.grdMultGrdItm.SetFocus();
			tab.tabMult.grdMultGrdItm.SetCellPos(tab.tabMult.grdMultGrdItm.GetBindCellIndex("body", "B_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "B등급");
			return false;
		}
		
		if( fnc_IsNull(dsItmGrdMult.GetColumn(0, "C_RATE")) ) {
			tab.TabIndex = 3;
			tab.tabMult.grdMultGrdItm.SetFocus();
			tab.tabMult.grdMultGrdItm.SetCellPos(tab.tabMult.grdMultGrdItm.GetBindCellIndex("body", "C_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "C등급");
			return false;
		}

		if( fnc_IsNull(dsItmGrdMult.GetColumn(0, "D_RATE")) ) {
			tab.TabIndex = 3;
			tab.tabMult.grdMultGrdItm.SetFocus();
			tab.tabMult.grdMultGrdItm.SetCellPos(tab.tabMult.grdMultGrdItm.GetBindCellIndex("body", "D_RATE"));
			fnc_Message(SNIS_COM_1035, "N", "D등급");
			return false;
		}
	}
    
    //오른쪽 화면의 row가 한개라도 존재해야 함
    for(var i=0; i<dsMultLItm.rowcount;i++) {
		if( dsMultMItm.FindRowNF("CNTR_ITM_CD", dsMultLItm.GetColumn(i, "CNTR_ITM_CD")) == -1) {
			tab.TabIndex = 3;
			dsMultLItm.row = i;
			fnc_Message(SNIS_RBM_F046, "N");
			return false;
		}
    }
    
    //필수항목체크
	for(var i=0; i<dsMultMItm.GetCountNF();i++) {
		if( fnc_IsNull(dsMultMItm.GetColumnNF(i, "ESTM_LITEM_NM"))) {
			tab.TabIndex = 3;
			fnc_Message(SNIS_COM_1035,"N","평가대항목");
			return false;
		}
	}
	

	// 업무수행평가항목 하단 등급점수 체크
	var sRate = dsItmGrdPrm.GetColumn(0, "S_RATE");
	var aRate = dsItmGrdPrm.GetColumn(0, "A_RATE");
	var bRate = dsItmGrdPrm.GetColumn(0, "B_RATE");
	var cRate = dsItmGrdPrm.GetColumn(0, "C_RATE");
	var dRate = dsItmGrdPrm.GetColumn(0, "D_RATE");
	
	if( toInteger(sRate) > 100 )
	{
		fnc_Message(SNIS_RBM_F050, "N", "S_RATE");
		tab.TabIndex = 0;
		dsItmGrdPrm.SetColumn(0, "S_RATE", 0 );
		return false;
	} else if ( toInteger(aRate) > 100 ) {
		tab.TabIndex = 0;
		fnc_Message(SNIS_RBM_F050, "N", "A_RATE");
		dsItmGrdPrm.SetColumn(0, "A_RATE", 0 );
		return false;
	} else if ( toInteger(bRate) > 100 ) {
		tab.TabIndex = 0;
		fnc_Message(SNIS_RBM_F050, "N", "B_RATE");
		dsItmGrdPrm.SetColumn(0, "B_RATE", 0 );
		return false;
	} else if ( toInteger(cRate) > 100 ) {
		tab.TabIndex = 0;
		fnc_Message(SNIS_RBM_F050, "N", "C_RATE");
		dsItmGrdPrm.SetColumn(0, "C_RATE", 0 );
		return false;
	} else if ( toInteger(dRate) > 100 ) {
		tab.TabIndex = 0;
		fnc_Message(SNIS_RBM_F050, "N", "D_RATE");
		dsItmGrdPrm.SetColumn(0, "D_RATE", 0 );
		return false;
	}

	// 다면평가항목 하단 등급점수 체크
	var sRate = dsItmGrdMult.GetColumn(0, "S_RATE");
	var aRate = dsItmGrdMult.GetColumn(0, "A_RATE");
	var bRate = dsItmGrdMult.GetColumn(0, "B_RATE");
	var cRate = dsItmGrdMult.GetColumn(0, "C_RATE");
	var dRate = dsItmGrdMult.GetColumn(0, "D_RATE");
	
	if( toInteger(sRate) > 100 )
	{
		tab.TabIndex = 3;
		fnc_Message(SNIS_RBM_F050, "N", "S_RATE");
		dsItmGrdMult.SetColumn(0, "S_RATE", 0 );
		return false;
	} else if ( toInteger(aRate) > 100 ) {
		tab.TabIndex = 3;
		fnc_Message(SNIS_RBM_F050, "N", "A_RATE");
		dsItmGrdMult.SetColumn(0, "A_RATE", 0 );
		return false;
	} else if ( toInteger(bRate) > 100 ) {
		tab.TabIndex = 3;
		fnc_Message(SNIS_RBM_F050, "N", "B_RATE");
		dsItmGrdMult.SetColumn(0, "B_RATE", 0 );
		return false;
	} else if ( toInteger(cRate) > 100 ) {
		tab.TabIndex = 3;
		fnc_Message(SNIS_RBM_F050, "N", "C_RATE");
		dsItmGrdMult.SetColumn(0, "C_RATE", 0 );
		return false;
	} else if ( toInteger(dRate) > 100 ) {
		tab.TabIndex = 3;
		fnc_Message(SNIS_RBM_F050, "N", "D_RATE");
		dsItmGrdMult.SetColumn(0, "D_RATE", 0 );
		return false;
	}

	//업무수행평가항목
	dsItm1.ClearData();
	for(var i = 0 ; i < dsPrmLItm.rowcount ; i++ ) {
		
		var sEvalYear  = dsPrmLItm.GetColumn(i, "ESTM_YEAR");
		var sEvalNum   = dsPrmLItm.GetColumn(i, "ESTM_NUM");
		var sCntrItmCd = dsPrmLItm.GetColumn(i, "CNTR_ITM_CD");
		var sItm       = dsPrmLItm.GetColumn(i, "CNTR_ITM_IN");
		
		sItm = split(sItm, "|");
		
		for(var j = 0; j < sItm.length(); j++) {
			var nRow = dsItm1.AddRow();	
			dsItm1.SetColumn(nRow, "ESTM_YEAR"   , sEvalYear);
			dsItm1.SetColumn(nRow, "ESTM_NUM"    , sEvalNum);
			dsItm1.SetColumn(nRow, "ESTM_ITEM_CD", "1");
			dsItm1.SetColumn(nRow, "CNTR_ITM_CD" , sCntrItmCd);
			dsItm1.SetColumn(nRow, "CNTR_ITM_DTL", sItm[j]);
		}
	}	

	//근무태도평가항목
	dsItm2.ClearData();
	for(var i = 0 ; i < dsMnrLItm.rowcount ; i++ ) {
		
		var sEvalYear  = dsMnrLItm.GetColumn(i, "ESTM_YEAR");
		var sEvalNum   = dsMnrLItm.GetColumn(i, "ESTM_NUM");
		var sCntrItmCd = dsMnrLItm.GetColumn(i, "CNTR_ITM_CD");
		var sItm       = dsMnrLItm.GetColumn(i, "CNTR_ITM_IN");
		
		sItm = split(sItm, "|");
		
		for(var j = 0; j < sItm.length(); j++) {
			var nRow = dsItm2.AddRow();	
			dsItm2.SetColumn(nRow, "ESTM_YEAR"   , sEvalYear);
			dsItm2.SetColumn(nRow, "ESTM_NUM"    , sEvalNum);
			dsItm2.SetColumn(nRow, "ESTM_ITEM_CD", "2");
			dsItm2.SetColumn(nRow, "CNTR_ITM_CD" , sCntrItmCd);
			dsItm2.SetColumn(nRow, "CNTR_ITM_DTL", sItm[j]);
		}
	}	
	
	
	//서비스평가항목
	dsItm3.ClearData();
	for(var i = 0 ; i < dsSvrLItm.rowcount ; i++ ) {
		
		var sEvalYear  = dsSvrLItm.GetColumn(i, "ESTM_YEAR");
		var sEvalNum   = dsSvrLItm.GetColumn(i, "ESTM_NUM");
		var sCntrItmCd = dsSvrLItm.GetColumn(i, "CNTR_ITM_CD");
		var sItm       = dsSvrLItm.GetColumn(i, "CNTR_ITM_IN");
		
		sItm = split(sItm, "|");
		
		for(var j = 0; j < sItm.length(); j++) {
			var nRow = dsItm3.AddRow();	
			dsItm3.SetColumn(nRow, "ESTM_YEAR"   , sEvalYear);
			dsItm3.SetColumn(nRow, "ESTM_NUM"    , sEvalNum);
			dsItm3.SetColumn(nRow, "ESTM_ITEM_CD", "3");
			dsItm3.SetColumn(nRow, "CNTR_ITM_CD" , sCntrItmCd);
			dsItm3.SetColumn(nRow, "CNTR_ITM_DTL", sItm[j]);
		}
	}	
	
	
	//다면평가항목
	dsItm4.ClearData();
	for(var i = 0 ; i < dsMultLItm.rowcount ; i++ ) {
		
		var sEvalYear  = dsMultLItm.GetColumn(i, "ESTM_YEAR");
		var sEvalNum   = dsMultLItm.GetColumn(i, "ESTM_NUM");
		var sCntrItmCd = dsMultLItm.GetColumn(i, "CNTR_ITM_CD");
		var sItm       = dsMultLItm.GetColumn(i, "CNTR_ITM_IN");
		
		sItm = split(sItm, "|");
		
		for(var j = 0; j < sItm.length(); j++) {
			var nRow = dsItm4.AddRow();	
			dsItm4.SetColumn(nRow, "ESTM_YEAR"   , sEvalYear);
			dsItm4.SetColumn(nRow, "ESTM_NUM"    , sEvalNum);
			dsItm4.SetColumn(nRow, "ESTM_ITEM_CD", "4");
			dsItm4.SetColumn(nRow, "CNTR_ITM_CD" , sCntrItmCd);
			dsItm4.SetColumn(nRow, "CNTR_ITM_DTL", sItm[j]);
		}
	}	
	return true;
}

function fcSave(obj)
{
	if ( !fcSaveCheck(obj) ) return;
	
	var sServiceName = "rev1020-service:saveItems";
    var sInDataSet   = "dsPrmSItm=dsPrmSItm:U "
                     + "dsPrmLItm=dsPrmLItm:U "
                     + "dsItmGrdPrm=dsItmGrdPrm:U "
                     + "dsMnrSItm=dsMnrSItm:U "
                     + "dsMnrMItm=dsMnrMItm:A "
                     + "dsMnrLItm=dsMnrLItm:U "
                     + "dsSvrSItm=dsSvrSItm:U "
                     + "dsSvrMItm=dsSvrMItm:A "
                     + "dsSvrLItm=dssvrLItm:U "
                     + "dsMultMItm=dsMultMItm:U "
                     + "dsMultLItm=dsMultLItm:U "
                     + "dsItmGrdMult=dsItmGrdMult:U "
                     + "dsItm1=dsItm1:A "
                     + "dsItm2=dsItm2:A "
                     + "dsItm3=dsItm3:A "
                     + "dsItm4=dsItm4:A ";
	var sOutDataSet  = "";
    
    fcd_AddParam("ESTM_YEAR", sEvalYear);	
	fcd_AddParam("ESTM_NUM" , sEvalNum);
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
	
	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 조회 완료 후
	if ( sServiceName == "rev1020-service:searchItems" )
	{
		//화면 수정 막기
		if( dsConst.GetColumn(0, "UPDATE_YN") == "N" ) {
			divBtnLst.btnSave.Enable = false;
			
			//첫번째 탭
			tab.tabPrm.grpBtnPrmLItm.Visible = false;
			tab.tabPrm.grpBtnPrmMItm.Visible = false;
			
			tab.tabPrm.grdPrmLItm  .Editable = false;
			tab.tabPrm.grdPrmMItm  .Editable = false;
			tab.tabPrm.grdPrmSItm  .Editable = false;
			tab.tabPrm.grdPrmGrdItm.Editable = false;
			
			tab.tabPrm.grdPrmLItm.SetCellProp("Body", 1, "ExpandShow", false);
			
			//두번째 탭
			tab.tabMnr.grpBtnMnrLItm.Visible = false;
			tab.tabMnr.grpBtnMnrSItm.Visible = false;
			
			tab.tabMnr.grdMnrLItm.Editable = false;
			tab.tabMnr.grdMnrMItm.Editable = false;
			tab.tabMnr.grdMnrSItm.Editable = false;
			
			tab.tabMnr.grdMnrLItm.SetCellProp("Body", 0, "ExpandShow", false);
			
			//세번째 탭
			tab.tabSvr.grpBtnSvrLItm.Visible = false;
			tab.tabSvr.grpBtnSvrSItm.Visible = false;
			
			tab.tabSvr.grdSvrLItm.Editable = false;
			tab.tabSvr.grdSvrSItm.Editable = false;
			tab.tabSvr.grdSvrMItm.Editable = false;
			
			tab.tabSvr.grdSvrLItm.SetCellProp("Body", 0, "ExpandShow", false);
			
			//네번째 탭
			tab.tabMult.grpBtnMultLItm.Visible = false;
			tab.tabMult.grpBtnMultMItm.Visible = false;
			
			tab.tabMult.grdMultLItm  .Editable = false;
			tab.tabMult.grdMultSItm  .Editable = false;
			tab.tabMult.grdMultGrdItm.Editable = false;
			
			tab.tabMult.grdMultLItm.SetCellProp("Body", 2, "ExpandShow", false);
		} else {
			divBtnLst.btnSave.Enable = true;
			
			//첫번째 탭
			tab.tabPrm.grpBtnPrmLItm.Visible = true;
			tab.tabPrm.grpBtnPrmMItm.Visible = true;
			
			tab.tabPrm.grdPrmLItm  .Editable = true;
			tab.tabPrm.grdPrmMItm  .Editable = true;
			tab.tabPrm.grdPrmSItm  .Editable = true;
			tab.tabPrm.grdPrmGrdItm.Editable = true;
			
			tab.tabPrm.grdPrmLItm.SetCellProp("Body", 1, "ExpandShow", true);
			
			//두번째 탭
			tab.tabMnr.grpBtnMnrLItm.Visible = true;
			tab.tabMnr.grpBtnMnrSItm.Visible = true;
			
			tab.tabMnr.grdMnrLItm.Editable = true;
			tab.tabMnr.grdMnrMItm.Editable = true;
			tab.tabMnr.grdMnrSItm.Editable = true;
			
			tab.tabMnr.grdMnrLItm.SetCellProp("Body", 0, "ExpandShow", true);
			
			//세번째 탭
			tab.tabSvr.grpBtnSvrLItm.Visible = true;
			tab.tabSvr.grpBtnSvrSItm.Visible = true;
			
			tab.tabSvr.grdSvrLItm.Editable = true;
			tab.tabSvr.grdSvrSItm.Editable = true;
			tab.tabSvr.grdSvrMItm.Editable = true;
			
			tab.tabSvr.grdSvrLItm.SetCellProp("Body", 0, "ExpandShow", true);
			
			//네번째 탭
			tab.tabMult.grpBtnMultLItm.Visible = true;
			tab.tabMult.grpBtnMultMItm.Visible = true;
			
			tab.tabMult.grdMultLItm  .Editable = true;
			tab.tabMult.grdMultSItm  .Editable = true;
			tab.tabMult.grdMultGrdItm.Editable = true;
			
			tab.tabMult.grdMultLItm.SetCellProp("Body", 2, "ExpandShow", true);
		
		}
		
		var sFilter = "CNTR_ITM_CD== '" + dsPrmLItm.GetColumn(dsPrmLItm.currow , "CNTR_ITM_CD") +"'";
		dsPrmMItm.Filter(sFilter);

		var sFilter2 = "ESTM_LITEM_CD== '" + dsPrmMItm.GetColumn(0, "ESTM_LITEM_CD") + "'";
		dsPrmSItm.Filter(sFilter2);
		
		var sFilter3 = "CNTR_ITM_CD== '" + dsMnrLItm.GetColumn(dsMnrLItm.currow , "CNTR_ITM_CD") +"'";
		dsMnrMItm.Filter(sFilter3);
		dsMnrSItm.Filter(sFilter3);
		
		var sFilter4 = "CNTR_ITM_CD== '" + dsSvrLItm.GetColumn(dsSvrLItm.currow , "CNTR_ITM_CD") +"'";
		dsSvrMItm.Filter(sFilter4);
		dsSvrSItm.Filter(sFilter4);
		
		var sFilter5 = "CNTR_ITM_CD== '" + dsMultLItm.GetColumn(dsMultLItm.currow , "CNTR_ITM_CD") +"'";
		dsMultMItm.Filter(sFilter5);
		
		if ( dsItmGrdPrm.RowCount() == 0 )
		{
			dsItmGrdPrm.addRow();
			dsItmGrdPrm.SetColumn(0,"ESTM_YEAR" , sEvalYear);
			dsItmGrdPrm.SetColumn(0,"ESTM_NUM" , sEvalNum);
		}
		if ( dsItmGrdMult.RowCount() == 0 )
		{
			dsItmGrdMult.addRow();
			dsItmGrdMult.SetColumn(0,"ESTM_YEAR" , sEvalYear);
			dsItmGrdMult.SetColumn(0,"ESTM_NUM" , sEvalNum);
		}
	}
	
	// 저장완료 후
	if ( sServiceName == "rev1020-service:saveItems" )
	{
		fcSearch();
	}
}

function fcEstmYearValue(obj)
{
	/* 콤보박스에서 값 가져오기 */
    var nCbValue =cbEstmYear.Value;
	var nCbRow = dsEstmYear.SearchRow("CD=="+nCbValue);
	
	sEvalYear = dsEstmYear.GetColumn(nCbRow,"ESTM_YEAR");
	sEvalNum = dsEstmYear.GetColumn(nCbRow,"ESTM_NUM");

}

function fcDsOnRowPosChanged(obj,nOldRow,nRow)
{
	switch ( obj.id ) 
	{
		case "dsPrmLItm" :
			var sFilter = "CNTR_ITM_CD== '" + dsPrmLItm.GetColumn(dsPrmLItm.currow , "CNTR_ITM_CD") +"'";
			dsPrmMItm.Filter(sFilter);
	
			var sFilter2 = "ESTM_LITEM_CD== '" + dsPrmMItm.GetColumn(0, "ESTM_LITEM_CD") + "'";
			dsPrmSItm.Filter(sFilter2);
		break;
		
		case "dsPrmMItm" :
			var sFilter2 = "ESTM_LITEM_CD== '" + dsPrmMItm.GetColumn(dsPrmMItm.currow , "ESTM_LITEM_CD") + "'";
			dsPrmSItm.Filter(sFilter2);
		break;
	
		case "dsMnrLItm" :
			var sFilter3 = "CNTR_ITM_CD== '" + dsMnrLItm.GetColumn(dsMnrLItm.currow , "CNTR_ITM_CD") +"'";
			dsMnrMItm.Filter(sFilter3);
			dsMnrSItm.Filter(sFilter3);
		break;
		
		case "dsSvrLItm" :
			var sFilter4 = "CNTR_ITM_CD== '" + dsSvrLItm.GetColumn(dsSvrLItm.currow , "CNTR_ITM_CD") +"'";
			dsSvrMItm.Filter(sFilter4);
			dsSvrSItm.Filter(sFilter4);
		break;
		
		case "dsMultLItm" :
			var sFilter5 = "CNTR_ITM_CD== '" + dsMultLItm.GetColumn(dsMultLItm.currow , "CNTR_ITM_CD") +"'";
			dsMultMItm.Filter(sFilter5);
		break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex)
{
	switch ( objGrd.id )
    {
		case "grdPrmLItm" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			
			if (nCell == 1) {
				sFormId = "frm_rev::REV1020P.xml";
				sArgs = "";	
				
				sEvalYear = dsPrmLItm.GetColumn(nRow, "ESTM_YEAR");
				sEvalNum  = dsPrmLItm.GetColumn(nRow, "ESTM_NUM");
				
				sCntrItm      = "";
				sCntrItmCurr  = "";
				sSplitCntrItm = "";
				
				for( var i = 0 ; i < dsPrmLItm.rowcount ; i++) {
					if( !fnc_IsNull(dsPrmLItm.GetColumn(i, "CNTR_ITM_IN")) ) {
						if( i == nRow ) {
							sCntrItmCurr = sCntrItmCurr 
							             + dsPrmLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						} else {
							sCntrItm = sCntrItm +'|'
							         + dsPrmLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						}
					}
				}
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0  )
				{
					dsPrmLItm.SetColumn(nRow, "CNTR_ITM_NM", arrReturn[0]);
					dsPrmLItm.SetColumn(nRow, "CNTR_ITM_IN", arrReturn[1]);
				}
				
			}
		break;
		
		case "grdMnrLItm" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			
			if (nCell == 0) {
			
				sFormId = "frm_rev::REV1020P.xml";
				sArgs   = "";	
				
				sEvalYear = dsMnrLItm.GetColumn(nRow, "ESTM_YEAR");
				sEvalNum  = dsMnrLItm.GetColumn(nRow, "ESTM_NUM");
				
				sCntrItm      = "";
				sCntrItmCurr  = "";
				sSplitCntrItm = "";
				
				for( var i = 0 ; i < dsMnrLItm.rowcount ; i++) {
					if( !fnc_IsNull(dsMnrLItm.GetColumn(i, "CNTR_ITM_IN")) ) {
						if( i == nRow ) {
							sCntrItmCurr = sCntrItmCurr 
							             + dsMnrLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						} else {
							sCntrItm = sCntrItm +'|'
							         + dsMnrLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						}
					}
				}
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if (length(arrReturn) > 0  )
				{
					dsMnrLItm.SetColumn(nRow, "CNTR_ITM_IN", arrReturn[1]);
					dsMnrLItm.SetColumn(nRow, "CNTR_ITM_NM", arrReturn[0]);
				}
			}
		break;
		
		case "grdSvrLItm" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			
			if (nCell == 0) {
				sFormId = "frm_rev::REV1020P.xml";
				sArgs = "";	
				
				sEvalYear = dsSvrLItm.GetColumn(nRow, "ESTM_YEAR");
				sEvalNum = dsSvrLItm.GetColumn(nRow, "ESTM_NUM");
				
				sCntrItm      = "";
				sCntrItmCurr  = "";
				sSplitCntrItm = "";
				
				for( var i = 0 ; i < dsSvrLItm.rowcount ; i++) {
					if( !fnc_IsNull(dsSvrLItm.GetColumn(i, "CNTR_ITM_IN")) ) {
						if( i == nRow ) {
							sCntrItmCurr = sCntrItmCurr 
							             + dsSvrLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						} else {
							sCntrItm = sCntrItm +'|'
							         + dsSvrLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						}
					}
				}
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0 )
				{
					dsSvrLItm.SetColumn(nRow, "CNTR_ITM_IN", arrReturn[1]);
					dsSvrLItm.SetColumn(nRow, "CNTR_ITM_NM", arrReturn[0]);
					
					dsSvrMItm.SetColumn(0, "CNTR_ITM_IN", arrReturn[1]);
					dsSvrMItm.SetColumn(1, "CNTR_ITM_IN", arrReturn[1]);
					dsSvrMItm.SetColumn(0, "CNTR_ITM_NM", arrReturn[0]);
					dsSvrMItm.SetColumn(1, "CNTR_ITM_NM", arrReturn[0]);
					
					for( var i = 0; i < dsSvrSItm.RowCount(); i++) {
						if ( dsSvrLItm.GetColumn(nRow, "CNTR_ITM_CD") = dsSvrSItm.GetColumn(i, "CNTR_ITM_CD") ) {
							dsSvrSItm.SetColumn(i,"CNTR_ITM_IN", arrReturn[1]);
							dsSvrSItm.SetColumn(i,"CNTR_ITM_NM", arrReturn[0]);
						}
					}
				}
			}
		break;
		
		case "grdMultLItm" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			
			if (nCell == 2) {
				sFormId = "frm_rev::REV1020P.xml";
				sArgs = "";	
				
				sEvalYear = dsMultLItm.GetColumn(nRow, "ESTM_YEAR");
				sEvalNum = dsMultLItm.GetColumn(nRow, "ESTM_NUM");
				
				sCntrItm      = "";
				sCntrItmCurr  = "";
				sSplitCntrItm = "";
								
				for( var i = 0 ; i < dsMultLItm.rowcount ; i++) {
					if( !fnc_IsNull(dsMultLItm.GetColumn(i, "CNTR_ITM_IN")) ) {
						if( i == nRow ) {
							sCntrItmCurr = sCntrItmCurr 
							             + dsMultLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						} else {
							sCntrItm = sCntrItm +'|'
							         + dsMultLItm.GetColumn(i, "CNTR_ITM_IN") +'|';
						}
					}
				}
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0  )
				{
					dsMultLItm.SetColumn(nRow, "CNTR_ITM_IN", arrReturn[1]);
					dsMultLItm.SetColumn(nRow, "CNTR_ITM_NM", arrReturn[0]);
					
				}
			}
		break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj)
{
    switch ( obj.GetForm().id )
    {
		case "grpBtnPrmLItm" :
			for ( var cc=0; cc<dsPrmLItm.RowCount(); cc++)
			{
				if ( dsPrmLItm.GetColumn(cc, "CNTR_ITM_NM") == null)
				return;
			}
			dsPrmLItm.AddRow(); // Record Add
			
			fcEstmYearValue();
			
			dsPrmLItm.SetColumn(dsPrmLItm.currow, "ESTM_YEAR", sEvalYear );
			dsPrmLItm.SetColumn(dsPrmLItm.currow, "ESTM_NUM", sEvalNum);
			dsPrmLItm.SetColumn(dsPrmLItm.currow, "CNTR_ITM_CD", lpad(toString(toInteger(dsPrmLItm.Max("CNTR_ITM_CD")) + 1) ,"0", 2));
						
		break;
		
		case "grpBtnPrmMItm" :
			for ( var dd=0; dd<dsPrmMItm.RowCount(); dd++)
			{
				if ( dsPrmMItm.GetColumn(dd, "ESTM_LITEM_NM") == null)
				return;
			}
			if ( fnc_IsNull(dsPrmLItm.GetColumn(dsPrmLItm.currow, "CNTR_ITM_IN")) == false )
			{
				dsPrmMItm.AddRow(); // Record Add
				
				dsPrmMItm.SetColumn(dsPrmMItm.currow, "ESTM_YEAR", dsPrmLItm.GetColumn(dsPrmLItm.currow,"ESTM_YEAR") );
				dsPrmMItm.SetColumn(dsPrmMItm.currow, "ESTM_NUM", dsPrmLItm.GetColumn(dsPrmLItm.currow,"ESTM_NUM") );
				dsPrmMItm.SetColumn(dsPrmMItm.currow, "CNTR_ITM_CD", dsPrmLItm.GetColumn(dsPrmLItm.currow , "CNTR_ITM_CD") );
				dsPrmMItm.SetColumn(dsPrmMItm.currow, "ESTM_LITEM_CD", toString(dsPrmLItm.GetColumn(dsPrmLItm.currow , "CNTR_ITM_CD"))+toString(lpad(toInteger( substr(dsPrmMItm.Max("ESTM_LITEM_CD"),2,3 )) + 1  ,"0", 2)) );
				dsPrmMItm.SetColumn(dsPrmMItm.currow, "CNTR_ITM_NM", dsPrmLItm.GetColumn(dsPrmLItm.currow,"CNTR_ITM_NM") );
				dsPrmMItm.SetColumn(dsPrmMItm.currow, "CNTR_ITM_IN", dsPrmLItm.GetColumn(dsPrmLItm.currow,"CNTR_ITM_IN") );
				
				dsPrmSItm.AddRow(); // Record Add
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_YEAR", dsPrmMItm.GetColumn(dsPrmMItm.currow,"ESTM_YEAR") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_NUM", dsPrmMItm.GetColumn(dsPrmMItm.currow,"ESTM_NUM") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "CNTR_ITM_CD", dsPrmMItm.GetColumn(dsPrmMItm.currow , "CNTR_ITM_CD") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_LITEM_CD", dsPrmMItm.GetColumn(dsPrmMItm.currow , "ESTM_LITEM_CD") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "CNTR_ITM_NM", dsPrmMItm.GetColumn(dsPrmMItm.currow,"CNTR_ITM_NM") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "FST_SND_GBN", "001" );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "CNTR_ITM_IN", dsPrmMItm.GetColumn(dsPrmMItm.currow,"CNTR_ITM_IN") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_LITEM_NM", dsPrmMItm.GetColumn(dsPrmMItm.currow,"ESTM_LITEM_NM") );
				
				dsPrmSItm.AddRow(); // Record Add
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_YEAR", dsPrmMItm.GetColumn(dsPrmMItm.currow,"ESTM_YEAR") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_NUM", dsPrmMItm.GetColumn(dsPrmMItm.currow,"ESTM_NUM") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "CNTR_ITM_CD", dsPrmMItm.GetColumn(dsPrmMItm.currow , "CNTR_ITM_CD") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_LITEM_CD", dsPrmMItm.GetColumn(dsPrmMItm.currow , "ESTM_LITEM_CD") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "CNTR_ITM_NM", dsPrmMItm.GetColumn(dsPrmMItm.currow,"CNTR_ITM_NM") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "FST_SND_GBN", "002" );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "CNTR_ITM_IN", dsPrmMItm.GetColumn(dsPrmMItm.currow,"CNTR_ITM_IN") );
				dsPrmSItm.SetColumn(dsPrmSItm.currow, "ESTM_LITEM_NM", dsPrmMItm.GetColumn(dsPrmMItm.currow,"ESTM_LITEM_NM") );
				
			} else {
				return;
			} 
		break;
		
		case "grpBtnMnrLItm" :
			for ( var aa=0; aa<dsMnrLItm.RowCount(); aa++)
			{
				if ( dsMnrLItm.GetColumn(aa, "CNTR_ITM_NM") == null)
				return;
			}
			
			dsMnrLItm.AddRow(); // Record Add
			
			fcEstmYearValue();
			
			dsMnrLItm.SetColumn(dsMnrLItm.currow, "ESTM_YEAR", sEvalYear );
			dsMnrLItm.SetColumn(dsMnrLItm.currow, "ESTM_NUM", sEvalNum);
			dsMnrLItm.SetColumn(dsMnrLItm.currow, "CNTR_ITM_CD", lpad(toString(toInteger(dsMnrLItm.Max("CNTR_ITM_CD")) + 1) ,"0", 2));
			
			dsMnrMItm.AddRow(); // Record Add
			dsMnrMItm.SetColumn(dsMnrMItm.currow,"ESTM_YEAR", dsMnrLItm.GetColumn(dsMnrLItm.currow,"ESTM_YEAR") );
			dsMnrMItm.SetColumn(dsMnrMItm.currow,"ESTM_NUM", dsMnrLItm.GetColumn(dsMnrLItm.currow,"ESTM_NUM") );
			dsMnrMItm.SetColumn(dsMnrMItm.currow,"CNTR_ITM_CD", dsMnrLItm.GetColumn(dsMnrLItm.currow,"CNTR_ITM_CD") );
			dsMnrMItm.SetColumn(dsMnrMItm.currow, "FST_SND_GBN", "001" );
			dsMnrMItm.SetColumn(dsMnrMItm.currow, "CNTR_ITM_NM", "" );
			dsMnrMItm.SetColumn(dsMnrMItm.currow, "CNTR_ITM_IN", "" );
				
			dsMnrMItm.AddRow(); // Record Add
			dsMnrMItm.SetColumn(dsMnrMItm.currow,"ESTM_YEAR", dsMnrLItm.GetColumn(dsMnrLItm.currow,"ESTM_YEAR") );
			dsMnrMItm.SetColumn(dsMnrMItm.currow,"ESTM_NUM", dsMnrLItm.GetColumn(dsMnrLItm.currow,"ESTM_NUM") );
			dsMnrMItm.SetColumn(dsMnrMItm.currow,"CNTR_ITM_CD", dsMnrLItm.GetColumn(dsMnrLItm.currow,"CNTR_ITM_CD") );
			dsMnrMItm.SetColumn(dsMnrMItm.currow, "FST_SND_GBN", "002" );
			dsMnrMItm.SetColumn(dsMnrMItm.currow, "CNTR_ITM_NM", "" );
			dsMnrMItm.SetColumn(dsMnrMItm.currow, "CNTR_ITM_IN", "" );
		break;
		
		case "grpBtnMnrSItm" :
			if ( fnc_IsNull(dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_IN")) == false )
			{
				dsMnrSItm.AddRow(); // Record Add
				
				dsMnrSItm.SetColumn(dsMnrSItm.currow,"ESTM_YEAR", dsMnrLItm.GetColumn(dsMnrLItm.currow,"ESTM_YEAR") );
				dsMnrSItm.SetColumn(dsMnrSItm.currow,"ESTM_NUM", dsMnrLItm.GetColumn(dsMnrLItm.currow,"ESTM_NUM") );
				dsMnrSItm.SetColumn(dsMnrSItm.currow,"CNTR_ITM_CD", dsMnrLItm.GetColumn(dsMnrLItm.currow,"CNTR_ITM_CD") );
				dsMnrSItm.SetColumn(dsMnrSItm.currow, "CNTR_ITM_IN", dsMnrLItm.GetColumn(dsMnrLItm.currow,"CNTR_ITM_IN") );
				dsMnrSItm.SetColumn(dsMnrSItm.currow, "CNTR_ITM_NM", dsMnrLItm.GetColumn(dsMnrLItm.currow,"CNTR_ITM_NM") );
				dsMnrSItm.SetColumn(dsMnrSItm.currow, "ESTM_RATE", dsMnrLItm.GetColumn(dsMnrLItm.currow,"ESTM_RATE") );
				dsMnrSItm.SetColumn(dsMnrSItm.currow, "STND_SCR", dsMnrLItm.GetColumn(dsMnrLItm.currow,"STND_SCR") );
				dsMnrSItm.SetColumn(dsMnrSItm.currow, "ESTM_LITEM_CD", toString(dsMnrLItm.GetColumn(dsMnrLItm.currow , "CNTR_ITM_CD"))+toString(lpad(toInteger( substr(dsMnrSItm.Max("ESTM_LITEM_CD"),2,3 )) + 1  ,"0", 2)) );
				dsMnrSItm.SetColumn(dsMnrSItm.currow, "FST_SND_GBN", dsMnrMItm.GetColumn(dsMnrMItm.currow,"FST_SND_GBN") );
			}
		break;
		
		case "grpBtnSvrLItm" :
			for ( var bb=0; bb<dsSvrLItm.RowCount(); bb++)
			{
				if ( dsSvrLItm.GetColumn(bb, "CNTR_ITM_NM") == null)
				return;
			}
						
			dsSvrLItm.AddRow(); // Record Add
			
			fcEstmYearValue();
			
			dsSvrLItm.SetColumn(dsSvrLItm.currow, "ESTM_YEAR", sEvalYear );
			dsSvrLItm.SetColumn(dsSvrLItm.currow, "ESTM_NUM", sEvalNum);
			dsSvrLItm.SetColumn(dsSvrLItm.currow, "CNTR_ITM_CD", lpad(toString(toInteger(dsSvrLItm.Max("CNTR_ITM_CD")) + 1) ,"0", 2));
			
			dsSvrMItm.AddRow(); // Record Add
			dsSvrMItm.SetColumn(dsSvrMItm.currow,"ESTM_YEAR", dsSvrLItm.GetColumn(dsSvrLItm.currow,"ESTM_YEAR") );
			dsSvrMItm.SetColumn(dsSvrMItm.currow,"ESTM_NUM", dsSvrLItm.GetColumn(dsSvrLItm.currow,"ESTM_NUM") );
			dsSvrMItm.SetColumn(dsSvrMItm.currow,"CNTR_ITM_CD", dsSvrLItm.GetColumn(dsSvrLItm.currow,"CNTR_ITM_CD") );
			dsSvrMItm.SetColumn(dsSvrMItm.currow, "FST_SND_GBN", "001" );
			dsSvrMItm.SetColumn(dsSvrMItm.currow, "CNTR_ITM_NM", "" );
			dsSvrMItm.SetColumn(dsSvrMItm.currow, "CNTR_ITM_IN", "" );
				
			dsSvrMItm.AddRow(); // Record Add
			dsSvrMItm.SetColumn(dsSvrMItm.currow,"ESTM_YEAR", dsSvrLItm.GetColumn(dsSvrLItm.currow,"ESTM_YEAR") );
			dsSvrMItm.SetColumn(dsSvrMItm.currow,"ESTM_NUM", dsSvrLItm.GetColumn(dsSvrLItm.currow,"ESTM_NUM") );
			dsSvrMItm.SetColumn(dsSvrMItm.currow,"CNTR_ITM_CD", dsSvrLItm.GetColumn(dsSvrLItm.currow,"CNTR_ITM_CD") );
			dsSvrMItm.SetColumn(dsSvrMItm.currow, "FST_SND_GBN", "002" );
			dsSvrMItm.SetColumn(dsSvrMItm.currow, "CNTR_ITM_NM", "" );
			dsSvrMItm.SetColumn(dsSvrMItm.currow, "CNTR_ITM_IN", "" );
		break;
		
		case "grpBtnSvrSItm" :
			if ( fnc_IsNull(dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_IN")) == false )
			{
				dsSvrSItm.AddRow(); // Record Add
				
				dsSvrSItm.SetColumn(dsSvrSItm.currow,"ESTM_YEAR", dsSvrLItm.GetColumn(dsSvrLItm.currow,"ESTM_YEAR") );
				dsSvrSItm.SetColumn(dsSvrSItm.currow,"ESTM_NUM", dsSvrLItm.GetColumn(dsSvrLItm.currow,"ESTM_NUM") );
				dsSvrSItm.SetColumn(dsSvrSItm.currow,"CNTR_ITM_CD", dsSvrLItm.GetColumn(dsSvrLItm.currow,"CNTR_ITM_CD") );
				dsSvrSItm.SetColumn(dsSvrSItm.currow, "CNTR_ITM_IN", dsSvrLItm.GetColumn(dsSvrLItm.currow,"CNTR_ITM_IN") );
				dsSvrSItm.SetColumn(dsSvrSItm.currow, "CNTR_ITM_NM", dsSvrLItm.GetColumn(dsSvrLItm.currow,"CNTR_ITM_NM") );
				dsSvrSItm.SetColumn(dsSvrSItm.currow, "ESTM_RATE", dsSvrLItm.GetColumn(dsSvrLItm.currow,"ESTM_RATE") );
				dsSvrSItm.SetColumn(dsSvrSItm.currow, "STND_SCR", dsSvrLItm.GetColumn(dsSvrLItm.currow,"STND_SCR") );
				dsSvrSItm.SetColumn(dsSvrSItm.currow, "ESTM_LITEM_CD", toString(dsSvrLItm.GetColumn(dsSvrLItm.currow , "CNTR_ITM_CD"))+toString(lpad(toInteger( substr(dsSvrSItm.Max("ESTM_LITEM_CD"),2,3 )) + 1  ,"0", 2)) );
				dsSvrSItm.SetColumn(dsSvrSItm.currow, "FST_SND_GBN", dsSvrMItm.GetColumn(dsSvrMItm.currow,"FST_SND_GBN") );
			}
		break;
		
		case "grpBtnMultLItm" :
			for ( var ee=0; ee<dsMultLItm.RowCount(); ee++)
			{
				if ( dsMultLItm.GetColumn(ee, "CNTR_ITM_NM") == null)
				return;
			}
			dsMultLItm.AddRow(); // Record Add
			
			fcEstmYearValue();
			
			dsMultLItm.SetColumn(dsMultLItm.currow, "ESTM_YEAR", sEvalYear );
			dsMultLItm.SetColumn(dsMultLItm.currow, "ESTM_NUM", sEvalNum);
			dsMultLItm.SetColumn(dsMultLItm.currow, "CNTR_ITM_CD", lpad(toString(toInteger(dsMultLItm.Max("CNTR_ITM_CD")) + 1) ,"0", 2));
						
		break;
		
		case "grpBtnMultMItm" :
			if ( fnc_IsNull(dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_IN")) == false )
			{
				dsMultMItm.AddRow(); // Record Add
				
				dsMultMItm.SetColumn(dsMultMItm.currow, "ESTM_YEAR", dsMultLItm.GetColumn(dsMultLItm.currow,"ESTM_YEAR") );
				dsMultMItm.SetColumn(dsMultMItm.currow, "ESTM_NUM", dsMultLItm.GetColumn(dsMultLItm.currow,"ESTM_NUM") );
				dsMultMItm.SetColumn(dsMultMItm.currow, "CNTR_ITM_CD", dsMultLItm.GetColumn(dsMultLItm.currow , "CNTR_ITM_CD") );
				dsMultMItm.SetColumn(dsMultMItm.currow, "ESTM_LITEM_CD", toString(dsMultLItm.GetColumn(dsMultLItm.currow , "CNTR_ITM_CD"))+toString(lpad(toInteger( substr(dsMultMItm.Max("ESTM_LITEM_CD"),2,3 )) + 1  ,"0", 2)) );
				dsMultMItm.SetColumn(dsMultMItm.currow, "CNTR_ITM_NM", dsMultLItm.GetColumn(dsMultLItm.currow,"CNTR_ITM_NM") );
				dsMultMItm.SetColumn(dsMultMItm.currow, "CNTR_ITM_IN", dsMultLItm.GetColumn(dsMultLItm.currow,"CNTR_ITM_IN") );
				dsMultMItm.SetColumn(dsMultMItm.currow, "ESTM_RATE", dsMultLItm.GetColumn(dsMultLItm.currow,"ESTM_RATE") );
				
			} else {
				return;
			} 
		break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj)
{
	switch ( obj.GetForm().id )
	{
		case "grpBtnPrmLItm" :
			for(var i=dsPrmSItm.RowCount()-1; i>=0; i--)
			{
				if( dsPrmSItm.GetColumn(i,"CNTR_ITM_CD") == dsPrmLItm.GetColumn(dsPrmLItm.currow, "CNTR_ITM_CD") )
				{
					dsPrmSItm.DeleteRow(i);
				}
			}
			
			for(var p=dsPrmMItm.RowCount()-1; p>=0; p--)
			{
				if( dsPrmMItm.GetColumn(p,"CNTR_ITM_CD") == dsPrmLItm.GetColumn(dsPrmLItm.currow, "CNTR_ITM_CD") )
				{
					dsPrmMItm.DeleteRow(p);
				}
			}
			
			var sFilter = "CNTR_ITM_CD== '" + dsPrmLItm.GetColumn(dsPrmLItm.currow , "CNTR_ITM_CD") +"'";
			dsPrmMItm.Filter(sFilter);
	
			var sFilter2 = "ESTM_LITEM_CD== '" + dsPrmMItm.GetColumn(0, "ESTM_LITEM_CD") + "'";
			dsPrmSItm.Filter(sFilter2);
			
			dsPrmLItm.DeleteRow(dsPrmLItm.lastrow);
		break;
		
		case "grpBtnPrmMItm" :
			//if ( !fnc_DeleteCheck(dsPrmMItm, "CHK", "1") ) return;
			
						
			for(var i=dsPrmSItm.RowCount()-1; i>=0; i--)
			{
				if( dsPrmSItm.GetColumn(i,"ESTM_LITEM_CD") == dsPrmMItm.GetColumn(dsPrmMItm.currow, "ESTM_LITEM_CD") )
				{
					dsPrmSItm.DeleteRow(i);
				}
			}
			
			var sFilter2 = "ESTM_LITEM_CD== '" + dsPrmMItm.GetColumn(dsPrmMItm.currow , "ESTM_LITEM_CD") + "'";
			dsPrmSItm.Filter(sFilter2);
			
			var nCal = 0;
			
			for (var i=0; i < dsPrmSItm.Rowcount(); i++)
			{
				if( dsPrmSItm.GetColumn(i, "CNTR_ITM_CD") == dsPrmLItm.GetColumn(dsPrmLItm.rowposition, "CNTR_ITM_CD") )
				{
					nCal = toNumber(nCal) + toNumber(dsPrmSItm.GetColumn(i,"ESTM_RATE")); 
				}
			}
			
			dsPrmMItm.SetColumn(dsPrmMItm.rowposition, "M_TOT_RT", nCal);
			
			dsPrmMItm.DeleteRow(dsPrmMItm.lastrow);
		break;
		
		case "grpBtnMnrLItm" :
			
			for(var v=dsMnrSItm.RowCount()-1; v>=0; v--)
			{
				if( dsMnrSItm.GetColumn(v,"CNTR_ITM_CD") == dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_CD") )
				{
					dsMnrSItm.DeleteRow(v);
				}
			}
			
			for(var n=dsMnrMItm.RowCount()-1; n>=0; n--)
			{
				if( dsMnrMItm.GetColumn(n,"CNTR_ITM_CD") == dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_CD") )
				{
					dsMnrMItm.DeleteRow(n);
				}
			}
			var sFilter3 = "CNTR_ITM_CD== '" + dsMnrLItm.GetColumn(dsMnrLItm.currow , "CNTR_ITM_CD") +"'";
			dsMnrMItm.Filter(sFilter3);
			dsMnrSItm.Filter(sFilter3);
			
			dsMnrLItm.DeleteRow(dsMnrLItm.lastrow);
			
		break;
		
		case "grpBtnMnrSItm" :
			if ( !fnc_DeleteCheck(dsMnrSItm, "CHK", "1") ) return;
			
		break;
		
		case "grpBtnSvrLItm" :
			
			dsSvrMItm.UnFilter();
			dsSvrSItm.UnFilter();
			for(var g=dsSvrSItm.RowCount()-1; g>=0; g--)
			{
				if( dsSvrSItm.GetColumn(g,"CNTR_ITM_CD") == dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_CD") )
				{
					dsSvrSItm.DeleteRow(g);
				}
			}
			
			for(var d=dsSvrMItm.RowCount()-1; d>=0; d--)
			{
				if( dsSvrMItm.GetColumn(d,"CNTR_ITM_CD") == dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_CD") )
				{
					dsSvrMItm.DeleteRow(d);
				}
			}
			var sFilter4 = "CNTR_ITM_CD== '" + dsSvrLItm.GetColumn(dsSvrLItm.currow , "CNTR_ITM_CD") +"'";
			dsSvrMItm.Filter(sFilter4);
			dsSvrSItm.Filter(sFilter4);
			
			dsSvrLItm.DeleteRow(dsSvrLItm.lastrow);
		break;
		
		case "grpBtnSvrSItm" :
			if ( !fnc_DeleteCheck(dsSvrSItm, "CHK", "1") ) return;
			
		break;
		
		case "grpBtnMultLItm" :
			
			for(var p=dsMultMItm.RowCount()-1; p>=0; p--)
			{
				if( dsMultMItm.GetColumn(p,"CNTR_ITM_CD") == dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_CD") )
				{
					dsMultMItm.DeleteRow(p);
				}
			}
			
			var sFilter = "CNTR_ITM_CD== '" + dsMultLItm.GetColumn(dsMultLItm.currow , "CNTR_ITM_CD") +"'";
			dsMultMItm.Filter(sFilter);
			
			dsMultLItm.DeleteRow(dsMultLItm.lastrow);
			
		break;
		
		case "grpBtnMultMItm" :
			if ( !fnc_DeleteCheck(dsMultMItm, "CHK", "1") ) return;
			
		break;
	}
}

function fsDsColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    switch ( obj.id )
	{
		case "dsPrmLItm" :
			if ( strColumnID != "TOT_RT" )
			{
				dsPrmMItm.FireEvent = false;
				dsPrmMItm.UnFilter();
				
				for (var k=0; k<dsPrmMItm.RowCount(); k++)
				{
					if( dsPrmMItm.GetColumn(k, "CNTR_ITM_CD") == dsPrmLItm.GetColumn(dsPrmLItm.currow, "CNTR_ITM_CD") )
					{
						dsPrmMItm.SetColumn(k , "CNTR_ITM_IN", dsPrmLItm.GetColumn(dsPrmMItm.currow, "CNTR_ITM_IN") );
						dsPrmMItm.SetColumn(k , "CNTR_ITM_NM", dsPrmLItm.GetColumn(dsPrmMItm.currow, "CNTR_ITM_NM") );
					}
				}
				
				var sFilter = "CNTR_ITM_CD == '" + dsPrmLItm.GetColumn(dsPrmLItm.currow, "CNTR_ITM_CD") +"'";
				dsPrmMItm.Filter(sFilter);
				dsPrmMItm.FireEvent = true;
			}
		break;
		//두번째 그리드 값 변경시 세번째 그리드 적용
		case "dsPrmMItm" :
			if( strColumnID == "ESTM_LITEM_NM")
			{
				for (var k=0; k<dsPrmSItm.RowCount(); k++)
				{
					if( dsPrmSItm.GetColumn(k, "ESTM_LITEM_CD") == dsPrmMItm.GetColumn(dsPrmMItm.currow, "ESTM_LITEM_CD") )
					{
						dsPrmSItm.SetColumn(k , "ESTM_LITEM_NM" ,dsPrmMItm.GetColumn(dsPrmMItm.currow, "ESTM_LITEM_NM") );
						dsPrmSItm.SetColumn(k , "ESTM_LITEM_NM" ,dsPrmMItm.GetColumn(dsPrmMItm.currow, "ESTM_LITEM_NM") );
					}
				}
			}
			if( strColumnID == "ESTM_LITEM_TYPE" || strColumnID == "LITEM_DEF" || strColumnID == "LITEM_CNDR")
			{
				for (var k=0; k<dsPrmSItm.RowCount(); k++)
				{
					if( dsPrmSItm.GetColumn(k, "ESTM_LITEM_CD") == dsPrmMItm.GetColumn(dsPrmMItm.currow, "ESTM_LITEM_CD") )
					{
						dsPrmSItm.SetColumn(k , "ESTM_LITEM_TYPE" ,dsPrmMItm.GetColumn(dsPrmMItm.currow, "ESTM_LITEM_TYPE") );
						dsPrmSItm.SetColumn(k , "LITEM_DEF" ,      dsPrmMItm.GetColumn(dsPrmMItm.currow, "LITEM_DEF") );
						dsPrmSItm.SetColumn(k , "LITEM_CNDR" ,     dsPrmMItm.GetColumn(dsPrmMItm.currow, "LITEM_CNDR") );
					}
				}
			}
			
			if (strColumnID == "M_TOT_RT")
			{
				var xCal = 0;
			
				for (var l=0; l < dsPrmMItm.Rowcount(); l++)
				{
					if( dsPrmMItm.GetColumn(l, "CNTR_ITM_CD") == dsPrmLItm.GetColumn(dsPrmLItm.rowposition, "CNTR_ITM_CD") )
					{
						xCal = toNumber(xCal) + toNumber(dsPrmMItm.GetColumn(l,"M_TOT_RT")); 
					}
				}
				
				dsPrmLItm.SetColumn(dsPrmLItm.rowposition, "TOT_RT", xCal);
			}
		break;
		
		case "dsPrmSItm" :
			if ( strColumnID == "ESTM_RATE" )
			{
				var nCal = 0;
			
				for (var i=0; i < dsPrmSItm.Rowcount(); i++)
				{
					if( dsPrmSItm.GetColumn(i, "CNTR_ITM_CD") == dsPrmLItm.GetColumn(dsPrmLItm.rowposition, "CNTR_ITM_CD") )
					{
						nCal = toNumber(nCal) + toNumber(dsPrmSItm.GetColumn(i,"ESTM_RATE")); 
					}
				}
				
				dsPrmMItm.SetColumn(dsPrmMItm.rowposition, "M_TOT_RT", nCal);
			}
		break;
		
		case "dsMnrLItm" :
			if( strColumnID == "CNTR_ITM_NM" )
			{
				for (var y=0; y<dsMnrMItm.RowCount(); y++)
				{
					if( dsMnrMItm.GetColumn(y, "CNTR_ITM_CD") == dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_CD") )
					{
						dsMnrMItm.SetColumn(y , "CNTR_ITM_IN", dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_IN") );
						dsMnrMItm.SetColumn(y , "CNTR_ITM_NM", dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_NM") );
					}
				}
			}
			if( strColumnID == "ESTM_RATE" )
			{
				for (var t=0; t<dsMnrSItm.RowCount(); t++)
				{
					if( dsMnrSItm.GetColumn(t, "CNTR_ITM_CD") == dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_CD") )
					{
						dsMnrSItm.SetColumn(t , "ESTM_RATE", dsMnrLItm.GetColumn(dsMnrLItm.currow, "ESTM_RATE") );
					}
				}
			}
			if( strColumnID == "STND_SCR" )
			{
				for (var h=0; h<dsMnrSItm.RowCount(); h++)
				{
					if( dsMnrSItm.GetColumn(h, "CNTR_ITM_CD") == dsMnrLItm.GetColumn(dsMnrLItm.currow, "CNTR_ITM_CD") )
					{
						dsMnrSItm.SetColumn(h , "STND_SCR", dsMnrLItm.GetColumn(dsMnrLItm.currow, "STND_SCR") );
					}
				}
			}
		break;
		
		case "dsMnrSItm" :
			if( strColumnID == "ESTM_SCR" ) {
				if( varNewValue < 0 ) {
					obj.FireEvent = false;
					obj.SetColumn(nRow, strColumnID, "");
					obj.FireEvent = true;
					fnc_Message(SNIS_RBM_F048, "N");
				}
			}
		break;
		
		case "dsSvrLItm" :
			if( strColumnID == "CNTR_ITM_NM" )
			{
				for (var x=0; x<dsSvrMItm.RowCount(); x++)
				{
					if( dsSvrMItm.GetColumn(x, "CNTR_ITM_CD") == dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_CD") )
					{
						dsSvrMItm.SetColumn(x , "CNTR_ITM_IN", dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_IN") );
						dsSvrMItm.SetColumn(x , "CNTR_ITM_NM", dsMnrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_NM") );
					}
				}
			}
			if( strColumnID == "ESTM_RATE" )
			{
				for (var t=0; t<dsSvrSItm.RowCount(); t++)
				{
					if( dsSvrSItm.GetColumn(t, "CNTR_ITM_CD") == dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_CD") )
					{
						dsSvrSItm.SetColumn(t , "ESTM_RATE", dsSvrLItm.GetColumn(dsSvrLItm.currow, "ESTM_RATE") );
					}
				}
			}
			if( strColumnID == "STND_SCR" )
			{
				for (var a=0; a<dsSvrSItm.RowCount(); a++)
				{
					if( dsSvrSItm.GetColumn(a, "CNTR_ITM_CD") == dsSvrLItm.GetColumn(dsSvrLItm.currow, "CNTR_ITM_CD") )
					{
						dsSvrSItm.SetColumn(a , "STND_SCR", dsSvrLItm.GetColumn(dsSvrLItm.currow, "STND_SCR") );
					}
				}
			}
		break;
		
		case "dsSvrSItm" :
			if( strColumnID == "ESTM_SCR" ) {
				if( varNewValue < 0 ) {
					obj.FireEvent = false;
					obj.SetColumn(nRow, strColumnID, "");
					obj.FireEvent = true;
					fnc_Message(SNIS_RBM_F048, "N");
				}
			}
		break;
		
		case "dsMultLItm" :
			if ( strColumnID == "CNTR_ITM_NM" )
			{
				dsMultMItm.FireEvent = false;
				dsMultMItm.UnFilter();
				
				for (var k=0; k<dsMultMItm.RowCount(); k++)
				{
					if( dsMultMItm.GetColumn(k, "CNTR_ITM_CD") == dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_CD") )
					{
						dsMultMItm.SetColumn(k , "CNTR_ITM_IN", dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_IN") );
						dsMultMItm.SetColumn(k , "CNTR_ITM_NM", dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_NM") );
					}
				}
				
				var sFilter5 = "CNTR_ITM_CD == '" + dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_CD") +"'";
				dsMultMItm.Filter(sFilter5);
				dsMultMItm.FireEvent = true;
			}
			
			if ( strColumnID == "ESTM_RATE" )
			{
				dsMultMItm.FireEvent = false;
				dsMultMItm.UnFilter();
				
				for (var kk=0; kk<dsMultMItm.RowCount(); kk++)
				{
					if( dsMultMItm.GetColumn(kk, "CNTR_ITM_CD") == dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_CD") )
					{
						dsMultMItm.SetColumn(kk , "ESTM_RATE", dsMultLItm.GetColumn(dsMultLItm.currow, "ESTM_RATE") );
					}
				}
				
				var sFilter5 = "CNTR_ITM_CD == '" + dsMultLItm.GetColumn(dsMultLItm.currow, "CNTR_ITM_CD") +"'";
				dsMultMItm.Filter(sFilter5);
				dsMultMItm.FireEvent = true;
			}
		break;
	}
}

function fcOnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (obj.id == "cbEstmYear") {
		if (Mid(cbEstmYear.Text,0,4) == "2013") {
			tab.tabPrm.text = "역량평가항목";
		} else {
			tab.tabPrm.text = "역량평가항목";
		}
		fcSearch();  // 목록 조회 
	}
}


function fcDsOnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	if (obj.id == "dsEstmYear") {
		if (Mid(cbEstmYear.Text,0,4) == "2013") {
			tab.tabPrm.text = "역량평가항목";
		} else {
			tab.tabPrm.text = "역량평가항목";
		}
	}
}
]]></Script>
</Window>