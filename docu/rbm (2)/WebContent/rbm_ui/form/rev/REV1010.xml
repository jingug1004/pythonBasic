<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="REV1010" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="평가생성" Top="8" Ver="1.0" Width="816" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsEVCreate" OnColumnChanged="fcDsOnColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_STR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_END_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_ESTM_END_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="OPEN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRM_STR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRM_END_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESC_STR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESC_END_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CRA_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MRA_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDATE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_UPDATE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_OPN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEA_ESC_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEstmYear">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>사업상태코드</DESCRIPTION>
						<DSNAME>dsEstmYear</DSNAME>
						<QUERY_ID>rev1010_yearCombo</QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusWk">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JJOB" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusAtt">
				<Contents>
					<colinfo id="ATT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusDate">
				<Contents>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusDept">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPPER_DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_RANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LVL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsWorkEmp">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WRK_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RES_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="PWD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ESC_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MULT_ESTM_GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_WK_JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_EMP" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="MNR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="SVR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="PERM_TEMP_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_WRK_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDept">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRegEmp">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WRK_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RES_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="PWD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ESC_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MULT_ESTM_GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_WK_JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_EMP" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="MNR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="SVR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="PERM_TEMP_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_WRK_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDwComm">
				<Contents>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="TELLER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDwTelmp">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TELLER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SOLD_AVG" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_DAY_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCnt">
				<Contents>
					<colinfo id="DEL_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsUploadFile">
				<Contents>
					<colinfo id="CLS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_URL" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="CONTENT" size="256" summ="default" type="BLOB"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="5" summ="default" type="INT"/>
					<colinfo id="SEQ" size="5" summ="default" type="INT"/>
					<colinfo id="TBL_NM" size="50" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="100" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="100" summ="default" type="STRING"/>
					<colinfo id="REAL_FILE_NM" size="200" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInUploadFile">
				<Contents>
					<colinfo id="CLS_CD" size="256" type="STRING"/>
					<colinfo id="SEQ_NO" size="256" type="STRING"/>
					<colinfo id="FILE_SEQ" size="256" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" type="STRING"/>
					<colinfo id="FILE_URL" size="256" type="STRING"/>
					<colinfo id="FILE_SIZE" size="256" type="STRING"/>
					<colinfo id="INST_ID" size="256" type="STRING"/>
					<colinfo id="INST_DTM" size="256" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" type="STRING"/>
					<colinfo id="UPDT_DTM" size="256" type="STRING"/>
					<colinfo encrypt="base64" id="CONTENT" size="256" type="BLOB"/>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" type="STRING"/>
					<colinfo id="MAKE_MAN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFileMana">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="5" summ="default" type="INT"/>
					<colinfo id="SEQ" size="5" summ="default" type="INT"/>
					<colinfo id="TBL_NM" size="50" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="100" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="100" summ="default" type="STRING"/>
					<colinfo id="REAL_FILE_NM" size="200" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="10" summ="default" type="INT"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPcDiv">
				<Contents>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SELL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Font="굴림,9,Bold" Height="70" Id="Static18" Left="8" TabOrder="48" Top="377" Type="Groupbox" Width="801"></Static>
		<Div Height="28" Id="divBtnLst" Left="442" TabOrder="0" Text="Div0" Url="common::comButtonType.xml" Width="374">
			<Contents></Contents>
		</Div>
		<Static Font="굴림,9,Bold" Height="138" Id="Static0" Left="8" TabOrder="22" Top="218" Type="Groupbox" Width="665"></Static>
		<Shape BKColor="user0" Bottom="61" Height="31" Id="Shape1" Left="8" LineColor="user1" LineKind="Vertical" Right="809" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="0" Top="30" Type="RoundRect" Width="801"></Shape>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="0" Width="17"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsEVCreate" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="200" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="118" Id="grdEVCreate" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="809" SelColor="user19" Style="snis_grid" TabOrder="21" TabStop="true" Top="82" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="801">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="59"/>
						<col width="52"/>
						<col width="151"/>
						<col width="151"/>
						<col width="111"/>
						<col width="224"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="√"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="평가년도"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="평가회차"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="평가대상시작일"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="평가대상종료일"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="최종평가완료일"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9,Bold" text="비고"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="ESTM_YEAR" display="text"/>
						<cell align="center" col="2" colid="ESTM_NUM" display="text"/>
						<cell align="center" col="3" colid="PRM_STR_DT" display="date"/>
						<cell align="center" col="4" colid="PRM_END_DT" display="date"/>
						<cell align="center" col="5" colid="LAST_ESTM_END_DT" display="date"/>
						<cell align="center" col="6" colid="RMK" display="text" multiline="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Border="Flat" Height="21" Id="Static4" Left="16" Style="snis_m_lable" TabOrder="23" Text="평가기간" Top="256" VAlign="Middle" Width="80"></Static>
		<TextArea BindDataset="dsEVCreate" Border="Flat" Column="RMK" Height="48" Id="taRmk" Left="97" MaxLength="2000" Style="snis_if_input01" TabOrder="8" Top="301" Width="555"></TextArea>
		<Static Align="Right" Border="None" Height="20" Id="Static10" Left="10" Style="snis_if_lable" TabOrder="24" Text="년도" Top="34" VAlign="Middle" Width="54"></Static>
		<Static Font="굴림,10,Bold" Height="22" Id="stFormTitle" Left="24" Style="snis_m_title" TabOrder="25" Text="평가내역" VAlign="Middle" Width="430"></Static>
		<Static Align="Right" Border="Flat" Height="48" Id="Static2" Left="16" Style="snis_m_lable" TabOrder="26" Text="비&#32;&#32;&#32;&#32;&#32;&#32;고" Top="301" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Border="Flat" Height="21" Id="Static1" Left="16" Style="snis_m_lable" TabOrder="27" Text="평가회차" Top="278" VAlign="Middle" Width="80"></Static>
		<Image Height="20" Id="Image0" ImageID="m_titleblet2" Left="11" TabOrder="28" Top="204" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="Static3" Left="32" Style="snis_m_title" TabOrder="29" Text="기본정보" Top="202" VAlign="Middle" Width="118"></Static>
		<Calendar BindDataset="dsEVCreate" Border="Flat" Column="ESTM_STR_DT" Height="21" Id="calEvStrDt" Left="98" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="4" Top="256" Width="90"></Calendar>
		<Calendar BindDataset="dsEVCreate" Border="Flat" Column="ESTM_END_DT" Height="21" Id="calEvEndDt" Left="211" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="5" Top="256" Width="90"></Calendar>
		<Combo Border="Flat" CodeColumn="ESTM_YEAR" DataColumn="ESTM_YEAR" Height="19" Id="cboSchYear" ImeMode="none" InnerDataset="dsEstmYear" Left="78" OnChanged="fcCboOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="1" Top="34" Width="108">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Div Height="20" Id="revBtnRow" Left="769" Style="snis_grid" TabOrder="30" Text="Div0" ToolTipText="그룹코드" Top="62" Url="common::comButtonRow.xml" Width="40">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Border="Flat" Height="21" Id="Static6" Left="16" Style="snis_m_lable" TabOrder="31" Text="평가년도" Top="234" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="ESTM_NUM" Enable="FALSE" Height="21" Id="edEstmTms" Left="98" Number="TRUE" Style="snis_if_input01" TabOrder="32" Top="278" Width="90"></Edit>
		<Static Align="Center" Border="None" Color="user4" Height="20" Id="Static5" Left="194" Style="snis_m_stitle" TabOrder="33" Text="~" Top="256" VAlign="Middle" Width="10"></Static>
		<Image Height="20" Id="Image1" ImageID="m_titleblet2" Left="11" TabOrder="34" Top="454" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="Static7" Left="32" Style="snis_m_title" TabOrder="35" Text="파일첨부" Top="452" VAlign="Middle" Width="118"></Static>
		<Edit Align="RIGHT" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="ESTM_YEAR" Enable="FALSE" Height="21" Id="edEstmYear" Left="98" Number="TRUE" Style="snis_if_input01" TabOrder="16" Top="234" Width="90"></Edit>
		<Static Align="Right" Border="Flat" Height="21" Id="Static8" Left="368" Style="snis_m_lable" TabOrder="36" Text="근무제외기간" Top="256" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="dsEVCreate" Border="Flat" Column="ESC_STR_DT" Height="21" Id="calEscStrDt" Left="449" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="6" Top="256" Width="90"></Calendar>
		<Calendar BindDataset="dsEVCreate" Border="Flat" Column="ESC_END_DT" Height="21" Id="calEscEndDt" Left="562" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="7" Top="256" Width="90"></Calendar>
		<Static Align="Right" Border="Flat" Height="21" Id="Static9" Left="368" Style="snis_m_lable" TabOrder="37" Text="평가대상기간" Top="234" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="dsEVCreate" Border="Flat" Column="PRM_STR_DT" Height="21" Id="calPrmStrDt" Left="449" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="2" Top="234" Width="90"></Calendar>
		<Calendar BindDataset="dsEVCreate" Border="Flat" Column="PRM_END_DT" Height="21" Id="calPrmEndDt" Left="562" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="3" Top="234" Width="90"></Calendar>
		<Static Align="Center" Border="None" Color="user4" Height="20" Id="Static11" Left="545" Style="snis_m_stitle" TabOrder="38" Text="~" Top="237" VAlign="Middle" Width="10"></Static>
		<Static Align="Center" Border="None" Color="user4" Height="20" Id="Static12" Left="545" Style="snis_m_stitle" TabOrder="39" Text="~" Top="256" VAlign="Middle" Width="10"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsUploadFile" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="566" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="94" Id="grdUploadFile" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" OnCellDBLClick="fcGrdOnCellDBLClick" Right="809" SelColor="user19" Style="snis_grid" TabOrder="40" TabStop="true" Top="472" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="801">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="730"/>
					</columns>
					<head>
						<cell autosizing="keep" bkcolor="user20" col="0" color="user21" display="text" text="√"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="첨부파일"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="FILE_NM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="20" Id="fileBtnRow" Left="769" Style="snis_grid" TabOrder="17" Text="Div0" Top="449" Url="common::comButtonRow.xml" Width="38">
			<Contents></Contents>
		</Div>
		<FileDialog Bottom="470" Height="24" Id="fdSaveAs" Left="720" Right="744" TabOrder="35" Top="446" Width="24"></FileDialog>
		<Button ButtonStyle="TRUE" Color="user0" Cursor="HAND" Font="굴림,9,Bold" Height="82" Id="btnEstmEnd" ImageID="btn_ev_end" Left="695" OnClick="fcBtnOnClick" TabOrder="14" Text="기초자료생성" Top="234" Width="102"></Button>
		<Button ButtonStyle="TRUE" Color="user0" Cursor="HAND" Enable="FALSE" Font="굴림,9,Bold" Height="23" Id="btnTelmp" ImageID="btn_ev_status" Left="703" OnClick="fcBtnOnClick" TabOrder="15" Text="발매실적" Top="322" Visible="FALSE" Width="85"></Button>
		<Static Align="Right" Border="Flat" Height="21" Id="Static14" Left="369" Style="snis_m_lable" TabOrder="41" Text="담당자" Top="278" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="MNG_NO" Enable="FALSE" Height="21" Id="edMngNO" Left="450" Number="TRUE" Style="snis_if_input01" TabOrder="42" Top="278" Width="87"></Edit>
		<Static Align="Right" Border="Flat" Height="21" Id="Static15" Left="153" Style="snis_m_lable" TabOrder="43" Text="경륜(%)" Top="415" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="CRA_RATE" Height="21" Id="edCraRate" Left="234" MaxLength="2" Number="TRUE" Style="snis_if_input01" TabOrder="11" Top="415" Width="91"></Edit>
		<Static Align="Right" Border="Flat" Height="21" Id="Static16" Left="326" Style="snis_m_lable" TabOrder="44" Text="경정(%)" Top="415" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="MRA_RATE" Height="21" Id="edMraRate" Left="407" MaxLength="2" Number="TRUE" Style="snis_if_input01" TabOrder="12" Top="415" Width="91"></Edit>
		<Edit Align="RIGHT" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="RELEA_RATE" Height="21" Id="edReleaRate" Left="153" MaxLength="2" Number="TRUE" OnChanged="edReleaRate_OnChanged" Style="snis_if_input01" TabOrder="9" Text="10" Top="393" Width="91"></Edit>
		<Edit Align="CENTER" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="MNG_NM" Enable="FALSE" Height="21" Id="edMngNm" Left="538" Style="snis_if_input01" TabOrder="45" Top="278" Width="87"></Edit>
		<Button BKColor="user0" Height="16" Id="btnMngPop" ImageID="btn_pop_search" Left="631" OnClick="fcBtnOnClick" TabOrder="13" Text="Button1" Top="280" Width="16"></Button>
		<Image Height="20" Id="Image2" ImageID="m_titleblet2" Left="11" TabOrder="46" Top="361" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="Static13" Left="32" Style="snis_m_title" TabOrder="47" Text="평가비율" Top="359" VAlign="Middle" Width="118"></Static>
		<Static Align="Right" Border="Flat" Height="21" Id="Static19" Left="16" Style="snis_m_lable" TabOrder="49" Text="발매실적&#32;적용비율(%)" Top="393" VAlign="Middle" Width="136"></Static>
		<Static Align="Right" Border="Flat" Height="21" Id="Static20" Left="16" Style="snis_m_lable" TabOrder="50" Text="공동근무자&#32;평가비율" Top="415" VAlign="Middle" Width="136"></Static>
		<Static Align="Right" Border="Flat" Height="21" Id="Static17" Left="326" Style="snis_m_lable" TabOrder="51" Text="발매최소건수" Top="393" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="dsEVCreate" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="RELEA_ESC_CNT" Enable="FALSE" Height="21" Id="edEscCnt" Left="407" MaxLength="3" Number="TRUE" OnChanged="edEscCnt_OnChanged" Style="snis_if_input01" TabOrder="10" Text="10" Top="393" Width="91"></Edit>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = this.GetForm().id;
var sBUTTONLIST   = "FFFFTFT";                         //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = "";                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = "";                                //Form의 Title 정보
var sFORMLOCATION = "";                                //Form의 Location 정보
var sUSERLAVEL    = "";                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트
 
var sMenuGrpNum     = "0";                             // 메뉴그룹의 갯수보관
var sMenuListNum    = "0";                             // 메뉴리스트의 갯수보관
var sMenuUpId       = "";
var sMenuUpNm       = "";

var sEvalYear = "";
var sEvalNum  = "";

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'FTTFFFT';
  
    //화면환경 설정
    sFORMCAPTION  = obj.Title;
    sFORMLOCATION = "";

    //화면 정보 Display 및 Button 권한 설정
    fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
    
    //공통코드 조회
    fcd_GetComboDs(dsInComCd);
    
    //년도 정보 없을 때, 현재년도로 추가
    if ( dsEstmYear.RowCount() == 0 ) {
		dsEstmYear.AddRow();
		dsEstmYear.SetColumn(0,"ESTM_YEAR",fcd_GetSysdate("YYYY")); 
    }
    
	//현재년도 없을 시, 추가
	if( dsEstmYear.FindRow("ESTM_YEAR", fcd_GetSysdate("YYYY")) == -1 ) {
		dsEstmYear.InsertRow(0);
		dsEstmYear.SetColumn(0, "ESTM_YEAR", fcd_GetSysdate("YYYY"));
		cboSchYear.Index = 0;
	}
	
	//저장권한 없을 시, '기초자료생성', '발매실적 버튼 비활성화'
	if( sInpt == "F") {
		btnEstmEnd.Enable = false;
		btnTelmp  .Enable = false;
	}

    fcSearch();  //시작시 조회
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
    //자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
    var sDataset = "dsEVCreate|dsUploadFile";
    if (!fnc_FormUnloadCheck(sDataset, sFormId)) return false;
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
    dsEVCreate  .ClearData();  
    dsUploadFile.ClearData();
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
    fcInit(obj); 
    return true;
}

function fcSearch(obj) {
    if ( !fcSearchCheck(obj) ) return;

    var sServiceName = "rev1010-service:searchList";
    var sInDataSet   = "";
    var sOutDataSet  = "dsEVCreate=dsEVCreate ";     
    
    //조회조건
    fcd_AddParam("ESTM_YEAR", cboSchYear.Value); 
    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

//첨부파일 조회
function fcSearchFile(sAttFileKey){	
    var sServiceName = "common_file-service:searchFileMana";
    var sInDataSet   = "";
    var sOutDataSet  = "dsUploadFile=dsUploadFile ";
    
    //조회조건
    fcd_AddParam("ATT_FILE_KEY", sAttFileKey);
    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}
/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {  
    //변경된 자료가 있는지 체크
    if ( !fnc_DatasetChangeCheck(dsEVCreate) && 
         !fnc_DatasetChangeCheck(dsUploadFile)) {
        //저장 할 자료가 없음
        fnc_Message(SNIS_COM_1006, "N");    
        return false;
    }
    
    // 필수항목체크
    oDataSet          = dsEVCreate;
    sMandatoryColID   = "ESTM_YEAR|ESTM_NUM|PRM_STR_DT|PRM_END_DT|ESTM_STR_DT|ESTM_END_DT|"
                      + "ESC_STR_DT|ESC_END_DT|MNG_NO|RELEA_RATE|CRA_RATE|MRA_RATE|RELEA_ESC_CNT";
    sMandatoryColName = "평가년도|평가회차|평가대상기간|평가대상기간|평가기간|평가기간|"
                      + "근무제외기간|근무제외기간|담당자|발매비율|경륜비율|경정비율|발매제외건수";
    oGrid             = grdEVCreate;
    if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
        return false;
    }
    
    return true;
}

function fcSave(obj) {

    if ( !fcSaveCheck() ) return;
       
    var sServiceName = "rev1010-service:saveEVMistr";
    var sInDataSet   = "dsUploadFile=dsUploadFile:u dsEVCreate=dsEVCreate:u ";
    var sOutDataSet  = "dsEVCreate=dsEVCreate";    
    
    //첨부파일 서버 업로드 
    if( dsUploadFile.GetRowCount() > 0 ) {
        for (var i = 0 ; i < dsUploadFile.GetRowCount() ; i++ ) {
            if(dsUploadFile.GetRowType(i) == "insert" ) {
                var rtn_arr = fnc_FileWrite(  divBtnLst.HttpFile 
                                            , dsUploadFile.GetColumn(i, "FILE_PATH" )
                                            , dsUploadFile.GetColumn(i, "FILE_NM" ) 
                                            ,"");
    
                var fileSize = divBtnLst.HttpFile.GetFileSizeLocal(dsUploadFile.GetColumn(i, "FILE_PATH" ));
                
                if ( rtn_arr[0] != "SUCC" ) {
                    fnc_Message(SNIS_COM_1050, "N", rtn_arr[1]);
                    return false;
                }
            
                dsUploadFile.SetColumn(i, "FILE_PATH", rtn_arr[1] );
                dsUploadFile.SetColumn(i, "FILE_SIZE", fileSize );
            } // end if
        }
    } // end        
    
    fcd_AddParam("ESTM_YEAR", sEvalYear);   
    fcd_AddParam("ESTM_NUM" , sEvalNum);    
    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
    //화면 종료
    Close();    
}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
    //특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
    fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
    
    if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
    
    // 기초자료생성 조회 완료 후
    if ( sServiceName == "rev1010-service:searchVenusWk" ) {
        for(var i = 0; i < dsRegEmp.rowcount ; i++) {
            
            var sEmpNo  = dsRegEmp.GetColumn(i, "EMP_NO");
			
            if( dsWorkEmp.FindRowNF("EMP_NO", sEmpNo) == -1 ) {
                var nRow = dsWorkEmp.AddRow();
                
                dsWorkEmp.SetColumn(nRow, "DEPT_CD", dsRegEmp.GetColumn(i, "DEPT_CD"));
                dsWorkEmp.SetColumn(nRow, "WRK_GBN", dsRegEmp.GetColumn(i, "WRK_GBN")); 
                
                dsWorkEmp.SetColumn(nRow, "EMP_NO" , dsRegEmp.GetColumn(i, "EMP_NO"));
                dsWorkEmp.SetColumn(nRow, "EMP_NM" , dsRegEmp.GetColumn(i, "EMP_NM"));
                dsWorkEmp.SetColumn(nRow, "RES_NO" , dsRegEmp.GetColumn(i, "RES_NO"));
                dsWorkEmp.SetColumn(nRow, "ESTM_DEPT", dsRegEmp.GetColumn(i, "ESTM_DEPT"));
                
                dsWorkEmp.SetColumn(nRow, "PWD_NO"    , dsRegEmp.GetColumn(i, "PWD_NO"));
                dsWorkEmp.SetColumn(nRow, "WK_JOB_CD" , dsRegEmp.GetColumn(i, "WK_JOB_CD"));
                dsWorkEmp.SetColumn(nRow, "APT_DT"    , dsRegEmp.GetColumn(i, "APT_DT"));
                dsWorkEmp.SetColumn(nRow, "JOB_TIT_CD", dsRegEmp.GetColumn(i, "JOB_TIT_CD"));
                dsWorkEmp.SetColumn(nRow, "JOB_TIT_NM", dsRegEmp.GetColumn(i, "JOB_TIT_NM"));
                
                dsWorkEmp.SetColumn(nRow, "HP_NO"      , dsRegEmp.GetColumn(i, "HP_NO"));
                dsWorkEmp.SetColumn(nRow, "ESTM_ESC_GBN" , dsRegEmp.GetColumn(i, "ESTM_ESC_GBN"));
                dsWorkEmp.SetColumn(nRow, "FST_SND_GBN", dsRegEmp.GetColumn(i, "FST_SND_GBN"));
                dsWorkEmp.SetColumn(nRow, "MNG_GBN"    , dsRegEmp.GetColumn(i, "MNG_GBN"));
                dsWorkEmp.SetColumn(nRow, "MULT_ESTM_GRP", dsRegEmp.GetColumn(i, "MULT_ESTM_GRP"));
                
                dsWorkEmp.SetColumn(nRow, "CNL_GBN"  , dsRegEmp.GetColumn(i, "CNL_GBN"));
                dsWorkEmp.SetColumn(nRow, "ESTM_WK_JOB", dsRegEmp.GetColumn(i, "ESTM_WK_JOB"));
                dsWorkEmp.SetColumn(nRow, "ESTM_EMP" , dsRegEmp.GetColumn(i, "ESTM_EMP"));
                dsWorkEmp.SetColumn(nRow, "COMM_NO"  , dsRegEmp.GetColumn(i, "COMM_NO"));
                dsWorkEmp.SetColumn(nRow, "DIV_NO"   , dsRegEmp.GetColumn(i, "DIV_NO"));
                
                dsWorkEmp.SetColumn(nRow, "MNR_FST_SND"  , dsRegEmp.GetColumn(i, "MNR_FST_SND"));
                dsWorkEmp.SetColumn(nRow, "SVR_FST_SND"  , dsRegEmp.GetColumn(i, "SVR_FST_SND")); 
                dsWorkEmp.SetColumn(nRow, "PERM_TEMP_GBN", dsRegEmp.GetColumn(i, "PERM_TEMP_GBN"));
                dsWorkEmp.SetColumn(nRow, "CO_WRK_GBN"   , dsRegEmp.GetColumn(i, "CO_WRK_GBN")); 
            }
        }
		
        dsRegEmp.ClearData();
        dsRegEmp.Copy(dsWorkEmp);
		
        sServiceName = "rev1010-service:saveData";
        sInDataSet   = "dsVenusWk=dsVenusWk:a "
                     + "dsVenusAtt=dsVenusAtt:a "
                     + "dsVenusDate=dsVenusDate:a "
                     + "dsVenusDept=dsVenusDept:a "
                     + "dsDept=dsDept:a "
                     + "dsRegEmp=dsRegEmp:a "
                     + "dsDwComm=dsDwComm:a "
                     + "dsDwTelmp=dsDwTelmp:a "
                     + "dsPcDiv=dsPcDiv:a "; 
        sOutDataSet  = "";  
        
        //서버에 보낼값
        fcd_AddParam("ESTM_YEAR", dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_YEAR"));
        fcd_AddParam("ESTM_NUM" , dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_NUM"));
       
        fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
    }       
    
    // 발매실적 조회 완료 후
    if ( sServiceName == "rev1010-service:searchDwTelmp" ) {
        sServiceName = "rev1010-service:saveTelmp";
        sInDataSet   = "dsDwTelmp=dsDwTelmp:a dsDwComm=dsDwComm:a";
        sOutDataSet  = "";  

        //서버에 보낼값
        fcd_AddParam("ESTM_YEAR", dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_YEAR"));
        fcd_AddParam("ESTM_NUM" , dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_NUM"));
        
        fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
    }
    
    // 조회 완료 후
    if ( sServiceName == "rev1010-service:searchCnt" ) {  
        if( dsCnt.GetColumn(dsCnt.currow, "DEL_YN") == "Y" ) {
            btnEstmEnd.Text = "기초자료재생성";
        } else {
            btnEstmEnd.Text = "기초자료생성";
        }
    }
    
    // 평가마스터 저장 완료 후
    if ( sServiceName == "rev1010-service:saveEVMistr" ) {
        fcSearch();     
    }
        
    // 기초자료생성 OR 발매실적 저장 완료 후
    if ( sServiceName == "rev1010-service:saveData" ||
         sServiceName == "rev1010-service:searchDwTelmp" ) {
        var ARRAY2_GBL_RET_VALUE = split2(GBL_RET_VALUE,"^","=");
        var sResult = fnc_Array2Value(ARRAY2_GBL_RET_VALUE, "RESULT"); // 결과

        if( sResult == "0") {	//정상적으로 내려받았을 때, 사용자에게 메세지
            fnc_Message(SNIS_RBM_F030, "N");
        }
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {
    //DataSet의 Header 정보가 있을 때  Add 처리  
    switch ( obj.GetForm().id ) {
        case "revBtnRow" :
            //현재 진행중인 평가를 개시한 이후에 새로운 평가를 추가할 수 있음
            for(var i = 0 ; i < dsEVCreate.rowcount ; i++ ) {
                if( dsEVCreate.GetColumn(i, "OPEN_YN") != "Y" ) {
                    fnc_Message(SNIS_RBM_F026, "N", dsEVCreate.GetColumn(i, "ESTM_YEAR"), dsEVCreate.GetColumn(i, "ESTM_NUM"));
                    return;
                }
            }
            dsEVCreate.AddRow(); 
            edEstmYear.text = cboSchYear.Value;
            edEstmTms.value = dsEVCreate.rowcount;  //평가 회차
            edReleaRate.SetFocus(); 				// 입력 첫 항목으로 Focus

            break;
            
        case "fileBtnRow" : // 첨부파일 추가
            var sResponse = fcd_GetSelectFile();  
              
            if ( fnc_IsNull(sResponse) ) return;
        
            var nRow = dsUploadFile.addRow();
        
            dsUploadFile.SetColumn(nRow, "ATT_FILE_KEY", dsEVCreate.GetColumn(dsEVCreate.row,"ATT_FILE_KEY"));
			dsUploadFile.SetColumn(nRow, "FILE_PATH"   , sResponse[0] + "\\" + sResponse[1]);
			dsUploadFile.SetColumn(nRow, "FILE_NM"     , sResponse[1]);
            
            break;          
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj)
{
    switch ( obj.GetForm().id ) {
        case "revBtnRow" :	//평가마스터
            if ( !fnc_DeleteCheck(dsEVCreate, "CHK", "1") ) return;
            break;
        
        case "fileBtnRow" :	//첨부파일
            if ( !fnc_DeleteCheck(dsUploadFile, "CHK", "1") ) return;
            break;
    }
}


/*-------------------------------------------------------------------------------------------------+
>>  컬럼이 변경될 때
+-------------------------------------------------------------------------------------------------*/
function fcDsOnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    switch( obj.id ) {
        case "dsEVCreate" :	//평가마스터
			if( strColumnID == "CHK" ) {
				if(varNewValue == 1) {   //체크박스 선택
					//내가 선택한 체크박스 로우에  윗 로우부분과 아래 로우부분은 무조건 0으로 세팅  
					for(var i = 0; i < nRow ; i++) {                               
						dsEVCreate.SetColumn(i, "CHK", 0); 
					}
					for(var i = nRow+1; i< dsEVCreate.rowcount ; i++) {
						dsEVCreate.SetColumn(i, "CHK", 0);
					}
				}
			}
            
            //평가대상기간
            if( strColumnID=="PRM_STR_DT" || strColumnID == "PRM_END_DT") {
                
                var nStrDt = dsEVCreate.GetColumn(nRow, "PRM_STR_DT");
                var nEndDt = dsEVCreate.GetColumn(nRow, "PRM_END_DT");
                
                if( !fnc_IsNull(nStrDt) && !fnc_IsNull(nEndDt) ) {
                    if( nEndDt < nStrDt ) {
                        fnc_Message(SNIS_RBM_E002, "N");
                        dsEVCreate.fireEvent = false;
                        dsEVCreate.SetColumn(nRow, strColumnID, "");
                        dsEVCreate.fireEvent = true;
                        return;
                    }
                }
            }
            //평가기간
            if( strColumnID=="ESTM_STR_DT" || strColumnID == "ESTM_END_DT") {
                
                var nStrDt = dsEVCreate.GetColumn(nRow, "ESTM_STR_DT");
                var nEndDt = dsEVCreate.GetColumn(nRow, "ESTM_END_DT");
                
                if( !fnc_IsNull(nStrDt) && !fnc_IsNull(nEndDt) ) {
                    if( nEndDt < nStrDt ) {
                        fnc_Message(SNIS_RBM_E002, "N");
                        dsEVCreate.fireEvent = false;
                        dsEVCreate.SetColumn(nRow, strColumnID, "");
                        dsEVCreate.fireEvent = true;
                        return;
                    }
                }
                
                
            }
            //근무제외기간
            if( strColumnID=="ESC_STR_DT" || strColumnID == "ESC_END_DT") {

                var nStrDt = dsEVCreate.GetColumn(nRow, "ESC_STR_DT");
                var nEndDt = dsEVCreate.GetColumn(nRow, "ESC_END_DT");
                
                if( !fnc_IsNull(nStrDt) && !fnc_IsNull(nEndDt) ) {
                    if( nEndDt < nStrDt ) {
                        fnc_Message(SNIS_RBM_E002, "N");
                        dsEVCreate.fireEvent = false;
                        dsEVCreate.SetColumn(nRow, strColumnID, "");
                        dsEVCreate.fireEvent = true;
                        return;
                    }
                }
            }
            
            //평가대상기간 > 근무제외기간
            if( strColumnID=="PRM_STR_DT" || strColumnID == "PRM_END_DT" ||
                strColumnID=="ESC_STR_DT" || strColumnID == "ESC_END_DT" ) {
                
                var nPrmStrDt = dsEVCreate.GetColumn(nRow, "PRM_STR_DT");
                var nPrmEndDt = dsEVCreate.GetColumn(nRow, "PRM_END_DT");
                var nEscStrDt = dsEVCreate.GetColumn(nRow, "ESC_STR_DT");
                var nEscEndDt = dsEVCreate.GetColumn(nRow, "ESC_END_DT");

                if( (nPrmStrDt > nEscStrDt) || (nPrmEndDt < nEscEndDt) ) {
                    fnc_Message(SNIS_RBM_F028, "N", "평가대상기간", "근무제외기간");
                    dsEVCreate.fireEvent = false;
                    dsEVCreate.SetColumn(nRow, strColumnID, "");
                    dsEVCreate.fireEvent = true;
                    return;
                }
            }
            
            //평가기간 > 평가대상기간
            if( strColumnID=="PRM_END_DT" || strColumnID=="ESTM_STR_DT" ) {
                var nPrmEndDt = dsEVCreate.GetColumn(nRow, "PRM_END_DT");
                var nEvStrDt  = dsEVCreate.GetColumn(nRow, "ESTM_STR_DT");
                
                if( (nPrmEndDt > nEvStrDt) ) {
                    fnc_Message(SNIS_RBM_F029, "N", "평가기간", "평가대상기간");
                    dsEVCreate.fireEvent = false;
                    dsEVCreate.SetColumn(nRow, strColumnID, "");
                    dsEVCreate.fireEvent = true;
                    return;
                }
            }
            break;
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  Row가 변경될 때
+-------------------------------------------------------------------------------------------------*/
function fcDsOnRowPosChanged(obj,nOldRow,nRow)
{
    switch( obj.id ) {
        case "dsEVCreate" : 
            //첨부파일 조회
            if(dsEVCreate.GetRowType(nRow) ==  "insert") {
                dsUploadFile.ClearData();
            } else {
                fcSearchFile(dsEVCreate.GetColumn(nRow, "ATT_FILE_KEY"));
            }
            
            //수정여부            
            if( dsEVCreate.GetColumn(nRow, "UPDATE_YN") == "Y"  ||
				fnc_IsNull(dsEVCreate.GetColumn(nRow, "UPDATE_YN"))) {
				if( sInpt == "T" ) { //저장권한 있을 때
					btnEstmEnd.Enable = true;
				}
				calPrmStrDt.Enable = true;
				calPrmEndDt.Enable = true;
				calEvStrDt .Enable = true;
				calEvEndDt .Enable = true;
				calEscStrDt.Enable = true;
				calEscEndDt.Enable = true;
				btnMngPop  .Enable = true;
				edReleaRate.Enable = true;
				edCraRate  .Enable = true;
				edMraRate  .Enable = true;
				edEscCnt   .Enable = true;
            } else {
				btnEstmEnd.Enable = false;
				
				calPrmStrDt.Enable = false;
				calPrmEndDt.Enable = false;
				calEvStrDt .Enable = false;
				calEvEndDt .Enable = false;
				calEscStrDt.Enable = false;
				calEscEndDt.Enable = false;
				btnMngPop  .Enable = false;
				edReleaRate.Enable = false;
				edCraRate  .Enable = false;
				edMraRate  .Enable = false;
				edEscCnt   .Enable = false;
            }
            
            //발매실적 버튼 활성여부
            if( dsEVCreate.GetColumn(nRow, "ESTM_OPN_YN") == "N" ||
				fnc_IsNull(dsEVCreate.GetColumn(nRow, "ESTM_OPN_YN"))) {
				if( sInpt == "T" ) //저장권한 있을 때
					btnTelmp.Enable = true;
			} else {
				btnTelmp.Enable = false;
			}

            //btnEstmEnd 버튼 텍스트 변경
            var sServiceName = "rev1010-service:searchCnt";
            var sInDataSet   = "";
            var sOutDataSet  = "dsCnt=dsCnt ";
            
            //조회조건
            sEvalYear = dsEVCreate.GetColumn(nRow, "ESTM_YEAR");
            sEvalNum  = dsEVCreate.GetColumn(nRow, "ESTM_NUM");

            fcd_AddParam("ESTM_YEAR", sEvalYear);
            fcd_AddParam("ESTM_NUM" , sEvalNum);
                             
            fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
            break;
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  버튼 클릭시
+-------------------------------------------------------------------------------------------------*/
function fcBtnOnClick(obj) {
    switch(obj.id) {
        case "btnEstmEnd" :
            // 변경된 자료 존재
            if ( fnc_DatasetChangeCheck(dsEVCreate) ) {
                fnc_Message(SNIS_RBM_F015, "N");    
                return;
            }
            
            if( fnc_IsNull(dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_STR_DT")) ||
                fnc_IsNull(dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_END_DT")) ||
                fnc_IsNull(dsEVCreate.GetColumn(dsEVCreate.currow, "ESC_STR_DT")) ||
                fnc_IsNull(dsEVCreate.GetColumn(dsEVCreate.currow, "ESC_END_DT")) ) {
                
                fnc_Message(SNIS_RBM_F016, "N");
                return;
            }
            
            if(fnc_Message(SNIS_RBM_F027, "Y", btnEstmEnd.Text, "평가내역")) {
            
                var sServiceName = "rev1010-service:searchVenusWk";
                var sInDataSet   = "";
                var sOutDataSet  = "dsVenusWk=dsVenusWk "
                                 + "dsVenusAtt=dsVenusAtt "
                                 + "dsVenusDate=dsVenusDate "
                                 + "dsVenusDept=dsVenusDept "
                                 + "dsWorkEmp=dsWorkEmp "
                                 + "dsDept=dsDept "
                                 + "dsRegEmp=dsRegEmp "
                                 + "dsDwComm=dsDwComm "
                                 + "dsDwTelmp=dsDwTelmp "
                                 + "dsPcDiv=dsPcDiv ";
                
                //조회조건
                fcd_AddParam("ESTM_YEAR" , dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_YEAR"));
                fcd_AddParam("ESTM_NUM"  , dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_NUM"));
                fcd_AddParam("PRM_STR_DT", dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_STR_DT"));
                fcd_AddParam("PRM_END_DT", dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_END_DT"));
                fcd_AddParam("ESC_STR_DT", dsEVCreate.GetColumn(dsEVCreate.currow, "ESC_STR_DT"));
                fcd_AddParam("ESC_END_DT", dsEVCreate.GetColumn(dsEVCreate.currow, "ESC_END_DT"));
                fcd_AddParam("CHK_DT", toInteger(dsEVCreate.GetColumn(dsEVCreate.currow, "ESC_END_DT")) - toInteger(dsEVCreate.GetColumn(dsEVCreate.currow, "ESC_STR_DT")) );
                fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
            }
            break;
        
        case "btnTelmp" :
            
            // 변경된 자료 존재
            if ( fnc_DatasetChangeCheck(dsEVCreate) ) {
                fnc_Message(SNIS_RBM_F015, "N");    
                return;
            }
            
            if( fnc_IsNull(dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_STR_DT")) ||
                fnc_IsNull(dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_END_DT")) ) {
                
                fnc_Message(SNIS_RBM_F016, "N");
                return;
            }
            
            if(fnc_Message(SNIS_RBM_F027, "Y", btnEstmEnd.Text, "발매실적")) {
                var sServiceName = "rev1010-service:searchDwTelmp";
                var sInDataSet   = "";
                var sOutDataSet  = "dsDwTelmp=dsDwTelmp dsDwComm=dsDwComm ";
                
                //조회조건
                fcd_AddParam("ESTM_YEAR" , dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_YEAR"));
                fcd_AddParam("ESTM_NUM"  , dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_NUM"));
                fcd_AddParam("PRM_STR_DT", dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_STR_DT"));
                fcd_AddParam("PRM_END_DT", dsEVCreate.GetColumn(dsEVCreate.currow, "PRM_END_DT"));

                fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
            }
            break;
            
		case "btnMngPop" :
			sEvalYear = dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_YEAR");
			sEvalNum  = dsEVCreate.GetColumn(dsEVCreate.currow, "ESTM_NUM");
		
			var sFormId   = "frm_rev::REV1010P.xml";
			var sArgs     = "";	
			var arrReturn = array(3);
			
			arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
			
			if ( length(arrReturn) > 0 ) {
				dsEVCreate.SetColumn(dsEVCreate.currow, "MNG_DEPT", arrReturn[2]);
				dsEVCreate.SetColumn(dsEVCreate.currow, "MNG_NM"  , arrReturn[1]);
				dsEVCreate.SetColumn(dsEVCreate.currow, "MNG_NO"  , arrReturn[0]);
			}
			break;
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 더블 클릭시
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnCellDBLClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var sLocalFileName  = fcd_GetSelectFile("Save", dsUploadFile.GetColumn(nRow, "FILE_NM"));
	var sServerFileName = dsUploadFile.GetColumn(nRow, "FILE_PATH");
	var sFileSize       = dsUploadFile.GetColumn(nRow, "FILE_SIZE");
	if ( sLocalFileName == null ) return;

	fnc_FileRead(divBtnLst.HttpFile, sLocalFileName[0] + "\\" + sLocalFileName[1], sServerFileName, sFileSize, nRow, "PROG_BAR", dsUploadFile);
}

function fcCboOnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	fcSearch();
}

function edReleaRate_OnChanged(obj,strText)
{
	dsEVCreate.SetColumn(dsEVCreate.currow,"RELEA_ESC_CNT","0");
}
]]></Script>
</Window>