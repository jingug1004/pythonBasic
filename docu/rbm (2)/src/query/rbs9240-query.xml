<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="RBS9240(전자카드 인프라)">
        
    <query id="rbs9240_s01" desc="전자카드 인프라 조회" fetchSize="10">
        <![CDATA[
                
			SELECT '' AS CHK, BRNC_CD, STND_YEAR, TOT_MACH, 
			       RELEA_MACH_MANNED, RELEA_MACH_MANLESS, GRN_CRD_LOC, GRN_CRD_RATE,
			       AREA_SQMT, FLOOR, SEAT_CNT, MACH_CNT, OPEN_DT 
			  FROM TBRE_GREENCARD_INFRA
			 WHERE 1 = 1
			   AND STND_YEAR = NVL(?, STND_YEAR)
			   AND BRNC_CD = NVL(?, BRNC_CD)  
			ORDER BY STND_YEAR, BRNC_CD     
        ]]>
    </query>    
    
    <query id="rbs9240_m01" desc="전자카드 인프라 저장,수정" fetchSize="10">
        <![CDATA[
            MERGE INTO TBRE_GREENCARD_INFRA A /* rbs9240_m01 */  --전자카드 인프라
            USING
                    (SELECT  ? AS BRNC_CD               --지점코드
                            ,? AS STND_YEAR             --년도
                            ,? AS TOT_MACH              --단말기 총계
                            ,? AS RELEA_MACH_MANNED     --유인 단말기
                            ,? AS RELEA_MACH_MANLESS    --무인 단말기
                            ,? AS GRN_CRD_LOC           --전자카드 
                            ,? AS GRN_CRD_RATE          --전자카드 배치비율
                            ,? AS AREA_SQMT             --전자카드 전용존/전용층 면적(M2)
                            ,? AS FLOOR                 --전자카드 전용존/전용층 층
                            ,? AS SEAT_CNT              --전자카드 전용존/전용층 좌석수
                            ,? AS MACH_CNT              --전자카드 전용존/전용층 발매기수    
                            ,? AS OPEN_DT               --전자카드 전용존/전용층 개설시기
                            ,? AS INST_ID               --작성자                        
                            ,? AS UPDT_ID               --수정자
                       FROM DUAL ) B
                ON (
                        A.BRNC_CD   = B.BRNC_CD   --지점코드
                    AND A.STND_YEAR = B.STND_YEAR  --년도
            )            
            
            WHEN MATCHED THEN
                UPDATE SET 
                     A.TOT_MACH              = B.TOT_MACH           --단말기 총계
                    ,A.RELEA_MACH_MANNED    = B.RELEA_MACH_MANNED   --유인 단말기
                    ,A.RELEA_MACH_MANLESS   = B.RELEA_MACH_MANLESS  --무인 단말기
                    ,A.GRN_CRD_LOC          = B.GRN_CRD_LOC         --전자카드 
                    ,A.GRN_CRD_RATE         = B.GRN_CRD_RATE        --전자카드 배치비율
                    ,A.AREA_SQMT            = B.AREA_SQMT           --전자카드 전용존/전용층 면적(M2)
                    ,A.FLOOR                = B.FLOOR               --전자카드 전용존/전용층 층
                    ,A.SEAT_CNT             = B.SEAT_CNT            --전자카드 전용존/전용층 좌석수
                    ,A.MACH_CNT             = B.MACH_CNT            --전자카드 전용존/전용층 발매기수
                    ,A.OPEN_DT              = B.OPEN_DT             --전자카드 전용존/전용층 개설시기
                    ,A.UPDT_ID              = B.UPDT_ID             --수정자
                    ,A.UPDT_DT              = SYSDATE               --수정일시       
            WHEN NOT MATCHED THEN
                INSERT (
                         A.BRNC_CD               --지점코드
                        ,A.STND_YEAR             --년도
                        ,A.TOT_MACH              --단말기 총계
                        ,A.RELEA_MACH_MANNED     --유인 단말기
                        ,A.RELEA_MACH_MANLESS    --무인 단말기
                        ,A.GRN_CRD_LOC           --전자카드 
                        ,A.GRN_CRD_RATE          --전자카드 배치비율
                        ,A.AREA_SQMT             --전자카드 전용존/전용층 면적(M2)
                        ,A.FLOOR                 --전자카드 전용존/전용층 층
                        ,A.SEAT_CNT              --전자카드 전용존/전용층 좌석수
                        ,A.MACH_CNT              --전자카드 전용존/전용층 발매기수    
                        ,A.OPEN_DT               --전자카드 전용존/전용층 개설시기
                        ,A.INST_ID               --작성자                        
                        ,A.INST_DT               --작성일
                    
                ) VALUES (
	                     B.BRNC_CD               --지점코드
	                    ,B.STND_YEAR             --년도
	                    ,B.TOT_MACH              --단말기 총계
	                    ,B.RELEA_MACH_MANNED     --유인 단말기
	                    ,B.RELEA_MACH_MANLESS    --무인 단말기
	                    ,B.GRN_CRD_LOC           --전자카드 
	                    ,B.GRN_CRD_RATE          --전자카드 배치비율
	                    ,B.AREA_SQMT             --전자카드 전용존/전용층 면적(M2)
	                    ,B.FLOOR                 --전자카드 전용존/전용층 층
	                    ,B.SEAT_CNT              --전자카드 전용존/전용층 좌석수
	                    ,B.MACH_CNT              --전자카드 전용존/전용층 발매기수    
	                    ,B.OPEN_DT               --전자카드 전용존/전용층 개설시기
	                    ,B.INST_ID               --작성자                            
	                    ,SYSDATE                 --작성일시
                )
        ]]>
    </query>
    
    <query id="rbs9240_d01" desc="그룹코드삭제" fetchSize="10">
        <![CDATA[
			DELETE  /* rbs9240_d01 */ 
			  FROM  TBRE_GREENCARD_INFRA
			 WHERE  1=1
			   AND  BRNC_CD    = ?  --지점코드
			   AND  STND_YEAR = ?  --발급년도
        ]]>
    </query>  
     
</queryMap>