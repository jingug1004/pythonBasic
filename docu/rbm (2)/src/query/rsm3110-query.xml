<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="RSM3110(금액구간별 발매)">
	<query id="rsm3110_select01" desc="금액구간별 (SELECT)" fetchSize="10">
        <![CDATA[        
         SELECT /* rsm3110_select01 */
		]]>
    </query>
	<query id="rsm3110_select02" desc="금액구간별 발매(회차별 SELECT)" fetchSize="10">
        <![CDATA[        
         	/* rsm3110_select02 */                                  
	          DECODE(T.TMS,NULL,'TOTAL',T.TMS) TMS,			-- 회차
		]]>
    </query>
    
    <query id="rsm3110_select03" desc="금액구간별 발매(경주별 SELECT)" fetchSize="10">
        <![CDATA[        
         	/* rsm3110_select03 */                                  
	          DECODE(TO_NUMBER(T.RACE_NO),NULL,'TOTAL',TO_NUMBER(T.RACE_NO)) TMS,	-- 경주별
		]]>
    </query>
    
    <query id="rsm3110_select04" desc="금액구간별 발매(일자별 SELECT)" fetchSize="10">
        <![CDATA[        
         	/* rsm3110_select04 */                                  
	          DECODE(RACE_DAY,NULL,'TOTAL',RACE_DAY) TMS,	-- 일자별
		]]>
    </query>
    
    <query id="rsm3110_select06" desc="금액구간별 발매(지점별 SELECT)" fetchSize="10">
        <![CDATA[        
         	/* rsm3110_select06 */
         	  --CASE WHEN T.COMM_NO < 10 THEN '01' ELSE T.COMM_NO END AS TMS,   -- 지점별
         	  CASE WHEN T.meet_cd||sell_cd IN ('00101','00303') AND T.COMM_NO < 10 THEN '01' 
                    WHEN T.meet_cd||sell_cd = '00103' AND T.COMM_NO < 10 THEN '98' 
                    WHEN T.meet_cd||sell_cd = '00301' AND T.COMM_NO < 10 THEN '99' 
                    ELSE T.COMM_NO END AS TMS,   -- 지점별 
		]]>
    </query>
    
    
    
    <query id="rsm3110_select05" desc="금액구간별 발매(SELECT)" fetchSize="10">
        <![CDATA[
        	/* rsm3110_select05 */	          	                                              
		      SUM(COUNT1) COUNT1,                     		-- 건수 100~10,000
		      ROUND(SUM(COUNT1)/SUM(COUNT8)*100,2) RATE1,   -- 비율 100~10,000
		      (SUM(AMOUNT1)*100) AMOUNT1,                   -- 금액 100~10,000
		      SUM(COUNT2) COUNT2,                     		-- 건수 10,100~20,000
		      ROUND(SUM(COUNT2)/SUM(COUNT8)*100,2) RATE2,   -- 비율 10,100~20,000
		      (SUM(AMOUNT2)*100) AMOUNT2,                   -- 금액 10,100~20,000
		      SUM(COUNT3) COUNT3,                     		-- 건수 20,100~49,900
		      ROUND(SUM(COUNT3)/SUM(COUNT8)*100,2) RATE3,   -- 비율 20,100~49,900
		      (SUM(AMOUNT3)*100) AMOUNT3,                   -- 금액 20,100~49,900        
		      SUM(COUNT4) COUNT4,                     		-- 건수 50,000
		      ROUND(SUM(COUNT4)/SUM(COUNT8)*100,2) RATE4,   -- 비율 50,000          
		      (SUM(AMOUNT4)*100) AMOUNT4,                   -- 금액 50,000     
		      SUM(COUNT5) COUNT5,                     		-- 건수 50,100~80,000
		      ROUND(SUM(COUNT5)/SUM(COUNT8)*100,2) RATE5,   -- 비율 50,100~80,000
		      (SUM(AMOUNT5)*100) AMOUNT5,                   -- 금액 50,100~80,000
		      SUM(COUNT6) COUNT6,                     		-- 건수 80,100~99,900
		      ROUND(SUM(COUNT6)/SUM(COUNT8)*100,2) RATE6,   -- 비율 80,100~99,900
		      (SUM(AMOUNT6)*100) AMOUNT6,                   -- 금액 80,100~99,900              
		      SUM(COUNT7) COUNT7,                    		-- 건수 100,000
		      ROUND(SUM(COUNT7)/SUM(COUNT8)*100,2) RATE7,   -- 비율 100,000          
		      (SUM(AMOUNT7)*100) AMOUNT7,                   -- 금액 100,000             
		      SUM(COUNT8) COUNT8,                           -- 건수 계
		      (SUM(AMOUNT8)*100) AMOUNT8                    -- 금액 계      
        ]]>
    </query>
    <query id="rsm3110_from01" desc="금액구간별 발매(FROM)" fetchSize="10">
        <![CDATA[
        	/* rsm3110_from01 */	          	                                              
		 FROM                                                      
		      VW_SDL_INFO V,	-- 경주일 정보                                        
		      VW_PC_SELLST_GSUM T	-- 구간별 매출액                                      
		 WHERE 1=1
		 	  AND T.MEET_CD=V.MEET_CD                               
		      AND T.STND_YEAR=V.STND_YEAR                           
		      AND T.TMS=V.TMS                                       
		      AND T.DAY_ORD=V.DAY_ORD    
		      AND T.GREEN_YN LIKE DECODE(?, '0', '%', '1', 'N', '2', 'Y')             
		      AND V.MEET_CD	= ?		-- 경륜 구분 코드
		      AND V.RACE_DAY >= ?	-- 기간 시작일
		      AND V.RACE_DAY <= ?	-- 기간 종료일
        ]]>
    </query>
    
    <query id="rsm3110_where01" desc="금액구간별 발매(본장 WHERE)" fetchSize="10">
        <![CDATA[      
        	 /* rsm3110_where01 */
        	 --  조건
		      AND T.SELL_CD = DECODE(?,'003','03','01')
              AND T.COMM_NO IN ('01','02','03','04','08') -- 본장            
        ]]>
    </query>
    
    <query id="rsm3110_where02" desc="금액구간별 발매(교차 WHERE)" fetchSize="10">
        <![CDATA[      
        	 /* rsm3110_where02 */
        	 --  조건
             -- AND T.SELL_CD NOT IN ('01','03') -- 교차                                                                                                                  
        ]]>
    </query>
    
    <query id="rsm3110_where03" desc="금액구간별 발매(지점 WHERE)" fetchSize="10">
        <![CDATA[      
        	 /* rsm3110_where03 */
        	 --  조건
             AND T.COMM_NO = ? 	-- COMM_NO 지점 코드                                                                                                                                        
        ]]>
    </query>
    
    
    <query id="rsm3110_where04" desc="금액구간별 발매(지점별 WHERE)" fetchSize="10">
        <![CDATA[      
        	 /* rsm3110_where04 */
        	 --  조건
             AND C.GRP_CD = '060'
             AND C.CD = (CASE WHEN T.COMM_NO < 10 THEN '01' ELSE T.COMM_NO END)                                                                                                                                        
        ]]>
    </query>    
    
    <query id="rsm3110_where05" desc="금액구간별 발매(지점별 WHERE:공동활용 본장)" fetchSize="10">
        <![CDATA[      
        	 /* rsm3110_where05 */
        	 --  조건
             AND SELL_CD = DECODE(?,'003','01','03')
             AND COMM_NO IN ('01','02','03','04','08') 
                                                                                                                                                          
        ]]>
    </query>    
        
    <query id="rsm3110_groupby01" desc="금액구간별 발매(회차별 GROUPBY)" fetchSize="10">
        <![CDATA[
        	/* rsm3110_groupby01 */
				GROUP BY T.TMS                        
			        -- ROLLUP(T.TMS)  -- 최종 레코드의  TOTAL, SUM 생성용                      
			     ORDER BY T.TMS                              	                                                                                                                                            

        ]]>
    </query>
    
    <query id="rsm3110_groupby02" desc="금액구간별 발매(경주별 GROUPBY)" fetchSize="10">
        <![CDATA[
        	/* rsm3110_groupby02 */
				GROUP BY TO_NUMBER(T.RACE_NO)                              
			        -- ROLLUP(V.TMS)  -- 최종 레코드의  TOTAL, SUM 생성용                      
			     ORDER BY TO_NUMBER(T.RACE_NO)                                 	                                                                                                                                            

        ]]>
    </query>
    
    
    <query id="rsm3110_groupby03" desc="금액구간별 발매(일자별 GROUPBY)" fetchSize="10">
        <![CDATA[
        	/* rsm3110_groupby03 */
				GROUP BY RACE_DAY                           
			        -- ROLLUP(V.TMS)  -- 최종 레코드의  TOTAL, SUM 생성용                      
			     ORDER BY RACE_DAY                                 	                                                                                                                                            

        ]]>
    </query>
    
    
    <query id="rsm3110_groupby04" desc="금액구간별 발매(지점별 GROUPBY)" fetchSize="10">
        <![CDATA[
        	/* rsm3110_groupby04 */
				GROUP BY CASE WHEN T.meet_cd||sell_cd IN ('00101','00303') AND T.COMM_NO < 10 THEN '01' 
			                  WHEN T.meet_cd||sell_cd = '00103' AND T.COMM_NO < 10 THEN '98' 
			                  WHEN T.meet_cd||sell_cd = '00301' AND T.COMM_NO < 10 THEN '99' 
			                  ELSE T.COMM_NO END  
				ORDER BY CASE WHEN T.meet_cd||sell_cd IN ('00101','00303') AND T.COMM_NO < 10 THEN '01' 
			                  WHEN T.meet_cd||sell_cd = '00103' AND T.COMM_NO < 10 THEN '98' 
			                  WHEN T.meet_cd||sell_cd = '00301' AND T.COMM_NO < 10 THEN '99' 
			                  ELSE T.COMM_NO END  

        ]]>
    </query>
    
    


</queryMap>