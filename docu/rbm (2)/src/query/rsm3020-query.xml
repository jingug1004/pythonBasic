<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="RSM3020(½Â½Äº°¸ÅÃâ¾×)">
    <query id="rsm3020_s01" desc="½Â½Äº° ¸ÅÃâ¾×" fetchSize="10">
        <![CDATA[
			   SELECT                                                                                         
			     A.MEET_CD,		-- °æ·ûÀåÄÚµå 
			     A.STND_YEAR,   -- ±âÁØ³âµµ                                                                               
			     DECODE(GP_TMS,0,A.TMS||'',DECODE(GP_STND_YEAR,0,'TOTAL',1,'AVG')) TMS, -- È¸Â÷                     
			     DECODE(GP_TMS,0,A.MIN_DAY) MIN_DAY, 									-- ÃÖÃÊÀÏ                                               
			     ROUND(DECODE(GP_STND_YEAR,0,WIN,1,WIN/CNT_TMS)) WIN, 			-- ´Ü½Â½Ä ¸ÅÃâ¾×                                       
			     TO_CHAR(DECODE(GP_STND_YEAR,0,WIN_RATE),'990.00') WIN_RATE,	-- ´Ü½Â½Ä Á¡À¯À²                                                  
			     ROUND(DECODE(GP_STND_YEAR,0,PLC,1,PLC/CNT_TMS)) PLC,			-- ¿¬½Â½Ä ¸ÅÃâ¾×                                       
			     TO_CHAR(DECODE(GP_STND_YEAR,0,PLC_RATE),'990.00') PLC_RATE,    -- ¿¬½Â½Ä Á¡À¯À²                                              
			     ROUND(DECODE(GP_STND_YEAR,0,QU,1,QU/CNT_TMS)) QU,				-- º¹½Â½Ä ¸ÅÃâ¾×                                          
			     TO_CHAR(DECODE(GP_STND_YEAR,0,QU_RATE),'990.00') QU_RATE,		-- º¹½Â½Ä Á¡À¯À²                                                    
			     ROUND(DECODE(GP_STND_YEAR,0,EX,1,EX/CNT_TMS)) EX,              -- ½Ö½Â½Ä ¸ÅÃâ¾×                            
			     TO_CHAR(DECODE(GP_STND_YEAR,0,EX_RATE),'990.00') EX_RATE,      -- ½Ö½Â½Ä Á¡À¯À²                                              
			     ROUND(DECODE(GP_STND_YEAR,0,TLA,1,TLA/CNT_TMS)) TLA,           -- »ïº¹½Â½Ä ¸ÅÃâ¾×                            
			     TO_CHAR(DECODE(GP_STND_YEAR,0,TLA_RATE),'990.00') TLA_RATE,    -- »ïº¹½Â½Ä Á¡À¯À²
			     ROUND(DECODE(GP_STND_YEAR,0,TRI,1,TRI/CNT_TMS)) TRI,           -- »ï½Ö½Â½Ä ¸ÅÃâ¾×                            
			     TO_CHAR(DECODE(GP_STND_YEAR,0,TRI_RATE),'990.00') TRI_RATE,    -- »ï½Ö½Â½Ä Á¡À¯À²
			     --ROUND(DECODE(GP_STND_YEAR,0,XLA,1,XLA/CNT_TMS)) XLA,           -- ½Öº¹½Â½Ä ¸ÅÃâ¾×                            
			     --TO_CHAR(DECODE(GP_STND_YEAR,0,XLA_RATE),'990.00') XLA_RATE,    -- ½Öº¹½Â½Ä Á¡À¯À²                                              
			     ROUND(DECODE(GP_STND_YEAR,0,POOL_TOTAL_SUM,POOL_TOTAL_SUM/CNT_TMS)) TOTAL  -- ÇÕ°è                               
			 FROM (                                                                                         
			     SELECT                                                                                     
			         B.MEET_CD,                                                                             
			         B.STND_YEAR,                                                                           
			         GROUPING(B.STND_YEAR) GP_STND_YEAR,                                                    
			         GROUPING(B.TMS) GP_TMS,                                                                
			         B.TMS, MIN(B.RACE_DAY) MIN_DAY,                                                        
			         COUNT(DISTINCT A.TMS) CNT_TMS,                                                         
			         SUM(DECODE(A.POOL_CD,'001',A.POOL_TOTAL)) WIN,                                             
			         (SUM(DECODE(A.POOL_CD,'001',A.POOL_TOTAL))/SUM(POOL_TOTAL)*100) WIN_RATE,    
			         SUM(DECODE(A.POOL_CD,'002',A.POOL_TOTAL)) PLC,                                             
			         (SUM(DECODE(A.POOL_CD,'002',A.POOL_TOTAL))/SUM(POOL_TOTAL)*100) PLC_RATE,    
			         SUM(DECODE(A.POOL_CD,'005',A.POOL_TOTAL)) QU,                                              
			         (SUM(DECODE(A.POOL_CD,'005',A.POOL_TOTAL))/SUM(POOL_TOTAL)*100) QU_RATE,     
			         SUM(DECODE(A.POOL_CD,'004',A.POOL_TOTAL)) EX,                                              
			         (SUM(DECODE(A.POOL_CD,'004',A.POOL_TOTAL))/SUM(POOL_TOTAL)*100) EX_RATE,     
			         SUM(DECODE(A.POOL_CD,'006',A.POOL_TOTAL)) TLA,                                             
			         (SUM(DECODE(A.POOL_CD,'006',A.POOL_TOTAL))/SUM(POOL_TOTAL)*100) TLA_RATE,
			         SUM(DECODE(A.POOL_CD,'007',A.POOL_TOTAL)) TRI,                                             
			         (SUM(DECODE(A.POOL_CD,'007',A.POOL_TOTAL))/SUM(POOL_TOTAL)*100) TRI_RATE,
			         --SUM(DECODE(A.POOL_CD,'008',A.POOL_TOTAL)) XLA,                                             
			         --(SUM(DECODE(A.POOL_CD,'008',A.POOL_TOTAL))/SUM(POOL_TOTAL)*100) XLA_RATE,    
			         SUM(A.POOL_TOTAL) POOL_TOTAL_SUM                                                         
			     FROM                                                                                       
			         VW_SDL_PT A,	-- ½Â½Ä                                                                         
			         VW_SDL_INFO B  -- °æÁÖÀÏ Á¤º¸                                                                      
			     WHERE 1 = 1                                                                                
			         AND B.RACE_DAY LIKE ? ||'%'	-- 0:STND_YEAR ±âÁØ³âµµ                                          
			         AND B.MEET_CD = ?              -- 1:MEET_CD °æÁÖ±¸ºÐÄÚµå                           
			         AND B.STND_YEAR = ?            -- 2:STND_YEAR ±âÁØ³âµµ                                    
			         AND A.MEET_CD = B.MEET_CD                                                              
			         AND A.STND_YEAR = B.STND_YEAR                                                          
			         AND A.TMS = B.TMS                                                                      
			         AND A.DAY_ORD = B.DAY_ORD                                                              
			     GROUP BY B.MEET_CD
			     , B.STND_YEAR, B.TMS
			     -- , ROLLUP(B.STND_YEAR, B.TMS)	-- ÃÖÁ¾ ·¹ÄÚµåÀÇ  TOTAL, SUM »ý¼º¿ë                                              
			 ) A                                                                                            
			 WHERE 1 = 1                                                                                    
			 ORDER BY A.MEET_CD, A.STND_YEAR, A.GP_STND_YEAR, A.GP_TMS, A.TMS                     

                                                                       
        ]]>
    </query>
    
</queryMap>