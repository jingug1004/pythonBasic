<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="REV3080(다면평가제외자현황)">
    <query id="rev3080_s01" desc="다면평가제외자 조회" fetchSize="10">
      <![CDATA[
			SELECT  /* rev3080_s01 */
					A.ESTM_YEAR
			       ,A.ESTM_NUM
			       ,A.ESTM_DEPT
			       ,(SELECT DEPT_NM FROM TBRF_EV_DEPT WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND DEPT_CD = A.ESTM_DEPT) AS DEPT_NM
			       ,A.ESTM_EMP  --평가한 사람
			       ,(SELECT EMP_NM FROM TBRF_EV_EMP WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND ESTM_DEPT = A.ESTM_DEPT AND EMP_NO = A.ESTM_EMP GROUP BY EMP_NM) AS ESTM_EMP_NM
			       ,A.EMP_NO    --제외된 사람
			       ,(SELECT EMP_NM FROM TBRF_EV_EMP WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND ESTM_DEPT = A.ESTM_DEPT AND EMP_NO = A.EMP_NO GROUP BY EMP_NM) AS EMP_NM
			       ,A.EXPT_RSN
			  FROM  TBRF_EV_WK_MULT A
			 WHERE  1=1
			   AND  A.ESTM_YEAR = ?
			   AND  A.ESTM_NUM  = ?
			   AND  DECODE(?, '', '1', A.ESTM_DEPT) = DECODE(?, '', '1', ?)
			   AND  A.CFM_YN    = 'Y'
			   AND  A.EXPT_YN   = 'Y'
        ]]>
    </query>
</queryMap>