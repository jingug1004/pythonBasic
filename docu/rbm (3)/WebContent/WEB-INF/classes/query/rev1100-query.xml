<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="REV1100(평가대상조정)">
    <query id="rev1100_s01" desc="평가대상자 조회" fetchSize="10">
      <![CDATA[
		   SELECT   /* rev1100_s01 */
		   			'0' AS CHK 
		   		   ,A.ESTM_YEAR 
		           ,A.ESTM_NUM 
		           ,A.DEPT_CD 
		           ,(SELECT DEPT_NM FROM TBRF_EV_DEPT WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND DEPT_CD = A.DEPT_CD) AS DEPT_NM 
		           ,A.ESTM_DEPT 
		           ,(SELECT DEPT_NM FROM TBRF_EV_DEPT WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND DEPT_CD = A.ESTM_DEPT) AS ESTM_DEPT_NM 
		           ,A.ESTM_WK_JOB  
		           ,(SELECT WK_JOB_NM FROM TBRF_EV_WORK_JOB WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND WK_JOB_CD = A.ESTM_WK_JOB) AS ESTM_WK_JOB_NM 
		           ,A.EMP_NO 
		           ,A.EMP_NM 
		           ,A.ESTM_ALT_YN
		           ,FC_CODE_NM('113', A.ESTM_ALT_YN) AS ESTM_ALT_NM 
		           ,A.ESTM_ESC_RSN 
		           ,CASE WHEN CO_WRK_GBN IN ('001', '002') THEN 'Y' END AS CO_WRK_GBN		           
		      FROM TBRF_EV_EMP A 
		     WHERE 1 = 1 
		       AND A.ESTM_YEAR = ?
		       AND A.ESTM_NUM  = ? 
		       AND DECODE(?, '', '1', A.ESTM_DEPT) = DECODE(?, '', '1', ?) 
		       AND A.EMP_NM LIKE '%' || ? || '%'
		       AND DECODE(?, '', '1', A.ESTM_ALT_YN) = DECODE(?, '', '1', ?) 
		       AND (A.ESTM_ESC_GBN = 'Y' 
        		OR  A.ESTM_ALT_YN = 'Y')  
        ]]>
    </query>
    
    <query id="rev1100_s02" desc="화면수정여부 조회(다면평가 승인이 들어가면 불가능)" fetchSize="10">
      <![CDATA[
		   SELECT DECODE(APRV_STAS, '001', 'Y', 'N') AS APRV_YN 
	         FROM TBRF_EV_APRV 
	        WHERE 1 = 1 
	          AND ESTM_YEAR = ? 
	          AND ESTM_NUM  = ?  
	          AND APRV_SEQ  = '13' 
        ]]>
    </query>
    
    <query id="rev1100_u01" desc="대상자를 비대상으로 변경" fetchSize="10">
      <![CDATA[  
      		UPDATE TBRF_EV_EMP 
      		   SET ESTM_ESC_GBN   = 'N' 
                  ,ESTM_ALT_YN  = 'Y'
                  ,ESTM_ESC_RSN = ?
                  ,UPDT_ID      = ?
                  ,UPDT_DT      = SYSDATE  
             WHERE 1 = 1 
               AND ESTM_YEAR = ?
               AND ESTM_NUM  = ? 
               AND ESTM_DEPT   = ? 
               AND EMP_NO    = ? 
        ]]>
    </query>
    
    <query id="rev1100_d01" desc="업무수행평가 삭제" fetchSize="10">
      <![CDATA[  
      		DELETE /* rev1100_d01 */
      		  FROM TBRF_EV_WK_PRM   
		     WHERE 1 = 1 
		       AND ESTM_YEAR = ? 
		       AND ESTM_NUM  = ? 
		       AND ESTM_DEPT = ? 
		       AND EMP_NO    = ? 
        ]]>
    </query>
    
    <query id="rev1100_d02" desc="업무수행평가상세 삭제" fetchSize="10">
      <![CDATA[  
      		DELETE /* rev1100_d02 */
      		  FROM TBRF_EV_WK_PRM_DT   
        	 WHERE 1 = 1 
         	   AND ESTM_YEAR = ? 
         	   AND ESTM_NUM  = ? 
         	   AND ESTM_DEPT = ? 
         	   AND EMP_NO    = ?  
        ]]>
    </query>
    
    <query id="rev1100_d03" desc="근무태도평가 삭제" fetchSize="10">
      <![CDATA[  
      		DELETE /* rev1100_d03 */
      		  FROM  TBRF_EV_WK_MNR
        	 WHERE 1 = 1 
         	   AND ESTM_YEAR = ? 
         	   AND ESTM_NUM  = ? 
         	   AND ESTM_DEPT = ? 
         	   AND EMP_NO    = ?  
        ]]>
    </query>
    
    <query id="rev1100_d04" desc="근무태도평가상세 삭제" fetchSize="10">
      <![CDATA[  
      		DELETE /* rev1100_d04 */
      		  FROM  TBRF_EV_WK_MNR_DT
        	 WHERE 1 = 1 
         	   AND ESTM_YEAR = ? 
         	   AND ESTM_NUM  = ? 
         	   AND ESTM_DEPT = ? 
         	   AND EMP_NO    = ?  
        ]]>
    </query>
    
    <query id="rev1100_d05" desc="서비스평가 삭제" fetchSize="10">
      <![CDATA[  
      		DELETE /* rev1100_d05 */
      		  FROM  TBRF_EV_WK_SRV   
        	 WHERE 1 = 1 
         	   AND ESTM_YEAR = ? 
         	   AND ESTM_NUM  = ? 
         	   AND ESTM_DEPT = ? 
         	   AND EMP_NO    = ?  
        ]]>
    </query>
    
    <query id="rev1100_d06" desc="서비스평가상세 삭제" fetchSize="10">
      <![CDATA[  
      		DELETE /* rev1100_d06 */
      		  FROM  TBRF_EV_WK_SRV_DT   
        	 WHERE 1 = 1 
         	   AND ESTM_YEAR = ? 
         	   AND ESTM_NUM  = ? 
         	   AND ESTM_DEPT = ? 
         	   AND EMP_NO    = ?  
        ]]>
    </query>
</queryMap>