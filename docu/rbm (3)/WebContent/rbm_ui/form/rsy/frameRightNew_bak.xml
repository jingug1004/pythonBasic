<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form BKColor="#eeeeee" Color="#5a5a5a" Height="615" Id="FSM03D" Left="8" OnLoadCompleted="FrameRight_OnLoadCompleted" PidAttrib="7" Title="FrameRight" Top="8" Ver="1.0" Width="200" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="DS_Menu" OnLoadCompleted="DS_Menu_OnLoadCompleted">
				<Contents>
					<colinfo Id="Depth" Size="2" Type="INT"/>
					<colinfo Id="Name" Size="256" Type="STRING"/>
					<colinfo Id="FormID" Size="256" Type="STRING"/>
					<colinfo Id="MID" Size="256" Type="STRING"/>
					<record>
						<Depth>0</Depth>
						<Name>Seasonal&#32;Flight&#32;List</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Arrival</Name>
						<FormID>FSM01D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Departure</Name>
						<FormID>FSM02D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Arrival/Departure</Name>
						<FormID>FSM03D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>0</Depth>
						<Name>New&#32;Schedule</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Arrival</Name>
						<FormID>FSM07D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Departure</Name>
						<FormID>FSM08D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Arrival/Departure</Name>
						<FormID>FSM09D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>0</Depth>
						<Name>Option</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Import&#32;Schedule</Name>
						<FormID>FSM04D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Export&#32;Schedule</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>0</Depth>
						<Name>Link&#32;Flight</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>0</Depth>
						<Name>Codeshare&#32;Flight</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>0</Depth>
						<Name>Configuration</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Set&#32;Season</Name>
						<FormID>FSM05D</FormID>
						<MID>FS</MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Workplace</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>1</Depth>
						<Name>Roll&#32;on&#32;Active</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>0</Depth>
						<Name>Report</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
					<record>
						<Depth>0</Depth>
						<Name>Interface&#32;Message</Name>
						<FormID></FormID>
						<MID></MID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMenuGrpValue" OnRowPosChanged="fcSearchMenuList">
				<Contents>
					<colinfo id="MN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="UP_MN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="SCRN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="URL" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="LVL" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="color" size="256" summ="default" type="STRING"/>
					<colinfo id="MN_LEVEL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMenuGrpList" OnColumnChanged="dsMenuGrpList_OnColumnChanged" OnLoadCompleted="dsMenuGrpList_OnLoadCompleted">
				<Contents>
					<colinfo id="MN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="UP_MN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UP_MN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SCRN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="URL" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MN_LEVEL" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape Bottom="2" Height="2" Id="Shape0" Left="0" LineColor="#d1d1d1" Right="179" TabOrder="1" Top="0" Width="179"></Shape>
		<Image Height="29" Id="Image0" ImageID="navi_head01" Left="11" TabOrder="2" Top="8" Transparent="TRUE" Width="162"></Image>
		<Shape Bottom="5" Height="3" Id="Shape5" Left="180" LineColor="#d1d1d1" LineKind="LDiagonal" Right="183" TabOrder="12" Top="2" Width="3"></Shape>
	</Form>
	<Script><![CDATA[#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";


var FocusMenu = null;
var startTop = 47;
var nTotTopMenu = 0;



//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收
// Form OnLoadCompleted
//收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收收

function FrameRight_OnLoadCompleted(obj)
{
//    G_Main_OnSize(this);
    
	//vR_minL     = img_Menubtn.Width;
	//vMenu_btn_W = img_Menubtn.Width;

    
	fcSearch("R000002");		//晦獄 雖薄⑷ 褻葭З絲
    
}  


function TopMenu_OnClick(obj,nX,nY)
{
	if ( FocusMenu != null )
	{
		TopMenuProc(FocusMenu,"off");
	}
	else
	{
		SubMenuDivHeightSet();
	}
	
	var lstr = "DivTop" + right(obj.id,2) + ".";
	
	object(lstr + "imgD" + right(obj.id,2)).ImageID = "open_f";
	object(lstr + "imgT" + right(obj.id,2)).Font = "掉葡,9,bold";
	FocusMenu = right(obj.id,2);
	TopMenuProc(FocusMenu,"on");
}

function SubTopMenu_OnClick(obj,nX,nY)
{
	
	var seq = right(obj.GetForm().id,2);
	Clear_SubMenu(object("DivTop" + seq),seq);
	var strsub = "DivTop" + seq + ".DivSub" + seq + ".";
	
	var subseq = right(obj.id,2);
	object(strsub + "ImgT" + subseq).font = "掉葡,9,bold";
	object(strsub + "Img" + subseq).imageID = "on_icon";
	object(strsub + "ImgT" + subseq).color = "#067ca2";
/*		
	var nRow = parseInt(obj.userData);
	var f_id = DS_Menu.GetColumn(nRow,"FormID");
	var m_id = DS_Menu.GetColumn(nRow,"MID");

	// ?????? u? ( ???? ???? ???????? ???????? ??╞? )
	var w_chk = "False";
	var winObj = AllWindows();
	
	for ( var i = 0; i < winObj.count; i++ )
	{
		if ( Trim(winObj[i].id) == Trim(f_id ) )
			w_chk = "True";
	}

	if ( ( f_id.length() > 0 ) && ( w_chk = "False" ) )
		NewWindow(f_id,m_id + "::" + f_id + ".xml", "",100,100,"AutoSize=false",-10000,-10000);
	else
		Alert("??? ?????? ?????闖 ??????????.");
*/		
}

function TopMenuProc(seq,flag)
{
	
	var DivTopstr;
	
	if ( flag == "off" )		
	{
		for ( var i = toInteger(seq) ; i <= nTotTopMenu ; i++ )
		{
			DivTopstr = "DivTop" + lpad(i,'0',2);
			if ( i == toInteger(seq) )
			{
				Object(DivTopstr + ".imgD" + lpad(i,'0',2)).ImageID = "close_f";
				Object(DivTopstr + ".imgT" + lpad(i,'0',2)).Font = "掉葡,9";
				Clear_SubMenu(object(DivTopstr),lpad(i,'0',2));
			}

			object(DivTopstr).Top = startTop + ((i-1)*22) ;
			if ( i == nTotTopMenu )
				object(DivTopstr).Height = 20;
			else
				object(DivTopstr).Height = 22;
			
		}
	}
	else
	{
		var nPos = (startTop + ((toInteger(seq) - 1) * 22));
		var nSubCnt;
		for ( var i = toInteger(seq) ; i <= nTotTopMenu ; i++ )
		{
			DivTopstr = "DivTop" + lpad(i,'0',2);
			if ( i == toInteger(seq) )
			{
				Object(DivTopstr + ".imgD" + lpad(i,'0',2)).ImageID = "open_f";
				Object(DivTopstr + ".imgT" + lpad(i,'0',2)).Font = "掉葡,9,Bold";
				nSubCnt = toNumber(object(DivTopstr).Static0.Text);
				object(DivTopstr).Height =  ( decode(nSubCnt,0,1,nSubCnt) * 23 ) + decode(nSubCnt,0,0,28);
				//alert(object(DivTopstr).Height);
				object(DivTopstr).Top = nPos;
				nPos += object(DivTopstr).Height;
			}
			else
			{
				object(DivTopstr).Top = nPos;
				nPos += 22;
			}	
		}
	}
	
}
function Clear_SubMenu(DivTopObj,seq)
{
	var nCnt = toNumber(DivTopObj.Static0.Text);
	var strsub = DivTopObj.id + ".DivSub" + seq + ".";
	for ( var i = 1 ; i <= nCnt ; i++ )
	{
		object(strsub + "ImgT" + lpad(i,'0',2)).font = "掉葡,9";
		object(strsub + "ImgT" + lpad(i,'0',2)).color = "#5a5a5a";
		object(strsub + "Img" + lpad(i,'0',2)).imageID = "off_icon";
	}
}

function SubMenuDivHeightSet()
{
	var DivTopObj;
	var nCnt;
	for ( var i = 1 ; i <= nTotTopMenu ; i++ )
	{
		DivTopObj = object("DivTop" + lpad(i,'0',2));
		nCnt = toNumber(DivTopObj.Static0.Text) * 23;
		object("DivTop" + lpad(i,'0',2) + '.DivSub' + lpad(i,"0",2)).height = nCnt;
	}
}

function gen_topMenu()
{
	var seq = 1;
	var TopPos = startTop;
	var CurDiv;
	var CurDivContent = "";
	var SubTopPos = 0;
	var SubCount = 0;
	var Subseq = 1;
	
	for ( var i = 0 ; i < dsMenuGrpValue.rowcount ; i++ )
	{

		if ( dsMenuGrpValue.getcolumn(i,"LVL") == 1 )
		{
			if ( CurDivContent.length() > 0 )
			{
				CurDivContent += "	</Contents>";
				CurDivContent += "</Div>";
				CurDivContent += '<Static Visible="false" Height="13" Id="Static0" Left="311" TabOrder="9" Text="' + SubCount + '" Top="65" Width="40"></Static>';
				CurDivContent += "</Contents>";
				
				CurDiv.Contents = CurDivContent;
				seq++;
			}
			SubTopPos = 0;
			SubCount = 0;
			Subseq = 1;
			Create("Div","DivTop" + lpad(seq,"0",2),
			'Height="22" Top="' + TopPos + '" Width="182"');
			TopPos += 22;
			
			CurDiv = Object("DivTop" + lpad(seq,"0",2));
			CurDivContent = "<Contents>";
			CurDivContent += '<Image Height="14" Id="imgD' + lpad(seq,"0",2) + '"  ImageID="close_f" Left="15" TabOrder="1" Top="3" Transparent="TRUE" Width="14"></Image>';
			CurDivContent += '<Image Align="Left" Cursor="HAND" Font="掉葡,9" Height="20" Id="imgT' + lpad(seq,"0",2) + '" Left="35" OnClick="TopMenu_OnClick" Static="FALSE" TabOrder="2" Text="' + dsMenuGrpValue.getcolumn(i,"MN_NM") + '" Width="136"></Image>';
			CurDivContent += '<Shape Bottom="22" Height="2" Id="ShapeT1" Left="10" LineColor="white" Right="192" TabOrder="3" Top="20" Width="182"></Shape>';
			CurDivContent += '<Shape Bottom="21" Height="2" Id="ShapeT2" Left="10" LineColor="#d1d1d1" Right="192" TabOrder="4" Top="19" Width="182"></Shape>';
			CurDivContent += '	<Div BKColor="white" Height="48" Id="DivSub' + lpad(seq,"0",2) + '" Left="8" TabOrder="5" Text="Div0" Top="22" Width="180">';
			CurDivContent += '		<Contents>';
			
		}
		else
		{
			SubCount++;
			CurDivContent += '<Image Align="Left" Color="#5a5a5a" Cursor="HAND" DropMode="TRUE" Font="????,9" Height="21" Id="ImgT' + lpad(Subseq,"0",2) + '" OnClick="SubTopMenu_OnClick" Left="38" Static="FALSE" TabOrder="2" Top="' +  SubTopPos + '" Text="' + dsMenuGrpValue.getcolumn(i,"MN_NM") + '"  OnClick="fcSearchMenu" Width="138" userData="' + i + '"></Image>';
			SubTopPos += 6;
			CurDivContent += '<Image Height="7" Id="Img' + lpad(Subseq,"0",2) + '" ImageID="off_icon" Left="28" TabOrder="1" Top="' + SubTopPos + '" Width="7"></Image>';
			SubTopPos += 16;
			CurDivContent += '<Image FillType="TILE" Height="1" Id="ImgLine' + lpad(Subseq,"0",2) + '" ImageID="dot_iine" Left="1" TabOrder="3" Top="' +  SubTopPos +'" Width="170"></Image>';
			SubTopPos += 1;
			Subseq++;
			
		}
	}

	if ( CurDivContent.length() > 0 )
	{
		CurDiv.Height -= 2;
		CurDivContent += "	</Contents>";
		CurDivContent += "</Div>";
		CurDivContent += '<Static Visible="false" Height="13" Id="Static0" Left="311" TabOrder="9" Text="' + SubCount + '" Top="65" Width="40"></Static>';
		CurDivContent += "</Contents>";
		CurDiv.Contents = CurDivContent;
		nTotTopMenu = seq;
	}
	
	
}

function DS_Menu_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
		//trace(nReason);
		// if ( nReason == 6 )
		// {
			// if ( Job_depth == 0 )
			// {
				// for ( var i = 0 ; i < DS_Menu.rowcount ; i++ )
				// {
					// Create("Div","DivTop" + 01
				// }
			// }
		// }
}

function FZ10Q05D_OnLoadCompleted(obj)
{
	gen_topMenu();
}

function Button0_OnClick(obj)
{
	TextArea0.text = object("DivTop" + lpad(edit0.text,"0",2)).Contents;
}


function fcSearch(obj) {
	var sServiceName = "rsy2010-service:searchMenuGrpValue";
    var sInDataSet   = "";
    var sOutDataSet  = "dsMenuGrpValue=dsMenuGrpValue ";
        sOutDataSet += "dsMenuGrpList=dsMenuGrpList ";    
	
	var sMnGrpCd = obj;
	fcd_AddParam("MN_GRP", sMnGrpCd);
	fcd_AddParam("USER_ID", gdsUser.getColumn(0, "USER_ID"));
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	
}


function fcSearchMenuList(obj,nOldRow,nRow) {
	var strID = dsMenuGrpValue.GetColumn(nRow, "SCRN_ID");
	
    if ( !fnc_IsNull(strID) ) {
        global.FrameBottom.fcOpenMdiForm(strID);
	}
}

function fcSearchMenu(obj) {
	
	
    if ( !fnc_IsNull(obj.userData) ) {
   
        global.FrameBottom.fcOpenMdiForm(dsMenuGrpValue.GetColumn(obj.userData,"MN_ID"));
	}
}


/*-------------------------------------------------------------------------------------------------+
>>  Transaction  籀葬 п撿 й 頂辨!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

    if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
    
    // 詭景葬蝶お 褻 諫猿 礪sy0020-service:searchMenuGrpList
	if ( sServiceName == "rsy2010-service:searchMenuGrpValue" ) {
                gen_topMenu();
	}
	
}]]></Script>
</Window>