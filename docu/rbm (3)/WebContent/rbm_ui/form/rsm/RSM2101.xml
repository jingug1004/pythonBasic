<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="RSM2101" Left="8" OnLoadCompleted="fcFormLoadSetting" OnTimer="fcOnTimer" PidAttrib="7" Title="매출액비교&#32;그래프" Top="8" Ver="1.0" Width="816" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsAutoOPT">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CD>1</CD>
						<CD_NM>수동</CD_NM>
					</record>
					<record>
						<CD>2</CD>
						<CD_NM>자동</CD_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsBeforeCompare">
				<Contents>
					<colinfo id="RACE_YOIL" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_COMPARE_COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_COMPARE_COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_COMPARE" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_COMPARE" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_BEFORE" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_LAST_BEFORE" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_BEFORE_COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_LAST_BEFORE_COLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsBranchSalesAggregate">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_11" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_12" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_13" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_14" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_15" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_16" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_17" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_18" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_19" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_20" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_21" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_22" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_23" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_24" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_25" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_26" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_27" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_28" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsBranchSalesAggregateTmp">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_11" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_12" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_13" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_14" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_15" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_16" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_17" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_18" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_19" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_20" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_21" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_22" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_23" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_24" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_25" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_26" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_27" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO_28" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
						<COMM_NO_11></COMM_NO_11>
						<COMM_NO_12></COMM_NO_12>
						<COMM_NO_13></COMM_NO_13>
						<COMM_NO_14></COMM_NO_14>
						<COMM_NO_15></COMM_NO_15>
						<COMM_NO_16></COMM_NO_16>
						<COMM_NO_17></COMM_NO_17>
						<COMM_NO_18></COMM_NO_18>
						<COMM_NO_19></COMM_NO_19>
						<COMM_NO_20></COMM_NO_20>
						<COMM_NO_21></COMM_NO_21>
						<COMM_NO_22></COMM_NO_22>
						<COMM_NO_23></COMM_NO_23>
						<COMM_NO_24></COMM_NO_24>
						<COMM_NO_25></COMM_NO_25>
						<COMM_NO_26></COMM_NO_26>
						<COMM_NO_27></COMM_NO_27>
						<COMM_NO_28></COMM_NO_28>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CNT></CNT>
						<COMM_NO_11></COMM_NO_11>
						<COMM_NO_12></COMM_NO_12>
						<COMM_NO_13></COMM_NO_13>
						<COMM_NO_14></COMM_NO_14>
						<COMM_NO_15></COMM_NO_15>
						<COMM_NO_16></COMM_NO_16>
						<COMM_NO_17></COMM_NO_17>
						<COMM_NO_18></COMM_NO_18>
						<COMM_NO_19></COMM_NO_19>
						<COMM_NO_20></COMM_NO_20>
						<COMM_NO_21></COMM_NO_21>
						<COMM_NO_22></COMM_NO_22>
						<COMM_NO_23></COMM_NO_23>
						<COMM_NO_24></COMM_NO_24>
						<COMM_NO_25></COMM_NO_25>
						<COMM_NO_26></COMM_NO_26>
						<COMM_NO_27></COMM_NO_27>
						<COMM_NO_28></COMM_NO_28>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CNT></CNT>
						<COMM_NO_11></COMM_NO_11>
						<COMM_NO_12></COMM_NO_12>
						<COMM_NO_13></COMM_NO_13>
						<COMM_NO_14></COMM_NO_14>
						<COMM_NO_15></COMM_NO_15>
						<COMM_NO_16></COMM_NO_16>
						<COMM_NO_17></COMM_NO_17>
						<COMM_NO_18></COMM_NO_18>
						<COMM_NO_19></COMM_NO_19>
						<COMM_NO_20></COMM_NO_20>
						<COMM_NO_21></COMM_NO_21>
						<COMM_NO_22></COMM_NO_22>
						<COMM_NO_23></COMM_NO_23>
						<COMM_NO_24></COMM_NO_24>
						<COMM_NO_25></COMM_NO_25>
						<COMM_NO_26></COMM_NO_26>
						<COMM_NO_27></COMM_NO_27>
						<COMM_NO_28></COMM_NO_28>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CNT></CNT>
						<COMM_NO_11></COMM_NO_11>
						<COMM_NO_12></COMM_NO_12>
						<COMM_NO_13></COMM_NO_13>
						<COMM_NO_14></COMM_NO_14>
						<COMM_NO_15></COMM_NO_15>
						<COMM_NO_16></COMM_NO_16>
						<COMM_NO_17></COMM_NO_17>
						<COMM_NO_18></COMM_NO_18>
						<COMM_NO_19></COMM_NO_19>
						<COMM_NO_20></COMM_NO_20>
						<COMM_NO_21></COMM_NO_21>
						<COMM_NO_22></COMM_NO_22>
						<COMM_NO_23></COMM_NO_23>
						<COMM_NO_24></COMM_NO_24>
						<COMM_NO_25></COMM_NO_25>
						<COMM_NO_26></COMM_NO_26>
						<COMM_NO_27></COMM_NO_27>
						<COMM_NO_28></COMM_NO_28>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CNT></CNT>
						<COMM_NO_11></COMM_NO_11>
						<COMM_NO_12></COMM_NO_12>
						<COMM_NO_13></COMM_NO_13>
						<COMM_NO_14></COMM_NO_14>
						<COMM_NO_15></COMM_NO_15>
						<COMM_NO_16></COMM_NO_16>
						<COMM_NO_17></COMM_NO_17>
						<COMM_NO_18></COMM_NO_18>
						<COMM_NO_19></COMM_NO_19>
						<COMM_NO_20></COMM_NO_20>
						<COMM_NO_21></COMM_NO_21>
						<COMM_NO_22></COMM_NO_22>
						<COMM_NO_23></COMM_NO_23>
						<COMM_NO_24></COMM_NO_24>
						<COMM_NO_25></COMM_NO_25>
						<COMM_NO_26></COMM_NO_26>
						<COMM_NO_27></COMM_NO_27>
						<COMM_NO_28></COMM_NO_28>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CNT></CNT>
						<COMM_NO_11></COMM_NO_11>
						<COMM_NO_12></COMM_NO_12>
						<COMM_NO_13></COMM_NO_13>
						<COMM_NO_14></COMM_NO_14>
						<COMM_NO_15></COMM_NO_15>
						<COMM_NO_16></COMM_NO_16>
						<COMM_NO_17></COMM_NO_17>
						<COMM_NO_18></COMM_NO_18>
						<COMM_NO_19></COMM_NO_19>
						<COMM_NO_20></COMM_NO_20>
						<COMM_NO_21></COMM_NO_21>
						<COMM_NO_22></COMM_NO_22>
						<COMM_NO_23></COMM_NO_23>
						<COMM_NO_24></COMM_NO_24>
						<COMM_NO_25></COMM_NO_25>
						<COMM_NO_26></COMM_NO_26>
						<COMM_NO_27></COMM_NO_27>
						<COMM_NO_28></COMM_NO_28>
						<TOTAL></TOTAL>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCommInfo">
				<Contents>
					<colinfo id="COMM1" size="256" summ="default" type="STRING"/>
					<colinfo id="COT_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="BF_WK1" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS_DAY_ORD1" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COT_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="BF_WK2" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS_DAY_ORD2" size="256" summ="default" type="STRING"/>
					<record>
						<BF_WK1>1000</BF_WK1>
						<BF_WK2>2500</BF_WK2>
						<COMM1>1</COMM1>
						<COMM2>2</COMM2>
						<COT_NO1>7101</COT_NO1>
						<COT_NO2>7102</COT_NO2>
						<TMS_DAY_ORD1>2000</TMS_DAY_ORD1>
						<TMS_DAY_ORD2>3500</TMS_DAY_ORD2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCond">
				<Contents>
					<colinfo id="MAX_STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MIN_STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>경주일정보</DESCRIPTION>
						<DSNAME>dsCond</DSNAME>
						<QUERY_ID>rsm0000_s01</QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMeetCd">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CD>001</CD>
						<CD_NM>경륜</CD_NM>
					</record>
					<record>
						<CD>003</CD>
						<CD_NM>경정</CD_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRaceInfo">
				<Contents>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_YOIL" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_INFO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSalesViewDiv">
				<Contents>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="B_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="Y_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_DIV_TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_DIV_TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_MINUS" size="256" summ="default" type="STRING"/>
					<colinfo id="LAST_MINUS" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_BEFORE" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_LAST" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_BEFORE_COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_LAST_COLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsTimeBox">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CD>5</CD>
						<CD_NM>5분</CD_NM>
					</record>
					<record>
						<CD>10</CD>
						<CD_NM>10분</CD_NM>
					</record>
					<record>
						<CD>15</CD>
						<CD_NM>15분</CD_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSales">
				<Contents>
					<colinfo id="MEET_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="G_MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="G_RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="WIN" size="256" summ="default" type="STRING"/>
					<colinfo id="PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUB_TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUB_REFUND_TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRA" size="256" summ="default" type="STRING"/>
					<colinfo id="MRA" size="256" summ="default" type="STRING"/>
					<colinfo id="MYCAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BON_CAT" size="256" summ="default" type="STRING"/>
					<colinfo id="NON_CAT" size="256" summ="default" type="STRING"/>
					<colinfo id="OLM_CAT" size="256" summ="default" type="STRING"/>
					<colinfo id="JIBANG" size="256" summ="default" type="STRING"/>
					<colinfo id="JIJUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_TOTAL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsObjCompare">
				<Contents>
					<colinfo id="stnd_year" size="256" summ="default" type="STRING"/>
					<colinfo id="o_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="s_amt" size="256" summ="default" type="STRING"/>
					<colinfo id="ratio" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRemark">
				<Contents>
					<colinfo id="stnd_year" size="256" summ="default" type="STRING"/>
					<colinfo id="meet_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="gbn" size="256" summ="default" type="STRING"/>
					<colinfo id="etc1" size="256" summ="default" type="STRING"/>
					<colinfo id="etc2" size="256" summ="default" type="STRING"/>
					<colinfo id="etc3" size="256" summ="default" type="STRING"/>
					<colinfo id="etc26" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="20" Id="Image1" ImageID="m_titleblet" Left="4" TabOrder="2" Top="13" Width="17"></Image>
		<Static Color="user4" Height="20" Id="stFormTitle" Left="20" Style="snis_m_stitle" TabOrder="3" Text="매출현황&#32;조회" Top="11" VAlign="Middle" Width="88"></Static>
		<Radio CodeColumn="CD" ColumnCount="4" DataColumn="CD_NM" Height="21" Hilight3dColor="user0" Id="rdoAutoOPT" INDEX="0" InnerDataset="dsAutoOPT" Left="348" OnChanged="fcOnChanged" ShadowColor="user0" TabOrder="4" Top="11" Width="104"></Radio>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Enable="FALSE" Height="21" Id="cboTimeBox" ImeMode="none" InnerDataset="dsTimeBox" Left="454" OnChanged="fcOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="5" Top="11" Width="52">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Div Height="903" Id="divFullScreen" Left="-4" scroll="true" TabOrder="6" Text="Div0" Top="33" Width="1020">
			<Contents>
				<Image Height="20" Id="Image2" ImageID="m_titleblet2" Left="8" TabOrder="1" Top="11" Width="17"></Image>
				<Static Color="user4" Height="20" Id="stRaceInfo" Left="24" Style="snis_m_stitle" TabOrder="2" Text="매출현황" Top="11" VAlign="Middle" Width="254"></Static>
				<WebBrowser Border="None" Height="1039" Id="WB" Left="9" TabOrder="3" Top="32" Width="939"></WebBrowser>
			</Contents>
		</Div>
		<Div Height="22" Id="divBtnLst" Left="706" TabOrder="7" Text="Div0" Top="11" Url="common::comButtonSearchClose.xml" Width="104">
			<Contents></Contents>
		</Div>
		<Calendar Border="Flat" Height="21" Id="calRaceDay" Left="113" OnChar="fcOnChar" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="8" Top="10" Width="90"></Calendar>
		<Radio BorderColor="user0" CodeColumn="CD" ColumnCount="4" DataColumn="CD_NM" Height="21" Hilight3dColor="user0" Id="rdoMeetCd" INDEX="0" InnerDataset="dsMeetCd" Left="220" OnChanged="fcOnChanged" ShadowColor="user0" TabOrder="8" Top="11" Width="120"></Radio>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/************************
*  공통 Script Include  *
************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";


/*-----------------------------------+
|  최초 화면 Load時 처리 할 사항     |
+------------------------------------*/
var ARRAY2_GBL_RET_VALUE = Array();	// 이전페이지에서 넘어온 변수

function fcFormLoadSetting(obj){
	var nCXScreen	= GetDeviceInfo("CXScreen");			
	var nCYScreen	= GetDeviceInfo("CYScreen");
	
	RSM2101.MoveWindow(0,0,nCXScreen,nCYScreen);
	divBtnLst.Left = nCXScreen-120;
	divFullScreen.Width = nCXScreen;
	divFullScreen.Height = nCYScreen-100;
	divFullScreen.stUnit.Left= nCXScreen-100; 
	divFullScreen.WB.Width = nCXScreen -50;  

	dsRaceInfo.ClearData();
    dsBranchSalesAggregate.ClearData();
    dsBeforeCompare.ClearData();
    
    // 이전 페이지에서 파라미터 받음	 
    var sRetValue = decode(GBL_RET_VALUE,null,'',GBL_RET_VALUE);
    ARRAY2_GBL_RET_VALUE = split2(GBL_RET_VALUE," ","=");
	GBL_RET_VALUE="";
	if(sRetValue!='')
	{		
		calRaceDay.Value  = fcArray2Value(ARRAY2_GBL_RET_VALUE,"RACE_DAY");
		rdoMeetCd.Value  = fcArray2Value(ARRAY2_GBL_RET_VALUE,"MEET_CD");
	}
	
	divFullScreen.WB.PageUrl =GBL_SERVER_URL+ "/webpage/kspochart/chart_rsm2100.jsp?RACE_DAY="+calRaceDay.Value+"&MEET_CD="+rdoMeetCd.Value;
	divFullScreen.WB.Run();
	divFullScreen.WB.SetFocus();
		
    fcSearch();
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 체크 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
    //조회조건 체크및 trim처리

	return true;
}


/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearch(obj) {
	var sServiceName = "rsm2010-service:searchMeetCd";  // Grid 조회
	var sInDataSet   = "";
	var sOutDataSet  = "dsMeetCd=dsMeetCd";     
	
	
	fcd_AddParam("RACE_DAY", calRaceDay.Value);    
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);

}


/*-----------------------+
|  조회 실행 !  |
+------------------------*/
function fcSearchInfo(obj) {	
	//필수 조회 조건 체크
	
	if ( !fcSearchCheck(obj) ) return;
    
	var sServiceName = "rsm2010-service:searchRaceInfo";  // Grid 조회
	var sInDataSet   = "";
	var sOutDataSet  = "dsRaceInfo=dsRaceInfo ";     
		sOutDataSet  += "dsSales=dsSales ";     
		sOutDataSet  += "dsBranchSalesAggregate=dsBranchSalesAggregate ";     
		sOutDataSet  += "dsBeforeCompare=dsBeforeCompare ";
		sOutDataSet  += "dsObjCompare=dsObjCompare ";  // 목표대비 실적 추가
	
	// 매출현황 파라미터

	if( calRaceDay.Value == fcd_GetSysdate("YYYYMMDD"))
	{
		sServiceName = "rsm2010-service:searchRaceInfoToday";  // Grid 조회
	}
	
	
	fcd_AddParam("RACE_DAY", calRaceDay.Value);        
	fcd_AddParam("MEET_CD", rdoMeetCd.Value);        
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);


}



// 콤보박스 바꾸면 검색
function fcOnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	switch ( obj.ID ) {
		
		case "rdoAutoOPT" : // 수동 자동 구분
			if(strCode=="2")
			{
				cboTimeBox.Enable = true;
				SetTimer(1, parseInt(cboTimeBox.Value) *60 * 1000 ); // Timer구동
			}
			else
			{
				cboTimeBox.Enable = false;
				KillTimer(1); // Timer해제
			}
	
			break;
		
		case "cboTimeBox":
			KillTimer(1); // Timer해제
			SetTimer(1, parseInt(strCode) *60 *1000 ); // Timer구동	
			break;
	}


//	fcSearch();
}


// 지점별 매출액 클릭시 나타남


function fcOnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{	
	var COMM_NO	="";
	var sBRNCH_NM = "";
	switch ( obj.ID ) {			
		case "grdBeforeCompare" :	
			var sCellText = grdBeforeCompare.GetCellText("HEAD",1,nCell);
			
			if(sCellText=='전주대비')
			{
				var strParam = "RACE_DAY="+calRaceDay.Value;
				strParam +=" MEET_CD="+rdoMeetCd.Value;
				strParam +=" COMM_NO=00";
				strParam +=" BRNCH_NM=전체";
				
				GBL_RET_VALUE=strParam; // 값 생성	
	//			global.FrameBottom.fcOpenMdiForm("RSM2011P", "매출액비교", "frm_rsm::RSM2011P.xml");
			}
			
		break;
		
	}
	
//	fcGridSort(obj,nCell,nX,nY);	
}


/*------------------------------------+
|  Transaction 후 처리 해야 할 내용!  |
+-------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 조회 완료 후
	
	if(sServiceName = "rsm2010-service:searchMeetCd")
    {
		rdoMeetCd.Value = dsMeetCd.GetColumn(0,"CD");			

		if(dsMeetCd.rowcount > 0) // 경주일이 있을 경우만 검색
		{
			fcSearchInfo();
			fcSetAmountChart();
			fcSearchRemark();
		}
		return;
    }
	
	//trace("dsRaceInfo.SaveXML()  :"+dsRaceInfo.SaveXML());
	divFullScreen.stRaceInfo.Text = "매출현황 "+dsRaceInfo.GetColumn(0,"RACE_INFO");

	
divFullScreen.grdRemark.SetColProp(47,"Width",value);	
	
	if(rdoMeetCd.Value = "001") {		
		dsBeforeCompare.DeleteRow(3);
		dsBeforeCompare.DeleteRow(2);
		dsBeforeCompare.DeleteRow(1);
		dsBeforeCompare.DeleteRow(0);
		
		divFullScreen.grdRemark.SetColProp(0,"Width",56);	
		fc_adjust_remark_width(34);
		
	}
	else {
		dsBeforeCompare.DeleteRow(6);
		dsBeforeCompare.DeleteRow(5);
		dsBeforeCompare.DeleteRow(4);
		dsBeforeCompare.DeleteRow(1);
		dsBeforeCompare.DeleteRow(0);
		
		divFullScreen.grdRemark.SetColProp(0,"Width",50);	
		fc_adjust_remark_width(0);
				
	}
	divFullScreen.edRemarkEtc.value = "";
}

/*--------------+
|  확인 처리 !  |
+---------------*/
function fcChoice(obj) {
	
//    Close(arrReturn);                                                   //반환 후 조회
}


/*--------------+
|  취소 처리 !  |
+---------------*/
function fcClose(obj) 
{
	Close(false);     //Null 반환 후 종료
}



/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

*-------------------------------------------------------------------------------------------------+
>>  // 자동 검색 시간 옵션
+-------------------------------------------------------------------------------------------------*/
function fcOnTimer(obj,nEventID)
{
	if(rdoAutoOPT.Value=="2")
	{
		fcSearch();
	}
}


function fcOnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam)
{
	switch ( obj.ID ) {		
		// 경주일자에서 ENTER_KEY 눌렀을 경우
		case "calRaceDay" :	
			if ( nChar == ENTER_KEY ) {
				fcSearch();
				return;
			}
		break;
	
	}
}


// 경륜 경정에 따른 그리드높이와, 위치 이동
function fcSetAmountChart()
{
    //SQL방식
    /* report를 사용해서 그래프를 그렸지만, 지금은 사용하지 않음
    rptViewer.ServletURL1="http://can.kcycle.or.kr/can/UbiForm";
    rptViewer.ServletURL2="http://can.kcycle.or.kr/can/UbiData";
	rptViewer.setJrfFileDir("/web/waspage/usrbm/report/common/"); // 절대 경로 주의!
	rptViewer.datasource = "rbm#jdbc/RBM"; 						  // 경주사업관리
	rptViewer.setJrfFileName("sales_amt_chart_"+rdoMeetCd.Value +".jrf");
	rptViewer.FontRevision = true;
	rptViewer.utfData = false;
	rptViewer.isUnicode = false;
	rptViewer.IsDeflater = true;
	rptViewer.SetVariable("isBase64", "true");
    rptViewer.SetArgument("MEET_CD", rdoMeetCd.Value);
    rptViewer.SetArgument("RACE_DAY", calRaceDay.Value);
    rptViewer.Retrieve();   
    */
    
}


function fcSearchRemark(obj) {
    
	var sServiceName = "rsm2041-service:searchGraphEtc"; // 경륜 특이사항 조회
		
    var sInDataSet   = "";
    var sOutDataSet  = "dsRemark=dsRemark ";      
    
	fcd_AddParam("MEET_CD", rdoMeetCd.Value);	// 경륜 구분 코드
	fcd_AddParam("RACE_DAY", calRaceDay.Value);	// 경주일
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
	
}


function divFullScreen_grdRemark_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	dsRemark.row = nRow;
	divFullScreen.edRemarkEtc.value = " " + dsRemark.GetColumn(dsRemark.row, "etc"+nCell);		
	
}

function divFullScreen_grdRemark_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	divFullScreen.grdremark.UseSelColor = false;
	
	
	//trace(nRow);
	//trace(nCell);
	dsRemark.row = nRow;
	divFullScreen.grdremark.SetCellPos(nCell);
	divFullScreen_grdRemark_OnCellClick(obj,nRow,nCell,0,0,nPivotIndex);

	divFullScreen.grdremark.UseSelColor = true;
}
 
function fc_adjust_remark_width(value) //34 or 0
{
	divFullScreen.grdRemark.SetColProp(47,"Width",value);
	divFullScreen.grdRemark.SetColProp(48,"Width",value);
	divFullScreen.grdRemark.SetColProp(49,"Width",value);
	divFullScreen.grdRemark.SetColProp(50,"Width",value);
}
]]></Script>
</Window>