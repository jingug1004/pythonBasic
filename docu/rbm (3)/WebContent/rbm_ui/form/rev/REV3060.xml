<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="REV3060" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="부서별&#32;평가자재선정" Top="8" Ver="1.0" Width="816" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsEstmYear">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATA" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>사업상태코드</DESCRIPTION>
						<DSNAME>dsEstmYear</DSNAME>
						<QUERY_ID>rev1030_cb</QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDept">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEmpEstmExp">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_WK_JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_EMP" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="PERM_TEMP_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TELLER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEmpEstmMnr">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEmpEstmSvr">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEmpEstm1" OnColumnChanged="fcDsOnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RES_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_WK_JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PERM_TEMP_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEmpEstm" OnColumnChanged="fcDsOnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EV_GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PERM_TEMP_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsAprvStas">
				<Contents>
					<colinfo id="APRV_OFIR_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="APRV_REQ_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="APRV_STAS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsAprvMnrSvr">
				<Contents>
					<colinfo id="APRV_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDATE_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEstmEnd">
				<Contents>
					<colinfo id="ESTM_END_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="61" Height="31" Id="Shape1" Left="8" LineColor="user1" LineKind="Vertical" Right="809" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="6" Top="30" Type="RoundRect" Width="801"></Shape>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="1" Top="2" Width="17"></Image>
		<Static Align="Right" Height="22" Id="stFormLocation" Left="209" Style="styFormLocation" TabOrder="2" Top="4" VAlign="Middle" Width="288"></Static>
		<Div Height="28" Id="divBtnLst" Left="442" TabOrder="3" Text="Div0" Url="common::comButtonType.xml" Width="374">
			<Contents></Contents>
		</Div>
		<Static Font="굴림,10,Bold" Height="22" Id="stFormTitle" Left="24" Style="snis_m_title" TabOrder="4" Text="부서별&#32;평가자재선정" VAlign="Middle" Width="430"></Static>
		<Tab Height="494" Id="tab" Left="8" TabOrder="5" Top="72" Width="801">
			<Contents>
				<TabPage BorderColor="black" Height="470" Id="tab1" ImageID="m_tab_09" Left="2" TabOrder="19" Text="역량평가" Top="22" Width="797">
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button0" ImageID="btn_txt_07" Left="552" OnClick="fcBtnOnClick" TabOrder="2" Text="SMS전송" Top="568" Width="80"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnViolScr" ImageID="btn_txt_07" Left="640" OnClick="fcBtnOnClick" TabOrder="1" Text="메신저전송" Top="568" Width="80"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="btn_txt_07" Left="536" OnClick="fcBtnOnClick" TabOrder="4" Text="SMS전송" Top="576" Width="80"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button2" ImageID="btn_txt_07" Left="624" OnClick="fcBtnOnClick" TabOrder="3" Text="메신저전송" Top="576" Width="80"></Button>
					<Image Height="20" Id="Image1" ImageID="m_titleblet2" Left="334" TabOrder="6" Top="10" Width="17"></Image>
					<Static Font="굴림,10,Bold" Height="22" Id="Static4" Left="352" Style="snis_m_title" TabOrder="7" Text="피평가자" Top="8" VAlign="Middle" Width="208"></Static>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsEmpEstmExp" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="458" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="424" Id="grdEmpEstmExp" InputPanel="FALSE" Left="334" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" OnHeadClick="fcGridSort" Right="790" SelColor="user19" Style="snis_grid" TabOrder="5" TabStop="true" Top="34" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="456">
						<contents>
							<format id="Default">
								<columns>
									<col width="47"/>
									<col width="51"/>
									<col width="54"/>
									<col width="74"/>
									<col width="163"/>
									<col width="64"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="사번"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="성명"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="발매번호"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="보직"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="근무지"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="평가자(B)"/>
								</head>
								<body>
									<cell align="center" bkcolor="expr:decode(ESTM_YN&#32;,&#32;&apos;Y&apos;&#32;,&#32;&apos;GRAY&apos;&#32;,&#32;&apos;N&apos;&#32;,&#32;&apos;default&apos;)" col="0" colid="EMP_NO" display="text"/>
									<cell align="center" bkcolor="expr:decode(ESTM_YN&#32;,&#32;&apos;Y&apos;&#32;,&#32;&apos;GRAY&apos;&#32;,&#32;&apos;N&apos;&#32;,&#32;&apos;default&apos;)" col="1" colid="EMP_NM" display="text"/>
									<cell align="center" bkcolor="expr:decode(ESTM_YN&#32;,&#32;&apos;Y&apos;&#32;,&#32;&apos;GRAY&apos;&#32;,&#32;&apos;N&apos;&#32;,&#32;&apos;default&apos;)" col="2" colid="TELLER_ID" display="text" limit="6"/>
									<cell align="center" bkcolor="expr:decode(ESTM_YN&#32;,&#32;&apos;Y&apos;&#32;,&#32;&apos;GRAY&apos;&#32;,&#32;&apos;N&apos;&#32;,&#32;&apos;default&apos;)" col="3" colid="WK_JOB_NM" display="text" expandimage="btn_pop_search" expandshow="true"/>
									<cell align="left" bkcolor="expr:decode(ESTM_YN&#32;,&#32;&apos;Y&apos;&#32;,&#32;&apos;GRAY&apos;&#32;,&#32;&apos;N&apos;&#32;,&#32;&apos;default&apos;)" col="4" colid="DIV_NM" display="text" expandimage="btn_pop_search" expandshow='expr:iif(&#32;dsEmpEstmExp.GetColumn(row,&#32;&quot;ESTM_WK_JOB&quot;)&#32;==&#32;&quot;1003&quot;,&#32;true,&#32;false)'/>
									<cell align="center" bkcolor="expr:decode(ESTM_YN&#32;,&#32;&apos;Y&apos;&#32;,&#32;&apos;GRAY&apos;&#32;,&#32;&apos;N&apos;&#32;,&#32;&apos;default&apos;)" col="5" colid="EV_EMP_NM" display="text" expandimage="btn_pop_search" expandshow='expr:iif(&#32;dsEmpEstmExp.GetColumn(row,&#32;&quot;ESTM_WK_JOB&quot;)&#32;==&#32;&quot;1003&quot;,&#32;true,&#32;false)'/>
								</body>
							</format>
						</contents>
					</Grid>
					<Image Height="22" Id="Image0" ImageID="m_titleblet2" Left="6" TabOrder="8" Top="10" Width="17"></Image>
					<Static Font="굴림,10,Bold" Height="22" Id="Static3" Left="24" Style="snis_m_title" TabOrder="10" Text="평가자" Top="8" VAlign="Middle" Width="208"></Static>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsEmpEstm" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="92" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="58" Id="grdEmpEstm" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" OnHeadClick="fcGridSort" Right="326" SelColor="user19" Style="snis_grid" TabOrder="7" TabStop="true" Top="34" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="320">
						<contents>
							<format id="Default">
								<columns>
									<col width="86"/>
									<col width="76"/>
									<col width="55"/>
									<col width="64"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="평가자구분"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="부서"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="직급"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="성명"/>
								</head>
								<body>
									<cell align="center" col="0" colid="EV_GBN_NM" display="text"/>
									<cell align="center" col="1" colid="DEPT_NM" display="text"/>
									<cell align="center" col="2" colid="JOB_TIT_NM" display="text"/>
									<cell align="center" col="3" colid="EMP_NM" display="text" expandimage="btn_pop_search" expandshow='expr:&#32;iif(&#32;dsEmpEstm.GetColumn(row,&#32;&quot;EV_GBN&quot;)&#32;==&#32;&quot;001&quot;&#32;,&#32;true,&#32;false&#32;)'/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsEmpEstm1" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="458" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="360" Id="grdEmpEstm1" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" OnHeadClick="fcGridSort" Right="326" SelColor="user19" Style="snis_grid" TabOrder="11" TabStop="true" Top="98" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="320">
						<contents>
							<format id="Default">
								<columns>
									<col width="186"/>
									<col width="65"/>
									<col width="64"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="근무지"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="보직"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="성명"/>
								</head>
								<body>
									<cell align="left" col="0" colid="DIV_NM" display="text" expandimage="btn_pop_search"/>
									<cell align="center" col="1" colid="WK_JOB_NM" display="text" expandimage="btn_pop_search"/>
									<cell align="center" col="2" colid="EMP_NM" display="text" expandimage="btn_pop_search" expandshow="true"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Border="Flat" BorderColor="red" Color="red" Height="32" Id="Static0" Left="16" LineSpacing="2" TabOrder="17" Text="승인자&#32;사용&#32;버튼" Top="472" Visible="FALSE" Width="376"></Static>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="aprvCanCelBtn" ImageID="btn_txt_07" Left="120" OnClick="fcBtnOnClick" TabOrder="16" Text="승인취소" Top="488" Visible="FALSE" Width="80"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="aprvOkBtn" ImageID="btn_txt_07" Left="208" OnClick="fcBtnOnClick" TabOrder="13" Text="승인" Top="488" Visible="FALSE" Width="80"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="aprvBackBtn" ImageID="btn_txt_07" Left="296" OnClick="fcBtnOnClick" TabOrder="12" Text="반려" Top="488" Visible="FALSE" Width="80"></Button>
					<Static Border="Flat" BorderColor="red" Color="red" Height="32" Id="Static1" Left="395" LineSpacing="2" TabOrder="18" Text="승인자&#32;사용&#32;버튼" Top="472" Visible="FALSE" Width="277"></Static>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="aprvReqBtn" ImageID="btn_txt_07" Left="496" OnClick="fcBtnOnClick" TabOrder="14" Text="승인요청" Top="488" Visible="FALSE" Width="80"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="aprvCallBtn" ImageID="btn_txt_07" Left="584" OnClick="fcBtnOnClick" TabOrder="15" Text="회수" Top="488" Visible="FALSE" Width="80"></Button>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="tab2" ImageID="m_tab_09" Left="2" TabOrder="19" Text="근무실적평가" Top="22" Width="797">
					<Image Height="22" Id="Image0" ImageID="m_titleblet2" Left="11" TabOrder="1" Top="10" Width="17"></Image>
					<Static Font="굴림,10,Bold" Height="22" Id="Static3" Left="24" Style="snis_m_title" TabOrder="2" Text="평가자" Top="8" VAlign="Middle" Width="208"></Static>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsEmpEstmMnr" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="458" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="424" Id="grdEmpEstmMnr" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" Right="790" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="34" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="784">
						<contents>
							<format id="Default">
								<columns>
									<col width="86"/>
									<col width="76"/>
									<col width="55"/>
									<col width="64"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="평가자구분"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="부서"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="직급"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="성명"/>
								</head>
								<body>
									<cell align="center" col="0" colid="EV_NM" display="text"/>
									<cell align="center" col="1" colid="DEPT_NM" display="text"/>
									<cell align="center" col="2" colid="JOB_TIT_NM" display="text"/>
									<cell align="center" col="3" colid="EMP_NM" display="text" expandimage="btn_pop_search" expandshow='expr:&#32;iif(&#32;dsEmpEstm.GetColumn(row,&#32;&quot;EV_GBN&quot;)&#32;==&#32;&quot;001&quot;&#32;,&#32;true,&#32;false&#32;)'/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="tab3" ImageID="m_tab_09" Left="2" TabOrder="13" Text="서비스평가" Top="22" Width="797">
					<Image Height="20" Id="Image0" ImageID="m_titleblet2" Left="6" TabOrder="1" Top="12" Width="17"></Image>
					<Static Font="굴림,10,Bold" Height="22" Id="Static3" Left="22" Style="snis_m_title" TabOrder="2" Text="평가자" Top="10" VAlign="Middle" Width="208"></Static>
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsEmpEstmSvr" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="458" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="424" Id="grdEmpEstmSvr" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" Right="790" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="34" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="784">
						<contents>
							<format id="Default">
								<columns>
									<col width="86"/>
									<col width="76"/>
									<col width="55"/>
									<col width="64"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="평가자구분"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="부서"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="직급"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="성명"/>
								</head>
								<body>
									<cell align="center" col="0" colid="EV_NM" display="text"/>
									<cell align="center" col="1" colid="DEPT_NM" display="text"/>
									<cell align="center" col="2" colid="JOB_TIT_NM" display="text"/>
									<cell align="center" col="3" colid="EMP_NM" display="text" expandimage="btn_pop_search" expandshow='expr:iif(&#32;dsEmpEstmMnr.GetColumn(row,&#32;&quot;EV_GBN&quot;)&#32;==&#32;&quot;001&quot;&#32;,&#32;true,&#32;false&#32;)'/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Static Align="Right" Border="None" Height="20" Id="Static10" Left="40" Style="snis_if_lable" TabOrder="7" Text="년도/차수" Top="36" VAlign="Middle" Width="54"></Static>
		<Static Align="Right" Border="None" Height="20" Id="Static0" Left="240" Style="snis_if_lable" TabOrder="8" Text="부서" Top="36" VAlign="Middle" Width="54"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="DATA" Height="19" Id="cbEstmYear" ImeMode="none" InnerDataset="dsEstmYear" Left="110" OnChanged="fcCheckCombo" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="9" Top="35" Width="108">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Combo Border="Flat" CodeColumn="DEPT_CD" DataColumn="DEPT_NM" Height="20" Id="cboDept" ImeMode="none" InnerDataset="dsDept" Left="310" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="10" Top="35" Width="108">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="ApprBtn" ImageID="btn_txt_10" Left="710" OnClick="fcBtnOnClick" TabOrder="11" Text="평가대상생성" Top="66" Width="99"></Button>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = this.GetForm().id;
var sBUTTONLIST   = 'FFFFTFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var sMenuGrpNum     = "0";                         	   // 메뉴그룹의 갯수보관
var sMenuListNum    = "0";                             // 메뉴리스트의 갯수보관
var sMenuUpId       = "";
var sMenuUpNm       = "";
var sPAGENUM        = "20";

var sEvalYear = ""; 
var sEvalNum  = "";
var nDeptCd   = "";
var xRow      = "";

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'FT'+sInpt+'FFFT';
  
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
    
    //공통코드 조회
	fcd_GetComboDs(dsInComCd);
	
    fcSearchComboDept();
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "dsEmpEstm|dsEmpEstm1|dsEmpEstmExp|dsEmpEstmMnr|dsEmpEstmSvr";
	if (!fnc_FormUnloadCheck(sDataset, sFormId)) return false;
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
    dsEmpEstm   .ClearData();
    dsEmpEstm1  .ClearData();
	dsEmpEstmExp.ClearData();
	dsEmpEstmMnr.ClearData();
	dsEmpEstmSvr.ClearData();
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
	fcInit(obj);
	return true;
}

function fcSearch(obj) {
	if ( !fcSearchCheck(obj) ) return;

	var sServiceName = "rev1070-service:searchEmpEstm";
    var sInDataSet   = "";
    var sOutDataSet  = "dsEmpEstm=dsEmpEstm "
                     + "dsEmpEstmExp=dsEmpEstmExp "
                     + "dsEmpEstmMnr=dsEmpEstmMnr "
                     + "dsEmpEstmSvr=dsEmpEstmSvr "
                     + "dsAprvStas=dsAprvStas "
                     + "dsEmpEstm1=dsEmpEstm1 "
                     + "dsAprvMnrSvr=dsAprvMnrSvr ";     
    
	fcEstmYearValue();	
    nDeptCd = cboDept.Value;
    
	fcd_AddParam("ESTM_YEAR", sEvalYear);	
	fcd_AddParam("ESTM_NUM" , sEvalNum);		
	fcd_AddParam("DEPT_CD"  , cboDept.Value);
	fcd_AddParam("APRV_DEPT", cboDept.Value);	
	fcd_AddParam("APRV_SEQ" , "1");
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

function fcSearchComboDept(obj)
{
	dsDept.ClearData();
	
	var sServiceName = "rev1070-service:searchCbDept";
    var sInDataSet   = "";
    var sOutDataSet  = "dsDept=dsDept ";     
    
	fcEstmYearValue();	
    
	fcd_AddParam("ESTM_YEAR", sEvalYear);	
	fcd_AddParam("ESTM_NUM", sEvalNum);	
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

//평가마감여부 조회
function fcSearchEnd() {
	var sServiceName = "rev2010-service:searchEstmEnd";
    var sInDataSet   = "";
    var sOutDataSet  = "dsEstmEnd=dsEstmEnd ";     

    fcEstmYearValue();
    
	fcd_AddParam("ESTM_YEAR", sEvalYear);	
	fcd_AddParam("ESTM_NUM" , sEvalNum);	
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}
/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSave(obj) {

}

function fcSaveData() {
	//1차평가자로 지정된 투표소장의 근무지를 피평가자와 같게한다.
	for(var i=0; i<dsEmpEstm1.rowcount;i++) {
		if( !fnc_IsNull( dsEmpEstm1.GetColumn(i, "EMP_NO")) ) {
			var nFindRow = dsEmpEstmExp.FindRow("EMP_NO", dsEmpEstm1.GetColumn(i, "EMP_NO"));
			
			dsEmpEstmExp.SetColumn(nFindRow, "COMM_NO", dsEmpEstm1.GetColumn(i, "COMM_NO"));
			dsEmpEstmExp.SetColumn(nFindRow, "DIV_NO" , dsEmpEstm1.GetColumn(i, "DIV_NO"));
			dsEmpEstmExp.SetColumn(nFindRow, "DIV_NM" , dsEmpEstm1.GetColumn(i, "DIV_NM"));
		}
	}  
	
	var sServiceName = "rev1070-service:saveEmpEstm";
	var sInDataSet   = "dsEmpEstm=dsEmpEstm:U "
					 + "dsEmpEstm1=dsEmpEstm1:a "
					 + "dsEmpEstmExp=dsEmpEstmExp:a "
					 + "dsEmpEstmMnr=dsEmpEstmMnr:U "
					 + "dsEmpEstmSvr=dsEmpEstmSvr:U ";
	var sOutDataSet  = "";		
	
	fcEstmYearValue();	

	fcd_AddParam("ESTM_YEAR", sEvalYear);	
	fcd_AddParam("ESTM_NUM" , sEvalNum);		
	fcd_AddParam("DEPT_CD"  , cboDept.Value);
	fcd_AddParam("REGRANT"  , "Y");
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

function fcEvalCreate() {
	var sServiceName = "rev1070-service:saveAppr";
	var sInDataSet   = "";
	var sOutDataSet  = "";		
	
	fcEstmYearValue();	
	
	fcd_AddParam("ESTM_YEAR", sEvalYear);	
	fcd_AddParam("ESTM_NUM" , sEvalNum);		
	fcd_AddParam("DEPT_CD"  , cboDept.Value);
	fcd_AddParam("REGRANT"  , "Y");

	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}
/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
	
	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 조회 완료 후 
	// 업무수행평가현황
	if ( sServiceName == "rev1070-service:searchEmpEstm" ) {
		for( var o=0; o<dsEmpEstmExp.RowCount(); o++) {
			if( fnc_IsNull(dsEmpEstmExp.GetColumn(o, "ESTM_WK_JOB")) ) {
				dsEmpEstmExp.SetColumn(o, "ESTM_WK_JOB" , dsEmpEstmExp.GetColumn(o, "WK_JOB_CD") );
			}
		}
		
		fcSearchEnd();
	}	
	
	//평가마감 여부 조회 완료 후
	if ( sServiceName == "rev2010-service:searchEstmEnd" ) {
		if( dsEstmEnd.GetColumn(0, "ESTM_END_YN") == "Y" ) {
			divBtnLst.btnSave.Enable = false;
			ApprBtn.Enable = false;
			
			tab.tab1.grdEmpEstm.Editable    = false;
			tab.tab1.grdEmpEstm1.Editable   = false;
			tab.tab1.grdEmpEstmExp.Editable = false;
			
			tab.tab2.grdEmpEstmMnr.Editable = false;
			
			tab.tab3.grdEmpEstmSvr.Editable = false;
			
		} else {
			divBtnLst.btnSave.Enable = true;
			ApprBtn.Enable = true;
			
			tab.tab1.grdEmpEstm.Editable    = true;
			tab.tab1.grdEmpEstm1.Editable   = true;
			tab.tab1.grdEmpEstmExp.Editable = true;
			
			tab.tab2.grdEmpEstmMnr.Editable = true;
			
			tab.tab3.grdEmpEstmSvr.Editable = true;
		}
	}
	
	
	//  부서 콤보 조회 완료 후
	if ( sServiceName == "rev1070-service:searchCbDept" ) {
		fcSearch();	
	}
	
	// 저장 완료 후
	if ( sServiceName == "rev1070-service:saveEmpEstm" ) {
		fcEvalCreate();
	}
	
	// 평가대상생성 완료 후
	if ( sServiceName == "rev1070-service:saveAppr" ) {
		fcSearch();		
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex)
{	
	switch ( objGrd.id ) {
		case "grdEmpEstm" :
			
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			
			var nEmpNo =  "";
			var xRow   =  "";
			nDeptCd    = cboDept.Value;
			
			if (nCell == 3 && dsEmpEstm.GetColumn(nRow, "EV_GBN") != '002' )
			{
				sFormId = "frm_rev::REV1070P.xml";
				sArgs = "FLAG="     + quote("Y")  + " "
				      + "PERM_GBN=" + quote("001");	
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0 ) {
					
					nEmpNo = dsEmpEstm.GetColumn(nRow, "EMP_NO");
					xRow = dsEmpEstmExp.FindRow("EMP_NO", nEmpNo );

					if ( !fnc_IsNull(dsEmpEstm.GetColumn(nRow, "EMP_NO")) ) {
						dsEmpEstmExp.SetColumn(xRow , "ESTM_YN" , "N");
					}
					
					dsEmpEstm.SetColumn(nRow, "EMP_NO"    , arrReturn[0]);
					dsEmpEstm.SetColumn(nRow, "EMP_NM"    , arrReturn[1]);
					dsEmpEstm.SetColumn(nRow, "JOB_TIT_NM", arrReturn[2]);
					nEmpNo = dsEmpEstm.GetColumn(nRow, "EMP_NO");
					xRow = dsEmpEstmExp.FindRow("EMP_NO", nEmpNo );
					dsEmpEstmExp.SetColumn(xRow , "ESTM_YN" , "Y");
					
					//피평가자 자동 Setting
					var sJobCd = "1003";
					
					var sEmpNo = arrReturn[0];
					var sEmpNm = arrReturn[1];
					
					for( var i = 0 ; i < dsEmpEstmExp.rowcount ; i++) {
						if( dsEmpEstmExp.GetColumn(i, "ESTM_WK_JOB") != sJobCd ) {
							dsEmpEstmExp.SetColumn(i, "ESTM_EMP" , sEmpNo);
							dsEmpEstmExp.SetColumn(i, "EV_EMP_NM", sEmpNm);
						}
					}
				}
			}
		break;
		
		case "grdEmpEstm1" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(4);
			
			var nEmpNo =  "";
			var xRow   =  "";
			
			nDeptCd     = cboDept.Value;
			
			if( nCell == 2 ) {
				sFormId = "frm_rev::REV1070P.xml";
				sArgs = "FLAG="      + quote("N")   + " "
				      + "PERM_GBN="  + quote("002") + " "
				      + "WK_JOB_CD=" + quote("1006");
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if( length(arrReturn) > 0  ) {
					dsEmpEstm1.SetColumn(nRow, "TEAM_CD"  , arrReturn[6]);
					dsEmpEstm1.SetColumn(nRow, "HP_NO"    , arrReturn[5]);
					dsEmpEstm1.SetColumn(nRow, "RES_NO"   , arrReturn[4]);
					dsEmpEstm1.SetColumn(nRow, "WK_JOB_NM", arrReturn[2]);
					dsEmpEstm1.SetColumn(nRow, "ESTM_WK_JOB", arrReturn[3]);
					dsEmpEstm1.SetColumn(nRow, "EMP_NM"   , arrReturn[1]);
					dsEmpEstm1.SetColumn(nRow, "EMP_NO"   , arrReturn[0]);
					
					//피평가자 자동 Setting
					var sJobCd = "1003";
					
					var sEmpNo  = arrReturn[0];
					var sEmpNm  = arrReturn[1];
					var sDivNo  = dsEmpEstm1.GetColumn(nRow, "DIV_NO");
					var sCommNo = dsEmpEstm1.GetColumn(nRow, "COMM_NO");
					
					for( var i = 0 ; i < dsEmpEstmExp.rowcount ; i++) {
						if( dsEmpEstmExp.GetColumn(i, "WK_JOB_CD") == sJobCd &&
							dsEmpEstmExp.GetColumn(i, "DIV_NO")    == sDivNo &&
							dsEmpEstmExp.GetColumn(i, "COMM_NO")   == sCommNo ) {
							dsEmpEstmExp.SetColumn(i, "ESTM_EMP"   , sEmpNo);
							dsEmpEstmExp.SetColumn(i, "EV_EMP_NM", sEmpNm);
						}
					}
				}
			}
			break;
		case "grdEmpEstmExp" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			nDeptCd     = cboDept.Value;
	
			if (nCell == 3 &&  dsEmpEstmExp.GetColumn(nRow, "ESTM_YN") == 'N')
			{
				
				sFormId = "frm_rev::REV1071P.xml";
				sArgs = "";	
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0  ) {
					dsEmpEstmExp.SetColumn(nRow, "WK_JOB_NM", arrReturn[0]);
					dsEmpEstmExp.SetColumn(nRow, "ESTM_WK_JOB", arrReturn[1]);
				
					var nFGbn = dsEmpEstm.FindRow("EV_GBN", "001");
					
					if( nFGbn != -1 ) {
						var sEmpNo = dsEmpEstm.GetColumn(nFGbn, "EMP_NO");
						var sEmpNm = dsEmpEstm.GetColumn(nFGbn, "EMP_NM");
						
						if( arrReturn[1] == "1003" ) {
							//발매원이 아닌 보직 -> 발매원
							dsEmpEstmExp.SetColumn(nRow, "ESTM_EMP" , "");
							dsEmpEstmExp.SetColumn(nRow, "EV_EMP_NM", "");
						} else {
							//발매원 -> 발매원이 아닌 보직
							dsEmpEstmExp.SetColumn(nRow, "ESTM_EMP" , sEmpNo);
							dsEmpEstmExp.SetColumn(nRow, "EV_EMP_NM", sEmpNm);
						}
					}
				}
			}
			
			if (nCell == 4 &&  dsEmpEstmExp.GetColumn(nRow, "ESTM_YN") == 'N')
			{
				var sDeptCd = dsEmpEstmExp.GetColumn(nRow, "DEPT_CD");
				
				if( fnc_IsNull(sDeptCd) ) {
					fnc_Message(SNIS_RBM_F017,"N");
					return;
				}
				
				sFormId = "frm_rev::REV1072P.xml";
				sArgs   = "DEPT_CD=" + quote(sDeptCd) + " ";	
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0  ) {
					dsEmpEstmExp.SetColumn(nRow, "DIV_NO" , arrReturn[0]);
					dsEmpEstmExp.SetColumn(nRow, "DIV_NM" , arrReturn[1]);
					dsEmpEstmExp.SetColumn(nRow, "COMM_NO", arrReturn[2]);
					
					if( dsEmpEstmExp.GetColumn(nRow, "ESTM_WK_JOB" ) == "1003" ) {
						var nFindRow = dsEmpEstm1.FindRowNF("DIV_NO", arrReturn[0]);
						
						dsEmpEstmExp.SetColumn(nRow, "ESTM_EMP"   , dsEmpEstm1.GetColumn(nFindRow, "EMP_NO"));
						dsEmpEstmExp.SetColumn(nRow, "EV_EMP_NM", dsEmpEstm1.GetColumn(nFindRow, "EMP_NM"));
					}
				}
			}
			
			if (nCell == 5 &&  dsEmpEstmExp.GetColumn(nRow, "ESTM_YN") == 'N')
			{
				
				sFormId = "frm_rev::REV1070P.xml";
				sArgs   = "FLAG="      + quote("N")    + " "
				        + "WK_JOB_CD=" + quote("1006") + " ";
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0  ) {
					dsEmpEstmExp.SetColumn(nRow, "ESTM_EMP", arrReturn[0]);
					dsEmpEstmExp.SetColumn(nRow, "EV_EMP_NM", arrReturn[1]);
				}
			}
			break;
		
		case "grdEmpEstmMnr" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			nDeptCd     = cboDept.Value;
			
			if (nCell == 3  && dsEmpEstmMnr.GetColumn(nRow, "EV_GBN") != '002'){
				sFormId = "frm_rev::REV1070P.xml";
				sArgs = "FLAG=" + quote("Y") + " ";	
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0  )
				{
					dsEmpEstmMnr.SetColumn(nRow, "EMP_NO", arrReturn[0]);
					dsEmpEstmMnr.SetColumn(nRow, "EMP_NM", arrReturn[1]);
					dsEmpEstmMnr.SetColumn(nRow, "JOB_TIT_NM", arrReturn[2]);
					
				}
		   }
		break;
		case "grdEmpEstmSvr" :
			var sFormId 	= "";
			var sArgs 		= "";
			var arrReturn   = array(2);
			nDeptCd     = cboDept.Value;
			
			if (nCell == 3 && dsEmpEstmSvr.GetColumn(nRow, "EV_GBN") != '002'){
				sFormId = "frm_rev::REV1070P.xml";
				sArgs = "FLAG=" + quote("Y") + " ";	
				
				arrReturn = Dialog(sFormId, sArgs, 334, 443, "");
				
				if ( length(arrReturn) > 0  )
				{
					dsEmpEstmSvr.SetColumn(nRow, "EMP_NO", arrReturn[0]);
					dsEmpEstmSvr.SetColumn(nRow, "EMP_NM", arrReturn[1]);
					dsEmpEstmSvr.SetColumn(nRow, "JOB_TIT_NM", arrReturn[2]);
				}
		    }
		break;
	}
}

function fcEstmYearValue(obj)
{
	/* 콤보박스에서 값 가져오기 */
    var nCbValue =cbEstmYear.Value;
	var nCbRow = dsEstmYear.SearchRow("CD=="+nCbValue);
	
	sEvalYear = dsEstmYear.GetColumn(nCbRow,"ESTM_YEAR");
	sEvalNum = dsEstmYear.GetColumn(nCbRow,"ESTM_NUM");
}

//평가대상생성 Check
function fcBtnCheck() {
	var sEvEmp = "";
	var sTitle = tab.tab1.grdEmpEstmExp.GetCellText("Head", 0, 5);
	
	//발매원 중의 Teller_ID가 없는 사람 존재시, 저장 불가능
	for(var i=0; i<dsEmpEstmExp.rowcount; i++) {
		if( fnc_IsNull(  dsEmpEstmExp.GetColumn(i, "TELLER_ID")) &&
			dsEmpEstmExp.GetColumn(i, "ESTM_WK_JOB") == "1003"  )  {
			fnc_Message(SNIS_RBM_F036, "N", i+1);
			dsEmpEstmExp.row = i;
			return false;
		}
	}
	
	//평가자 필수항목 
	if( dsEmpEstm.rowcount != 2 ) {
		fnc_Message(SNIS_RBM_F018, "N");
		return false;
	} else {
	
		for(var i = 0; i < dsEmpEstm.rowcount; i++) {
			if( fnc_IsNull(dsEmpEstm.GetColumn(i, "EMP_NO")) ){
				fnc_Message(SNIS_RBM_F018, "N");
				return false;
			}
		}
	}
	
	for(var i = 0; i < dsEmpEstmExp.rowcount; i++) {
		sEvEmp = dsEmpEstmExp.GetColumn(i, "ESTM_EMP");
		//피평가자 필수항목
		if( fnc_IsNull( sEvEmp ) &&
			dsEmpEstmExp.GetColumn(i, "ESTM_YN") == "N"    ) {
			fnc_Message(SNIS_RBM_F019, "N", "피평가자", "성명");
			return false;
		}
		
		//오른쪽 그리드의 평가자가 왼쪽하단 그리드에 없을 때, 평가대상생성 불가능
		if( dsEmpEstmExp.GetColumn(i, "ESTM_WK_JOB") == "1003" ) {
			if( dsEmpEstm1.FindRow( "EMP_NO", sEvEmp) == -1 ) {
				dsEmpEstmExp.row = i;
				fnc_Message(SNIS_RBM_F051, "N", i+1, sTitle);
				return false;
			}
		}
	}
	/*
	//근무태도평가항목 필수항목
	for(var i = 0; i < dsEmpEstmMnr.rowcount; i++) {
		if( fnc_IsNull( dsEmpEstmMnr.GetColumn(i, "EMP_NO")) ) {
			tab.TabIndex = 1;
			fnc_Message(SNIS_RBM_F019, "N", "근무태도평가항목의 평가자", "성명");
			return false;
		}
	}
	
	//서비스평가항목 필수항목
	for(var i = 0; i < dsEmpEstmSvr.rowcount; i++) {
		if( fnc_IsNull( dsEmpEstmSvr.GetColumn(i, "EMP_NO")) ) {
			tab.TabIndex = 2;
			fnc_Message(SNIS_RBM_F019, "N", "서비스평가항목의 평가자", "성명");
			return false;
		}
	}*/
	return true;
}

function fcBtnOnClick(obj) {

	switch(obj.id) {
		case "ApprBtn" : //평가대상생성 및 평가자들 권한 재부여
			if ( !fcBtnCheck() ) return;
			
			if(fnc_Message(SNIS_RBM_F034, "Y")) {
			         
			    // 정규직 EMP_NO에 값이 있는 항목만 Server에 넘긴다. 
				if ( fnc_DatasetChangeCheck(dsEmpEstm) ) {
					for(var i=0; i<dsEmpEstm.rowcount; i++) {
						if ( !fnc_IsNull(dsEmpEstm.GetColumn(i,"EMP_NO")) ) {
							dsEmpEstm.SetColumn(i,"CHK" , "1");
						}	
					}
				}
				
				// 비정규직 EMP_NO에 값이 있는 항목만 Server에 넘긴다. 
				for(var i=0; i<dsEmpEstm1.rowcount; i++) {
					if ( !fnc_IsNull(dsEmpEstm1.GetColumn(i,"EMP_NO")) ) {
						dsEmpEstm1.SetColumn(i,"CHK" , "1");
					}	
				}
				
				
				// 피평가자 EMP_NO에 값이 있는 항목만 Server에 넘긴다. 
				if ( fnc_DatasetChangeCheck(dsEmpEstmSvr) ) {
					for(var i=0; i<dsEmpEstmSvr.RowCount(); i++) {
						if ( !fnc_IsNull(dsEmpEstmSvr.GetColumn(i,"EMP_NO")) ) {
							dsEmpEstmSvr.SetColumn(i,"CHK" , "1");
						}
					}
				}
				
				// 근무태도평가 EMP_NO에 값이 있는 항목만 Server에 넘긴다.
				if ( fnc_DatasetChangeCheck(dsEmpEstmMnr) ) {
					for(var i=0; i<dsEmpEstmMnr.RowCount(); i++) {
						if ( !fnc_IsNull(dsEmpEstmMnr.GetColumn(i,"EMP_NO")) ) {
							dsEmpEstmMnr.SetColumn(i,"CHK" , "1");
						}	
					}
				}
				
				//피평가자의 투표소장은 무조건 서버로 넘긴다.
				for(var i=0; i<dsEmpEstmExp.rowcount; i++) {
					if( dsEmpEstmExp.GetColumn(i, "ESTM_WK_JOB") == "1006" ) {	//ESTM_WK_JOB WK_JOB_CD
						dsEmpEstmExp.SetColumn(i, "CHK", "1");
					}
				}     
			    
			    fcSaveData();
			}
			break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  중복여부 체크
+-------------------------------------------------------------------------------------------------*/
function fcDsOnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	switch( obj.id ) {
		case "dsEmpEstm1" :
			if ( strColumnID == "EMP_NO" ) {
				obj.FireEvent = false;
				
				if( !fnc_IsNull(varNewValue) ) {
					if ( fnc_GetExistValue(obj, strColumnID, varNewValue) != nRow ) {
						fnc_Message(L_COM_ALT_0016, "N", "성명이");
								
						obj.SetColumn(nRow, "TEAM_CD"  , "");
						obj.SetColumn(nRow, "HP_NO"    , "");
						obj.SetColumn(nRow, "HP_NO"    , "");
						obj.SetColumn(nRow, "WK_JOB_NM", "");
						obj.SetColumn(nRow, "ESTM_WK_JOB", "");
						obj.SetColumn(nRow, "EMP_NM"   , "");
						obj.SetColumn(nRow, strColumnID, "");
					}
					if ( fnc_GetExistValue(obj, strColumnID, varNewValue, nRow + 1) > 0 ) {
						fnc_Message(L_COM_ALT_0016, "N", "성명이");
						obj.SetColumn(nRow, "TEAM_CD"  , "");
						obj.SetColumn(nRow, "HP_NO"    , "");
						obj.SetColumn(nRow, "HP_NO"    , "");
						obj.SetColumn(nRow, "WK_JOB_NM", "");
						obj.SetColumn(nRow, "ESTM_WK_JOB", "");
						obj.SetColumn(nRow, "EMP_NM"   , "");
						obj.SetColumn(nRow, strColumnID, "");
					}
				}
				obj.FireEvent = true;
			}
		break;
	}
}

function fcCheckCombo(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fcSearchComboDept();
}
]]></Script>
</Window>