<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="common_file(첨부파일 관리)">
    <query id="common_file_s01" desc="첨부파일 조회" fetchSize="10">
      <![CDATA[
            SELECT /* common_file_s01 */
                '0' AS CHK
                ,ATT_FILE_KEY   --첨부파일키
                ,SEQ            --순번
                ,ORD_NO         --정렬순서
                ,TBL_NM         --테이블명
                ,FILE_NM        --파일명
                
                ,FILE_PATH      --파일경로
                ,REAL_FILE_NM   --실파일명 
                ,INST_ID        --작성자
                ,INST_DT        --작성일시

             FROM  TBRK_FILE_MANA  --첨부파일

            WHERE  1=1
              AND  ATT_FILE_KEY = ?  --첨부파일키
         ORDER BY  ORD_NO         
        ]]>
    </query>       

    <query id="common_file_i01" desc="첨부파일  입력" fetchSize="10">

            INSERT /* common_file_i01 */
                   INTO TBRK_FILE_MANA (  /* common_file_i01 */

                 ATT_FILE_KEY       --첨부파일키
                ,SEQ                --순번
                ,TBL_NM             --테이블명
                ,FILE_NM            --파일명
                ,FILE_PATH          --파일경로  
                
                ,REAL_FILE_NM       --실파일명
                ,ORD_NO             --정렬순
                ,INST_ID            --작성자
                ,INST_DT            --작성일시
                
            ) VALUES (
            
                  ?             -- ATT_FILE_KEY
                , (SELECT       -- SEQ
                        NVL(MAX(SEQ),0) + 1
                        FROM  TBRK_FILE_MANA    
                        WHERE   ATT_FILE_KEY = ?    
                  )            
                , ?             -- TBL_NM
                , ?             -- FILE_NM
                , ?             -- FILE_PATH
                
                , ?             -- REAL_FILE_NM
                , ?             -- ORD_NO         
                , ?             -- INST_ID      
                , SYSDATE       -- INST_DT
            )
    </query> 

    <query id="common_file_u01" desc=" 첨부파일  수정" fetchSize="10">

        <![CDATA[

            UPDATE /* common_file_u01 */
                   TBRK_FILE_MANA SET  /* common_file_u01 */
                 TBL_NM        = ?  --테이블명
                ,FILE_NM       = ?  --파일명                 
                ,FILE_PATH     = ?  --파일경로
                ,REAL_FILE_NM  = ?  --실파일명
                ,ORD_NO        = ?  --정렬순서
                
            WHERE ATT_FILE_KEY = ?
                AND SEQ = ?

        ]]>

    </query>    

    <query id="common_file_d01" desc="첨부파일  삭제" fetchSize="10">

        <![CDATA[

            DELETE TBRK_FILE_MANA   /* common_file_d01 */   

            WHERE ATT_FILE_KEY = ?   --첨부파일키
                AND SEQ = ?          --순번

        ]]>

    </query>
    
    <query id="common_file_s02" desc="첨부파일 KEY 조회" fetchSize="10">
      <![CDATA[
            SELECT /* common_file_s02 */
                SQ_TBRK_FILE_MANA.NEXTVAL ATT_FILE_KEY  -- 첨부파일키 MAX 
            FROM DUAL                       
        ]]>
    </query>
    
    <query id="common_file_s03" desc="첨부파일 존재여부 조회" fetchSize="10">
        <![CDATA[
            SELECT  COUNT(*) AS CNT   /* common_file_s03 */ 
              FROM  TBRK_FILE_MANA    --첨부파일
             WHERE  1=1
               AND  ATT_FILE_KEY = ?  --첨부파일키
        ]]>
    </query>
</queryMap>