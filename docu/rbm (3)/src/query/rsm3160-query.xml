<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="RSM3160(승식별 최고/최저)">
	<query id="rsm3160_s01" desc="승식별 최고/최저" fetchSize="10">
        <![CDATA[
        
        	 SELECT /* rsm3160_s01 */                                       
			     R.MEET_CD,                                
			     R.STND_YEAR,                              
			     R.POOL_CD,                                
			     CASE                                     
			         WHEN R.POOL_CD='001' THEN '단승식'    
			         WHEN R.POOL_CD='002' THEN '연승식'    
			         WHEN R.POOL_CD='005' THEN '복승식'    
			         WHEN R.POOL_CD='004' THEN '쌍승식'    
			         WHEN R.POOL_CD='006' THEN '삼복승식'  
			     END POOL_NM,						-- 구분                             
			     ROUND(AVG(R.PAYOFF),2) AVG_PAYOFF,	-- 평균배당률        
			     MAX(R.PAYOFF) MAX_PAYOFF,          -- 최고배당률       
			     MIN(R.PAYOFF) MIN_PAYOFF           -- 최저배당률
			 FROM                                         
			     VW_SDL_INFO V,                           
			     TBES_SDL_RS R                            
			 WHERE                                        
			     1=1                                      
			     AND V.MEET_CD	= ? -- 0:MEET_CD 개최지 코드                   
			     AND V.RACE_DAY >= ? -- 1:RACE_DAY_ST -- 경주검색 시작일           
			     AND V.RACE_DAY <= ? -- 2:RACE_DAY_END -- 경주검색 마지막 일          
			     AND R.MEET_CD=V.MEET_CD                  
			     AND R.STND_YEAR=V.STND_YEAR                        
			     AND R.TMS=V.TMS                          
			     AND R.DAY_ORD=V.DAY_ORD                  
			 GROUP BY                                     
			     R.MEET_CD,R.STND_YEAR,R.POOL_CD               
			 ORDER BY R.POOL_CD                           
			                
         	                                                       
        ]]>
    </query>

</queryMap>