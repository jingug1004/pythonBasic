<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbef_equip_drwlt 장비추첨 확정 여부 ">
    <query id="tbeb_race_tms_ff001" desc="장비추첨 대상 확정 여부  조회 " fetchSize="50">
        <![CDATA[
           -- 장비추첨 대상 확정 여부  조회
           SELECT 
                STND_YEAR,    -- 기준년도 
                MBR_CD,    -- 경정장 코드  
                TMS,    -- 회차 
                NVL(EQUIP_DRWLT_CMPL_YN, 'X') AS EQUIP_DRWLT_CMPL_YN,    -- 장비 추첨 대상 완료 여부 
                RACE_TMS_STAT_CD,     -- 회차 상태 (001: 회차 등록 , 010:주선, 장비 추첨) 이경우만 저장 가능 
                (SELECT CD_NM FROM TBEA_SPEC_CD TSC WHERE TSC.CD = TED.RACE_TMS_STAT_CD AND GRP_CD='E00106') AS RACE_TMS_STAT_CD_NM
            FROM TBEB_RACE_TMS TED
            WHERE STND_YEAR = ?    -- 기준 년도 
            AND MBR_CD    = ?     -- 경정장 코드 
            AND TMS = ?        -- 회차
		]]>	
    </query> 
   
    <query id="tbeb_race_tms_uf001" desc="장비추첨 확정 여부 수정" fetchSize="10">
        <![CDATA[
            -- 장비 추첨 확정 
			UPDATE /* tbeb_race_tms_uf001 */
			       TBEB_RACE_TMS
			SET 
		          EQUIP_DRWLT_CMPL_YN = ?,		-- 장비추첨 확정 여부 상태 		          RACE_TMS_STAT_CD = (CASE WHEN RACE_TMS_STAT_CD IN ('001', '010') THEN ? ELSE RACE_TMS_STAT_CD END),		-- 회차 상태		          UPDT_ID	= ?, 	-- 수정자 ID		          UPDT_DTM  = SYSDATE	-- 수정일시			WHERE STND_YEAR = ?	-- 기준 년도 			AND   MBR_CD	= ? 	-- 경정장 코드 			AND   TMS = ?		-- 회차         ]]>
    </query> 
</queryMap>