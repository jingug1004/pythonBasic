<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbeb_racer_perio_no_reg_term(기수등록기간)">
    <query id="tbeb_racer_perio_no_reg_term_fb000" desc="조회" fetchSize="10">
        <![CDATA[
			SELECT NVL(MAX(TRPNRT.SEQ), 0) + 1 SEQ
			FROM   TBEB_RACER_PERIO_NO_REG_TERM TRPNRT
			WHERE  TRPNRT.RACER_PERIO_NO = ?
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_fb001" desc="기수등록기간조회" fetchSize="10">
        <![CDATA[
			SELECT
			         TRPN.RACER_PERIO_NO
			       , TRPN.REG_DT	         
			       , (TRM .RACER + TRM .NEW_RACER + TRM .CANCEL_RACER) TOTAL_RACER
			       , (TRM .RACER + TRM .NEW_RACER) REG_RACER
			       , TRM .CANCEL_RACER
			FROM   TBEB_RACER_PERIO_NO TRPN
			       , (
			            SELECT
			                     RACER_PERIO_NO
			                   , MAX(DECODE(RACER_STAT_CD, '001', CNT, 0)) RACER
			                   , MAX(DECODE(RACER_STAT_CD, '002', CNT, 0)) NEW_RACER
			                   , MAX(DECODE(RACER_STAT_CD, '003', CNT, 0)) CANCEL_RACER
			            FROM   (
			                        SELECT 
			                                 TRM.RACER_PERIO_NO
			                               , TRM.RACER_STAT_CD
			                               , COUNT(*) CNT
			                        FROM   TBEC_RACER_MASTER TRM
			                        GROUP BY 
			                                 TRM.RACER_PERIO_NO
			                               , TRM.RACER_STAT_CD
			                   )
			            GROUP BY RACER_PERIO_NO
			         ) TRM
			WHERE  TRPN.RACER_PERIO_NO = TRM.RACER_PERIO_NO(+)
			ORDER BY TRPN.RACER_PERIO_NO
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_fb002" desc="기수등록기간조회" fetchSize="10">
        <![CDATA[
			SELECT
			         TRPNRT.RACER_PERIO_NO  -- 선수기수코드
			       , TRPNRT.SEQ             -- 일련번호    
			       , TRPNRT.STR_DT          -- 시작일자    
			       , TRPNRT.END_DT          -- 종료일자    
			       , TRPNRT.RMK				-- 비고
			       , TRPNRT.INST_ID         -- 작성자ID    
			       , TRPNRT.INST_DTM        -- 작성일시    
			       , TRPNRT.UPDT_ID         -- 수정자ID    
			       , TRPNRT.UPDT_DTM        -- 수정일시    
			FROM   TBEB_RACER_PERIO_NO_REG_TERM TRPNRT
			WHERE  TRPNRT.RACER_PERIO_NO = ?
			ORDER BY TRPNRT.END_DT DESC
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_fb003" desc="기수조회" fetchSize="10">
        <![CDATA[
			SELECT
			       TRPN.RACER_PERIO_NO
			FROM   TBEB_RACER_PERIO_NO TRPN
		    ORDER BY TRPN.RACER_PERIO_NO
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_ib001" desc="기수등록기간저장" fetchSize="10">
        <![CDATA[
			INSERT INTO TBEB_RACER_PERIO_NO_REG_TERM
			(
			         RACER_PERIO_NO  -- 선수기수코드
			       , SEQ             -- 일련번호    
			       , STR_DT          -- 시작일자    
			       , END_DT          -- 종료일자 
			       , RMK			 -- 비고   
			       , INST_ID         -- 작성자ID    
			       , INST_DTM        -- 작성일시    
			       , UPDT_ID         -- 수정자ID    
			       , UPDT_DTM        -- 수정일시    
			) VALUES (
			         ?               -- 선수기수코드
			       , ?               -- 일련번호    
			       , ?               -- 시작일자    
			       , ?               -- 종료일자
			       , ?				 -- 비고    
			       , ?               -- 작성자ID    
			       , SYSDATE         -- 작성일시    
			       , ?               -- 수정자ID    
			       , SYSDATE         -- 수정일시    
			)
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_ub001" desc="기수등록기간수정" fetchSize="10">
        <![CDATA[
			UPDATE TBEB_RACER_PERIO_NO_REG_TERM SET
			         STR_DT       = ?         -- 시작일자    
			       , END_DT       = ?         -- 종료일자    
			       , RMK		  = ?		  -- 비고
			       , UPDT_ID      = ?         -- 수정자ID    
			       , UPDT_DTM     = SYSDATE   -- 수정일시    
			WHERE  RACER_PERIO_NO = ?         -- 선수기수코드
			AND    SEQ            = ?         -- 일련번호    
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_db001" desc="기수등록기간삭제" fetchSize="10">
        <![CDATA[
			DELETE
			FROM   TBEB_RACER_PERIO_NO_REG_TERM
			WHERE  RACER_PERIO_NO = ?             -- 선수기수코드
			AND    SEQ            = NVL(?, SEQ)   -- 일련번호    
        ]]>
    </query> 
    
    <query id="tbeb_racer_perio_no_reg_term_ib002" desc="기수저장" fetchSize="10">
        <![CDATA[
			INSERT INTO TBEB_RACER_PERIO_NO (
			      RACER_PERIO_NO
			    , REG_DT
			    , INST_ID
			    , INST_DTM
			    , UPDT_ID
			    , UPDT_DTM
			) VALUES (
			      ?             -- RACER_PERIO_NO
			    , ?             -- REG_DT
			    , ?             -- INST_ID
			    , SYSDATE       -- INST_DTM
			    , ?             -- UPDT_ID
			    , SYSDATE       -- UPDT_DTM    
			)
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_ub002" desc="기수수정" fetchSize="10">
        <![CDATA[
			UPDATE TBEB_RACER_PERIO_NO SET
			      REG_DT            = ?
			    , UPDT_ID           = ?
			    , UPDT_DTM          = SYSDATE
			WHERE RACER_PERIO_NO    = ?   
        ]]>
    </query> 
    <query id="tbeb_racer_perio_no_reg_term_db002" desc="기수삭제" fetchSize="10">
        <![CDATA[
			DELETE FROM TBEB_RACER_PERIO_NO
			WHERE RACER_PERIO_NO    = ?  
        ]]>
    </query>     
</queryMap>