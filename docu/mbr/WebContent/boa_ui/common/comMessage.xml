<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="160" Id="comMessage" Left="8" OnKeyDown="commessage_OnKeyDown" OnLoadCompleted="fcFormLoadSetting" PidAttrib="7" Style="style_form" Title="Message처리&#32;공통화면" Top="8" Ver="1.0" Width="480" WorkArea="true">
		<Shape BKColor="#e9e9e9" Bottom="118" Height="94" Id="Shape0" Left="112" LineColor="darkgray" Right="468" RoundUnit="Pixel" RoundWidth="22" TabOrder="3" Top="24" Type="RoundRect" Width="356"></Shape>
		<Image Height="141" Id="Image0" ImageID="confirm_im01" Left="8" TabOrder="1" Top="6" Width="101"></Image>
		<TextArea Border="None" Height="62" Id="edMessage" Left="126" TabOrder="2" Top="40" VScroll="TRUE" Width="330"></TextArea>
		<Div BKColor="user2" Border="Flat" BorderColor="user2" Height="25" Id="divBtnConfirm" Left="360" TabOrder="4" Text="Div0" Top="126" Url="common::comButtonConfirm.xml" Width="108">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[/************************
*  공통 Script Include  *
************************/

/*********************
*  화면 변수 선언부  *
*********************/
var sMESSAGEID   ="";      // Message ID
var sMESSAGETYPE ="";      // Message Type
var sARG1        ="";      // '@'인자1
var sARG2        ="";      // '@'인자2
var sARG3        ="";      // '@'인자3
var sARG4        ="";      // '@'인자4
var sARG5        ="";      // '@'인자5

/*---------------------------+
|  01.Form Load 時 화면 처리 |
-----------------------------*/
function fcFormLoadSetting(obj) {
	
	sMESSAGEID   = sMessageID;   
	sMESSAGETYPE = sMessageType;
	sARG1        = sArg1;        
	sARG2        = sArg2;        
	sARG3        = sArg3;        
	sARG4        = sArg4;        
	sARG5        = sArg5;     
	 
	fcFormAlin(sMESSAGEID, sMESSAGETYPE);
	
}

/*------------------------------------------------------------------+
|  Message의 Option('OK', 'YN')에 따라 Form의 Control을 재배치한다. |
--------------------------------------------------------------------*/
function fcFormAlin(sMessageID , sMESSAGETYPE){	

	//var iFindRow = dsMessage.FindRow("MESS_CODE", sMessageID);
	//var sMessage = dsMessage.GetColumn(iFindRow, "MESS_TEXT");
	var sMessage = sMessageID;
	var iIndex   = pos(sMessage, "@");
	
	//서버에서 내려온 Error 내용을 그냥 그대로 Display 한다.
	if (sMessageID=="SERVERMSG") {
		
		sMESSAGETYPE = "N";
		edMessage.Text = sARG1;
	} else {
		if(iIndex==-1){
			edMessage.Text = replace(sMessage, "\\n", chr(10));
		}else{
			edMessage.Text = replace(fnc_SetArgument(sMessage, sARG1, sARG2, sARG3, sARG4, sARG5),
									 "\\n", chr(13));
		}
	}
	if(sMESSAGETYPE=="N"){
		divBtnConfirm.btnOk.Visible      = false;
		divBtnConfirm.btnCancel.Visible  = true;
		divBtnConfirm.btnCancel.Text     = "확인";
		divBtnConfirm.btnCancel.SetFocus();
	} else {
		divBtnConfirm.btnOk.Visible      = true;
		divBtnConfirm.btnCancel.Visible  = true;
		divBtnConfirm.btnOk.Text         = "예";
		divBtnConfirm.btnCancel.Text     = "아니오";
		divBtnConfirm.btnOk.SetFocus();
	}
}



//-------------------------------------------------------------------------------------------------
// 확인
//-------------------------------------------------------------------------------------------------
function fcChoice(obj){
	Close(true);
}

//-------------------------------------------------------------------------------------------------
// 취소(MessageType이 'OK'이면 확인)
//-------------------------------------------------------------------------------------------------
function fcClose(obj){

	if(sMESSAGETYPE=="OK"){
		Close(true);
	}else{
		Close(false);
	}
}

//-------------------------------------------------------------------------------------------------
// Form에 Key처리
//-------------------------------------------------------------------------------------------------
function commessage_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam){

	// Esc
	if(nChar==27){
		if(sMESSAGETYPE=="OK"){
			Close(true);
		}else{
			Close(false);
		}
	}
	// Enter
	else if(nChar==13){
		if(objSenderObj.id=="btnOk"){
			Close(true);
		}else if(objSenderObj.id=="btnCancel"){
			if(sMESSAGETYPE=="OK"){
				Close(true);
			}else{
				Close(false);
			}
		}
	}
}

]]></Script>
</Window>