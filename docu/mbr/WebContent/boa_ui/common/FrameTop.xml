<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="76" Id="grdRaceInfo" Left="8" OnLoadCompleted="fcFormLoadSetting" OnSize="FrameTop_OnSize" OnTimer="FrameTop_OnTimer" PidAttrib="7" Title="FrameTop" Top="8" Ver="1.0" Width="1280" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsOutUserMn"></Dataset>
		</Datasets>
		<Image Height="76" Id="Image0" ImageID="c_topbg" LeftMargin="0" TabOrder="1" Width="1280"></Image>
		<Image Height="14" Id="Image5" ImageID="t_h_icon" Left="17" TabOrder="2" Top="56" Transparent="TRUE" Width="21"></Image>
		<Static BindDataset="gdsUser" Color="#053973" Column="USER_NM" Height="12" Id="Static0" Left="41" TabOrder="3" Top="58" VAlign="Middle" Width="123"></Static>
		<MenuBar BorderColor="white" CaptionCol="MN_NM" EnableCol="Enable" EndColor="white" Font="새굴림,9" GradationMode="Horizontal" Height="26" HighlightBKColor="#bae2f1" HighlightTextColor="white" IconCol="PAGE_DESC" Id="MenuBar0" IDCol="SCRN_ID" ImageID="c_topbg_02" Left="185" LevelCol="LVL" MainTextColor="#112170" MenuDataset="gdsMenu" OnMenuClick="MenuBar0_OnMenuClick" PopupBKColor="white" PopupBoard3D="False" PopupHighlightBKColor="white" PopupHighlightTextColor="white" PopupLeftMargin="0" PopupTextColor="#112170" Selection3D="False" StartColor="white" Style="ORIGINAL" TabOrder="4" Top="49" Width="1085"></MenuBar>
		<Div Height="29" Id="TopDiv" Left="1072" TabOrder="5" Text="Div0" Top="4" Width="204">
			<Contents>
				<Image Height="29" Id="Image6" ImageID="t_quick_bg_k" TabOrder="4" Width="205"></Image>
				<Image Cursor="HAND" Height="20" Id="Image4" ImageID="t_quick_logout_k" Left="129" OnClick="fcCancel" Static="FALSE" TabOrder="1" Top="4" Transparent="TRUE" Width="71"></Image>
				<Image Cursor="HAND" Height="20" Id="Image3" ImageID="t_quick_home_k" Left="4" OnClick="TopDiv_Image3_OnClick" Static="FALSE" TabOrder="2" Top="4" Transparent="TRUE" Width="65"></Image>
				<Image Height="20" Id="Image2" ImageID="t_quick_help_k" Left="69" Static="FALSE" TabOrder="3" Top="4" Transparent="TRUE" Width="60"></Image>
			</Contents>
		</Div>
		<Div Height="20" Id="TopDivPro" Left="1102" TabOrder="6" Text="Div0" Top="29" Width="171">
			<Contents>
				<Button Cursor="HAND" Height="21" Id="btn_process" Left="100" OnClick="btn_process_OnClick" TabOrder="1" Text="프로세스" Top="-1" Width="70"></Button>
				<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="Button1" ImageID="btn_txt_06" LeftMargin="15" OnClick="Button1_OnClick" Style="snis_btn" TabOrder="2" Text="인터넷디스크" Transparent="TRUE" Width="100"></Button>
			</Contents>
		</Div>
		<Static Align="Center" Color="user21" Font="HY태백B,26" Height="57" Id="stDBName" Left="432" TabOrder="7" Top="-1" VAlign="Middle" Width="472"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

#include "lib::boa_app_script.js";
#include "lib::boa_common_script.js";
/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  01. 최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj){

    // 현재 회차 조회
    fce_GetCurTms();
    fcSearch();
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  01. 닫기(close) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcCancel(obj) {	
	exit();          					//프로그램 종료
}

/*-------------------------------------------------------------------------------------------------+
>>  02. 조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
	
	return true;
}

function fcSearch(obj) {
    if ( !fcSearchCheck(obj) ) return;

	var sServiceName = "common_login-service:searchUserMn";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutUserMn=dsOutUserMn";
    
    var sUserIp = ext_GetIPAddress();
	if ( Pos(sUserIp,",") != -1) {
		sUserIp = mid(sUserIp, 1, Pos(sUserIp,",") -1);
	} else {
		sUserIp = Replace(Replace(sUserIp, "["), "]");
	}
	
    fce_AddParam("USER_ID", gdsUser.getColumn(0, "USER_ID"));
    fce_AddParam("USER_IP", Trim(sUserIp));
    
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}


/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  01. Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 조회 후
	if ( sServiceName == "common_login-service:searchUserMn" ) {
        gdsMenu.Copy(dsOutUserMn);
	}

}

function FrameTop_OnSize(obj,nCx,nCy,nState){
	TopDiv.Left = nCx - TopDiv.Width;
	TopDivPro.Left = nCx - TopDivPro.Width;
}

function btn_process_OnClick(obj)
{
	if ( Global.FrameRight.Visible ) {
		Global.FrameRight.Visible = false;
	} else {
		Global.FrameRight.Visible = true;
	}
}

function MenuBar0_OnMenuClick(obj, strID){
	if ( !fnc_IsNull(strID) ) {
		global.FrameBottom.fcOpenMdiForm(strID);
	}
}

function TopDiv_Image3_OnClick(obj,nX,nY)
{
    global.FrameBottom.fcOpenMdiForm("E00000000", "메인화면", "common::comMain.xml");    
}

function Button1_OnClick(obj)
{
	ExecBrowser("http://idisk.kboat.or.kr");	
}
]]></Script>
</Window>