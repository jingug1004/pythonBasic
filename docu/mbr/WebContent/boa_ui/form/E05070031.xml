<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="514" Id="E05070031" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="고액환급정보입력" Top="8" Ver="1.0" Width="1000" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsOutSdlRate">
				<Contents>
					<colinfo id="POOL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYOFF" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsProgBar1">
				<Contents>
					<colinfo id="FRST_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FRST_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FRST_FILE_SIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" summ="default" type="STRING"/>
					<record>
						<FRST_FILE_NM></FRST_FILE_NM>
						<FRST_FILE_PATH></FRST_FILE_PATH>
						<FRST_FILE_SIZE></FRST_FILE_SIZE>
						<PROG_BAR></PROG_BAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsProgBar2">
				<Contents>
					<colinfo id="SCND_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SCND_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="SCND_FILE_SIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" summ="default" type="STRING"/>
					<record>
						<PROG_BAR></PROG_BAR>
						<SCND_FILE_NM></SCND_FILE_NM>
						<SCND_FILE_PATH></SCND_FILE_PATH>
						<SCND_FILE_SIZE></SCND_FILE_SIZE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>E00006</CD_GRP_ID>
						<DESCRIPTION>경정장코드</DESCRIPTION>
						<DSNAME>dsOutMbr</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutMbr">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="GRP_NM" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRacerRank">
				<Contents>
					<colinfo id="RACER_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="TMP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutDayOrd">
				<Contents>
					<colinfo id="DAY_ORD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutRace">
				<Contents>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutTms">
				<Contents>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutStndYear">
				<Contents>
					<colinfo id="STND_YEAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutBrchRtrn">
				<Contents>
					<colinfo id="SR_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MBR_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="OTB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CUST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BUY_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="RETURN_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="WINNER" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_WON1" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_WON2" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_WON3" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_WON4" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_WON5" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_NO3" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_NO4" size="256" summ="default" type="STRING"/>
					<colinfo id="EXA_NO5" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_WON1" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_WON2" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_WON3" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_WON4" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_WON5" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_NO3" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_NO4" size="256" summ="default" type="STRING"/>
					<colinfo id="QUI_NO5" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_WON1" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_WON2" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_WON3" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_WON4" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_WON5" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_NO3" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_NO4" size="256" summ="default" type="STRING"/>
					<colinfo id="TRI_NO5" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL_RETURN" size="256" summ="default" type="STRING"/>
					<colinfo id="VEH_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="VEH_COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="CUST_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CUST_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REG_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="PHOTO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PHOTO_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="PHOTO_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DTM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsExa">
				<Contents>
					<colinfo id="POOL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYOFF" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsQui">
				<Contents>
					<colinfo id="POOL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYOFF" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsTri">
				<Contents>
					<colinfo id="POOL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYOFF" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Font="굴림,9,Bold" Height="468" Id="Static1" Left="4" TabOrder="1" Text="입력내용" Top="40" Type="Groupbox" VClip="Top" Width="992" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="WINNER" Enable="FALSE" Height="20" Id="hdRankRacer" ImeMode="native" Left="136" LeftMargin="2" Style="snis_if_input01" TabOrder="109" TabStop="FALSE" Top="154" Width="856"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Enable="FALSE" Height="20" Id="edtRankRacer" ImeMode="native" Left="136" LeftMargin="2" Style="snis_if_input01" TabOrder="29" TabStop="FALSE" Top="154" Width="856"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="OTB_NM" Enable="FALSE" Height="20" Id="hdObtNm" ImeMode="native" Left="652" LeftMargin="2" Style="snis_if_input01" TabOrder="111" TabStop="FALSE" Top="58" Width="340"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="INST_NM" Enable="FALSE" Height="20" Id="hdWriter" ImeMode="native" Left="652" LeftMargin="2" Style="snis_if_input01" TabOrder="109" TabStop="FALSE" Top="58" Width="340"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Enable="FALSE" Height="20" Id="edtWriter" ImeMode="native" Left="652" LeftMargin="2" Style="snis_if_input01" TabOrder="26" TabStop="FALSE" Top="58" Width="340"></Edit>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="SR_NO" Enable="FALSE" Height="20" Id="hdSrNo" Left="136" MaxLength="100" Style="snis_m_input01" TabOrder="112" Top="82" Visible="FALSE" Width="366"></Edit>
		<Image Height="32" Id="Image0" ImageID="pop_bg" Left="208" LeftMargin="25" TabOrder="4" Width="790"></Image>
		<Image Height="32" Id="Image2" ImageID="pop_bg" LeftMargin="25" TabOrder="2" Width="794"></Image>
		<Static Height="20" Id="stTitle" Left="28" Style="snis_pop_title" TabOrder="3" Text="고액환급정보입력" Top="8" VAlign="Middle" Width="742"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static3" Left="8" Style="snis_m_lable" TabOrder="5" Text="관련경주" Top="58" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static0" Left="8" Style="snis_m_lable" TabOrder="6" Text="환급자성명" Top="82" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static2" Left="8" Style="snis_m_lable" TabOrder="7" Text="주소" Top="106" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static4" Left="8" Style="snis_m_lable" TabOrder="8" Text="차량번호" Top="130" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static5" Left="8" Style="snis_m_lable" TabOrder="9" Text="입상선수" Top="154" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="162" Id="Static6" Left="8" Style="snis_m_lable" TabOrder="10" Text="투표&#32;및&#32;환급상황" Top="178" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static7" Left="8" Style="snis_m_lable" TabOrder="11" Text="투표창구" Top="344" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="88" Id="Static8" Left="8" Style="snis_m_lable" TabOrder="12" Text="특기사항" Top="368" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static9" Left="8" Style="snis_m_lable" TabOrder="13" Text="사진이미지" Top="460" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static10" Left="8" Style="snis_m_lable" TabOrder="14" Text="첨부파일" Top="484" VAlign="Middle" Width="126"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static13" Left="199" Style="snis_if_lable" TabOrder="19" Text="경정장" Top="59" VAlign="Middle" Width="38"></Static>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" CodeColumn="CD" Column="MBR_CD" DataColumn="CD_NM" Enable="FALSE" Height="20" Id="cboMbrCd" ImeMode="none" InnerDataset="dsOutMbr" Left="136" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="17" Top="57" Width="62"></Combo>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" Column="STND_YEAR" DataColumn="STND_YEAR" Height="20" Id="cboStndYear" ImeMode="none" InnerDataset="dsOutStndYear" Left="240" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="15" Top="57" Width="55"></Combo>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" Column="TMS" DataColumn="TMS" Height="20" Id="cboTms" ImeMode="none" InnerDataset="dsOutTms" Left="315" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="16" Top="57" Width="44"></Combo>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" Column="DAY_ORD" DataColumn="DAY_ORD" Height="20" Id="cboDayOrd" ImeMode="none" InnerDataset="dsOutDayOrd" Left="378" OnChanged="fcCboOnChanged" Style="snis_if_input01" TabOrder="18" Top="57" Width="40"></Combo>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" Column="RACE_NO" DataColumn="RACE_NO" Height="20" Id="cboRaceNo" ImeMode="none" InnerDataset="dsOutRace" Left="448" OnChanged="fcCboOnChanged" Search="NOTFILTERED" Style="snis_if_input01" TabOrder="20" Top="57" Width="44"></Combo>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static14" Left="296" Style="snis_if_lable" TabOrder="21" Text="년" Top="59" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static11" Left="360" Style="snis_if_lable" TabOrder="22" Text="회" Top="59" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static12" Left="420" Style="snis_if_lable" TabOrder="23" Text="일차" Top="59" VAlign="Middle" Width="24"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static15" Left="493" Style="snis_if_lable" TabOrder="24" Text="경주" Top="59" VAlign="Middle" Width="24"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static16" Left="524" Style="snis_m_lable" TabOrder="25" Text="작성자" Top="58" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static17" Left="524" Style="snis_m_lable" TabOrder="27" Text="전화번호" Top="82" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static18" Left="524" Style="snis_m_lable" TabOrder="28" Text="차종색상" Top="130" VAlign="Middle" Width="126"></Static>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="CUST_NM" Height="20" Id="edtCustNm" Left="136" MaxLength="100" Style="snis_m_input01" TabOrder="30" Top="82" Width="385"></Edit>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="CUST_TEL" Height="20" Id="edtCustTel" Left="652" MaxLength="20" Style="snis_m_input01" TabOrder="31" Top="82" Width="340"></Edit>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="CUST_ADDR" Height="20" Id="edtAddr" Left="136" MaxLength="100" Style="snis_m_input01" TabOrder="32" Top="106" Width="856"></Edit>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="VEH_NO" Height="20" Id="edtCarNo" Left="136" MaxLength="20" Style="snis_m_input01" TabOrder="33" Top="130" Width="385"></Edit>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="VEH_COLOR" Height="20" Id="edtCarColor" Left="652" MaxLength="20" Style="snis_m_input01" TabOrder="34" Top="130" Width="340"></Edit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static19" Left="136" Style="snis_m_lable" TabOrder="35" Text="쌍승식" Top="178" VAlign="Middle" Width="280"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static20" Left="424" Style="snis_m_lable" TabOrder="36" Text="복승식" Top="178" VAlign="Middle" Width="280"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static21" Left="712" Style="snis_m_lable" TabOrder="37" Text="삼복승식" Top="178" VAlign="Middle" Width="280"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static22" Left="504" Style="snis_m_lable" TabOrder="38" Text="환급창구" Top="344" VAlign="Middle" Width="126"></Static>
		<TextArea BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="RMK" Height="88" Id="edtRmk" ImeMode="native" Left="136" MaxLength="1998" Style="snis_m_input01" TabOrder="110" Top="368" VScroll="TRUE" Width="750"></TextArea>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsProgBar1" BKColor="user15" BkColor2="user16" BkSelColor="user2" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="480" DisableBKColor="user2" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="20" Id="grdProgBar1" InputPanel="FALSE" Left="136" LineColor="default" MinWidth="100" OnCellDBLClick="grdProgBar1_OnCellDblClick" OnHeadClick="fcGridSort" Right="781" SelColor="user19" Style="snis_grid" TabOrder="39" TabStop="FALSE" Top="460" UseDBuff="true" UseExSizing="Col" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="645">
			<contents>
				<format id="Default">
					<columns>
						<col width="546"/>
						<col width="342"/>
					</columns>
					<body>
						<cell align="left" checklength="Byte" col="0" colid="FRST_FILE_NM" display="text" limit="3"/>
						<cell align="center" checklength="Byte" col="1" colid="PROG_BAR" color="red" display="bar" limit="3"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="imgFrstFileAdd" ImageID="grid_btn_08" Left="785" OnClick="imgFrstFileAdd_OnClick" Style="snis_txt" TabOrder="117" TabStop="FALSE" Text="이미지&#32;추가/수정" Top="462" Width="110"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="imgFrstFileDel" ImageID="grid_btn_06" Left="900" OnClick="imgFrstFileDel_OnClick" Style="snis_txt" TabOrder="119" TabStop="FALSE" Text="이미지&#32;삭제" Top="462" Width="86"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsProgBar2" BKColor="user15" BkColor2="user16" BkSelColor="user2" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="504" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="20" Id="grdProgBar2" InputPanel="FALSE" Left="136" LineColor="default" MinWidth="100" OnCellDBLClick="grdProgBar2_OnCellDblClick" Right="781" SelColor="user19" Style="snis_grid" TabOrder="40" TabStop="FALSE" Top="484" UseDBuff="true" UseExSizing="Col" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="645">
			<contents>
				<format id="Default">
					<columns>
						<col width="546"/>
						<col width="342"/>
					</columns>
					<body>
						<cell align="left" checklength="Byte" col="0" colid="SCND_FILE_NM" display="text" limit="3"/>
						<cell align="center" checklength="Byte" col="1" colid="PROG_BAR" color="red" display="bar" limit="3"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="imgSecondFileAdd" ImageID="grid_btn_08" Left="785" OnClick="imgSecondFileAdd_OnClick" Style="snis_txt" TabOrder="129" TabStop="FALSE" Text="첨부파일추가/수정" Top="485" Width="110"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="imgSecondFileDel" ImageID="grid_btn_06" Left="900" OnClick="imgSecondFileDel_OnClick" Style="snis_txt" TabOrder="131" TabStop="FALSE" Text="첨부파일삭제" Top="485" Width="86"></Button>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" Column="EXA_RATE" DataColumn="PAYOFF" Height="20" Id="cboExa" ImeMode="none" InnerDataset="dsExa" Left="216" Style="snis_if_input01" TabOrder="41" Top="200" Width="100"></Combo>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" Column="QUI_RATE" DataColumn="PAYOFF" Height="20" Id="cboQui" ImeMode="none" InnerDataset="dsQui" Left="504" Style="snis_if_input01" TabOrder="42" Top="200" Width="100"></Combo>
		<Combo BindDataset="dsOutBrchRtrn" Border="Flat" Column="TRI_RATE" DataColumn="PAYOFF" Height="20" Id="cboTri" ImeMode="none" InnerDataset="dsTri" Left="800" Style="snis_if_input01" TabOrder="43" Top="200" Width="100"></Combo>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static23" Left="320" Style="snis_if_lable" TabOrder="44" Text="배" Top="202" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static24" Left="608" Style="snis_if_lable" TabOrder="45" Text="배" Top="202" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static25" Left="904" Style="snis_if_lable" TabOrder="46" Text="배" Top="202" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_WON1" Height="20" Id="edtExaWon1" ImeMode="none" Left="136" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="47" Top="224" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static26" Left="279" Style="snis_if_lable" TabOrder="48" Text="원&#32;X" Top="226" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_NO1" Height="20" Id="edtExaNo1" Left="312" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="49" Top="224" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static27" Left="400" Style="snis_if_lable" TabOrder="50" Text="매" Top="226" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_WON2" Height="20" Id="edtExaWon2" ImeMode="none" Left="136" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="51" Top="248" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static28" Left="279" Style="snis_if_lable" TabOrder="52" Text="원&#32;X" Top="250" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_NO2" Height="20" Id="edtExaNo2" Left="312" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="53" Top="248" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static29" Left="400" Style="snis_if_lable" TabOrder="54" Text="매" Top="250" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_WON3" Height="20" Id="edtExaWon3" ImeMode="none" Left="136" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="55" Top="272" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static30" Left="279" Style="snis_if_lable" TabOrder="56" Text="원&#32;X" Top="274" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_NO3" Height="20" Id="edtExaNo3" Left="312" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="57" Top="272" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static31" Left="400" Style="snis_if_lable" TabOrder="58" Text="매" Top="274" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_WON4" Height="20" Id="edtExaWon4" ImeMode="none" Left="136" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="59" Top="296" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static32" Left="279" Style="snis_if_lable" TabOrder="60" Text="원&#32;X" Top="298" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_NO4" Height="20" Id="edtExaNo4" Left="312" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="61" Top="296" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static33" Left="400" Style="snis_if_lable" TabOrder="62" Text="매" Top="298" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_WON5" Height="20" Id="edtExaWon5" ImeMode="none" Left="136" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="63" Top="320" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static34" Left="279" Style="snis_if_lable" TabOrder="64" Text="원&#32;X" Top="322" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="EXA_NO5" Height="20" Id="edtExaNo5" Left="312" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="65" Top="320" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static35" Left="400" Style="snis_if_lable" TabOrder="66" Text="매" Top="322" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_WON1" Height="20" Id="edtQuiWon1" ImeMode="none" Left="424" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="67" Top="224" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static36" Left="567" Style="snis_if_lable" TabOrder="68" Text="원&#32;X" Top="226" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_NO1" Height="20" Id="edtQuiNo1" Left="600" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="69" Top="224" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static37" Left="688" Style="snis_if_lable" TabOrder="70" Text="매" Top="226" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static38" Left="688" Style="snis_if_lable" TabOrder="74" Text="매" Top="250" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_NO2" Height="20" Id="edtQuiNo2" Left="600" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="73" Top="248" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static39" Left="567" Style="snis_if_lable" TabOrder="72" Text="원&#32;X" Top="250" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_WON2" Height="20" Id="edtQuiWon2" ImeMode="none" Left="424" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="71" Top="248" Width="136"></Edit>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_WON3" Height="20" Id="edtQuiWon3" ImeMode="none" Left="424" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="75" Top="272" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static40" Left="567" Style="snis_if_lable" TabOrder="76" Text="원&#32;X" Top="274" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_NO3" Height="20" Id="edtQuiNo3" Left="600" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="77" Top="272" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static41" Left="688" Style="snis_if_lable" TabOrder="78" Text="매" Top="274" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static42" Left="688" Style="snis_if_lable" TabOrder="82" Text="매" Top="298" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_NO4" Height="20" Id="edtQuiNo4" Left="600" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="81" Top="296" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static43" Left="567" Style="snis_if_lable" TabOrder="80" Text="원&#32;X" Top="298" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_WON4" Height="20" Id="edtQuiWon4" ImeMode="none" Left="424" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="79" Top="296" Width="136"></Edit>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_WON5" Height="20" Id="edtQuiWon5" ImeMode="none" Left="424" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="83" Top="320" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static44" Left="567" Style="snis_if_lable" TabOrder="84" Text="원&#32;X" Top="322" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="QUI_NO5" Height="20" Id="edtQuiNo5" Left="600" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="85" Top="320" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static45" Left="688" Style="snis_if_lable" TabOrder="86" Text="매" Top="322" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_WON1" Height="20" Id="edtTriWon1" ImeMode="none" Left="712" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="87" Top="224" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static46" Left="855" Style="snis_if_lable" TabOrder="88" Text="원&#32;X" Top="226" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_NO1" Height="20" Id="edtTriNo1" Left="888" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="89" Top="224" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static47" Left="976" Style="snis_if_lable" TabOrder="90" Text="매" Top="226" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static48" Left="976" Style="snis_if_lable" TabOrder="94" Text="매" Top="250" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_NO2" Height="20" Id="edtTriNo2" Left="888" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="93" Top="248" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static49" Left="855" Style="snis_if_lable" TabOrder="92" Text="원&#32;X" Top="250" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_WON2" Height="20" Id="edtTriWon2" ImeMode="none" Left="712" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="91" Top="248" Width="136"></Edit>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_WON3" Height="20" Id="edtTriWon3" ImeMode="none" Left="712" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="95" Top="272" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static50" Left="855" Style="snis_if_lable" TabOrder="96" Text="원&#32;X" Top="274" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_NO3" Height="20" Id="edtTriNo3" Left="888" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="97" Top="272" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static51" Left="976" Style="snis_if_lable" TabOrder="98" Text="매" Top="274" VAlign="Middle" Width="16"></Static>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static52" Left="976" Style="snis_if_lable" TabOrder="102" Text="매" Top="298" VAlign="Middle" Width="16"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_NO4" Height="20" Id="edtTriNo4" Left="888" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="101" Top="296" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static53" Left="855" Style="snis_if_lable" TabOrder="100" Text="원&#32;X" Top="298" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_WON4" Height="20" Id="edtTriWon4" ImeMode="none" Left="712" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="99" Top="296" Width="136"></Edit>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_WON5" Height="20" Id="edtTriWon5" ImeMode="none" Left="712" MaxLength="8" Number="TRUE" Style="snis_m_input01" TabOrder="103" Top="320" Width="136"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static54" Left="855" Style="snis_if_lable" TabOrder="104" Text="원&#32;X" Top="322" VAlign="Middle" Width="33"></Static>
		<Edit Align="RIGHT" BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="TRI_NO5" Height="20" Id="edtTriNo5" Left="888" MaxLength="3" Number="TRUE" Style="snis_m_input01" TabOrder="105" Top="320" Width="80"></Edit>
		<Static BKColor="white" Border="None" BorderColor="white" Height="20" Id="Static55" Left="976" Style="snis_if_lable" TabOrder="106" Text="매" Top="322" VAlign="Middle" Width="16"></Static>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="BUY_PLC" Height="20" Id="edtBuyPlc" Left="136" MaxLength="100" Style="snis_m_input01" TabOrder="107" Top="344" Width="366"></Edit>
		<Edit BindDataset="dsOutBrchRtrn" Border="Flat" CheckLength="Byte" Column="RETURN_PLC" Height="20" Id="edtReturnPlc" Left="632" MaxLength="20" Style="snis_m_input01" TabOrder="108" Top="344" Width="360"></Edit>
		<HttpFile Height="24" Id="HttpFile" Left="856" Top="8" Width="24"></HttpFile>
		<Button Cursor="HAND" Height="20" Id="btnSave" ImageID="btn_Save" Left="892" OnClick="fcSave" TabOrder="113" Text="저장" Top="8" Transparent="TRUE" Width="50"></Button>
		<Button Cursor="HAND" Height="20" Id="btnEnd" ImageID="btn_close" Left="943" OnClick="fcClose" TabOrder="114" Text="종료" Top="8" Transparent="TRUE" Width="50"></Button>
		<Image Border="Flat" Cursor="HAND" Height="88" Id="imgPhotoNm" Left="892" OnClick="imgPhotoNm_OnClick" Static="FALSE" Style="snis_m_input01" TabOrder="116" TabStop="FALSE" Text="[사진]" Top="368" Width="100"></Image>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::boa_common_script.js";
#include "lib::boa_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'E05070031';
var sBUTTONLIST   = 'FTFFTT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var sUserId = "";
var sUserNm = "";
var sDeptNm = "";
var sStndYear= "";
var sSrNo = "";
var fileUploadStat1 = "N";
var fileUploadStat2 = "N";

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  

	//년도 리스트 조회 
	fce_SetStndYear(dsOutStndYear, toInteger(fce_GetSysdate("YYYY")));

	if ( IsExistVar("USER_ID") ) sUserId = USER_ID;
    if ( IsExistVar("USER_NM") ) sUserNm = USER_NM;
    if ( IsExistVar("DEPT_NM") ) sDeptNm = DEPT_NM;
    if ( IsExistVar("STND_YEAR") ) sStndYear = STND_YEAR;
    if ( IsExistVar("SR_NO") ) sSrNo = SR_NO;

    edtWriter.Text = sUserNm + " (" + sUserId + ")";
    hdWriter.Text = sUserNm;
    hdObtNm.Text = sDeptNm;
    
    if (sSrNo == "" || sSrNo == null) {
		dsOutBrchRtrn.AddRow();
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"SR_NO","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"STND_YEAR","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"MBR_CD","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TMS","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"DAY_ORD","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"RACE_NO","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"OTB_NM",sDeptNm);
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"CUST_NM","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"BUY_PLC","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"RETURN_PLC","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"WINNER","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_RATE","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_WON1","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_WON2","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_WON3","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_WON4","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_WON5","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_NO1","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_NO2","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_NO3","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_NO4","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"EXA_NO5","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_RATE","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_WON1","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_WON2","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_WON3","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_WON4","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_WON5","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_NO1","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_NO2","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_NO3","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_NO4","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"QUI_NO5","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_RATE","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_WON1","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_WON2","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_WON3","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_WON4","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_WON5","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_NO1","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_NO2","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_NO3","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_NO4","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TRI_NO5","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"TOTAL_RETURN","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"VEH_NO","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"VEH_COLOR","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"CUST_TEL","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"CUST_ADDR","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"RMK","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"INST_NM","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"REG_IP",replace(replace(ext_GetIPAddress(),"[",""),"]",""));
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"PHOTO_NM","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"PHOTO_PATH","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"PHOTO_TYPE","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"FILE_NM","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"FILE_PATH","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"FILE_TYPE","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"INST_DTM","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"FILE_SIZE","");
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row,"PHOTO_SIZE","");

		//공통코드 조회
		fce_GetComboDs(dsInComCd);

		fcSearchRacerRank();
	} else {
		fcSearch(obj);
		//공통코드 조회
		fce_GetComboDs(dsInComCd);
	}	
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "";
	if (!fnc_FormUnloadCheck(sDataset, sFormId)) return false;
}

/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}

}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}

/*------------------------------------+
|  등록된 고액환급 정보를 조회한다. |
+-------------------------------------*/
function fcSearch(obj) {
	var sServiceName = "e05070031-service:searchBrchRtrn";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutBrchRtrn=dsOutBrchRtrn";
    
    fce_AddParam("SR_NO", sSrNo);
	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

/*------------------------------------+
|  경주별 입상선수, 배당율을 조회한다. |
+-------------------------------------*/
function fcSearchRacerRank() {
	var sServiceName = "e05070030-service:searchRacerRank";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutRacerRank=dsOutRacerRank";
        
    fce_AddParam("STND_YEAR", Trim(cboStndYear.Value));
    fce_AddParam("TMS", Trim(cboTms.Value));
	fce_AddParam("DAY_ORD", Trim(cboDayOrd.Value));
	fce_AddParam("RACE_NO", Trim(cboRaceNo.Value));
    	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	
	fcSearchRate();
}

/*------------------------------------+
|  경주별 배당율을 조회한다. |
+-------------------------------------*/
function fcSearchRate() {
	dsOutSdlRate.ClearData();
	dsExa.ClearData();
	dsQui.ClearData();
	dsTri.ClearData();

	var sServiceName = "e05070031-service:searchSdlRate";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutSdlRate=dsOutSdlRate";

    fce_AddParam("STND_YEAR", Trim(cboStndYear.Value));
    fce_AddParam("TMS", Trim(cboTms.Value));
	fce_AddParam("DAY_ORD", Trim(cboDayOrd.Value));
	fce_AddParam("RACE_NO", Trim(cboRaceNo.Value));
	
	fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

function fcSave(obj) {
    if ( !fcSaveCheck() ) return;
    
    var sServiceName = "e05070031-service:saveBrchRtrn";
    var sInDataSet   = "dsOutBrchRtrn=dsOutBrchRtrn:u ";
    var sOutDataSet  = "dsOutBrchRtrn=dsOutBrchRtrn";  
    
    if(!fnc_IsNull(dsProgBar1.GetColumn(0,"FRST_FILE_PATH")) && fileUploadStat1 == "Y") {
		var rtn_arr = fnc_FileWrite(divBtnLst.HttpFile 
									, dsProgBar1.GetColumn(0, "FRST_FILE_PATH")
									, dsProgBar1.GetColumn(0, "FRST_FILE_NM")
									, "FAIR");
	
        if (rtn_arr[0] != "SUCC") {
            alert(rtn_arr[1] + "이미지파일 업로드 에러발생");
            return false;
        }

		//var sTemp = Replace(rtn_arr[1],"\\","/");
		//var asFile = split(sTemp, "/");
		//dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row, "PHOTO_PATH", asFile[asFile.length - 1]);
		//파일명만 저장
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row, "PHOTO_PATH", rtn_arr[1]);
        var fileSize = divBtnLst.HttpFile.GetFileSizeLocal(dsProgBar1.GetColumn(0, "FRST_FILE_PATH"));
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row, "PHOTO_SIZE", fileSize);
    }
    
    if(!fnc_IsNull(dsProgBar2.GetColumn(0,"SCND_FILE_PATH")) && fileUploadStat2 == "Y") {
		var rtn_arr = fnc_FileWrite(divBtnLst.HttpFile 
									, dsProgBar2.GetColumn(0, "SCND_FILE_PATH")
									, dsProgBar2.GetColumn(0, "SCND_FILE_NM")
									, "FAIR");
	
		if ( rtn_arr[0] != "SUCC" ) {
			alert(rtn_arr[1] + "첨부파일 업로드 에러발생");
			return false;
		}
		
		//var sTemp = Replace(rtn_arr[1],"\\","/");
		//var asFile = split(sTemp, "/");
		//dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row, "FILE_PATH", asFile[asFile.length - 1]);
		//파일저장 path 모두 set
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row, "FILE_PATH", rtn_arr[1]);
		var fileSize = divBtnLst.HttpFile.GetFileSizeLocal(dsProgBar2.GetColumn(0, "SCND_FILE_PATH" ));
		dsOutBrchRtrn.SetColumn(dsOutBrchRtrn.row, "FILE_SIZE", fileSize);
    }
    
    fce_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

function fcSaveCheck(obj) {  
    if ( !fnc_DatasetChangeCheck(dsOutBrchRtrn) ) {
		//저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");	
		return false;
	}
	
	if (fnc_IsNull(cboMbrCd.Value)) {
		fnc_Message(SNIS_COM_1035, "N", "경정장");
		cboMbrCd.SetFocus();
		return false;
	}
	
	if (fnc_IsNull(cboStndYear.Value)) {
		fnc_Message(SNIS_COM_1035, "N", "년도");
		cboStndYear.SetFocus();
		return false;
	}
	
	if (fnc_IsNull(cboTms.Value)) {
		fnc_Message(SNIS_COM_1035, "N", "회차");
		cboTms.SetFocus();
		return false;
	}
	
	if (fnc_IsNull(cboDayOrd.Value)) {
		fnc_Message(SNIS_COM_1035, "N", "일차");
		cboDayOrd.SetFocus();
		return false;
	}
	
	if (fnc_IsNull(cboRaceNo.Value)) {
		fnc_Message(SNIS_COM_1035, "N", "경주");
		cboRaceNo.SetFocus();
		return false;
	}
	
	if (fnc_IsNull(dsOutBrchRtrn.GetColumn(0, "WINNER"))) {
		fnc_Message(SNIS_COM_1035, "N", "입상선수");
		return false;
	}
	
	//총환급액 계산
	var dExa =   fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_RATE")) 
	         * ( (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_WON1")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_NO1")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_WON2")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_NO2")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_WON3")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_NO3")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_WON4")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_NO4")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_WON5")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "EXA_NO5"))) );
	var dQui =   fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_RATE"))
	         * ( (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_WON1")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_NO1")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_WON2")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_NO2")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_WON3")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_NO3")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_WON4")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_NO4")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_WON5")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "QUI_NO5"))) );
	var dTri =   fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_RATE"))
	         * ( (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_WON1")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_NO1")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_WON2")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_NO2")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_WON3")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_NO3")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_WON4")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_NO4")))
	           + (fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_WON5")) * fc_NullToZero(dsOutBrchRtrn.GetColumn(0, "TRI_NO5"))) );
	var dTotal = dExa + dQui + dTri;
	dsOutBrchRtrn.SetColumn(0, "TOTAL_RETURN", dTotal);

	if ( dTotal <= 0 ) {
		fnc_Message(SNIS_COM_1035, "N", "환급액");
		return false;
	}
	
	return true;
}

/*------------------------------------+
|  Transaction 후 처리 해야 할 내용!  |
+-------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	// 공통코드 조회시
	if ( sServiceName == "common-service:searchCode" ) {
		//경정장 콤보값 설정
		if (sSrNo == "" || sSrNo == null) cboMbrCd.Value = fce_GetUserInfo("MBR_CD");

		cboStndYear.Index = 0;
		//회차리스트 콜
		fce_GetRaceTms(sStndYear, "001", "", "dsOutTms");
		return;
	}
	// 회차 리스트 조회시
	if ( sServiceName == "common_race-service:searchRaceTms" ) {
		//회차 콤보값 설정
		if (sSrNo == "" || sSrNo == null) {
			cboTms.Index = 0;
			if ( cboStndYear.Value == fce_GetCurRaceInfo("STND_YEAR") ) {
				var nIndexRow = fnc_GetExistValue(dsOutTms, "TMS", fce_GetCurRaceInfo("TMS"));
				if ( nIndexRow > -1 ) cboTms.Index = nIndexRow;
			}
		}
		//일차리스트 콜
        fce_GetRaceDayOrd(cboStndYear.Value, "001", cboTms.Value, "dsOutDayOrd");
        return;
	}
	// 일차 리스트 조회시
	if ( sServiceName == "common_race-service:searchRaceDayOrd" ) {
		//일차 콤보값 설정
		if (sSrNo == "" || sSrNo == null) {
			cboDayOrd.Index = 0;
			if ( cboStndYear.Value == fce_GetCurRaceInfo("STND_YEAR") && cboTms.Value == fce_GetCurRaceInfo("TMS") ) {
				var nIndexRow = fnc_GetExistValue(dsOutDayOrd, "DAY_ORD", fce_GetCurRaceInfo("DAY_ORD"));
				if ( nIndexRow > -1 ) cboDayOrd.Index = nIndexRow;
			}
        }
		//경주리스트 콜
        fce_GetRace(cboStndYear.Value, cboMbrCd.Value, cboTms.Value, cboDayOrd.Value, "dsOutRace");
		return;
	}

	// 경주번호 리스트 조회시
	if ( sServiceName == "common_race-service:searchRace" ) {
		fcCboOnChanged(cboRaceNo);
		return;
	}

	//순위선수조회시
	if (sServiceName == "e05070030-service:searchRacerRank") {
		if (dsOutRacerRank.rowcount > 0) {
			var sRacerRank1 = "";
			var sRacerRank2 = "";
			var sRacerRank3 = "";
			var sRacerRank = "";
			
			for (var i=0; i<dsOutRacerRank.rowcount; i++) {
				if (Trim(dsOutRacerRank.GetColumn(i, "RANK")) == "1") {
					sRacerRank1 = sRacerRank1 + Trim(dsOutRacerRank.GetColumn(i, "RACE_REG_NO")) + "번 " + Trim(dsOutRacerRank.GetColumn(i, "RACER_NM")) + " ";
				}
				if (Trim(dsOutRacerRank.GetColumn(i, "RANK")) == "2") {
					sRacerRank2 = sRacerRank2 + Trim(dsOutRacerRank.GetColumn(i, "RACE_REG_NO")) + "번 " + Trim(dsOutRacerRank.GetColumn(i, "RACER_NM")) + " ";
				}
				if (Trim(dsOutRacerRank.GetColumn(i, "RANK")) == "3") {
					sRacerRank3 = sRacerRank3 + Trim(dsOutRacerRank.GetColumn(i, "RACE_REG_NO")) + "번 " + Trim(dsOutRacerRank.GetColumn(i, "RACER_NM")) + " ";
				}
				
				sRacerRank = sRacerRank + Trim(dsOutRacerRank.GetColumn(i, "RACER_NM")) + ",";
			}
			
			hdRankRacer.Text = substr(sRacerRank,0, Length(sRacerRank)-1);

			sRacerRank = "1위 " + sRacerRank1;
			if(sRacerRank2 != "") sRacerRank = sRacerRank + "/ 2위 " + sRacerRank2;
			if(sRacerRank3 != "") sRacerRank = sRacerRank + "/ 3위 " + sRacerRank3;
			edtRankRacer.Text = sRacerRank;
	
			sRacerRank1 = "";
			sRacerRank2 = "";
			sRacerRank3 = "";
			sRacerRank = "";
		}
	}
	
	// 배당율 조회시
	if ( sServiceName == "e05070031-service:searchSdlRate" ) {
		for ( var i=0; i<dsOutSdlRate.rowcount; i++ ) {
			switch (dsOutSdlRate.GetColumn(i, "POOL_CD")) {
				case "004" :
					dsExa.addRow();
					dsExa.copyrow(dsExa.row, "dsOutSdlRate", i);
					break;
				case "005" :
					dsQui.addRow();
					dsQui.copyrow(dsQui.row, "dsOutSdlRate", i);
					break;
				case "006" :
					dsTri.addRow();
					dsTri.copyrow(dsTri.row, "dsOutSdlRate", i);
					break;
			}
		}

        cboExa.Index = 0;
        cboQui.Index = 0;
        cboTri.Index = 0;
	}

	if (sServiceName == "e05070031-service:searchBrchRtrn") {
		dsProgBar1.SetColumn(0,"FRST_FILE_NM",dsOutBrchRtrn.GetColumn(dsOutBrchRtrn.row,"PHOTO_NM"));
        dsProgBar1.SetColumn(0,"FRST_FILE_PATH",dsOutBrchRtrn.GetColumn(dsOutBrchRtrn.row,"PHOTO_PATH"));
        dsProgBar1.SetColumn(0,"FRST_FILE_SIZE",dsOutBrchRtrn.GetColumn(dsOutBrchRtrn.row,"PHOTO_SIZE"));
		dsProgBar2.SetColumn(0,"SCND_FILE_NM",dsOutBrchRtrn.GetColumn(dsOutBrchRtrn.row,"FILE_NM"));
        dsProgBar2.SetColumn(0,"SCND_FILE_PATH",dsOutBrchRtrn.GetColumn(dsOutBrchRtrn.row,"FILE_PATH"));
        dsProgBar2.SetColumn(0,"SCND_FILE_SIZE",dsOutBrchRtrn.GetColumn(dsOutBrchRtrn.row,"FILE_SIZE"));
        dsOutBrchRtrn.SetColumn(0,"REG_IP",replace(replace(ext_GetIPAddress(),"[",""),"]",""));
        dsOutBrchRtrn.SetColumn(0,"OTB_NM",sDeptNm);

		imgPhotoNm.ImageID = "";
		var sPtoName = dsOutBrchRtrn.GetColumn(0, "PHOTO_PATH");
    	if ( fnc_IsNull(sPtoName) ) return;
		var sPhysicalFileName = split(sPtoName, "//");
		imgPhotoNm.ImageID = GBL_IMAGELINK_URL_FAIRNESS + sPhysicalFileName[length(sPhysicalFileName) - 1];
		imgPhotoNm.FillType = "STRETCH";	

		fcSearchRacerRank();
	}
	
	if (sServiceName == "e05070031-service:saveBrchRtrn") {
		//parent.dsOutBrchRtrn_OnRowPosChanged(null,0,0);
		parent.fcSearch();
		Close(false);
	}
}

/*--------------+
|  취소 처리 !  |
+---------------*/
function fcClose(obj) {
	Close(false);     //Null 반환 후 종료
}

/*-------------------------------------------------------------------------------------------------+
>>  첨부파일 추가/수정
+-------------------------------------------------------------------------------------------------*/
function imgFrstFileAdd_OnClick(obj){
	sResponse = fce_GetSelectFile();
	dsOutBrchRtrn.SetColumn(0,"PHOTO_NM",sResponse[1]);
	dsOutBrchRtrn.SetColumn(0,"PHOTO_PATH",sResponse[0] + "\\" + sResponse[1]);
	dsOutBrchRtrn.SetColumn(0,"PHOTO_TYPE",substr(sResponse[1],indexOf(sResponse[1],".")+1));
	dsProgBar1.SetColumn(dsProgBar1.row,"FRST_FILE_NM",sResponse[1]);
	dsProgBar1.SetColumn(dsProgBar1.row,"FRST_FILE_PATH",sResponse[0] + "\\" + sResponse[1]);
	fileUploadStat1 = "Y";

	imgPhotoNm.ImageID = dsOutBrchRtrn.GetColumn(0,"PHOTO_PATH");
	imgPhotoNm.Text = "";
	imgPhotoNm.FillType = "STRETCH";	
}

function imgSecondFileAdd_OnClick(obj){
	sResponse = fce_GetSelectFile();
	dsOutBrchRtrn.SetColumn(0,"FILE_NM",sResponse[1]);
	dsOutBrchRtrn.SetColumn(0,"FILE_PATH",sResponse[0] + "\\" + sResponse[1]);
	dsOutBrchRtrn.SetColumn(0,"FILE_TYPE",substr(sResponse[1],indexOf(sResponse[1],".")+1));
	dsProgBar2.SetColumn(dsProgBar2.row,"SCND_FILE_NM",sResponse[1]);
	dsProgBar2.SetColumn(dsProgBar2.row,"SCND_FILE_PATH",sResponse[0] + "\\" + sResponse[1]);
	fileUploadStat2 = "Y";
}

/*-------------------------------------------------------------------------------------------------+
>>  첨부파일 다운로드
+-------------------------------------------------------------------------------------------------*/
function grdProgBar1_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex){
	if(!fnc_IsNull(dsProgBar1.GetColumn(0,"FRST_FILE_NM"))){
        var sLocalFileName  = fce_GetSelectFile("Save", dsProgBar1.GetColumn(nRow, "FRST_FILE_NM"));
        var sServerFileName = dsProgBar1.GetColumn(nRow, "FRST_FILE_PATH");
        var sFileSize       = dsProgBar1.GetColumn(nRow, "FRST_FILE_SIZE");
        if ( sLocalFileName == null ) return;
        
        fnc_FileRead(HttpFile, sLocalFileName[0] + "\\" + sLocalFileName[1], sServerFileName, sFileSize, nRow, "PROG_BAR", dsProgBar1);
	}
}

function grdProgBar2_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex){
	if(!fnc_IsNull(dsProgBar2.GetColumn(0,"SCND_FILE_NM"))){
        var sLocalFileName  = fce_GetSelectFile("Save", dsProgBar2.GetColumn(nRow, "SCND_FILE_NM"));
        var sServerFileName = dsProgBar2.GetColumn(nRow, "SCND_FILE_PATH");
        var sFileSize       = dsProgBar2.GetColumn(nRow, "SCND_FILE_SIZE");
        if ( sLocalFileName == null ) return;
        
        fnc_FileRead(HttpFile, sLocalFileName[0] + "\\" + sLocalFileName[1], sServerFileName, sFileSize, nRow, "PROG_BAR", dsProgBar2);
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  첨부파일 삭제
+-------------------------------------------------------------------------------------------------*/
function imgFrstFileDel_OnClick(obj){
	if(fnc_IsNull(dsProgBar1.GetColumn(0,"FRST_FILE_NM"))){
	    fnc_Message(SNIS_BOA_E008, "N");	
		return false;
	}
	
	if(fnc_Message(SNIS_BOA_E009, "Y", dsProgBar1.GetColumn(0,"FRST_FILE_NM")) == "1"){
		imgPhotoNm.ImageID = "";
		imgPhotoNm.Text = "[사진]";
		dsOutBrchRtrn.SetColumn(0,"PHOTO_NM", "");
		dsOutBrchRtrn.SetColumn(0,"PHOTO_PATH", "");
		dsOutBrchRtrn.SetColumn(0,"PHOTO_TYPE", "");
		dsProgBar1.ClearData();
   }
}

function imgSecondFileDel_OnClick(obj){
	if(fnc_IsNull(dsProgBar2.GetColumn(0,"SCND_FILE_NM"))){
	    fnc_Message(SNIS_BOA_E008, "N");	
		return false;
	}
	
	if(fnc_Message(SNIS_BOA_E009, "Y", dsProgBar2.GetColumn(0,"SCND_FILE_NM")) == "1"){
		dsOutBrchRtrn.SetColumn(0,"FILE_NM", "");
		dsOutBrchRtrn.SetColumn(0,"FILE_PATH", "");
		dsOutBrchRtrn.SetColumn(0,"FILE_TYPE", "");
		dsProgBar2.ClearData();
    }
}

function fcCboOnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	switch (obj.Id) {
		case "cboStndYear" :
			//회차리스트 콜
			fce_GetRaceTms(cboStndYear.Value, cboMbrCd.Value, "", "dsOutTms");
			break;
			
		case "cboTms" :
			//일차리스트 콜
			fce_GetRaceDayOrd(cboStndYear.Value, cboMbrCd.Value, cboTms.Value, "dsOutDayOrd");
			break;
			
		case "cboDayOrd" : 
			//경주리스트 콜
			fce_GetRace(cboStndYear.Value, cboMbrCd.Value, cboTms.Value, cboDayOrd.Value, "dsOutRace");
			break;
			
		case "cboRaceNo" :
			break;
			
		case "cboMbrCd" :
			break;
	}

	if(cboStndYear.Value == "" || cboStndYear.Value == null) 	return ;
	if(cboMbrCd.Value 	 == "" || cboMbrCd.Value == null) 		return ;
	if(cboTms.Value      == "" || cboTms.Value == null) 		return ;
	if(cboDayOrd.Value   == "" || cboDayOrd.Value == null) 		return ;
	if(cboRaceNo.Value   == "" || cboRaceNo.Value  == null) 	return ;
	fcSearchRacerRank();
}

function fcdsOnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	switch (obj.Id) {
		case "dsOutStndYear" :
			cboStndYear.Index = 0;
			/*
			if (sSrNo == "" || sSrNo == null) {
				var nIndexRow = fnc_GetExistValue(dsOutStndYear, "STND_YEAR", sStndYear);
				if ( nIndexRow > -1 ) cboStndYear.Index = nIndexRow;
			}
			*/
			//회차리스트 콜
			fce_GetRaceTms(sStndYear, "001", "", "dsOutTms");
			break;
			
		case "dsOutTms" :
			cboTms.Index = 0;
			if (sSrNo == "" || sSrNo == null) {
				if ( cboStndYear.Value == fce_GetCurRaceInfo("STND_YEAR") ) {
					var nIndexRow = fnc_GetExistValue(dsOutTms, "TMS", fce_GetCurRaceInfo("TMS"));
					if ( nIndexRow > -1 ) cboTms.Index = nIndexRow;
				}
			}
			//일차리스트 콜
			fce_GetRaceDayOrd(sStndYear, "001", cboTms.Value, "dsOutDayOrd");
			break;
			
		case "dsOutDayOrd" : 
			cboDayOrd.Index = 0;
			if (sSrNo == "" || sSrNo == null) {
				if ( cboStndYear.Value == fce_GetCurRaceInfo("STND_YEAR") && cboTms.Value == fce_GetCurRaceInfo("TMS") ) {
					var nIndexRow = fnc_GetExistValue(dsOutDayOrd, "DAY_ORD", fce_GetCurRaceInfo("DAY_ORD"));
					if ( nIndexRow > -1 ) cboDayOrd.Index = nIndexRow;
				}
			}
			//경주리스트 콜
			fce_GetRace(sStndYear, "001", cboTms.Value, cboDayOrd.Value, "dsOutRace");
			break;
			
		case "dsOutRace" :
			fcCboOnChanged(cboRaceNo);
			break;
			
		case "dsOutMbr" :
			if (sSrNo == "" || sSrNo == null) cboMbrCd.Value = fce_GetUserInfo("MBR_CD");
			break;
	}
	
}

function imgPhotoNm_OnClick(obj,nX,nY)
{
	var sArg = "";
	var sImgNm = "";
	
	sImgNm = dsOutBrchRtrn.GetColumn(0, "PHOTO_PATH");

	if ( fnc_IsNull(sImgNm) ) return;

	sArg = "Arg_Gubun=Fair Arg_imgNm=" + sImgNm;
	Dialog("form::E03010013.xml", sArg, 0, 0, true);
}

function fc_NullToZero(sValue) 
{
	if ( sValue == null ) return 0; 
	else return toNumber(sValue);
}
]]></Script>
</Window>