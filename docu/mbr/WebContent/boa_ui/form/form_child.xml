<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="296" Id="form" Left="8" PidAttrib="7" Title="New&#32;Form" Top="8" Ver="1.0" Width="528" WorkArea="true">
		<Grid BindDataset="dsSrc" BKColor="whitesmoke" BkColor2="default" BoldHead="FALSE" Border="Flat" BorderColor="deeppink" Bottom="288" DragMode="TRUE" DropMode="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" Height="264" Id="gdMulti" InputPanel="FALSE" Left="8" LineColor="crimson" MultiSelect="TRUE" OnDrag="gdMulti_OnDrag" OnDragLeave="gdMulti_OnDragLeave" OnDrop="gdMulti_OnDrop" OnRButtonDown="gdMulti_OnRButtonDown" Right="520" TabOrder="1" TabStop="true" Top="24" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="512">
			<contents>
				<columns>
					<col width="66"/>
					<col width="190"/>
					<col width="123"/>
					<col width="80"/>
				</columns>
				<head>
					<cell bkcolor="navajowhite" col="0" display="text" text="CODE"/>
					<cell bkcolor="navajowhite" col="1" display="text" text="타이틀&#32;명"/>
					<cell bkcolor="navajowhite" col="2" display="text" text="가&#32;격"/>
					<cell col="3" display="text"/>
				</head>
				<body>
					<cell align="center" bkcolor="lightcyan" bkcolor2="gainsboro" col="0" colid="code" display="text"/>
					<cell bkcolor="lightcyan" bkcolor2="gainsboro" col="1" colid="name" display="text"/>
					<cell align="right" bkcolor="lightcyan" bkcolor2="gainsboro" col="2" colid="price" display="number"/>
					<cell col="3" display="text"/>
				</body>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[// Multiline Dragging
function gdMulti_OnDrag(obj,nPosX,nPosY,varKeyState,nRow,nCell)
{
	var dataObj = CreateDataObject();
	
	dataObj.SetData("CF_TEXT","gdMulti");
	
	if(obj.IsAboveSel())
		return dataObj;	
}
function gdMulti_OnDragLeave(obj,objDragObj)
{
	obj.BkColor = "linen";
}
function gdMulti_OnDrop(obj,objDragObj,objDataObj,nPosX,nPosY,varKeyState,nRow,nCell)
{
	var curRow = nRow;

// trace(	dataObj.GetData("CF_TEXT"));

	var dataObj = objDataObj;
	var dragObj = objDragObj;

	if(dataObj.GetData("CF_TEXT")=="gdMulti") // MultiLine Grid 에서 온경우
	{
		var iRowCnt = dsSrc.RowCount();
		dsSrc.fireEvent = false;
		for(i=0;i<iRowCnt;i++) // 소스 데이터셋 카운트 루핑
		{
			if(dsSrc.GetSelect(i)==TRUE) // 선택된놈인지 체크
			{
				curRow = dsSrc.AddRow();
				  
				dsSrc.SetColumn(curRow,'code',dsSrc.GetColumn(i,'code'));
				dsSrc.SetColumn(curRow,'name',dsSrc.GetColumn(i,'name'));
				dsSrc.SetColumn(curRow,'price',dsSrc.GetColumn(i,'price'));
				dsSrc.SetColumn(curRow,'qgbn',0); // 구분값을 신규로
			}
		}
		dsSrc.fireEvent = true;
	}	
	EndDrop(obj);
}
function EndDrop(obj)
{
	// 원래 색상으로
	obj.BkColor = "linen";
}

]]></Script>
</Window>