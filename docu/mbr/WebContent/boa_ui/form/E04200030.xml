<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="JRM0003" Left="8" OnFocus="JRM0003_OnFocus" OnInit="JRM0003_OnInit" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="교육결과등록" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsMain">
				<Contents>
					<colinfo id="chk" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEET_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_ORD" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_CNTNTS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DSCN_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_CNTNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CONF_RULLES" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_INFO" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDayOrd">
				<Contents>
					<colinfo id="cd" size="256" summ="default" type="STRING"/>
					<colinfo id="cd_nm" size="256" summ="default" type="STRING"/>
					<record>
						<cd></cd>
						<cd_nm>전체</cd_nm>
					</record>
					<record>
						<cd>0</cd>
						<cd_nm>입소</cd_nm>
					</record>
					<record>
						<cd>1</cd>
						<cd_nm>1일차</cd_nm>
					</record>
					<record>
						<cd>2</cd>
						<cd_nm>2일차</cd_nm>
					</record>
					<record>
						<cd>3</cd>
						<cd_nm>3일차</cd_nm>
					</record>
					<record>
						<cd>4</cd>
						<cd_nm>4일차</cd_nm>
					</record>
					<record>
						<cd>5</cd>
						<cd_nm>5일차</cd_nm>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="75" Height="48" Id="Shape1" Left="4" LineColor="user1" LineKind="Vertical" Right="1006" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="3" Top="27" Type="RoundRect" Width="1002"></Shape>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="5" TabOrder="6" TabStop="FALSE" Top="7" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="stFormTitle" Left="26" Style="snis_m_title" TabOrder="3" Text="교육결과등록" Top="5" VAlign="Middle" Width="400"></Static>
		<Div Height="22" Id="divBtnLst" Left="632" TabOrder="2" Text="Div0" Top="3" Url="common::comButtonType.xml" Width="374">
			<Contents></Contents>
		</Div>
		<Combo Border="Flat" CodeColumn="STND_YEAR" DataColumn="STND_YEAR" Height="20" Id="cboStndYear" ImeMode="none" Left="70" OnChanged="cboStndYear_OnChanged" Style="snis_if_input01" TabOrder="7" Top="30" Width="90"></Combo>
		<Combo BindDataset="dsTms" Border="Flat" CodeColumn="TMS" DataColumn="TMS" Height="20" Id="cboTms" ImeMode="none" Left="190" OnChanged="fcSearch" Style="snis_if_input01" TabOrder="8" Top="30" Width="42"></Combo>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsMain" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="583" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="347" Id="grdDownEdu" InputPanel="FALSE" Left="5" LineColor="user18" MinWidth="100" OnCellClick="grdDownEdu_OnCellClick" OnHeadClick="fcGridSort" Right="1005" RowHeight="50" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="FALSE" Top="236" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1000">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="20"/>
						<col width="30"/>
						<col width="60"/>
						<col width="60"/>
						<col width="300"/>
						<col width="65"/>
						<col width="80"/>
						<col width="55"/>
						<col width="35"/>
						<col width="200"/>
						<col width="100"/>
					</columns>
					<head>
						<cell bkcolor="user20" celltype="head" col="0" display="checkbox" edit="checkbox"/>
						<cell bkcolor="user20" celltype="head" col="1" color="user21" display="text" font="굴림,9"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="회차"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="성명"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="교육내용"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="교육일자"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="경주정보"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="위반조항"/>
						<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" text="판정"/>
						<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" text="위반내용"/>
						<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell celltype="head" col="0" colid="chk" display="checkbox" edit="checkbox"/>
						<cell align="center" celltype="head" col="1" display="text" expr="row+1"/>
						<cell align="center" checklength="Byte" col="2" colid="TMS" display="text" limit="40"/>
						<cell align="center" checklength="Byte" col="3" colid="DAY_ORD" combocol="cd" combodataset="dsDayOrd" combotext="cd_nm" display="combo" limit="40"/>
						<cell align="center" checklength="Byte" col="4" colid="RACER_NM" display="text" limit="40"/>
						<cell align="left" col="5" colid="EDU_CNTNTS" cursor="hand" display="normal" edit="normal" multiline="true"/>
						<cell align="center" checklength="Byte" col="6" colid="EDU_DT" display="date" edit="date" limit="40" Valign="Center"/>
						<cell align="center" checklength="Byte" col="7" colid="RACE_INFO" display="text" limit="40"/>
						<cell align="center" checklength="Byte" col="8" colid="CONF_RULLES" display="text" limit="40"/>
						<cell align="center" checklength="Byte" col="9" colid="DSCN_DESC" display="text" limit="40"/>
						<cell align="left" checklength="Byte" col="10" colid="VIOL_CNTNT" display="text" limit="40"/>
						<cell align="center" col="11" colid="RMK" cursor="hand" display="normal" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Border="None" Height="20" Id="stYear" Left="33" Style="snis_if_lable" TabOrder="4" Text="년도" Top="31" VAlign="Middle" Width="40"></Static>
		<Static Align="Center" Border="None" Height="20" Id="stTms" Left="164" Style="snis_if_lable" TabOrder="5" Text="회차" Top="31" VAlign="Middle" Width="24"></Static>
		<Static Align="Right" Height="22" Id="stFormLocation" Left="493" Style="styFormLocation" TabOrder="9" Top="-1" VAlign="Middle" Width="288"></Static>
		<Static Align="Right" Border="None" Height="20" Id="Static1" Left="621" Style="snis_if_lable" TabOrder="11" Text="대상구분" Top="31" VAlign="Middle" Width="47"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cboDayOrd" ImeMode="none" InnerDataset="dsDayOrd" Left="676" OnChanged="fcSearch" Style="snis_if_input01" TabOrder="10" Top="30" Width="74"></Combo>
		<Static Align="Center" BKColor="INACTIVECAPTION" Border="Flat" Height="59" Id="Static0" Left="413" Style="snis_if_lable" TabOrder="14" Text="위반&#10;내용" Top="79" VAlign="Middle" Width="37"></Static>
		<TextArea BindDataset="dsMain" Border="Flat" Column="VIOL_CNTNT" DisableBKColor="INFOBK" Height="60" Id="txaDownAcdntDesc" Left="453" Readonly="TRUE" Style="snis_m_input01" TabOrder="13" Top="78" Width="552"></TextArea>
		<Static Align="Center" BKColor="INACTIVECAPTION" Border="Flat" Height="91" Id="Static2" Left="6" Style="snis_if_lable" TabOrder="16" Text="교육&#10;내용" Top="141" VAlign="Middle" Width="37"></Static>
		<TextArea BindDataset="dsMain" Border="Flat" Column="EDU_CNTNTS" DisableBKColor="INFOBK" Height="92" Id="TextArea0" Left="45" Style="snis_m_input01" TabOrder="15" Top="141" VScroll="TRUE" Width="960"></TextArea>
		<Static Align="Center" BKColor="INACTIVECAPTION" Border="Flat" Height="59" Id="Static3" Left="6" Style="snis_if_lable" TabOrder="18" Text="판정" Top="79" VAlign="Middle" Width="37"></Static>
		<TextArea BindDataset="dsMain" Border="Flat" Column="DSCN_DESC" DisableBKColor="INFOBK" Height="60" Id="TextArea1" Left="45" Readonly="TRUE" Style="snis_m_input01" TabOrder="17" Top="79" Width="99"></TextArea>
		<Static Align="Center" BKColor="INACTIVECAPTION" Border="Flat" Height="59" Id="Static4" Left="150" Style="snis_if_lable" TabOrder="20" Text="위반&#10;조항" Top="80" VAlign="Middle" Width="37"></Static>
		<TextArea BindDataset="dsMain" Border="Flat" Column="CONF_RULLES" DisableBKColor="INFOBK" Height="60" Id="TextArea2" Left="189" Readonly="TRUE" Style="snis_m_input01" TabOrder="19" Top="79" Width="217"></TextArea>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btnCreate" ImageID="btn_txt_07" Left="799" OnClick="fcCreate" Style="snis_btn" TabOrder="21" Text="자료가져오기" Top="30" Transparent="TRUE" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btnBatchInput" ImageID="btn_txt_11" Left="895" OnClick="fcBatchApply" Style="snis_btn" TabOrder="22" Text="교육일시내용일괄" Top="30" Transparent="TRUE" Width="104"></Button>
		<Combo BindDataset="dsTms" Border="Flat" CodeColumn="TMS" DataColumn="TMS" Height="20" Id="cboTms2" ImeMode="none" Left="244" OnChanged="fcSearch" Style="snis_if_input01" TabOrder="23" Top="30" Width="42"></Combo>
		<Static Height="14" Id="Static5" Left="233" TabOrder="24" Text="~" Top="36" Width="17"></Static>
		<Div BKColor="user0" Height="20" Id="divRacerSearch" Left="307" TabOrder="25" Text="Div0" Top="43" Width="277">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Border="None" Color="blue" Height="20" Id="stInputDt" Left="15" Style="snis_if_lable" TabOrder="28" Text="교육일자" Top="53" VAlign="Middle" Width="48"></Static>
		<Calendar Border="Flat" Color="blue" Height="20" Id="calFromInputDt" Left="71" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="26" Top="53" Width="88"></Calendar>
		<Static Align="Center" Border="None" Height="20" Id="Static6" Left="167" Style="snis_if_lable" TabOrder="29" Text="~" Top="54" VAlign="Middle" Width="16"></Static>
		<Calendar Border="Flat" Color="blue" Height="20" Id="calToInputDt" Left="191" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="27" Top="53" Width="88"></Calendar>
		<Static Align="Center" Border="None" Color="blue" Height="20" Id="Static7" Left="597" Style="snis_if_lable" TabOrder="30" Text="※&#32;교육일자&#32;조건이&#32;있으면&#32;년도&#32;및&#32;회차&#32;조건은&#32;무시됩니다." Top="54" VAlign="Middle" Width="348"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::cra_common_script.js";
#include "lib::cra_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'JRM0003';
var sBUTTONLIST   = 'TTTTTTT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sTmpGBL_FRM_REL_VALUE = '';
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>> 최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
	sBUTTONLIST   = 'FT' + sInpt + 'FTTT';

	//버튼 enable
	if(sInpt =='F')  {
		btnCreate.Enable = false;
		btnBatchInput.Enable = false;
	}

	// 화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	// 화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);

	// 초기 화면 BK Color설정
	fnc_SetBKColor(this);
	
	// 그리드 사이즈 조정
	fcOnSize(parent.width, parent.height);
	
	// 경주정보 조회
	fcd_GetRaceInfo(sFormId, cboStndYear, NULL, cboTms, NULL, NULL);


	cboTms2.InnerDataset = cboTms.InnerDataset;
	cboTms2.Index = cboTms.Index;

	cboDayOrd.index = 0;
	
	// 공통코드 조회
	//fcd_GetComboDs(dsInComCd);	
	
	JRM0003_OnFocus();
	
}

/*-------------------------------------------------------------------------------------------------+
>> 선수등록번호
+-------------------------------------------------------------------------------------------------*/
function fcSetDivInit(obj) {
	if (obj == divRacerSearch) {
		divRacerSearch.setDivInit("002", "");
		divRacerSearch.setDivTitle("선수조회");
		// divRacerSearch.setDivWidths(140, 70, 100);
	}
}

/*-------------------------------------------------------------------------------------------------+
>> 최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	// 자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "dsMain"; 
	if (!fnc_FormUnloadCheck(sDataset, sFormId)) return false;
}
/*-------------------------------------------------------------------------------------------------+
>> 그리드 사이즈 조정
+-------------------------------------------------------------------------------------------------*/
function fcOnSize(nCx, nCy) {
	grdDownEdu.Height = nCy - grdDownEdu.Top  - 10;
}
/*-------------------------------------------------------------------------------------------------+
>> 그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj, nCell, nX, nY, nPivotIndex) {
	if(nCell = 0) {
			var objDs = grdDownEdu.BindDataset;	
			if (grdDownEdu.GetCellProp( "head", 0,"text") == 1){
				grdDownEdu.SetCellProp("head",0,"text","0");
				lfn_SetGrdChk(0, objDs, "chk");		
			} else {
				grdDownEdu.SetCellProp("head",0,"text","1");
				lfn_SetGrdChk(1, objDs, "chk");
			}
	}
	else {
		fnc_GridSort(obj, object(obj.BindDataset), nCell);
	}
}


function lfn_SetGrdChk(chk_val, objDs, chk_col){

	for (i=0; i<object(objDs).RowCount(); i++){
		object(objDs).SetColumn(i, chk_col, chk_val);
	
	}
}	
/*-------------------------------------------------------------------------------------------------+
>> 조회
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {	
	return true;
}

function fcSearch(obj) {
	if ( !fcSearchCheck(obj) ) return;	
	
    var sInDataSet   = "";
    var sOutDataSet  = "dsMain=dsMain "; 
    var sServiceName = "";

	if(length(calFromInputDt.Value) <1) {
		
		sServiceName = "jrm0003-service:searchDownEdu";
		
		fcd_AddParam("STND_YEAR", 	cboStndYear.Value);
		fcd_AddParam("MEET_CD", 	GBL_MEET_CD); // 이후 교육이 타경륜장과 연계시 수정해야함
		fcd_AddParam("FRTMS", 		cboTms.Value );
		fcd_AddParam("TOTMS", 		cboTms2.Value );		
		fcd_AddParam("DAY_ORD", 	cboDayOrd.Value );
		fcd_AddParam("RACER_NO" , 	divRacerSearch.edCode.Text);
	}
	else {
		sServiceName = "jrm0003-service:searchDownEduDt";
		
		fcd_AddParam("MEET_CD", GBL_MEET_CD); // 이후 교육이 타경륜장과 연계시 수정해야함
		fcd_AddParam("FRDT", calFromInputDt.Value );
		fcd_AddParam("TODT", calToInputDt.Value );
		fcd_AddParam("RACER_NO" , divRacerSearch.edCode.Text);
	}	

	// if (length(Trim(divRacerSearch.edCode.Text)) != 0) {
		// fcd_AddParam("RACER_NO", Trim(divRacerSearch.edCode.Text));
	// }
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);		
}

/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {  

	// 저장할 자료가 있는지 체크
	if ( !fnc_DatasetChangeCheck(this.dsMain)) {
		//저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");	
		return false;
	}

	return true;
}

//초기 가져오기 환경 체크
function fnc_CreateCheck() {
	if(length(cboStndYear.Value) > 0  and (cboTms.Value = cboTms2.Value))
		return true;
	else {
		fnc_Message("년도 및 회차를 확인하세요.\n자료 자져오기시에는 회차의 시작과 끝이 같아야 합니다.", "N");	
	 }		
}

// 교육자료 초기 생성
function fcCreate(obj) {

	if (fnc_CreateCheck()) {
		var sServiceName = "jrm0003-service:makeDownEdu";
		var sInDataSet   = "";    
		var sOutDataSet  = "";    
		
		fcd_AddParam("STND_YEAR", cboStndYear.Value); 
		fcd_AddParam("MEET_CD", GBL_MEET_CD);	
		fcd_AddParam("FRTMS", cboTms.Value );	
		fcd_AddParam("TOTMS", cboTms2.Value );	
			
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);			
	}
}

function fcSave(obj) {
	if ( !fcSaveCheck() ) return;

    var sServiceName = "jrm0003-service:saveDownEdu";
    var sInDataSet   = "dsMain=dsMain:u ";    
    var sOutDataSet  = "";    
    
	fcd_AddParam("STND_YEAR", cboStndYear.Value); 
	fcd_AddParam("MEET_CD", GBL_MEET_CD);	
	fcd_AddParam("FRTMS", cboTms.Value );
	fcd_AddParam("TOTMS", cboTms.Value );
	fcd_AddParam("DAY_ORD", cboDayOrd.Value );
	    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);		
}


function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

	if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	

	
	// 조회 완료 후
	switch (sServiceName) {		
		case "common-service:searchRaceInfoEx":
			break;
		
		case "jrm0003-service:searchDownEdu":
					
			if( dsMain.rowcount > 0  ) {

			}
			break;		
			
		case "jrm0003-service:saveDownEdu":
			fcSearch( NULL );
			break;

		case "jrm0003-service:createDownEdu":
			fcSearch( NULL );
			break;			
	}
}
/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
    var sExcelList = "grdDownEdu:교육현황";
    fcd_OpenExcelListExport(sExcelList);
}

/*-------------------------------------------------------------------------------------------------+
>> 화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	// 화면 종료
	Close();
}



function cboStndYear_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	switch (obj.Id) {
		case "cboStndYear" :
			fcd_GetTms(sFormId, cboTms, cboStndYear.Value, GBL_MEET_CD, false, null, null);
			fcSearch(obj);
			break;
	}
}

function grdDownEdu_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	
}

function fcBatchApply(obj)
{
	var i;
	var tmpEdu_DT;
	var tmpEdu_Contents;
	
	tmpEdu_Dt = dsMain.GetColumn(dsMain.currow , "EDU_DT");
	tmpEdu_Contents = dsMain.GetColumn(dsMain.currow , "EDU_CNTNTS");
	
	for(i=0;i<dsMain.RowCount();i++) {
		if(dsMain.GetColumn(i,"chk") =="1") {
			dsMain.SetColumn(i,"EDU_DT",tmpEdu_Dt);
			dsMain.SetColumn(i,"EDU_CNTNTS",tmpEdu_Contents);
		}
	}
	grdDownEdu.ReDraw();
}

//연계시 중요하다.
function JRM0003_OnInit(obj,nInitWidth,nInitHeight)
{
	divRacerSearch.url = DIV_CODE_URL;
}

// focus 갖을때
function JRM0003_OnFocus(obj)
{
	if(sTmpGBL_FRM_REL_VALUE <> GBL_FRM_REL_VALUE) {
		sTmpGBL_FRM_REL_VALUE = GBL_FRM_REL_VALUE;
		fc_relate_Search();
	}
	GBL_FRM_REL_VALUE="";
}

// 연계조회
function fc_relate_Search()  {
	
	if(sTmpGBL_FRM_REL_VALUE!='')
	{	
		// 이전 페이지에서 파라미터 받음	
		ARRAY2_GBL_RET_VALUE = split2(sTmpGBL_FRM_REL_VALUE," ","=");
		
		divRacerSearch.edCode.Value		= fnc_Array2Value(ARRAY2_GBL_RET_VALUE,"sRacerNo");
		divRacerSearch.edCodeNm.Value	= fnc_Array2Value(ARRAY2_GBL_RET_VALUE,"sRacerNm");
		calFromInputDt.Value 			= fnc_Array2Value(ARRAY2_GBL_RET_VALUE,"sFrDt");
		calToInputDt.Value 				= fnc_Array2Value(ARRAY2_GBL_RET_VALUE,"sToDt");
		
		// if(length(fnc_Array2Value(ARRAY2_GBL_RET_VALUE,"sMeetCd")) <1) {
			// cboMeetCd.Index = 0;
		// }
		// else {
			// object(cboMeetCd.InnerDataset).row = dsMain.FindRow("CD_NM",fnc_Array2Value(ARRAY2_GBL_RET_VALUE,"sMeetCd"));			
		// }
		
		fcSearch();
	}
}

// 변수 처리 (사실 경주사업에서는 공통에 있는데...)
function fnc_Array2Value(arr2Param,strParam)
{
	var strResult = "";
	for(var i=0;i<arr2Param.length;i++)
	{	
		for(var j=0;j<arr2Param[i].length;j++)
		{
			if(arr2Param[i][0]==strParam)
			{
				strResult = arr2Param[i][1];
			}
		}
	}
	return strResult;
}


function fcPrint() {
	if (!(cboTms.Value = cboTms2.Value) and (cboTms.value <> ""))  {
		fnc_Message("시작회차와 종료회차가 동일해야 합니다.", "N");	
		return;
	}
	//var sDate  = dsMain.GetColumn(0,"EDU_DT");
	//var nDay   = getDay(dsMain.GetColumn(0,"EDU_DT"));
	//var strDay = decode( nDay, 0, "(일)", 1, "(월)", 2, "(화)", 
	//			3, "(수)", 4, "(목)", 5, "(금)", 6, "(토)" ); // 요일 인덱스에 따라 지정한 요일 변수 설정
	//var argEduDt = mid(sDate,5,2)+'월 '+mid(
	 
	
	if(dsMain.RowCount() >0) {
	
		var sSubUrl   = "";                     	//레포트 파일이 있는 서브디렉토리
		var sRptNm    = "JRM0003.jrf";            //레포트 파일명
		var sDataSet  = "dsMain=dsMain";          //"UBI 쿼리명, MIP Dataset명"
				
		fcSearch();
						
		var sArg    = " TMS=" + cboTms.Value;
			sArg   += " TOTAL_CNT=" + dsMain.rowcount();
	
		var sRptDrct  = 0;                           //출력방향(0 : 수직, 1 : 수평)
		
		fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
		
	}
}]]></Script>
</Window>