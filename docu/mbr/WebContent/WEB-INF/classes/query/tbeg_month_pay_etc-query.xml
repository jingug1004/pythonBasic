<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbeg_month_pay 선수 기타 상금   ">
    <query id="tbeg_month_pay_etc_ff001" desc="선수 기타 상금 조회 " fetchSize="10">
        <![CDATA[
			-- 선수 기타 상금 조회 
			SELECT ROWNUM AS NUM, TP.* FROM (
				SELECT 
					STND_YEAR,	-- 기준년도
					PAY_MONTH,	-- 기준월
					PAY_TPE,	-- 유형 
				    TMP.RACER_NO,   -- 선수등록번호
				    TRM.NM_KOR AS RACER_NM, -- 선수명
				    SUPP_AMT_08,    -- 지급항목 - 수당 
				    SUPP_AMT_09,	-- 지급항목 - 기타항목 
				    SUPP_AMT_12,    -- 지급공제항목 - 선수연금(사업자분담)
				    SUPP_AMT_14, 	-- 지급공제항목 - 상해보험료(공제)
				    SUPP_AMT_15, 	-- 지급공제항목 - 현물제공(공제)
				    SUPP_AMT_16, 	-- 지급공제항목 - 기타항목(공제)
				    AID_AMT_05,     -- 공제항목 - 선수연금(개인부담분)
				    AID_AMT_06,     -- 공제항목 - 미수금 
				    AID_AMT_07,     -- 공제항목 - 선수복 대여료 
				    AID_AMT_08,     -- 공제항목 - 기타항목
				    AID_AMT_11,     -- 지급공제항목 - 상해보험료(공제)
				    AID_AMT_12,     -- 지급공제항목 - 선수연금(사업자분담)
				    AID_AMT_13,     -- 지급공제항목 - 현물제공(공제)
				    AID_AMT_14     -- 지급공제항목 - 기타항목(공제)
				FROM TBEG_MONTH_PAY TMP, TBEC_RACER_MASTER TRM
				WHERE TMP.RACER_NO = TRM.RACER_NO
				AND STND_YEAR=?
				AND PAY_MONTH=? 
				AND TRM.NM_KOR LIKE '%'||?||'%'
				AND PAY_TPE='1'  
				ORDER BY RACER_NO
			)TP
        ]]>
    </query> 
    
   <query id="tbeg_month_pay_etc_mf001" desc="선수 기타 상금  등록/수정   " fetchSize="10">
        <![CDATA[
			-- 선수 기타 상금  등록/수정
			MERGE INTO TBEG_MONTH_PAY TMP
			USING (
				SELECT
					? AS STND_YEAR,
					? AS PAY_MONTH,
					? AS PAY_TPE,
					? AS RACER_NO,
					NVL(?,0) AS SUPP_AMT_08,    -- 지급항목 - 수당 
				    NVL(?,0) AS SUPP_AMT_09,	-- 지급항목 - 기타항목 
				    NVL(?,0) AS SUPP_AMT_12,    -- 지급공제항목 - 선수연금(사업자분담)
				    NVL(?,0) AS SUPP_AMT_14, 	-- 지급공제항목 - 상해보험료(공제)
				    NVL(?,0) AS SUPP_AMT_15, 	-- 지급공제항목 - 현물제공(공제)
				    NVL(?,0) AS SUPP_AMT_16, 	-- 지급공제항목 - 기타항목(공제)
				    NVL(?,0) AS AID_AMT_05,     -- 공제항목 - 선수연금(개인부담분)
				    NVL(?,0) AS AID_AMT_06,     -- 공제항목 - 미수금 
				    NVL(?,0) AS AID_AMT_07,     -- 공제항목 - 선수복 대여료 
				    NVL(?,0) AS AID_AMT_08,     -- 공제항목 - 기타항목
				    NVL(?,0) AS AID_AMT_11,     -- 지급공제항목 - 상해보험료(공제)
				    NVL(?,0) AS AID_AMT_12,     -- 지급공제항목 - 선수연금(사업자분담)
				    NVL(?,0) AS AID_AMT_13,     -- 지급공제항목 - 현물제공(공제)
				    NVL(?,0) AS AID_AMT_14,     -- 지급공제항목 - 기타항목(공제)
				    ? AS USER_ID 
			    FROM DUAL ) TP
			ON (TMP.STND_YEAR = TP.STND_YEAR
			    AND TMP.PAY_MONTH = TP.PAY_MONTH
			    AND TMP.PAY_TPE = TP.PAY_TPE
			    AND TMP.RACER_NO = TP.RACER_NO
			    )
			WHEN MATCHED THEN
			UPDATE 
			SET
			    TMP.SUPP_AMT_08 = TP.SUPP_AMT_08,    -- 지급항목 - 수당 
			    TMP.SUPP_AMT_09 = TP.SUPP_AMT_09,	-- 지급항목 - 기타항목 
			    TMP.SUPP_AMT_12 = TP.SUPP_AMT_12,    -- 지급공제항목 - 선수연금(사업자분담)
			    TMP.SUPP_AMT_14 = TP.SUPP_AMT_14, 	-- 지급공제항목 - 상해보험료(공제)
			    TMP.SUPP_AMT_15 = TP.SUPP_AMT_15, 	-- 지급공제항목 - 현물제공(공제)
			    TMP.SUPP_AMT_16 = TP.SUPP_AMT_16, 	-- 지급공제항목 - 기타항목(공제)
			    TMP.AID_AMT_05 = TP.AID_AMT_05,     -- 공제항목 - 선수연금(개인부담분)
			    TMP.AID_AMT_06 = TP.AID_AMT_06,     -- 공제항목 - 미수금 
			    TMP.AID_AMT_07 = TP.AID_AMT_07,     -- 공제항목 - 선수복 대여료 
			    TMP.AID_AMT_08 = TP.AID_AMT_08,     -- 공제항목 - 기타항목
			    TMP.AID_AMT_11 = TP.AID_AMT_11,     -- 지급공제항목 - 상해보험료(공제)
			    TMP.AID_AMT_12 = TP.AID_AMT_12,     -- 지급공제항목 - 선수연금(사업자분담)
			    TMP.AID_AMT_13 = TP.AID_AMT_13,     -- 지급공제항목 - 현물제공(공제)
			    TMP.AID_AMT_14 = TP.AID_AMT_14,     -- 지급공제항목 - 기타항목(공제)
			    TMP.UPDT_ID = TP.USER_ID,
			    TMP.UPDT_DTM = SYSDATE
			WHEN NOT MATCHED THEN
			INSERT (
				TMP.STND_YEAR,
				TMP.PAY_MONTH,
			    TMP.PAY_TPE,
			    TMP.RACER_NO,
			    TMP.SUPP_AMT_08,    -- 지급항목 - 수당 
			    TMP.SUPP_AMT_09,	-- 지급항목 - 기타항목 
			    TMP.SUPP_AMT_12,    -- 지급공제항목 - 선수연금(사업자분담)
			    TMP.SUPP_AMT_14, 	-- 지급공제항목 - 상해보험료(공제)
			    TMP.SUPP_AMT_15, 	-- 지급공제항목 - 현물제공(공제)
			    TMP.SUPP_AMT_16, 	-- 지급공제항목 - 기타항목(공제)
			    TMP.AID_AMT_05,     -- 공제항목 - 선수연금(개인부담분)
			    TMP.AID_AMT_06,     -- 공제항목 - 미수금 
			    TMP.AID_AMT_07,     -- 공제항목 - 선수복 대여료 
			    TMP.AID_AMT_08,     -- 공제항목 - 기타항목
			    TMP.AID_AMT_11,     -- 지급공제항목 - 상해보험료(공제)
			    TMP.AID_AMT_12,     -- 지급공제항목 - 선수연금(사업자분담)
			    TMP.AID_AMT_13,     -- 지급공제항목 - 현물제공(공제)
			    TMP.AID_AMT_14,     -- 지급공제항목 - 기타항목(공제)
			    TMP.INST_ID,
			    TMP.INST_DTM
			)			    
			VALUES(
				TP.STND_YEAR,
				TP.PAY_MONTH,
			    TP.PAY_TPE,
			    TP.RACER_NO,
			    TP.SUPP_AMT_08,    	-- 지급항목 - 수당 
			    TP.SUPP_AMT_09,		-- 지급항목 - 기타항목 
			    TP.SUPP_AMT_12,    	-- 지급공제항목 - 선수연금(사업자분담)
			    TP.SUPP_AMT_14, 	-- 지급공제항목 - 상해보험료(공제)
			    TP.SUPP_AMT_15, 	-- 지급공제항목 - 현물제공(공제)
			    TP.SUPP_AMT_16, 		-- 지급공제항목 - 기타항목(공제)
			    TP.AID_AMT_05,     	-- 공제항목 - 선수연금(개인부담분)
			    TP.AID_AMT_06,     	-- 공제항목 - 미수금 
			    TP.AID_AMT_07,     	-- 공제항목 - 선수복 대여료 
			    TP.AID_AMT_08,     	-- 공제항목 - 기타항목
			    TP.AID_AMT_11,     	-- 지급공제항목 - 상해보험료(공제)
			    TP.AID_AMT_12,     -- 지급공제항목 - 선수연금(사업자분담)
			    TP.AID_AMT_13,     	-- 지급공제항목 - 현물제공(공제)
			    TP.AID_AMT_14,     	-- 지급공제항목 - 기타항목(공제)
			    TP.USER_ID,
			    SYSDATE
			  )
        ]]>
    </query> 
   
    
   
</queryMap>