<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbec_racer_master(선수정보)">
    <query id="tbec_racer_info_fc001" desc="선수상세정보 조회" fetchSize="10">
        <![CDATA[
            SELECT 
                    TRM.RACER_NO            -- 선수번호
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00046' AND CD = TRM.RACER_GRD_CD) RACER_GRD_CD_NM --선수등급명
                    ,TRM.NM_KOR                -- 성명 - 한글
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00017' AND CD = TRM.RACER_STAT_CD) RACER_STAT_CD_NM --선수구분명
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00007' AND CD = TRM.FAVOR_COURSE_CD) FAVOR_COURSE_CD_NM --선호코스명
                    ,TRM.EMAIL_ADDR            -- 이메일주소
                    ,TRM.RACER_PERIO_NO        -- 선수기수            
                    ,SUBSTR(TRD.BIRTH_DT,0,4)||'. ' ||SUBSTR(TRD.BIRTH_DT,5,2)||'. ' ||SUBSTR(TRD.BIRTH_DT,7,2)||' '
                     ||NVL(' ','('||(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00100' AND CD = TRD.LUNSOL_CD)||')') BIRTH_DT         -- 생년월일
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00100' AND CD = TRD.LUNSOL_CD) LUNSOL_CD_NM --음양구분명
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00082' AND CD = TRD.MRRG_CD) MRRG_CD_NM --결혼여부명
                    ,SUBSTR(GET_DEC(TRD.RES_NO),0,6)||'-'||SUBSTR(GET_DEC(TRD.RES_NO),7,7) AS RES_NO                 -- 주민등록번호
                    ,TRD.CELPON_NO            -- 휴대폰 번호
                    ,TRD.HOMEPAGE_ADDR        -- 홈페이지 주소
                    ,TRD.HOME_PHONE_NO        -- 집전화번호
                    ,TRD.CAR_NO                -- 차량번호
                    ,TRD.NM_CHN                -- 성명 - 한자
                    ,TRD.NM_ENG                -- 성명 - 영문
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00024' AND CD = TRD.NATV_PLAC_CD) NATV_PLAC_CD_NM --출신지명                    
                    ,TRD.NATY_SCHL            -- 출신고
                    ,TRD.NATY_UNIV            -- 출신대학교
                    ,TRD.NATY_GRAD            -- 출신대학원
                    --,'('||SUBSTR(TRD.POST_NO,0,3)||'-'||SUBSTR(TRD.POST_NO,4,6)||')' 
                    -- ||' '||TRD.ADD1_HOME||' '||TRD.ADD2_HOME AS HOME_ADDR -- 주소
                    ,TRD.ADD1_HOME||' '||TRD.ADD2_HOME AS HOME_ADDR -- 주소
                    ,TRD.BORN_ADDR            -- 본적지
                    ,TRD.PTO_NM                -- 논리 사진파일명
                    ,TRD.PTO_PATH            -- 물리 사진파일명
                    ,TRD.CNL_RSN            -- 취소사유
                    ,NVL(' ',SUBSTR(TRD.CNL_DT,0,4)||'년 ' ||SUBSTR(TRD.CNL_DT,5,2)||'월 ' ||SUBSTR(TRD.CNL_DT,7,2)||'일')  CNL_DT         -- 취소일자
                    ,TRD.SIGHT_LEFT            -- 시력 - 좌
                    ,TRD.SIGHT_RIGT            -- 시력 - 우
                    ,TRD.BLOD_TPE            -- 혈액형
                    ,TRD.DRINK                -- 주량
                    ,TRD.SMOKING            -- 흡연량
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00022' AND CD = TRD.RELGN_CD) RELGN_CD_NM --종교명 
                    ,TRD.HOBY                -- 취미
                    ,TRD.SPA_ABTY            -- 특기
                    ,TRD.HGHT                -- 신장
                    ,TRD.WGHT                -- 체중
                    ,TRD.SHOE_SIZE            -- 신발
                    ,TRD.SHOULDER_SIZE        -- 어깨
                    ,TRD.ARM_SIZE            -- 팔
                    ,TRD.BACK_SIZE            -- 등길이
                    ,TRD.UP_BODY_SIZE        -- 총장
                    ,TRD.BREAST_SIZE        -- 가슴
                    ,TRD.WGHT_SIZE            -- 허리
                    ,TRD.ABDOMEN_SIZE        -- 하동
                    ,TRD.INNER_SUIT_SIZE    -- 안기장
                    ,TRD.SUIT_SIZE            -- 기장
                    ,THIGH_SIZE                -- 허벅지
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00028' AND CD = TRD.ARMY_TPE_CD) ARMY_TPE_CD_NM --군별명                    
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00027' AND CD = TRD.ARMY_CLAS_CD) ARMY_CLAS_CD_NM --역종명                    
                    ,TRD.SPEC_INFO            -- 특이사항
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00023' AND CD = TRCI.BK_CD) BK_CD_NM --은행명                    
                    ,GET_DEC(TRCI.BK_ACCUNT) BK_ACCUNT  -- 계좌번호
                    ,TRD.NATY_RACER_YN		-- 선수출신여부
                    ,TRD.NATY_RACER_ITEM	-- 선수출신종목
            FROM     TBEC_RACER_MASTER TRM
                    ,TBEC_RACER_DETAIL TRD
                    ,TBEG_RACER_COM_INFO TRCI
            WHERE TRM.RACER_NO =  TRD.RACER_NO(+)
            AND TRM.RACER_NO =  TRCI.RACER_NO(+)
            AND TRM.RACER_NO = ?
        ]]>
    </query>
    <query id="tbec_racer_info_fc002" desc="선수가족사항 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					SEQ					-- 일련번호
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00020' AND CD = RELN_CD) RELN_CD_NM --관계명  
					,NM					-- 성명
					,BIRTH_DT			-- 생년월일
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00025' AND CD = SCHL_TPE_CD) SCHL_TPE_CD_NM --최종학력명 
					,RMK				-- 비고
					,JOB_INFO			-- 직장정보
			FROM TBEC_RACER_FAMILY
			WHERE RACER_NO = ?
        ]]>
    </query>      
    <query id="tbec_racer_info_fc003" desc="선수학력사항 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					SEQ				-- 일련번호
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00025' AND CD = SCHL_TPE_CD) SCHL_TPE_CD_NM --학력명 
					,SCHL_NM			-- 학교명
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00026' AND CD = GRDU_CD) GRDU_CD_NM --졸업명 
					,MTRIC_YY			-- 입학년도
					,GRDU_YY			-- 졸업년도
					,MJR				-- 전공학과
					,RMK				-- 비고
			FROM TBEC_RACER_ACADEMIC
			WHERE RACER_NO = ?
        ]]>
    </query>          
    <query id="tbec_racer_info_fc004" desc="선수관계정보 조회" fetchSize="10">
        <![CDATA[
            SELECT 
					SEQ					    			-- 일련번호
					,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00019' AND CD = TRR.RELA_RACER_CD) RELA_RACER_CD_NM --선수관계명 
					,TRR.RELA_RACER_NO					-- 관계선수번호
                    ,TRM.NM_KOR AS RELA_RACER_NM      	-- 관계선수성명
                    ,(SELECT CD_NM FROM TBEA_SPEC_CD WHERE GRP_CD ='E00084' AND CD = TRR.RELA_GRD_CD) RELA_GRD_CD_NM --관계등급명
			FROM     TBEC_RACER_RELATION TRR
                    ,TBEC_RACER_MASTER TRM
			WHERE TRR.RACER_NO = ?
            AND TRR.RELA_RACER_NO = TRM.RACER_NO
        ]]>
    </query>    
    <query id="tbec_racer_info_fc005" desc="선수입/포상사항 조회" fetchSize="10">
        <![CDATA[
            SELECT 
                              STND_YEAR    -- 기준년도
                            , TMS          -- 회차
                            , DAY_ORD      -- 일차
                            , RACE_DAY     -- 경주일자
                            , RACE_NO      -- 경주번호
                            , RACE_REG_NO  -- 정번번호
                            , RACER_NO     -- 선수번호
                            ,(SELECT RMK FROM TBEA_SPEC_CD WHERE GRP_CD ='E00005' AND CD = RACE_DGRE_CD) RACE_DGRE_CD_NM --경주등급명
                            , RANK         -- 순위
                            , RMK          -- 비고
                            , GBN          -- 입/포상 구분            
            FROM
                (
                    SELECT /*입상*/
                              TRT .STND_YEAR    -- 기준년도
                            , TRT .TMS          -- 회차
                            , TRDO.DAY_ORD      -- 일차
                            , TRDO.RACE_DAY     -- 경주일자
                            , TR  .RACE_NO      -- 경주번호
                            , TOR .RACE_REG_NO  -- 정번번호
                            , TOR .RACER_NO     -- 선수번호
                            , TR  .RACE_DGRE_CD -- 경주등급코드
                            , TOR .RANK         -- 순위
                            , TRT .TMS_NM AS RMK       -- 회차명
                            , '002' AS GBN        -- 입/포상 구분
                    FROM     TBEB_RACE_TMS     TRT
                           , TBEB_RACE_DAY_ORD TRDO
                           , TBEB_RACE         TR
                           , TBEB_ORGAN        TOR
                           , TBEB_CFRNT_METH   TCM
                    WHERE  TRT .STND_YEAR       = TRDO.STND_YEAR
                    AND    TRT .TMS             = TRDO.TMS
                    AND    TRDO.STND_YEAR       = TR  .STND_YEAR
                    AND    TRDO.TMS             = TR  .TMS
                    AND    TRDO.DAY_ORD         = TR  .DAY_ORD
                    AND    TR  .STND_YEAR       = TOR .STND_YEAR
                    AND    TR  .TMS             = TOR .TMS
                    AND    TR  .DAY_ORD         = TOR .DAY_ORD
                    AND    TR  .RACE_NO         = TOR .RACE_NO
                    AND    TRT .TMS       BETWEEN NVL(?, TRT .TMS)
                                              AND NVL(?, TRT .TMS)
                    AND    TOR .RANK      BETWEEN 1
                                              AND 3
                    AND    TOR  .RACER_NO       = NVL(?, TOR .RACER_NO    ) 
                    AND    TCM.RACE_KINDS_CD 	!= '001' 
                    AND    TRT.CFRNT_CD        	= TCM.CFRNT_CD 
                    AND    TR.RACE_DGRE_CD      LIKE '9%'        
                    UNION
                    SELECT  /*포상*/
                              SUBSTR(AWARD_DT,0,4) AS STND_YEAR       	-- 기준년도
                            , 0 AS TMS              					-- 회차
                            , 0 AS DAY_ORD          					-- 일차
                            , AWARD_DT AS RACE_DAY  					-- 경주일자
                            , '' AS RACE_NO         					-- 경주번호
                            , '' AS RACE_REG_NO     					-- 정번번호
                            , RACER_NO AS RACER_NO        				-- 선수번호
                            , '' AS RACE_DGRE_CD    					-- 경주등급코드
                            , AWARD_AMT AS RANK     					-- 상금액
                            , AWARD_DESC AS RMK      					-- 상명칭
                            , '001' AS GBN            					-- 입/포상 구분
                    FROM TBEG_RACER_AWARD_HIS TRAH
                    WHERE    TRAH.AWARD_GBN = '001'
			          AND    TRAH.RACER_NO  = NVL(?, TRAH .RACER_NO    ) 
                    ORDER BY RACE_DAY DESC
                           , TMS       DESC
                           , DAY_ORD   ASC
                           , RACE_NO   ASC
                           , RANK      ASC
                           , RMK DESC
                )
           WHERE GBN = NVL(?, GBN    ) 
        ]]>
    </query>
</queryMap>