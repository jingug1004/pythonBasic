<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="D02000025" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="조&#32;편&#32;성&#32;" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsRaceRndNo">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="VALUE" size="256" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<VALUE>1</VALUE>
					</record>
					<record>
						<CODE>2</CODE>
						<VALUE>2</VALUE>
					</record>
					<record>
						<CODE>3</CODE>
						<VALUE>3</VALUE>
					</record>
					<record>
						<CODE>4</CODE>
						<VALUE>4</VALUE>
					</record>
					<record>
						<CODE>5</CODE>
						<VALUE>5</VALUE>
					</record>
					<record>
						<CODE>6</CODE>
						<VALUE>6</VALUE>
					</record>
					<record>
						<CODE>7</CODE>
						<VALUE>7</VALUE>
					</record>
					<record>
						<CODE>8</CODE>
						<VALUE>8</VALUE>
					</record>
					<record>
						<CODE>9</CODE>
						<VALUE>9</VALUE>
					</record>
					<record>
						<CODE>10</CODE>
						<VALUE>10</VALUE>
					</record>
					<record>
						<CODE>11</CODE>
						<VALUE>11</VALUE>
					</record>
					<record>
						<CODE>12</CODE>
						<VALUE>12</VALUE>
					</record>
					<record>
						<CODE>13</CODE>
						<VALUE>13</VALUE>
					</record>
					<record>
						<CODE>14</CODE>
						<VALUE>14</VALUE>
					</record>
					<record>
						<CODE>15</CODE>
						<VALUE>15</VALUE>
					</record>
					<record>
						<CODE>16</CODE>
						<VALUE>16</VALUE>
					</record>
					<record>
						<CODE>17</CODE>
						<VALUE>17</VALUE>
					</record>
					<record>
						<CODE>18</CODE>
						<VALUE>18</VALUE>
					</record>
					<record>
						<CODE>19</CODE>
						<VALUE>19</VALUE>
					</record>
					<record>
						<CODE>20</CODE>
						<VALUE>20</VALUE>
					</record>
					<record>
						<CODE>21</CODE>
						<VALUE>21</VALUE>
					</record>
					<record>
						<CODE>22</CODE>
						<VALUE>22</VALUE>
					</record>
					<record>
						<CODE>23</CODE>
						<VALUE>23</VALUE>
					</record>
					<record>
						<CODE>24</CODE>
						<VALUE>24</VALUE>
					</record>
					<record>
						<CODE>25</CODE>
						<VALUE>25</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" type="STRING"/>
					<colinfo id="ALL_YN" size="1" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10040</CD_GRP_ID>
						<DESCRIPTION>경주방식</DESCRIPTION>
						<DSNAME>dsRaceMethCode</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10039</CD_GRP_ID>
						<DESCRIPTION>대진방식</DESCRIPTION>
						<DSNAME>dsMatMethCode</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10041</CD_GRP_ID>
						<DESCRIPTION>경주회차</DESCRIPTION>
						<DSNAME>dsRaceRnd</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10032</CD_GRP_ID>
						<DESCRIPTION>경주등급</DESCRIPTION>
						<DSNAME>dsRaceGrd</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10079</CD_GRP_ID>
						<DESCRIPTION>전법</DESCRIPTION>
						<DSNAME>dsStrategy</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10034</CD_GRP_ID>
						<DESCRIPTION>각질</DESCRIPTION>
						<DSNAME>dsLegType</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10042</CD_GRP_ID>
						<DESCRIPTION>시행경주급</DESCRIPTION>
						<DSNAME>dsRaceCode</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRaceGrd">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRaceRnd">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRaceYy">
				<Contents>
					<colinfo id="RACE_YY" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRaceMethCode">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMatMethCode">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDetlRaceScheValue">
				<Contents>
					<colinfo id="RACE_YY" size="256" type="STRING"/>
					<colinfo id="ROUND" size="256" type="STRING"/>
					<colinfo id="MAT_METH" size="256" type="STRING"/>
					<colinfo id="RACE_METH" size="256" type="STRING"/>
					<colinfo id="RACE_CNT" size="256" type="STRING"/>
					<colinfo id="RACE_DT" size="256" type="STRING"/>
					<colinfo id="AM_PM_GBN" size="256" type="STRING"/>
					<colinfo id="RACER_CNT" size="256" type="STRING"/>
					<colinfo id="SELT_ROUND" size="256" type="STRING"/>
					<colinfo id="N_AM_PM_GBN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsGroupOrg">
				<Contents>
					<colinfo id="RACE_YY" size="256" type="STRING"/>
					<colinfo id="ROUND" size="256" type="STRING"/>
					<colinfo id="CAND_NO" size="256" type="STRING"/>
					<colinfo id="MAT_CD" size="256" type="STRING"/>
					<colinfo id="RACE_GRD_CD" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="BACK_NO" size="256" type="STRING"/>
					<colinfo id="GEAR_RATE" size="256" type="STRING"/>
					<colinfo id="TOT_AVG" size="256" type="STRING"/>
					<colinfo id="GRD" size="256" type="STRING"/>
					<colinfo id="STRATEGY" size="256" type="STRING"/>
					<colinfo id="LEG_TPE" size="256" type="STRING"/>
					<colinfo id="WIN_RATE" size="256" type="STRING"/>
					<colinfo id="HIGH_RANK_RATE" size="256" type="STRING"/>
					<colinfo id="RANK1_CNT" size="256" type="STRING"/>
					<colinfo id="RANK2_CNT" size="256" type="STRING"/>
					<colinfo id="RANK3_CNT" size="256" type="STRING"/>
					<colinfo id="RANK_OUT" size="256" type="STRING"/>
					<colinfo id="ELIM1_CNT" size="256" type="STRING"/>
					<colinfo id="ELIM2_CNT" size="256" type="STRING"/>
					<colinfo id="ELIM3_CNT" size="256" type="STRING"/>
					<colinfo id="TOT_RANK" size="256" type="STRING"/>
					<colinfo id="ESTM_SCR" size="256" type="STRING"/>
					<colinfo id="BF_ROUND" size="256" type="STRING"/>
					<colinfo id="YY_AVG_RACE_SCR" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="BF_RACE" size="256" type="STRING"/>
					<colinfo id="RANK4_CNT" size="256" type="STRING"/>
					<colinfo id="RANK5_CNT" size="256" type="STRING"/>
					<colinfo id="RANK6_CNT" size="256" type="STRING"/>
					<colinfo id="RANK7_CNT" size="256" type="STRING"/>
					<colinfo id="LIFE_BASE" size="256" type="STRING"/>
					<colinfo id="AGE" size="256" type="STRING"/>
					<colinfo id="TOT_POINT" size="256" type="STRING"/>
					<colinfo id="DCSN_GBN" size="256" type="STRING"/>
					<colinfo id="PROP_SCR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsStrategy">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsLegType">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRaceCode">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsAssignListValue" OnColumnChanged="dsAssignListValue_OnColumnChanged" OnRowPosChanged="fcGetMenuDetailBefore">
				<Contents>
					<colinfo id="MAT_CD" size="256" type="STRING"/>
					<colinfo id="STLT_RACE_GRD_CD" size="256" type="STRING"/>
					<colinfo id="ADV_RACE_GRD_CD" size="256" type="STRING"/>
					<colinfo id="STR_RANK" size="256" type="STRING"/>
					<colinfo id="END_RANK" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="EQU_RANK" size="256" type="STRING"/>
					<colinfo id="EQU_RANK_NO" size="256" type="STRING"/>
					<colinfo id="NUM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCheck1">
				<Contents>
					<colinfo id="MAT_CD" size="256" type="STRING"/>
					<colinfo id="RACE_GRD_CD" size="256" type="STRING"/>
					<colinfo id="RACE_CNT" size="256" type="STRING"/>
					<colinfo id="GRD" size="256" type="STRING"/>
					<colinfo id="STR_RANK" size="256" type="STRING"/>
					<colinfo id="END_RANK" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="EQU_RANK" size="256" type="STRING"/>
					<colinfo id="EQU_RANK_NO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRound">
				<Contents>
					<colinfo id="ROUND" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsYear">
				<Contents>
					<colinfo id="YY" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRacePrint">
				<Contents>
					<colinfo id="RACE_YY" size="256" type="STRING"/>
					<colinfo id="ROUND" size="256" type="STRING"/>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACE_GRD_CD" size="256" type="STRING"/>
					<colinfo id="STR_TIME" size="256" type="STRING"/>
					<colinfo id="CCIT_CNT" size="256" type="STRING"/>
					<colinfo id="CAND_NM" size="256" type="STRING"/>
					<colinfo id="RACELEN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRacePoint">
				<Contents>
					<colinfo id="RACE_NO" size="256" type="STRING"/>
					<colinfo id="RACER_NO" size="256" type="STRING"/>
					<colinfo id="TOT_POINT" size="256" type="STRING"/>
					<colinfo id="SCR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDcsnGbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="VALUE" size="256" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<VALUE>O</VALUE>
					</record>
					<record>
						<CODE>1</CODE>
						<VALUE>X</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCfmFg">
				<Contents>
					<colinfo id="CFM_FG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsGrdScr">
				<Contents>
					<colinfo id="GRD" size="256" type="STRING"/>
					<colinfo id="PROP_SCR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="3" Top="8" Width="17"></Image>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="2" Text="조회조건" Top="6" VAlign="Middle" Width="132"></Static>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" Right="1008" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="1" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Div Height="20" Id="divBtnLst" Left="678" TabOrder="4" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Height="20" Id="Button1" ImageID="btn_pop_txt_05" Left="934" Style="snis_btn" TabOrder="5" Text="대상자출력" Top="66" Transparent="TRUE" Visible="FALSE" Width="74"></Button>
		<Button ButtonStyle="TRUE" Height="20" Id="edPrint" ImageID="btn_pop_txt_05" Left="928" OnClick="edPrint_OnClick" Style="snis_btn" TabOrder="6" Text="출주표출력" Top="64" Transparent="TRUE" Width="74"></Button>
		<Button ButtonStyle="TRUE" Height="20" Id="btnAutoSet" ImageID="btn_pop_txt_04" Left="864" OnClick="btnAutoSet_OnClick" Style="snis_btn" TabOrder="7" Text="자동배정" Top="64" Transparent="TRUE" Width="62"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="dsGroupOrg" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="584" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="440" Id="grdGroupOrg" InputPanel="FALSE" Left="8" LineColor="user18" OnHeadClick="fcGridSort" Right="1010" SelColor="user19" Style="snis_grid" TabOrder="8" TabStop="true" Top="144" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1002">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="41"/>
						<col fix="left" width="34"/>
						<col fix="left" width="34"/>
						<col fix="left" width="50"/>
						<col fix="left" width="62"/>
						<col fix="left" width="47"/>
						<col fix="left" width="45"/>
						<col fix="left" width="87"/>
						<col fix="left" width="42"/>
						<col fix="left" width="90"/>
						<col width="68"/>
						<col width="69"/>
						<col width="69"/>
						<col width="49"/>
						<col width="42"/>
						<col width="42"/>
						<col width="90"/>
						<col width="90"/>
						<col width="45"/>
						<col width="38"/>
						<col width="40"/>
						<col width="46"/>
						<col width="43"/>
						<col width="38"/>
						<col width="43"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="순번"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="확정"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="회차"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="대진표"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="경주급"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="조번호"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="배번"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="등록번호"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="기수"/>
						<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" text="성명"/>
						<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" text="기어배수"/>
						<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9" text="순위용점수"/>
						<cell bkcolor="user20" col="12" color="user21" display="text" font="굴림,9" text="총평균"/>
						<cell bkcolor="user20" col="13" color="user21" display="text" font="굴림,9" text="등급"/>
						<cell bkcolor="user20" col="14" color="user21" display="text" font="굴림,9" text="전법"/>
						<cell bkcolor="user20" col="15" color="user21" display="text" font="굴림,9" text="각질"/>
						<cell bkcolor="user20" col="16" color="user21" display="text" font="굴림,9" text="승률"/>
						<cell bkcolor="user20" col="17" color="user21" display="text" font="굴림,9" text="연대율"/>
						<cell bkcolor="user20" col="18" color="user21" display="text" font="굴림,9" text="1착"/>
						<cell bkcolor="user20" col="19" color="user21" display="text" font="굴림,9" text="2착"/>
						<cell bkcolor="user20" col="20" color="user21" display="text" font="굴림,9" text="3착"/>
						<cell bkcolor="user20" col="21" color="user21" display="text" font="굴림,9" text="착외"/>
						<cell bkcolor="user20" col="22" color="user21" display="text" font="굴림,9" text="실격"/>
						<cell bkcolor="user20" col="23" color="user21" display="text" font="굴림,9" text="경고"/>
						<cell bkcolor="user20" col="24" color="user21" display="text" font="굴림,9" text="주의"/>
						<cell bkcolor="user20" col="25" color="user21" display="text" font="굴림,9" text="총순위"/>
						<cell bkcolor="user20" col="26" color="user21" display="text" font="굴림,9" text="평가점"/>
						<cell bkcolor="user20" col="27" color="user21" display="text" font="굴림,9" text="전회차"/>
						<cell bkcolor="user20" col="28" color="user21" display="text" font="굴림,9" text="전회성적"/>
					</head>
					<body>
						<cell align="center" col="0" colid="NUM" display="text"/>
						<cell align="center" col="1" colid="DCSN_GBN" combocol="CODE" combodataset="dsDcsnGbn" combotext="VALUE" display="combo" edit="combo"/>
						<cell align="center" col="2" colid="ROUND" display="text"/>
						<cell align="center" col="3" colid="MAT_CD" display="text"/>
						<cell align="center" col="4" colid="RACE_GRD_CD" combocol="cD" combodataset="dsRaceCode" combotext="CD_NM" display="combo"/>
						<cell align="center" col="5" colid="RACE_NO" display="text"/>
						<cell align="center" col="6" colid="BACK_NO" display="text"/>
						<cell align="center" col="7" colid="CAND_NO" display="text"/>
						<cell align="center" col="8" colid="RACER_PERIO_NO" display="text"/>
						<cell align="center" col="9" colid="NM_KOR" display="text"/>
						<cell align="center" col="10" colid="GEAR_RATE" display="text" edit="number" limit="1" LimitDec="2" Mask="#.##"/>
						<cell col="11" colid="TOT_AVG" display="text"/>
						<cell align="center" col="12" colid="AVG_P" display="text"/>
						<cell align="center" col="13" colid="GRD" combocol="CD" combodataset="dsRaceGrd" combotext="CD_NM" display="combo"/>
						<cell align="center" col="14" colid="STRATEGY" combocol="CD" combodataset="dsStrategy" combotext="CD_NM" display="combo"/>
						<cell align="center" col="15" colid="LEG_TPE" combocol="CD" combodataset="dsLegType" combotext="CD_NM" display="combo"/>
						<cell align="center" col="16" colid="WIN_RATE" display="text" limit="1" LimitDec="3"/>
						<cell align="center" col="17" colid="HIGH_RANK_RATE" display="text" limit="1" LimitDec="3"/>
						<cell align="center" col="18" colid="RANK1_CNT" display="text"/>
						<cell align="center" col="19" colid="RANK2_CNT" display="text"/>
						<cell align="center" col="20" colid="RANK3_CNT" display="text"/>
						<cell align="center" col="21" colid="RANK_OUT" display="text"/>
						<cell align="center" col="22" colid="ELIM1_CNT" display="text"/>
						<cell align="center" col="23" colid="ELIM2_CNT" display="text"/>
						<cell align="center" col="24" colid="ELIM3_CNT" display="text"/>
						<cell align="center" col="25" colid="TOT_RANK" display="text"/>
						<cell align="center" col="26" colid="ESTM_SCR" display="text"/>
						<cell align="center" col="27" colid="BF_ROUND" display="text"/>
						<cell align="center" col="28" colid="BF_RACE" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Cursor="HAND" Height="20" Id="btnSearch" ImageID="btn_search_b" Left="240" OnClick="fcSearch" TabOrder="9" Text="조회" Top="32" Transparent="TRUE" Width="50"></Button>
		<Static Align="Right" Height="20" Id="Static6" Left="12" Style="snis_if_lable" TabOrder="10" Text="년도" Top="34" VAlign="Middle" Width="40"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="124" Style="snis_if_lable" TabOrder="11" Text="회차" Top="34" VAlign="Middle" Width="40"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsDetlRaceScheValue" BKColor="user15" BkColor2="user16" BkSelColor="user15" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="137" Editable="TRUE" Enable="true" EndLineColor="default" FillArea="TRUE" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grdDetailRndRace" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" Right="1010" RowHeight="20" SelColor="ACTIVECAPTION" Style="snis_grid" TabOrder="12" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1002">
			<contents>
				<format id="Default">
					<columns>
						<col width="150"/>
						<col width="150"/>
						<col width="150"/>
						<col width="150"/>
						<col width="190"/>
						<col width="150"/>
						<col width="150"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="날짜"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="오전/오후"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="선발회차"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="대진방식"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="경주방식"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="경주수"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="차립수"/>
					</head>
					<body>
						<cell align="center" col="0" colid="RACE_DT" display="date"/>
						<cell align="center" col="1" colid="AM_PM_GBN" combocol="CD" combodataset="dsRaceRnd" combotext="CD_NM" display="combo"/>
						<cell align="center" col="2" colid="SELT_ROUND" display="combo"/>
						<cell align="center" col="3" colid="MAT_METH" combocol="CD" combodataset="dsMatMethCode" combotext="CD_NM" display="combo"/>
						<cell align="center" col="4" colid="RACE_METH" combocol="CD" combodataset="dsRaceMethCode" combotext="CD_NM" display="combo"/>
						<cell align="center" col="5" colid="RACE_CNT" display="text"/>
						<cell align="center" col="6" colid="RACER_CNT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Combo Border="Flat" BorderColor="user1" CodeColumn="YY" DataColumn="YY" Editable="TRUE" Height="20" Id="cboYear" INDEX="0" InnerDataset="dsYear" Left="56" OnChanged="cboYear_OnChanged" Style="snis_m_input01" TabOrder="13" Top="33" Width="62"></Combo>
		<Combo Border="Flat" CodeColumn="ROUND" DataColumn="ROUND" Editable="TRUE" Height="20" Id="cboRound" INDEX="0" InnerDataset="dsRound" Left="164" OnChanged="cboRound_OnChanged" Style="snis_if_input01" TabOrder="14" Top="33" Width="70"></Combo>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsRacePoint" BKColor="user15" BkColor2="user16" BkSelColor="user15" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="544" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grdRacePoint" InputPanel="FALSE" Left="40" LineColor="user18" MinWidth="100" Right="328" RowHeight="20" SelColor="ACTIVECAPTION" Style="snis_grid" TabOrder="15" TabStop="true" Top="376" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="288">
			<contents>
				<format id="Default">
					<columns>
						<col width="150"/>
						<col width="150"/>
						<col width="150"/>
						<col width="150"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="고유점수"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="포인트"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="경주수"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="차립수"/>
					</head>
					<body>
						<cell align="center" col="0" colid="SCR" display="text"/>
						<cell align="center" col="1" colid="TOT_POINT" display="text"/>
						<cell align="center" col="2" colid="RACE_NO" display="text"/>
						<cell align="center" col="3" colid="RACER_NO" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsCheck1" BKColor="user15" BkColor2="user16" BkSelColor="user15" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="544" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grdCheck1" InputPanel="FALSE" Left="352" LineColor="user18" MinWidth="100" Right="640" RowHeight="20" SelColor="ACTIVECAPTION" Style="snis_grid" TabOrder="16" TabStop="true" Top="376" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="288">
			<contents>
				<format id="Default">
					<columns>
						<col width="150"/>
						<col width="150"/>
						<col width="150"/>
						<col width="150"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="대진"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="경주급"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="경주수"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="차립수"/>
					</head>
					<body>
						<cell align="center" col="0" colid="MAT_CD" display="text"/>
						<cell align="center" col="1" colid="RACE_GRD_CD" display="text"/>
						<cell align="center" col="2" colid="RACE_NO" display="text"/>
						<cell align="center" col="3" colid="RACE_CNT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsGrdScr" BKColor="user15" BkColor2="user16" BkSelColor="user15" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="544" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grdGrdScr" InputPanel="FALSE" Left="656" LineColor="user18" MinWidth="100" Right="944" RowHeight="20" SelColor="ACTIVECAPTION" Style="snis_grid" TabOrder="17" TabStop="true" Top="376" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="288">
			<contents>
				<format id="Default">
					<columns>
						<col width="150"/>
						<col width="150"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="등급"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="점수"/>
					</head>
					<body>
						<cell align="center" col="0" colid="GRD" display="text"/>
						<cell align="center" col="1" colid="PROP_SCR" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::can_common_script.js";
#include "lib::can_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'D02000025';
var sBUTTONLIST   = 'FTFTFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var sLastPeriodNo = "";                         	  // 현재의 최종기수보관
//var sMenuListNum    = "0";                          // 메뉴리스트의 갯수보관
//var sMenuUpId       = "";
//var sMenuUpNm       = "";
var sTotalCnt 	= 0;
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj)
{	
	//사용자 권한 설정
    sBUTTONLIST   = 'F'+sInpt+'FTFT';
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);

    fcd_GetComboDs(dsInComCd);
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "";//dsDetlRaceScheValue|dsGroupOrg";
	if (   !fnc_FormUnloadCheck(sDataset  , sFormId) ) return false;
}
/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearch(){
	cboRound_OnChanged();
	/*
	var sServiceName = "d02000025-service:searchGroupCandAssign";
    var sInDataSet   = "";
    var sOutDataSet  = " dsGroupOrg=dsGroupOrg ";  
    
	fcd_AddParam(trim("Raceyy"),cboYear.Value);
	fcd_AddParam(trim("RaceRndNo"),cboRound.Value);
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false); 
	*/
   // fnc_DataSetPrint(dsGroupOrg);
	}
/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {
      
    if(fnc_isNull(cboYear.Value)) {
            fnc_Message(SNIS_COM_1034, "N", "년도");
            cboYear.SetFocus();
            return false;
    }
    if(fnc_isNull(cboRound.Value)) {
            fnc_Message(SNIS_COM_1034, "N", "회차");
            cboRoundFrom.SetFocus();
            return false;
    }
    
    if(dsDetlRaceScheValue.GetColumn(0,"RACE_METH") != "003"){
		    fnc_Message(SNIS_CAN_J001 , "N", "");
			return false;
    }
    
    if ( dsCfmFg.getcolumn(0,"CFM_FG") == "Y"  ){  // 확정flag
			fnc_Message(SNIS_CAN_D013, "N", "조편성");
			return false;
    }
    return true;
}
function fcSave(obj){

	if ( !fcSaveCheck(obj) ) return;
	
	var sServiceName = "d02000025-service:saveGroupOrg";
    var sInDataSet   = " dsGroupOrg=dsGroupOrg ";      
    var sOutDataSet  = " dsGroupOrg=dsGroupOrg ";
   // fnc_DataSetPrint(dsGroupOrg);
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
	
}

/*-------------------------------------------------------------------------------------------------+
>>  엑셀버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/

function fcToExcel(obj) {
    var sExcelList = "grdDetailRndRace:세부시행일정|grdGroupOrg:조편성명단";
    fcd_OpenExcelListExport(sExcelList);
}
/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}
/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}
	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}
/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/

function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
    
    if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
	if ( sServiceName == "common-service:searchCode" ) {
    	fcd_GetYear();					                  // 년도 조회 
		fcd_GetRound(cboYear.value); 
    }
    if ( sServiceName == "common-service:searchRound" ) {
		 cboRound_OnChanged();
    }
    if ( sServiceName == "d02000025-service:searchCfmFg" ) {
		 /*
		  if ( dsCfmFg.getcolumn(0,"CFM_FG") != "Y"  ){
			TotPoint(); 
			}
		*/
		TotPoint(); 
    }
	if(sServiceName = "d02000025-service:searchDetailRace"){
	      		
		for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){
			dsGroupOrg.SetColumn(i,"NUM",i+1); }
		
		  var sServiceName1 = "";
		  
		  if ( dsDetlRaceScheValue.GetColumnNF(0,"RACE_METH") =="003"){ 
			   // 일자별
			   sServiceName1 = "d02000025-service:searchDetailRaceCnt1";	
			   }
			   else{
			  // 수정토너먼트
			   sServiceName1 = "d02000025-service:searchDetailRaceCnt2"; // 배정 프로그램 불필요 (경주급배정에서 조편성)	
			   }
			  
			  var sInDataSet   = "";
			  var sOutDataSet  = " dsCheck1=dsCheck1" ; // dsGroupOrg=dsGroupOrg dsCheck1=dsCheck1";  
			  
			  fcd_AddParam(trim("Raceyy"),cboYear.Value);
			  fcd_AddParam(trim("RaceRndNo"),cboRound.Value);
			  
			  fcd_SendTransaction(sServiceName1, sInDataSet, sOutDataSet, "fcCallBack", false);
			  
			  fcSearchCfmFg(); 
			  
	}
	
	if(sServiceName = "d02000025-service:searchGroupOrg"){//자동배정시
		for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){
			dsGroupOrg.SetColumn(i,"NUM",i+1);
		}
		//경주번호 배번 확정(일차별 경주만)
		for (j = 0; j < dsCheck1.getrowCount();j++){
		var back_no = 0;
			for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){			
				if(dsCheck1.getColumn(j,"RACE_GRD_CD") == dsGroupOrg.getColumn(i,"RACE_GRD_CD")){
					dsGroupOrg.SetColumn(i,"BACK_NO",floor(toInteger(back_no)/toInteger(dsCheck1.getColumn(j,"RACE_CNT"))+1));
					dsGroupOrg.setColumn(i,"RACE_NO", toInteger(back_no)% toInteger(dsCheck1.getColumn(j,"RACE_CNT")) + 1  +(j * toInteger(dsCheck1.getColumn(j,"RACE_CNT"))));
					
					back_no++;
				}
			}
		}
		// 배정후 저장
		// fcSave(dsGroupOrg);
	}
	if(sServiceName = "d02000025-service:searchGroupOrg1"){//자동배정시
        var GrdS_Cnt = 0;
        var GrdA_Cnt = 0;
		for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){
			dsGroupOrg.SetColumn(i,"NUM",i+1);
			if(dsGroupOrg.getColumn(i,"GRD")=="001"){
				GrdS_Cnt++;
			}else{
				GrdA_Cnt++;
			}
		}
	
		var back_1 = 1;
		var back_2 = 1;
		var back_3 = 1;
		var back_4 = 1;
		
		for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){	
						
			var race_no = dsCheck1.GetRowCount();
			if((GrdS_Cnt/2)>i){
				race_no = dsCheck1.GetRowCount();
				dsGroupOrg.setColumn(i,"BACK_NO", back_1);
				dsGroupOrg.setColumn(i,"RACE_GRD_CD", dsCheck1.GetColumn(2,"RACE_GRD_CD"));
				back_1++;
			}
			if(((GrdS_Cnt/2)<= i)&&(GrdS_Cnt>i)){
				race_no = dsCheck1.GetRowCount() -1;
				dsGroupOrg.setColumn(i,"BACK_NO", back_2);
				dsGroupOrg.setColumn(i,"RACE_GRD_CD", dsCheck1.GetColumn(3,"RACE_GRD_CD"));
				back_2++;
			}
			if((GrdS_Cnt<=i)&& ((grdS_Cnt+(GrdA_Cnt/2)) >i)){
				race_no = dsCheck1.GetRowCount() -2;
				dsGroupOrg.setColumn(i,"BACK_NO", back_3);
				dsGroupOrg.setColumn(i,"RACE_GRD_CD", dsCheck1.GetColumn(0,"RACE_GRD_CD"));
				back_3++;
			}
			if(grdS_Cnt+(GrdA_Cnt/2) <=i){
				race_no = dsCheck1.GetRowCount() -3;
				dsGroupOrg.setColumn(i,"BACK_NO", back_4);
				dsGroupOrg.setColumn(i,"RACE_GRD_CD", dsCheck1.GetColumn(1,"RACE_GRD_CD"));
				back_4++;
			}
			dsGroupOrg.setColumn(i,"RACE_NO", race_no);

		}
		
	
		// 배정후 저장
		// fcSave(dsGroupOrg);
	}
	/*
	if(sServiceName = "d02000025-service:searchGroupCandAssign"){ //편성된 내용보기
		
		for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){
			dsGroupOrg.SetColumn(i,"NUM",i+1);
		}	
		TotPoint();
	}
	*/	
	if(sServiceName = "d02000025-service:saveGroupOrg"){
		
		fcSearch();
	}
	
	if(sServiceName = "d02000025-service:searchRaceDetailPrint"){  // 출력시 각 경주별 정보
		
		//fnc_DataSetPrint(dsDetlRaceScheValue);
		var logImgUrl = GBL_REPORT_URL+"log.jpg";
		var sSubUrl   = "";                     			//레포트 파일이 있는 서브디렉토리
		var sRptNm    = "d02000025_racer_list.jrf";        	//레포트 파일명
		var sDataSet  = " dsDetlRaceScheValue=dsDetlRaceScheValue dsRacePrint=dsRacePrint dsGroupOrg=dsGroupOrg ";   	//"UBI 쿼리명, MIP Dataset명"
		var sArg      = "Raceyy="+cboYear.Value +"RaceRndNo="+cboRound.Value ; 
		
		var sRptDrct  = 1;                               	//출력방향(0 : 수직, 1 : 수평)
	
		fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
	}
	
	fcPostProcess(sServiceName);
	
	//trace(dsGroupOrg.SaveXML());
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {
} 
function btnAutoSet_OnClick(obj) // 자동배정
{
    
	//if ( !fcSaveCheck(obj) ) return;
	
	var confirmMsg = Confirm("조편성을 하시겠습니까???");
	
	if ( confirmMsg ) {
		var sServiceName = "";
		var sInDataSet   = "";
		var sOutDataSet  = "";
	  	if ( dsDetlRaceScheValue.GetColumnNF(0,"RACE_METH") =="002"){ //수정토너먼트
			 sServiceName = "d02000025-service:searchGroupOrg1";
			 sInDataSet   = "";
			 sOutDataSet  = " dsGroupOrg=dsGroupOrg ";  
		}else{//일차
			 sServiceName = "d02000025-service:searchGroupOrg";
			 sInDataSet   = "";
			 sOutDataSet  = " dsGroupOrg=dsGroupOrg ";  
		}
		fcd_AddParam(trim("Raceyy"),cboYear.Value);
		fcd_AddParam(trim("RaceRndNo"),cboRound.Value);
		
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false); 
	
	}
	
}

function cboRound_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	var sServiceName = "d02000025-service:searchDetailRace";
    var sInDataSet   = "";
    var sOutDataSet  = " dsDetlRaceScheValue=dsDetlRaceScheValue dsGroupOrg=dsGroupOrg dsGrdScr=dsGrdScr";//dsCheck1=dsCheck1";  
	fcd_AddParam(trim("Raceyy"),cboYear.Value);
	fcd_AddParam(trim("RaceRndNo"),cboRound.Value); 
	
		
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false); 
}


function cboYear_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fcd_GetRound(strText); 
	cboRound.Index = 0 ; 
	fcSearch();
}
/*-------------------------------------------------------------------------------------------------+
>>  인쇄 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function edPrint_OnClick(obj)
{

	var sServiceName = "d02000025-service:searchRaceDetailPrint";
    var sInDataSet   = "";
    var sOutDataSet  = " dsRacePrint=dsRacePrint ";
    
	fcd_AddParam(trim("Raceyy"),cboYear.Value);
	fcd_AddParam(trim("RaceRndNo"),trim(cboRound.Value));
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false); 

}
function TotPoint(){
	    //순위 득점계산
     
    var point,racer = 0;
    var race_cnt = dsDetlRaceScheValue.getColumn(0,"RACE_CNT");
    dsRacePoint.ClearData();
	for(var j = 0; j < race_cnt;j++){
		
		grd = "";
		point = 0;
		racer = 0;
		racer1 = 0;
		dsRacePoint.AddRow();
		//2008.10.08 추가
        var prop_scr = 0 ;
        var prop_scr_cnt = 0 ;
        var race_no = 0 ;
        ///////////////////////
		for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){	
			if(j+1 == dsGroupOrg.getColumn(i,"RACE_NO")){
				grd = dsGroupOrg.getColumn(i,"GRD");
				point = point + toInteger(dsGroupOrg.getColumn(i,"TOT_AVG"));
				if(toInteger(dsGroupOrg.getColumn(i,"TOT_AVG")) !=0){
					racer1 = racer1 + 1;
				}
				racer = racer + 1;
			}
			//////////////////////////////////////////////////////////////////////////////////////////
			for (k = 0;k < dsGrdScr.getRowCount(); k++){
				if (grd == trim(dsGrdScr.getColumn(k,"GRD"))){
					dsRacePoint.setColumn(j,"SCR",toNumber(dsGrdScr.getColumn(k,"PROP_SCR")));
				}
			}
			//////////////////////////////////////////////////////////////////////////////////////////
			if ( dsDetlRaceScheValue.GetColumnNF(0,"RACE_METH") =="003"){//일차별
				 //2008.10.08 수정
				    if(race_no != dsGroupOrg.getColumn(i,"RACE_NO")){
						prop_scr = 0;
						prop_scr_cnt = 0;
				    }
				    var prop_tmp = dsGroupOrg.getColumn(i,"PROP_SCR");
				    prop_scr = prop_scr + prop_tmp;
				    prop_scr_cnt++;
				    dsRacePoint.setColumn(dsGroupOrg.getColumn(i,"RACE_NO")-1,"TOT_POINT",Round(prop_scr/prop_scr_cnt,3)); 
				    race_no = dsGroupOrg.getColumn(i,"RACE_NO");

			}else{
				dsRacePoint.setColumn(j,"TOT_POINT",round(point/racer1,3));
			}
			//////////////////////////////////////////////////////////////////////////////////////////
			dsRacePoint.setColumn(j,"RACE_NO",j+1);
			dsRacePoint.setColumn(j,"RACER_NO",racer);
		}//FOR
	}//FOR
	
   
    var a = 0;
    
    for(var j = 0; j < dsRacePoint.GetRowCount(); j++){	
    	
    	if(dsRacePoint.getColumn(j,"RACER_NO") == 7){
			a = 6;
		}else{
			a = 5;
		}
		for(var i = 0; i < dsGroupOrg.GetRowCount(); i++){	
			if(dsRacePoint.getColumn(j,"RACE_NO") == dsGroupOrg.getColumn(i,"RACE_NO")){
				if(cboRound.Value = '1'){ // 1회차일 경우 고유점수로 나타낸다.
				 dsGroupOrg.setColumn(i,"TOT_POINT",toNumber(dsRacePoint.getColumn(j,"SCR")) + a);
				}
				else{
				 dsGroupOrg.setColumn(i,"TOT_POINT",toNumber(dsRacePoint.getColumn(j,"TOT_POINT")) + a);
				}
				 a = a - 2;
			}//if
		}//for
    }//for
    
}
//확정 flag 조회 
function fcSearchCfmFg(){
   
	var sServiceName = "d02000025-service:searchCfmFg";
    var sInDataSet   = "";    
	var sOutDataSet  = "dsCfmFg=dsCfmFg" ; 
  
	fcd_AddParam(Trim("RACE_YY"), cboYear.value);
	fcd_AddParam(Trim("ROUND"), cboRound.value);
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	//fnc_DataSetPrint(dsCfmFg);

}
function fcGridSort(obj,nCell,nX,nY,nPivotIndex)
{
	fnc_GridSort(obj, object(obj.BindDataset), nCell);
}
]]></Script>
</Window>