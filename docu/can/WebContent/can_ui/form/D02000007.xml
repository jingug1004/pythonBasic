<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="D02000007" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="1차&#32;선발&#32;시험" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsPerioNo">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="dsFstExamCycle">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="EXAM_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="CAND_NO" size="256" type="STRING"/>
					<colinfo id="DT" size="256" type="STRING"/>
					<colinfo id="REC" size="256" type="STRING"/>
					<colinfo id="SCR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFstExamRateBas">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="EXAM_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="FST_ASSIGN_SCR_RATE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFstExamIsUse">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="EXAM_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="FST_ESTM_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPerioExam1" OnColumnChanged="dsPerioExam1_OnColumnChanged">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="EXAM_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="CAND_NO" size="256" type="STRING"/>
					<colinfo id="DT" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="REC_200" size="256" type="STRING"/>
					<colinfo id="SCR_200" size="256" type="STRING"/>
					<colinfo id="REC_333" size="256" type="STRING"/>
					<colinfo id="SCR_333" size="256" type="STRING"/>
					<colinfo id="REC_500" size="256" type="STRING"/>
					<colinfo id="SCR_500" size="256" type="STRING"/>
					<colinfo id="REC_1000" size="256" type="STRING"/>
					<colinfo id="SCR_1000" size="256" type="STRING"/>
					<colinfo id="REC_2000" size="256" type="STRING"/>
					<colinfo id="SCR_2000" size="256" type="STRING"/>
					<colinfo id="TOT_SCR" size="256" type="STRING"/>
					<colinfo id="AVG_SCR" size="256" type="STRING"/>
					<colinfo id="CHNG_SCR" size="256" type="STRING"/>
					<colinfo id="RANK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsExamChng">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="EXAM_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="BAS100TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS100_SCR" size="256" type="STRING"/>
					<colinfo id="BAS95FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS95TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS95_SCR" size="256" type="STRING"/>
					<colinfo id="BAS90FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS90TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS90_SCR" size="256" type="STRING"/>
					<colinfo id="BAS85FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS85TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS85_SCR" size="256" type="STRING"/>
					<colinfo id="BAS80FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS80TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS80_SCR" size="256" type="STRING"/>
					<colinfo id="BAS75FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS75TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS75_SCR" size="256" type="STRING"/>
					<colinfo id="BAS70FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS70TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS70_SCR" size="256" type="STRING"/>
					<colinfo id="BAS65FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS65TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS65_SCR" size="256" type="STRING"/>
					<colinfo id="BAS60FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS60TO_SCR" size="256" type="STRING"/>
					<colinfo id="BAS60_SCR" size="256" type="STRING"/>
					<colinfo id="BAS0FROM_SCR" size="256" type="STRING"/>
					<colinfo id="BAS0_SCR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPerioExam2">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="EXAM_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="CAND_NO" size="256" type="STRING"/>
					<colinfo id="DT" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="GRIP_LEFT_REC" size="256" type="STRING"/>
					<colinfo id="GRIP_LEFT_SCR" size="256" type="STRING"/>
					<colinfo id="GRIP_RIGHT_REC" size="256" type="INT"/>
					<colinfo id="GRIP_RIGHT_SCR" size="256" type="INT"/>
					<colinfo id="GRIP_TOT_SCR" size="256" type="INT"/>
					<colinfo id="LEG_LEFT_REC" size="256" type="INT"/>
					<colinfo id="LEG_LEFT_SCR" size="256" type="INT"/>
					<colinfo id="LEG_LEFT_REC2" size="256" type="STRING"/>
					<colinfo id="LEG_LEFT_SCR2" size="256" type="STRING"/>
					<colinfo id="LEG_RIGHT_REC" size="256" type="INT"/>
					<colinfo id="LEG_RIGHT_SCR" size="256" type="INT"/>
					<colinfo id="LEG_RIGHT_REC2" size="256" type="STRING"/>
					<colinfo id="LEG_RIGHT_SCR2" size="256" type="STRING"/>
					<colinfo id="LEG_TOT_SCR" size="256" type="INT"/>
					<colinfo id="BELLY_REC" size="256" type="INT"/>
					<colinfo id="BELLY_SCR" size="256" type="INT"/>
					<colinfo id="MAX_PWR_REC" size="256" type="INT"/>
					<colinfo id="MAX_PWR_SCR" size="256" type="INT"/>
					<colinfo id="AVG_PWR_REC" size="256" type="INT"/>
					<colinfo id="AVG_PWR_SCR" size="256" type="STRING"/>
					<colinfo id="TIRE_IDX_REC" size="256" type="INT"/>
					<colinfo id="TIRE_IDX_SCR" size="256" type="STRING"/>
					<colinfo id="TURN_POINT_REC" size="256" type="INT"/>
					<colinfo id="MESUR_TOT_SCR" size="256" type="INT"/>
					<colinfo id="TOT_SCR" size="256" type="INT"/>
					<colinfo id="AVG_SCR" size="256" type="INT"/>
					<colinfo id="CHNG_SCR" size="256" type="INT"/>
					<colinfo id="RANK" size="256" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPerioExam3">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="CAND_NO" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="SCR_200" size="256" type="STRING"/>
					<colinfo id="SCR_333" size="256" type="STRING"/>
					<colinfo id="SCR_500" size="256" type="STRING"/>
					<colinfo id="SCR_1000" size="256" type="STRING"/>
					<colinfo id="SCR_2000" size="256" type="STRING"/>
					<colinfo id="GRIP_LEFT_SCR" size="256" type="STRING"/>
					<colinfo id="GRIP_RIGHT_SCR" size="256" type="STRING"/>
					<colinfo id="LEG_LEFT_SCR" size="256" type="STRING"/>
					<colinfo id="LEG_LEFT_SCR2" size="256" type="STRING"/>
					<colinfo id="LEG_RIGHT_SCR" size="256" type="STRING"/>
					<colinfo id="LEG_RIGHT_SCR2" size="256" type="STRING"/>
					<colinfo id="BELLY_SCR" size="256" type="STRING"/>
					<colinfo id="MAX_PWR_SCR" size="256" type="STRING"/>
					<colinfo id="AVG_PWR_SCR" size="256" type="STRING"/>
					<colinfo id="TIRE_IDX_SCR" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM3" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM1_TOT_SCR" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM1_CHNG_SCR" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM2_TOT_SCR" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM2_CHNG_SCR" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM3_CHNG_SCR" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM1_CNT" size="256" type="STRING"/>
					<colinfo id="PERIO_EXAM2_CNT" size="256" type="STRING"/>
					<colinfo id="TOTAL_CHNG_SCR" size="256" type="STRING"/>
					<colinfo id="RANK" size="256" type="STRING"/>
					<colinfo id="SUCCESS_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" type="STRING"/>
					<colinfo id="ALL_YN" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSuccessYn">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<record>
						<CD>A</CD>
						<CD_NM>전체</CD_NM>
					</record>
					<record>
						<CD>Y</CD>
						<CD_NM>합격</CD_NM>
					</record>
					<record>
						<CD>N</CD>
						<CD_NM>불합격</CD_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFstSeltExam2" OnColumnChanged="dsFstSeltExam2_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="EXAM_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="DT" size="256" type="STRING"/>
					<colinfo id="CAND_NO" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="REC_NOTE" size="256" type="STRING"/>
					<colinfo id="SCR_NOTE" size="256" type="STRING"/>
					<colinfo id="TOT_SCR" size="256" type="STRING"/>
					<colinfo id="AVG_SCR" size="256" type="STRING"/>
					<colinfo id="CHNG_SCR" size="256" type="STRING"/>
					<colinfo id="RANK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsUseItem">
				<Contents>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="FST_ESTM_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsUseGbnItem">
				<Contents>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="DT_STR" size="256" type="STRING"/>
					<colinfo id="DT_END" size="256" type="STRING"/>
					<colinfo id="A" size="256" type="STRING"/>
					<colinfo id="B" size="256" type="STRING"/>
					<colinfo id="C" size="256" type="STRING"/>
					<colinfo id="D" size="256" type="STRING"/>
					<colinfo id="E" size="256" type="STRING"/>
					<colinfo id="F" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSeltChng">
				<Contents>
					<colinfo id="ITEM_GBN_CD" size="256" type="STRING"/>
					<colinfo id="ITEM_CD" size="256" type="STRING"/>
					<colinfo id="BAS_SCR" size="256" type="STRING"/>
					<colinfo id="START_REC" size="256" type="STRING"/>
					<colinfo id="END_REC" size="256" type="STRING"/>
					<colinfo id="RATE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="4" Top="8" Width="17"></Image>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="2" Text="조회조건" Top="6" VAlign="Middle" Width="132"></Static>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" Right="1008" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="1" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Static Align="Right" Height="20" Id="Static6" Left="12" Style="snis_if_lable" TabOrder="3" Text="선발기수" Top="34" VAlign="Middle" Width="54"></Static>
		<Combo Border="Flat" CodeColumn="RACER_PERIO_NO" DataColumn="RACER_PERIO_NO" Height="20" Id="cbPerioNo" INDEX="0" InnerDataset="dsPerioNo" Left="69" Style="snis_if_input01" TabOrder="5" Top="33" Width="100"></Combo>
		<Div Height="20" Id="divBtnLst" Left="678" TabOrder="6" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Shape BKColor="#ff8500" Bottom="78" Height="6" Id="Shape1" Left="16" LineKind="Vertical" LineWidth="0" Right="22" RoundHeight="10" RoundWidth="10" TabOrder="8" Top="72" Type="Ellipse" Width="6"></Shape>
		<Static Height="20" Id="Static7" Left="24" Style="snis_m_stitle" TabOrder="7" Text="1차&#32;선발항목" Top="66" VAlign="Middle" Width="96"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="182" Style="snis_if_lable" TabOrder="10" Text="합격여부" Top="34" VAlign="Middle" Visible="FALSE" Width="56"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cbSuccessYn" INDEX="0" InnerDataset="dsSuccessYn" Left="243" OnChanged="cbPerioNo_OnChanged" Style="snis_if_input01" TabOrder="11" Top="33" Visible="FALSE" Width="100"></Combo>
		<Div BKColor="user0" Height="22" Id="divSearch" Left="175" TabOrder="12" Text="Div0" Top="34" Url="common::comButtonSearch.xml" Width="50">
			<Contents></Contents>
		</Div>
		<Tab Border="Flat" BorderColor="user40" Color="user41" Height="482" Id="tabMain" Left="6" MouseOverColor="user42" OnChanged="tabMain_OnChanged" OnClick="tabMain_OnClick" SelColor="user43" TabIndex="1" TabOrder="9" Top="102" Width="1002">
			<Contents>
				<TabPage BorderColor="black" Height="458" Id="tab1" ImageEdgeWidth="4" ImageID="m_tab_05" Left="2" TabOrder="80" Text="자전거실기" Top="22" Width="998">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsPerioExam1" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="452" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="448" Id="grdCycle" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="994" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="990">
						<contents>
							<format id="Default">
								<columns>
									<col width="40"/>
									<col width="90"/>
									<col width="70"/>
									<col width="70"/>
									<col width="45"/>
									<col width="70"/>
									<col width="45"/>
									<col width="70"/>
									<col width="45"/>
									<col width="70"/>
									<col width="45"/>
									<col width="70"/>
									<col width="45"/>
									<col width="55"/>
									<col width="55"/>
									<col width="55"/>
									<col width="45"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="순번"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="수험번호"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="성명"/>
									<cell bkcolor="user20" col="3" color="user21" colspan="2" display="text" font="굴림,9" text="200m"/>
									<cell bkcolor="user20" col="5" color="user21" colspan="2" display="text" font="굴림,9" text="333m"/>
									<cell bkcolor="user20" col="7" color="user21" colspan="2" display="text" font="굴림,9" text="500m"/>
									<cell bkcolor="user20" col="9" color="user21" colspan="2" display="text" font="굴림,9" text="1000m"/>
									<cell bkcolor="user20" col="11" color="user21" colspan="2" display="text" font="굴림,9" text="2000m"/>
									<cell bkcolor="user20" col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="합산점수"/>
									<cell bkcolor="user20" col="14" color="user21" display="text" font="굴림,9" rowspan="2" text="평균점수"/>
									<cell bkcolor="user20" col="15" color="user21" display="text" font="굴림,9" rowspan="2" text="환산점수"/>
									<cell bkcolor="user20" col="16" color="user21" display="text" font="굴림,9" rowspan="2" text="순위"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" row="1" text="기록"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" row="1" text="기록"/>
									<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" row="1" text="기록"/>
									<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" row="1" text="기록"/>
									<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9" row="1" text="기록"/>
									<cell bkcolor="user20" col="12" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow+1"/>
									<cell align="center" col="1" colid="CAND_NO" display="text"/>
									<cell align="center" col="2" colid="NM_KOR" display="text"/>
									<cell align="center" col="3" colid="REC_200" display="text" limit="6" Mask="##:##:##"/>
									<cell align="right" col="4" colid="SCR_200" display="number"/>
									<cell align="center" col="5" colid="REC_333" display="text" limit="6" Mask="##:##:##"/>
									<cell align="right" col="6" colid="SCR_333" display="number"/>
									<cell align="center" col="7" colid="REC_500" display="text" limit="6" Mask="##:##:##"/>
									<cell align="right" col="8" colid="SCR_500" display="number"/>
									<cell align="center" col="9" colid="REC_1000" display="text" limit="6" Mask="##:##:##"/>
									<cell align="right" col="10" colid="SCR_1000" display="number"/>
									<cell align="center" col="11" colid="REC_2000" display="text" limit="6" Mask="##:##:##"/>
									<cell align="right" col="12" colid="SCR_2000" display="number"/>
									<cell align="right" col="13" colid="TOT_SCR" display="number" expr="TONUMBER(SCR_200)&#32;+&#32;TONUMBER(SCR_333)&#32;+&#32;TONUMBER(SCR_500)&#32;+&#32;TONUMBER(SCR_1000)&#32;+&#32;TONUMBER(SCR_2000)" limit="3"/>
									<cell align="right" col="14" colid="AVG_SCR" display="number" limit="3"/>
									<cell align="right" col="15" colid="CHNG_SCR" display="number" limit="3"/>
									<cell align="center" col="16" colid="RANK" display="number"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="458" Id="tab2" ImageID="m_tab_05" Left="2" TabOrder="80" Text="체력측정" Top="22" Width="998">
					<Grid AutoEnter="TRUE" BindDataset="dsPerioExam2" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="452" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="448" Id="grdStrTest" InputPanel="FALSE" LineColor="user18" OnHeadClick="fcGridSort" Right="990" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="990">
						<contents>
							<format id="Default">
								<columns>
									<col width="40"/>
									<col width="70"/>
									<col width="65"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="50"/>
									<col width="70"/>
									<col width="50"/>
									<col width="60"/>
									<col width="50"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="50"/>
									<col width="55"/>
									<col width="55"/>
									<col width="55"/>
									<col width="40"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="순번"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="수험번호"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="성명"/>
									<cell bkcolor="user20" col="3" color="user21" colspan="4" display="text" font="굴림,9" text="악력(kg)"/>
									<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="총점"/>
									<cell bkcolor="user20" col="8" color="user21" colspan="8" display="text" font="굴림,9" text="각력(kg)"/>
									<cell bkcolor="user20" col="16" color="user21" display="text" font="굴림,9" rowspan="2" text="총점"/>
									<cell bkcolor="user20" col="17" color="user21" display="text" font="굴림,9" rowspan="2" text="배근력(kg)"/>
									<cell bkcolor="user20" col="18" color="user21" display="text" font="굴림,9" rowspan="2" text="총점"/>
									<cell bkcolor="user20" col="19" color="user21" colspan="6" display="text" font="굴림,9" text="무산소성&#32;운동측정"/>
									<cell bkcolor="user20" col="25" color="user21" display="text" font="굴림,9" rowspan="2" text="총점"/>
									<cell bkcolor="user20" col="26" color="user21" display="text" font="굴림,9" rowspan="2" text="합산점수"/>
									<cell bkcolor="user20" col="27" color="user21" display="text" font="굴림,9" rowspan="2" text="평균점수"/>
									<cell bkcolor="user20" col="28" color="user21" display="text" font="굴림,9" rowspan="2" text="환산점수"/>
									<cell bkcolor="user20" col="29" color="user21" display="text" font="굴림,9" rowspan="2" text="순위"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" row="1" text="좌"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" row="1" text="우"/>
									<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" row="1" text="굴근좌"/>
									<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" row="1" text="굴근우"/>
									<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="12" color="user21" display="text" font="굴림,9" row="1" text="신근좌"/>
									<cell bkcolor="user20" col="13" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="14" color="user21" display="text" font="굴림,9" row="1" text="신근우"/>
									<cell bkcolor="user20" col="15" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="19" color="user21" display="text" font="굴림,9" row="1" text="최대파워"/>
									<cell bkcolor="user20" col="20" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="21" color="user21" display="text" font="굴림,9" row="1" text="평균파워"/>
									<cell bkcolor="user20" col="22" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
									<cell bkcolor="user20" col="23" color="user21" display="text" font="굴림,9" row="1" text="피로지수"/>
									<cell bkcolor="user20" col="24" color="user21" display="text" font="굴림,9" row="1" text="점수"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow+1"/>
									<cell align="center" col="1" colid="CAND_NO" display="text"/>
									<cell align="center" col="2" colid="NM_KOR" display="text"/>
									<cell align="center" col="3" colid="GRIP_LEFT_REC" display="text" edit="mask" limit="4" Mask="##.##"/>
									<cell align="center" col="4" colid="GRIP_LEFT_SCR" display="number" limit="3"/>
									<cell align="center" col="5" colid="GRIP_RIGHT_REC" display="text" edit="mask" limit="4" Mask="##.##"/>
									<cell align="center" col="6" colid="GRIP_RIGHT_SCR" display="number" limit="3"/>
									<cell align="center" col="7" colid="GRIP_TOT_SCR" display="number" expr="TONUMBER(GRIP_LEFT_SCR)&#32;+&#32;TONUMBER(GRIP_RIGHT_SCR)" limit="3"/>
									<cell align="center" col="8" colid="LEG_LEFT_REC" display="text" edit="mask" limit="5" Mask="###.##"/>
									<cell align="center" col="9" colid="LEG_LEFT_SCR" display="number" limit="3"/>
									<cell align="center" col="10" colid="LEG_RIGHT_REC" display="text" edit="mask" limit="5" Mask="###.##"/>
									<cell align="center" col="11" colid="LEG_RIGHT_SCR" display="number" limit="3"/>
									<cell align="center" col="12" colid="LEG_LEFT_REC2" display="text" edit="mask" limit="5" Mask="###.##"/>
									<cell col="13" colid="LEG_LEFT_SCR2" display="text"/>
									<cell align="center" col="14" colid="LEG_RIGHT_REC2" display="text" edit="mask" limit="5" Mask="###.##"/>
									<cell align="center" col="15" colid="LEG_RIGHT_SCR2" display="number" limit="3"/>
									<cell align="center" col="16" colid="LEG_TOT_SCR" display="number" expr="TONUMBER(LEG_LEFT_SCR)&#32;+&#32;TONUMBER(LEG_RIGHT_SCR)+TONUMBER(LEG_LEFT_SCR2)&#32;+&#32;TONUMBER(LEG_RIGHT_SCR2)" limit="3"/>
									<cell align="center" col="17" colid="BELLY_REC" display="text" edit="mask" limit="5" Mask="###.##"/>
									<cell align="center" col="18" colid="BELLY_SCR" display="number" limit="3"/>
									<cell align="center" col="19" colid="MAX_PWR_REC" display="text" edit="mask" limit="4" Mask="##.##"/>
									<cell align="center" col="20" colid="MAX_PWR_SCR" display="number" limit="3"/>
									<cell align="center" col="21" colid="AVG_PWR_REC" display="text" edit="mask" limit="4" Mask="##.##"/>
									<cell align="center" col="22" colid="AVG_PWR_SCR" display="number" limit="3"/>
									<cell align="center" col="23" colid="TIRE_IDX_REC" display="text" edit="mask" limit="4" Mask="##.##"/>
									<cell align="center" col="24" colid="TIRE_IDX_SCR" display="number" limit="3"/>
									<cell align="center" col="25" colid="MESUR_TOT_SCR" display="number" expr="TONUMBER(MAX_PWR_SCR)+TONUMBER(AVG_PWR_SCR)+TONUMBER(TIRE_IDX_SCR)"/>
									<cell align="center" col="26" colid="TOT_SCR" display="number" expr="TONUMBER(GRIP_LEFT_SCR)&#32;+&#32;TONUMBER(GRIP_RIGHT_SCR)&#32;+&#32;TONUMBER(LEG_LEFT_SCR)&#32;+&#32;TONUMBER(LEG_RIGHT_SCR)&#32;+&#32;TONUMBER(LEG_LEFT_SCR2)&#32;+&#32;TONUMBER(LEG_RIGHT_SCR2)+&#32;TONUMBER(BELLY_SCR)&#32;+&#32;TONUMBER(MAX_PWR_SCR)+TONUMBER(AVG_PWR_SCR)+TONUMBER(TIRE_IDX_SCR)"/>
									<cell align="center" col="27" colid="AVG_SCR" display="number" limit="5"/>
									<cell align="center" col="28" colid="CHNG_SCR" display="number" limit="3"/>
									<cell align="center" col="29" colid="RANK" display="number" limit="3"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="458" Id="tab3" ImageID="m_tab_05" Left="2" TabOrder="10" Text="필기" Top="22" Width="998">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsFstSeltExam2" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="454" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="40" Height="450" Id="grdSndSeltExam2" InputPanel="FALSE" Left="3" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="993" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="990">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="120"/>
									<col width="120"/>
									<col width="120"/>
									<col width="120"/>
									<col width="100"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="수험번호"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="성명"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="합산점수"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="환산점수"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="순위"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" colid="CAND_NO" display="text" edit="mask" Mask="########"/>
									<cell align="center" col="2" colid="NM_KOR" display="text"/>
									<cell align="center" col="3" colid="TOT_SCR" display="text" edit="normal" limit="3"/>
									<cell align="center" col="4" colid="CHNG_SCR" display="text"/>
									<cell align="center" col="5" colid="RANK" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="458" Id="tab4" ImageID="m_tab_05" Left="2" TabOrder="10" Text="성적집계표" Top="22" Width="998">
					<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsPerioExam3" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="452" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="448" Id="grdResult" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="996" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="992">
						<contents>
							<format id="Default">
								<columns>
									<col width="40"/>
									<col width="80"/>
									<col width="70"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="70"/>
									<col width="100"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="순번"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="수험번호"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="성명"/>
									<cell bkcolor="user20" col="3" color="user21" colspan="2" display="text" font="굴림,9" text="자전거실기"/>
									<cell bkcolor="user20" col="5" color="user21" colspan="2" display="text" font="굴림,9" text="체력측정"/>
									<cell bkcolor="user20" col="7" color="user21" colspan="2" display="text" font="굴림,9" text="필기"/>
									<cell bkcolor="user20" col="9" color="user21" display="text" font="굴림,9" rowspan="2" text="총&#32;환산점수"/>
									<cell bkcolor="user20" col="10" color="user21" display="text" font="굴림,9" rowspan="2" text="순위"/>
									<cell bkcolor="user20" col="11" color="user21" display="text" font="굴림,9" rowspan="2" text="합격여부"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" row="1" text="평균득점"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" row="1" text="환산점수"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" row="1" text="평균득점"/>
									<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" row="1" text="환산점수"/>
									<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" row="1" text="평균득점"/>
									<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" row="1" text="환산점수"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow+1"/>
									<cell col="1" colid="CAND_NO" display="text"/>
									<cell col="2" colid="NM_KOR" display="text"/>
									<cell align="center" col="3" colid="PERIO_EXAM1_TOT_SCR" display="text"/>
									<cell align="center" col="4" colid="PERIO_EXAM1_CHNG_SCR" display="text"/>
									<cell align="center" col="5" colid="PERIO_EXAM2_TOT_SCR" display="text"/>
									<cell align="center" col="6" colid="PERIO_EXAM2_CHNG_SCR" display="text"/>
									<cell align="center" col="7" colid="PERIO_EXAM3" display="text"/>
									<cell align="center" col="8" colid="PERIO_EXAM3_CHNG_SCR" display="text"/>
									<cell align="center" col="9" colid="TOTAL_CHNG_SCR" display="text"/>
									<cell align="center" col="10" colid="RANK" display="text"/>
									<cell align="center" col="11" colid="SUCCESS_YN" combocol="CD" combodataset="dsSuccessYn" combotext="CD_NM" display="combo"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<MaskEdit Border="Flat" BorderColor="user2" Font="굴림,9,Bold" Height="21" Id="mkDate" Left="104" Mask="(&#32;기간&#32;:&#32;####.##.##&#32;~&#32;####.##.##&#32;)" MaxLength="16" TabOrder="13" Top="66" Type="STRING" Width="232"></MaskEdit>
		<Button ButtonStyle="TRUE" Enable="FALSE" Height="20" Id="btnProcess" ImageID="btn_pop_txt_04" Left="944" OnClick="btnProcess_OnClick" Style="snis_btn" TabOrder="14" Text="성적처리" Top="96" Transparent="TRUE" Width="62"></Button>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::can_common_script.js";
#include "lib::can_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'D02000007';
var sBUTTONLIST   = 'TTFTFT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'F'+sInpt+'FTTT';
    
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	//초기 화면 BK Color설정 
	fnc_SetBKColor(this);
	
	// 화면 초기화
	fcInit();
	//공통코드 조회
	fcd_GetComboDs(dsInComCd);
	//콤보 설정
	fcSetCombo();
	
	// 조회조건 처리
	cbPerioNo.Enable = true;
	tabMain.TabIndex = 0;
	
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/

function fcFormUnloadProcess(obj) {
	
	var sDataset = "";//dsPerioExam1|dsPerioExam2|dsPerioExam3";
	if ( !fnc_FormUnloadCheck(sDataset , sFormId) ) return false;
}


/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}
}



/*-------------------------------------------------------------------------------------------------+
>>  콤보  설정
+-------------------------------------------------------------------------------------------------*/
// 기수 콤보
function fcSetCombo() {
        
    var sServiceName = "d02000007-service:searchPerioNo";
    var sInDataSet   = "";
    var sOutDataSet  = " dsPerioNo=dsPerioNo ";
          
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false); 
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
    
    if ( obj.id == "btnCancel" || obj.id == "btnSearch" ) {
        
       if(tabMain.TabIndex == 0) {
            dsPerioExam1.ClearData();
       }
       
       fcd_GetComboDs(dsInComCd);
    }    
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchUseGbnItem(){

	var sServiceName = "";
    var sInDataSet   = "";
    var sOutDataSet  = "";    
    
    sServiceName  = "d02000007-service:searchUseGbnItem";
	sInDataSet    = "";
	sOutDataSet   = " dsUseGbnItem=dsUseGbnItem dsUseItem=dsUseItem dsFstExamRateBas=dsFstExamRateBas dsSeltChng=dsSeltChng ";
	
	fcd_AddParam("racerPerioNo", cbPerioNo.Value);
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
	
}
function fcStartEndDate(){
	
	mkdate.Text = dsUseGbnItem.getColumn(0,"DT_STR")+dsUseGbnItem.getColumn(0,"DT_END");
}
function fcUseEditable(){

	if (dsUseGbnItem.GetColumn(0,"A") == 0){ //필기
		tabMain.tab3.grdSndSeltExam2.Editable = false;
	}else{
	    tabMain.tab3.grdSndSeltExam2.Editable = true;
	}
	if (dsUseGbnItem.GetColumn(0,"D") == 0){ //체력
		tabMain.tab2.grdStrTest.Editable = false;
	}else{
		tabMain.tab2.grdStrTest.Editable =true;
	}
	if (dsUseGbnItem.GetColumn(0,"C") == 0){//자전거
		tabMain.tab1.grdCycle.Editable = false;
	}else{
		for (var i=0;i<dsUseItem.RowCount();i++){  
			var itemCode = dsUseItem.GetColumn(i,"ITEM_CD");
			switch(itemCode){
			   case "301" :
				tabMain.tab1.grdCycle.SetCellProp("Body",3,"Edit","mask");
				break;
			   case "302" :
				tabMain.tab1.grdCycle.SetCellProp("Body",5,"Edit","mask");
				break;
			   case "303" :
				tabMain.tab1.grdCycle.SetCellProp("Body",7,"Edit","mask");
				break;
			   case "304" :
				tabMain.tab1.grdCycle.SetCellProp("Body",9,"Edit","mask");
				break;
			   case "305" :
				tabMain.tab1.grdCycle.SetCellProp("Body",11,"Edit","mask");
				break;	
			}
		}
	}	
}
function fcSearchCheck(obj) {

	fcInit(obj);
	
	if(fnc_IsNull(cbPerioNo.Value)) {
        //조회할 자료가 없음
		fnc_Message(SNIS_CAN_0008, "N");
		return false;
	}
	
	return true;
}

function fcSearch(obj) {

    if ( !fcSearchCheck(obj) ) return;
    
          fcSearchUseGbnItem();
}
/*-------------------------------------------------------------------------------------------------+
>>  저장시 check
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {

    //변경된 자료가 있는지 체크
	var oDataSet			= "";
	var sMandatoryColID   	= "";
	var sMandatoryColName 	= "";
	var oGrid             	= "";

	if(tabMain.TabIndex == 0) {
		
		if ( !fnc_DatasetChangeCheck(dsPerioExam1) ) 
		{
			fnc_Message(SNIS_COM_1006, "N");//저장 할 자료가 없음	
			return;
		}			
		// 필수항목체크
		oDataSet 			= dsPerioExam1;
		sMandatoryColID 	= "CAND_NO|NM_KOR";
		sMandatoryColName 	= "수험번호|성명";
		oGrid				= tabMain.tab1.grdCycle;
	}
	else if(tabMain.TabIndex == 1) {
	
        if ( !fnc_DatasetChangeCheck(dsPerioExam2) ) 
		{
			fnc_Message(SNIS_COM_1006, "N");//저장 할 자료가 없음		
			return;
		}
		// 필수항목체크
		oDataSet 			= dsPerioExam2;
		sMandatoryColID 	= "CAND_NO|NM_KOR";
		sMandatoryColName 	= "수험번호|성명";
		oGrid				= tabMain.tab2.grdStrTest;			
	}
	else if(tabMain.TabIndex == 2) {
	     if ( !fnc_DatasetChangeCheck(dsFstSeltExam2) ) 
		{
			fnc_Message(SNIS_COM_1006, "N");//저장 할 자료가 없음		
			return;
		}
		oDataSet			="dsFstSeltExam2";
		sMandatoryColID 	= "CAND_NO|NM_KOR";
		sMandatoryColName 	= "수험번호|성명";
		oGrid				= tabMain.tab3.grdFstSeltExam2;	
		
	 }  
	if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
	    return false;
	}
	
	return true;	
}
/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSave(obj) {
    if ( !fcSaveCheck() ) return;
        
    var sServiceName = "";
    var sInDataSet   = "";
    var sOutDataSet  = "";    

   	if(tabMain.TabIndex == 0) {
		
		sServiceName  = "d02000007-service:savePerioExam";
		sInDataSet    = " dsPerioExam1=dsPerioExam1:u ";
		sOutDataSet   = " dsPerioExam1=dsPerioExam1 ";
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
		
	}else if(tabMain.TabIndex == 1) {
		
		sServiceName  = "d02000007-service:savePerioExam";
		sInDataSet    = " dsPerioExam2=dsPerioExam2:u ";
		sOutDataSet   = " dsPerioExam2=dsPerioExam2 ";	
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
				
	}else if(tabMain.TabIndex == 2) {
               
		sServiceName     = "d02000007-service:saveFstSeltExam";
		sInDataSet       = "dsFstSeltExam2=dsFstSeltExam2:u" ;
		sOutDataSet      = "dsFstSeltExam2=dsFstSeltExam2" ;
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
		
	}else{ //합격여부
	               
		var confirmMsg = Confirm("1차합격자를 저장할까요?");
		
		if ( confirmMsg ) {
			sServiceName     = "d02000007-service:savefstyn";
			sInDataSet       = "dsPerioExam3=dsPerioExam3:u" ;
			sOutDataSet      = "dsPerioExam3=dsPerioExam3" ;
			fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
		}
	}
}


/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {

    if(tabMain.TabIndex == 0) {
        fnc_OpenExcelExport("tabMain.tab1.grdCycle");
    }else if(tabMain.TabIndex == 1) {
        fnc_OpenExcelExport("tabMain.tab2.grdStrTest");
    }else if(tabMain.TabIndex == 2) {
        fnc_OpenExcelExport("tabMain.tab3.grdSndSeltExam2");
    }else{
        fnc_OpenExcelExport("tabMain.tab4.grdResult");
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}
/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
    fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {

}
/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex) {
	
}
/*-------------------------------------------------------------------------------------------------+
>>  평균점수 구하는 함수 
+-------------------------------------------------------------------------------------------------*/
function fcAvgScr(obj, nRow) {
	var scrCnt = 0;
	var totScr = 0;
	var avgScr = 0;
    if(obj.id == "dsPerioExam1") {		// 자전거
        for(var i=0; i<dsPerioExam1.rowcount; i++) {  
            if(i == nRow) {
                if(toNumber(dsPerioExam1.GetColumn(i,"REC_200")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam1.GetColumn(i,"SCR_200"));
                }
                if(toNumber(dsPerioExam1.GetColumn(i,"REC_333")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam1.GetColumn(i,"SCR_333"));
                }
                if(toNumber(dsPerioExam1.GetColumn(i,"REC_500")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam1.GetColumn(i,"SCR_500"));
                }
                if(toNumber(dsPerioExam1.GetColumn(i,"REC_1000")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam1.GetColumn(i,"SCR_1000"));
                }				
                if(toNumber(dsPerioExam1.GetColumn(i,"REC_2000")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam1.GetColumn(i,"SCR_2000"));
                }
                avgScr = Round(ToNumber(totScr / scrCnt),2);
                dsPerioExam1.SetColumn(i,"AVG_SCR",avgScr); //평균점수 셋팅
                dsPerioExam1.SetColumn(i,"CHNG_SCR",Round(avgScr * (toNumber(dsFstExamRateBas.GetColumn(0, "FST_ASSIGN_SCR_RATE")) / 100),2));
                break;
            }
        }
	}
	else if(obj.id == "dsPerioExam2") {   //체력측정
        for(var i=0; i<dsPerioExam2.rowcount; i++) {  
            if(i == nRow) {
                if(toNumber(dsPerioExam2.GetColumn(i,"GRIP_LEFT_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"GRIP_LEFT_SCR"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"GRIP_RIGHT_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"GRIP_RIGHT_SCR"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"LEG_LEFT_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"LEG_LEFT_SCR"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"LEG_RIGHT_SCR"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"LEG_LEFT_REC2")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"LEG_LEFT_SCR2"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC2")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"LEG_RIGHT_SCR2"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"BELLY_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"BELLY_SCR"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"MAX_PWR_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"MAX_PWR_SCR"));
                }
                if(toNumber(dsPerioExam2.GetColumn(i,"AVG_PWR_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"AVG_PWR_SCR"));
                }
                 if(toNumber(dsPerioExam2.GetColumn(i,"TIRE_IDX_REC")) > 0) {
                    scrCnt++;
                    totScr += ToInteger(dsPerioExam2.GetColumn(i,"TIRE_IDX_SCR"));
                }
                avgScr = Round(ToNumber(totScr / scrCnt),2);
                dsPerioExam2.SetColumn(i,"AVG_SCR",avgScr); //평균점수 셋팅
                dsPerioExam2.SetColumn(i,"CHNG_SCR",Round(avgScr * (toNumber(dsFstExamRateBas.GetColumn(0, "FST_ASSIGN_SCR_RATE")) / 100),2));
                break;
            }
        }
	}
}
/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/

function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
   
   if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
   switch(sServiceName) {
            
        case "d02000007-service:searchPerioNo" : 
            break;
        case "d02000007-service:searchUseGbnItem" :  
             fcStartEndDate();
			 fcSearchPerioExam1();	
			break;              
        case "d02000007-service:searchPerioExam1" :	// 1차선발 자전거실기 결과 조회   
              fcSearchPerioExam2();	
			  break;
        case "d02000007-service:searchFstSeltExam2" : //필기				
				if(dsFstSeltExam2.rowcount > 0) {
					for(var i=0; i<dsFstSeltExam2.rowcount; i++) {
					if(!fnc_IsNull(dsFstSeltExam2.GetColumn(i, "DT"))) {
					break;
					}
				}
			}
			fcSearchPerioExam3();    		
            break;   
        case "d02000007-service:searchPerioExam2" :       // 1차선발 체력측정 결과 조회 콜백처리
                fcSearchNoteExam(); 
            break;
        case "d02000007-service:searchPerioExam3" :      // 1차선발 결과집계 조회 콜백처리            
            fcFstYN();
            break;
        
        case "d02000007-service:savePerioExam" : 
            break;                        
        default :
            break;
    }
    
    //오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {

}
/*-------------------------------------------------------------------------------------------------+
>>  1차선발 자전거 실기 조회
+-------------------------------------------------------------------------------------------------*/
function fcSearchPerioExam1() {
    
    sServiceName = "d02000007-service:searchPerioExam1";
	sInDataSet   = "";
	sOutDataSet  = " dsPerioExam1=dsPerioExam1 ";
	
	fcd_AddParam("racerPerioNo", Trim(cbPerioNo.Value));
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

/*-------------------------------------------------------------------------------------------------+
>>  1차선발 체력측정 조회
+-------------------------------------------------------------------------------------------------*/
function fcSearchPerioExam2() {
    
    sServiceName = "d02000007-service:searchPerioExam2";
	sInDataSet   = "";
	sOutDataSet  = " dsPerioExam2=dsPerioExam2 ";
	
    fcd_AddParam("racerPerioNo", Trim(cbPerioNo.Value));
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}
/*-------------------------------------------------------------------------------------------------+
>>  1차 필기시험 조회
+-------------------------------------------------------------------------------------------------*/
function fcSearchNoteExam(){
    	
    	var sServiceName = "d02000007-service:searchFstSeltExam2";
		var sInDataSet   = "";
		var sOutDataSet  = " dsFstSeltExam2=dsFstSeltExam2 ";    
					
		fcd_AddParam("racerPerioNo", cbPerioNo.value); 
    
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);	
}
/*-------------------------------------------------------------------------------------------------+
>>  1차선발 결과 집계 조회(한과목이라도 40점이하를 받지않고 평균 60점이상인 사람중에서 선발인원의 2배수) 
+-------------------------------------------------------------------------------------------------*/
function fcSearchPerioExam3() {
    
    sServiceName = "d02000007-service:searchPerioExam3";
	sInDataSet   = "";
	sOutDataSet  = " dsPerioExam3=dsPerioExam3 ";
	
	fcd_AddParam("racerPerioNo", Trim(cbPerioNo.Value));
    fcd_AddParam("successYn", Trim(cbSuccessYn.Value));    	
        	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

/*-------------------------------------------------------------------------------------------------+
>>  환산비율 조회
+-------------------------------------------------------------------------------------------------*/
function fcSearchChngRate() {
    if(tabMain.TabIndex == 0) {
		dsFstExamRateBas.Filter("ITEM_GBN_CD = '003'");
    }else if(tabMain.TabIndex == 1) {
	    dsFstExamRateBas.Filter("ITEM_GBN_CD = '004'");
    }else if(tabMain.TabIndex == 2) {
	    dsFstExamRateBas.Filter("ITEM_GBN_CD = '001'");
	}
}
function tabMain_OnClick(obj,nButton,nX,nY)
{
	fcSearchChngRate();
}
// TAB 변경시 조회조건 처리
function tabMain_OnChanged(obj,nOldIndex,nNewindex)
{ 	
    switch(nNewindex){
    case 0 :
            btnProcess.Enable = false;
			dsFstExamRateBas.Filter("ITEM_GBN_CD = '003'");
			break;
    case 1 :
			btnProcess.Enable = true;
			dsFstExamRateBas.Filter("ITEM_GBN_CD = '004'");
			break;
    case 2 :   
			dsFstExamRateBas.Filter("ITEM_GBN_CD = '001'");
			btnProcess.Enable = false;
			cbPerioNo.Enable = true;
			cbSuccessYn.Enable = false;
			break;
	case 3:	
		btnProcess.Enable = false;
	    cbPerioNo.Enable = true;
		cbSuccessYn.Enable = true;
		break;
	default : break;	
    }
}

//  자전거실기 기록입력후 컬럼이동시 자동 배점, 평균, 환산점수 설정
function dsPerioExam1_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	
	var iRec = ToFloat(varNewValue);
	var iScr = 0;
	
	switch(strColumnID){
		case "REC_200"  : dsSeltChng.Filter("ITEM_GBN_CD = '003' AND ITEM_CD ='301'"); break;
		case "REC_333"  : dsSeltChng.Filter("ITEM_GBN_CD = '003' AND ITEM_CD ='302'"); break;
		case "REC_500"  : dsSeltChng.Filter("ITEM_GBN_CD = '003' AND ITEM_CD ='303'"); break;
		case "REC_1000" : dsSeltChng.Filter("ITEM_GBN_CD = '003' AND ITEM_CD ='304'"); break;
		case "REC_2000" : dsSeltChng.Filter("ITEM_GBN_CD = '003' AND ITEM_CD ='305'"); break;
	default : break;
	}
	
	for(i=0;i<dsSeltChng.RowCount();i++){
			var iStartRec = toNumber(dsSeltChng.GetColumn(i, "START_REC")); 
			var iEndRec = toNumber(dsSeltChng.GetColumn(i, "END_REC"));
			if( (iRec >= iStartRec)&&(iRec <=iEndRec)){
				 iScr = dsSeltChng.getColumn(i,"BAS_SCR");
			 }
		}
	
	switch(strColumnID){
		case "REC_200"  : dsPerioExam1.SetColumn(nRow,"SCR_200",iScr);   break;
		case "REC_333"  : dsPerioExam1.SetColumn(nRow,"SCR_333",iScr);   break;
		case "REC_500"  : dsPerioExam1.SetColumn(nRow,"SCR_500",iScr);   break;
		case "REC_1000" : dsPerioExam1.SetColumn(nRow,"SCR_1000",iScr);  break;
		case "REC_2000" : dsPerioExam1.SetColumn(nRow,"SCR_2000",iScr);  break;
	default : break;
	}
	fcAvgScr(obj, nRow);// 평균,환산점수
}


function dsFstSeltExam2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    var sTotScr      = 0;	   // 필기시험 합계점수	
    var nScrRate     = 0;
	if(Trim(strColumnID) == "TOT_SCR") {	  
	   nChangeRow        = dsFstSeltExam2.rowposition;
	   sTotScr           = toNumber(dsFstSeltExam2.GetColumn(nChangeRow,"TOT_SCR"));
	   nScrRate 		 = toNumber(dsFstExamRateBas.GetColumn(0,"FST_ASSIGN_SCR_RATE")) * 0.01; 
	   dsFstSeltExam2.SetColumn(nChangeRow,"CHNG_SCR",Round((sTotScr * nScrRate),2)); 
	}    
}

function btnProcess_OnClick()//체력측정 성적계산
{
	var iCnt =dsPerioExam2.RowCount(); 
	var iRank = 0;
	var check = 0;
	var iPer = 0;
	//401	
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='401'");
		dsPerioExam2.Sort("GRIP_LEFT_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"GRIP_LEFT_REC")) == dsPerioExam2.GetColumn(i-1,"GRIP_LEFT_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			
			if (((dsPerioExam2.GetColumn(i,"GRIP_LEFT_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"GRIP_LEFT_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"GRIP_LEFT_SCR",iPer);
		}
	//402	
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='402'");
		dsPerioExam2.Sort("GRIP_RIGHT_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"GRIP_RIGHT_REC")) == dsPerioExam2.GetColumn(i-1,"GRIP_RIGHT_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"GRIP_RIGHT_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"GRIP_RIGHT_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"GRIP_RIGHT_SCR",iPer);
		}
		//403
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='403'");
		dsPerioExam2.Sort("LEG_LEFT_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"LEG_LEFT_REC")) == dsPerioExam2.GetColumn(i-1,"LEG_LEFT_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"LEG_LEFT_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"LEG_LEFT_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"LEG_LEFT_SCR",iPer);
		}
	   //404
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='404'");
		dsPerioExam2.Sort("LEG_RIGHT_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC")) == dsPerioExam2.GetColumn(i-1,"LEG_RIGHT_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"LEG_RIGHT_SCR",iPer);
		}
	//405
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='405'");
		dsPerioExam2.Sort("LEG_LEFT_REC2",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"LEG_LEFT_REC2")) == dsPerioExam2.GetColumn(i-1,"LEG_LEFT_REC2")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"LEG_LEFT_REC2")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"LEG_LEFT_REC2")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"LEG_LEFT_SCR2",iPer);
		}	
	//406
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='406'");
		dsPerioExam2.Sort("LEG_RIGHT_REC2",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC2")) == dsPerioExam2.GetColumn(i-1,"LEG_RIGHT_REC2")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC2")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"LEG_RIGHT_REC2")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"LEG_RIGHT_SCR2",iPer);
		}	
		
	//407
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='407'");
		dsPerioExam2.Sort("BELLY_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"BELLY_REC")) == dsPerioExam2.GetColumn(i-1,"BELLY_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"BELLY_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"BELLY_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"BELLY_SCR",iPer);
		}	
	//408
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='408'");
		dsPerioExam2.Sort("MAX_PWR_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"MAX_PWR_REC")) == dsPerioExam2.GetColumn(i-1,"MAX_PWR_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"MAX_PWR_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"MAX_PWR_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"MAX_PWR_SCR",iPer);
		}
		
	//409
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='409'");
		dsPerioExam2.Sort("AVG_PWR_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"AVG_PWR_REC")) == dsPerioExam2.GetColumn(i-1,"AVG_PWR_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"AVG_PWR_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"AVG_PWR_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"AVG_PWR_SCR",iPer);
		}
	//4010
	 iRank = 0;
	 check = 0;
	 iPer  = 0;
		dsSeltChng.Filter("ITEM_GBN_CD = '004' AND ITEM_CD ='410'");
		dsPerioExam2.Sort("TIRE_IDX_REC",0);
		
		for(var i = 0;i<iCnt;i++){
			if((dsPerioExam2.GetColumn(i,"TIRE_IDX_REC")) == dsPerioExam2.GetColumn(i-1,"TIRE_IDX_REC")){
				check ++;
			}else{
				iRank++; 
				iRank = iRank + check;
				check = 0;
			}
			iPer = Round((iRank/iCnt)*100,0);
			iPer = fccalculation(iPer);
			if (((dsPerioExam2.GetColumn(i,"TIRE_IDX_REC")) =="")||(toNumber(dsPerioExam2.GetColumn(i,"TIRE_IDX_REC")) == 0)){
				iPer = 0;
			}
			dsPerioExam2.SetColumn(i,"TIRE_IDX_SCR",iPer);
			fcAvgScr(dsPerioExam2,i);
		}
}
function fccalculation(iPer){
	
	var iScr = 0;
	for(i=0;i<dsSeltChng.RowCount();i++){
			var iStartRec = toNumber(dsSeltChng.GetColumn(i, "START_REC")); 
			var iEndRec = toNumber(dsSeltChng.GetColumn(i, "END_REC"));
			if( (iPer >= iStartRec)&&(iPer <=iEndRec)){
				 iScr = dsSeltChng.getColumn(i,"BAS_SCR");
			 }
			 
		}
	return iScr;
}
function fcFstYN(){

	var iCnt = dsPerioExam3.RowCount();
	var iCycleCnt = toNumber(dsUseGbnItem.GetColumn(0,"C"));
	var iHealth = toNumber(dsUseGbnItem.GetColumn(0,"D"));
	var iCycYnCnt = 0;
	var i_HealCnt = 0;
	var i_Pass = "";
	var i_PassCnt = 0;
	var i_racerCnt = toNumber(dsUseGbnItem.GetColumn(0,"CNT"));
	for(var  i=0; i<iCnt; i++){
	
		iCycYnCnt = 0;
		i_HealCnt = 0;
		i_Pass = "";
		
		/* 과락이 없다. 2012.04.26. jdlee
		// 자전거
		if(!fnc_isNull(dsPerioExam3.GetColumn(i,"SCR_200"))){
			if((dsPerioExam3.GetColumn(i,"SCR_200")) >=60){
				iCycYnCnt++;
			}}
		if(!fnc_isNull(dsPerioExam3.GetColumn(i,"SCR_333"))){
			if((dsPerioExam3.GetColumn(i,"SCR_333")) >=60){
				iCycYnCnt++;
			}}
		if(!fnc_isNull(dsPerioExam3.GetColumn(i,"SCR_500"))){
			if((dsPerioExam3.GetColumn(i,"SCR_500")) >=60){
				iCycYnCnt++;
			}}
		if(!fnc_isNull(dsPerioExam3.GetColumn(i,"SCR_1000"))){
			if((dsPerioExam3.GetColumn(i,"SCR_1000")) >=60){
				iCycYnCnt++;
			}}
		if(!fnc_isNull(dsPerioExam3.GetColumn(i,"SCR_2000"))){
			if((dsPerioExam3.GetColumn(i,"SCR_2000")) >=60){
				iCycYnCnt++;
			}}
		if(iHealth > 0 ){   //체력측정 한다.
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"GRIP_LEFT_SCR"))){
				if((dsPerioExam3.GetColumn(i,"GRIP_LEFT_SCR")) >=60){
				i_HealCnt++;
				}}
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"GRIP_RIGHT_SCR"))){
				if((dsPerioExam3.GetColumn(i,"GRIP_RIGHT_SCR")) >=60){
				i_HealCnt++;
				}}	
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"LEG_LEFT_SCR"))){
				if((dsPerioExam3.GetColumn(i,"LEG_LEFT_SCR")) >=60){
				i_HealCnt++;
				}}		
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"LEG_RIGHT_SCR"))){
				if((dsPerioExam3.GetColumn(i,"LEG_RIGHT_SCR")) >=60){
				i_HealCnt++;
				}}						
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"LEG_LEFT_SCR2"))){
				if((dsPerioExam3.GetColumn(i,"LEG_LEFT_SCR2")) >=60){
				i_HealCnt++;
				}}						
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"LEG_RIGHT_SCR2"))){
				if((dsPerioExam3.GetColumn(i,"LEG_RIGHT_SCR2")) >=60){
				i_HealCnt++;
				}}		
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"BELLY_SCR"))){
				if((dsPerioExam3.GetColumn(i,"BELLY_SCR")) >=60){
				i_HealCnt++;
				}}						
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"MAX_PWR_SCR"))){
				if((dsPerioExam3.GetColumn(i,"MAX_PWR_SCR")) >=60){
				i_HealCnt++;
				}}
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"AVG_PWR_SCR"))){
				if((dsPerioExam3.GetColumn(i,"AVG_PWR_SCR")) >=60){
				i_HealCnt++;
				}}						
			if(!fnc_isNull(dsPerioExam3.GetColumn(i,"TIRE_IDX_SCR"))){
				if((dsPerioExam3.GetColumn(i,"TIRE_IDX_SCR")) >=60){
				i_HealCnt++;
				}}	
		}//체력측정
		if(iHealth > 0 ){  
			if(	(iCycleCnt == iCycYnCnt)&&(iHealth == i_HealCnt) ){
					i_Pass = "Y";
					i_PassCnt++;
			}else{
					i_Pass = "N";
			}
		}else{
			if(iCycleCnt == iCycYnCnt){
					i_Pass = "Y";
					i_PassCnt++;
			}else{
					i_Pass = "N";
			}
		}
	
		if(i_PassCnt > i_racerCnt){
			i_Pass = "N";
		}
		*/
		i_Pass = "Y";
		
		dsPerioExam3.SetColumn(i,"SUCCESS_YN",i_Pass);
	} //for
	
	i_racerCnt = toNumber(dsUseGbnItem.GetColumn(0,"CNT"));
	fcUseEditable();  // 등록가능 여부 
}
function fcPrint(){

	var logImgUrl = GBL_REPORT_URL+"log.jpg";
	var sSubUrl   = "";                     			//레포트 파일이 있는 서브디렉토리
	var sRptNm	  = "";
	var sDataSet  = "";
	var sArg	  = "";
	var sRptDrct  = "";
	if(tabMain.TabIndex = 0){
		sRptNm    = "d02000007_1.jrf";          //레포트 파일명
		sDataSet  = " dsPerioExam1=dsPerioExam1 ";    //"UBI 쿼리명, MIP Dataset명"
		sArg      = "";                               	//출력방향(0 : 수직, 1 : 수평)
	}else if(tabMain.TabIndex = 1){
		sRptNm    = "d02000007_2.jrf";          //레포트 파일명
		sDataSet  = " dsPerioExam2=dsPerioExam2 ";    //"UBI 쿼리명, MIP Dataset명"
		sArg      = "";                             	//출력방향(0 : 수직, 1 : 수평)
	}else if(tabMain.TabIndex = 2){
		sRptNm    = "d02000007_3.jrf";          //레포트 파일명
		sDataSet  = " dsFstSeltExam2=dsFstSeltExam2 ";    //"UBI 쿼리명, MIP Dataset명"
		sArg      = "";       
	//dsFstSeltExam2
	}else if(tabMain.TabIndex = 3){
		sRptNm    = "d02000007.jrf";          //레포트 파일명
		sDataSet  = " dsPerioExam3=dsPerioExam3 ";    //"UBI 쿼리명, MIP Dataset명"
		sArg      = "";
	}
	sRptDrct  = 1;                               	//출력방향(0 : 수직, 1 : 수평)
	fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
}
]]></Script>
</Window>