<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="202" Id="comChoice" Left="8" OnKeyDown="fcFormOnKeyDown" OnLoadCompleted="fcFormLoadSetting" PidAttrib="7" Title="선택&#32;공통화면" Top="8" Ver="1.0" Width="468" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsOutExcelList"></Dataset>
		</Datasets>
		<Static Height="20" Id="Static0" Left="6" Style="snis_txt" TabOrder="2" Text="*&#32;더블클릭&#32;또는&#32;Enter&#32;Key를&#32;누르시면&#32;선택&#32;됩니다!&#32;*" Top="177" VAlign="Middle" Width="324"></Static>
		<Grid AreaSelect="true" AutoFit="TRUE" BindDataset="dsOutExcelList" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="174" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadHeight="20" Height="170" Id="grdSelect" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" MultiSelect="TRUE" OnCellDBLClick="fcGridOnCellDblClick" OnKeyDown="fcGridOnKeyDown" Right="463" SelColor="user19" Style="styGrid01" TabOrder="0" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="459">
			<contents>
				<format id="Default">
					<columns>
						<col width="155"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" text="데이터명"/>
					</head>
					<body>
						<cell col="0" colid="TITLE_NAME" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="22" Id="divBtnConfirm" Left="357" TabOrder="3" Text="Div0" Top="175" Url="common::comButtonConfirm.xml" Width="108">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  01. 최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {
	
	var asGridList = split(sGridList, "|");         //Grid List
	if ( asGridList.length() == 0 ) {
        fnc_Message("Grid 정보가 없습니다.", "N");
        close(false);
        return;
	}
	if ( asGridList.length() == 1 ) {
        var asGridName = split(asGridList[0], ":");
        fnc_OpenExcelExport(asGridName[0]);
        close(false);
        return;
	}
	
	dsOutExcelList.AddColumn("GRID_NAME");
	dsOutExcelList.AddColumn("TITLE_NAME");
	
	var nRow = 0;
	for ( var i = 0; i < asGridList.length(); i++ ) {
        var asGridName = split(asGridList[i], ":");
        dsOutExcelList.AddRow();
        dsOutExcelList.SetColumn(nRow, "GRID_NAME" , asGridName[0]);
        dsOutExcelList.SetColumn(nRow, "TITLE_NAME", asGridName[1]);
        nRow++;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  02. Key Down (ESC)
+-------------------------------------------------------------------------------------------------*/
function fcFormOnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam){
	//ESC키 누르면 화면 종료
	if (nChar==27) Close(false);
}

/*-------------------------------------------------------------------------------------------------+
>>  03. Grid에서 Enter key
+-------------------------------------------------------------------------------------------------*/
function fcGridOnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {
	
	if (nChar==13) {
        sGridName = dsOutExcelList.GetColumn(dsOutExcelList.row, "GRID_NAME");
        if ( fnc_IsNull(sGridName) ) {
            fnc_Message("Grid 정보가 없습니다.", "N");
            return;
        }
        fnc_OpenExcelExport(sGridName); 
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  04. Grid에서 Double Click
+-------------------------------------------------------------------------------------------------*/
function fcGridOnCellDblClick(obj,nRow,nCell,nX,nY){
    sGridName = dsOutExcelList.GetColumn(nRow, "GRID_NAME");
    if ( fnc_IsNull(sGridName) ) {
        fnc_Message("Grid 정보가 없습니다.", "N");
        return;
    }
    fnc_OpenExcelExport(sGridName); 
}

/*-------------------------------------------------------------------------------------------------+
>>  05.확인 버튼 클릭
+-------------------------------------------------------------------------------------------------*/
function fcChoice(obj){
    sGridName = dsOutExcelList.GetColumn(dsOutExcelList.row, "GRID_NAME");
    if ( fnc_IsNull(sGridName) ) {
        fnc_Message("Grid 정보가 없습니다.", "N");
        return;
    }
    fnc_OpenExcelExport(sGridName); 
}

/*-------------------------------------------------------------------------------------------------+
>>  06.취소 버튼 클릭
+-------------------------------------------------------------------------------------------------*/
function fcClose(obj){
	Close(false);
}]]></Script>
</Window>