<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbdc_cand_dorm_assign(경륜후보생기숙사배정)"> 

 <query id="item_code_d03000001" desc="종목코드 조회" fetchSize="10">
        <![CDATA[
			SELECT 
			        TGC.GRP_CD      	-- 그룹코드
			      , TGC.GRP_NM      	-- 그룹명
			      , TSC.CD              -- 코드
			      , TSC.CD_NM       	-- 코드명
			      , TSC.RMK         	-- 비고
			FROM    TBDA_GRP_CD  TGC
			      , TBDA_SPEC_CD TSC
			WHERE TGC.GRP_CD = TSC.GRP_CD
			AND   TSC.DEL_YN = 'N'
			AND   TGC.GRP_CD IN ('D30002','D30003','D30004')
			ORDER BY GRP_CD,CD
        ]]>
    </query>  
    
    <query id="tbdc_cand_dorm_assign_fb000" desc="경륜후보생 기숙사 배정 조회" fetchSize="10">
		<![CDATA[
			SELECT 
					'0' CHK
					,A.RACER_PERIO_NO
					,A.BUILD
					,A.BUILD AS BUILD_NM
					,A.ROOM_NO
					,A.ROOM_NO AS ROOM_NM
					,A.CAND_NO
					,B.NM_KOR
					,A.ROOM_CHIEF_YN
			FROM	TBDC_CAND_DORM_ASSIGN A, TBDB_CAND_IDENT B
			WHERE	A.CAND_NO = B.CAND_NO
			AND		A.RACER_PERIO_NO = NVL(?, A.RACER_PERIO_NO)
			AND		A.BUILD   = NVL(?, A.BUILD)
			AND		A.ROOM_NO = NVL(?, A.ROOM_NO)
			AND		A.CAND_NO = NVL(?, A.CAND_NO)
			AND 	B.DEL_YN = 'N'
				  UNION ALL
			SELECT
					'0' CHK				
					,RACER_PERIO_NO
					,'-1' AS BUILD
					,'선택' AS BUILD_NM
					,'-1' AS ROOM_NO
					,'선택' AS ROOM_NM
					,CAND_NO
					,NM_KOR
					,'0' AS ROOM_CHIEF_YN
			FROM	TBDB_CAND_IDENT
			WHERE	CAND_NO NOT IN (SELECT CAND_NO FROM TBDC_CAND_DORM_ASSIGN)
			AND		RACER_PERIO_NO = NVL(?, RACER_PERIO_NO)	
			AND 	DEL_YN = 'N'		
		]]>
    </query>
    	
    <query id="tbdc_cand_dorm_assign_fb001" desc="경륜후보생 기숙사 배정 조회" fetchSize="10">
		<![CDATA[
			SELECT 
					'0' CHK
					,A.RACER_PERIO_NO
					,A.BUILD
					,A.ROOM_NO
					,A.CAND_NO
					,B.NM_KOR
					,A.ROOM_CHIEF_YN
			FROM	TBDC_CAND_DORM_ASSIGN A, TBDB_CAND_IDENT B
			WHERE	A.CAND_NO = B.CAND_NO
			AND		A.RACER_PERIO_NO = NVL(?, A.RACER_PERIO_NO)
			AND		A.BUILD   = NVL(?, A.BUILD)
			AND		A.ROOM_NO = NVL(?, A.ROOM_NO)
			AND		A.CAND_NO  = NVL(?, A.CAND_NO)
			AND 	B.DEL_YN = 'N'
			ORDER BY A.RACER_PERIO_NO, A.CAND_NO
	    ]]>
    </query>
 
    <query id="tbdb_CandIdent_fb001" desc="경륜후보생신상 조회" fetchSize="10">
        <![CDATA[
			SELECT
					'0' CHK				
					,RACER_PERIO_NO
					,CAND_NO
					,NM_KOR
			FROM	TBDB_CAND_IDENT
			WHERE	CAND_NO NOT IN (SELECT CAND_NO FROM TBDC_CAND_DORM_ASSIGN)
			AND		RACER_PERIO_NO = NVL(?, RACER_PERIO_NO)	
			AND 	DEL_YN = 'N'		
			ORDER BY RACER_PERIO_NO, CAND_NO
		]]>
    </query> 

    <query id="tbdb_CandIdent_fb002" desc="경륜호부생신상 콤보 조회" fetchSize="10">
        <![CDATA[
			SELECT
					'0' CHK				
					,RACER_PERIO_NO
					,CAND_NO
					,NM_KOR
			FROM	TBDB_CAND_IDENT		
			WHERE 	DEL_YN = 'N'	
		]]>
    </query> 
    
    <query id="tbdc_cand_dorm_assign_fb002" desc="동 콤보 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					DISTINCT BUILD
			FROM	TBDC_CAND_DORM_ASSIGN
		]]>
    </query>      
    
    <query id="tbdc_cand_dorm_assign_fb003" desc="호 콤보 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					DISTINCT ROOM_NO
			FROM	TBDC_CAND_DORM_ASSIGN
		]]>
    </query>
    
    <query id="tbdc_cand_dorm_assign_fb011" desc="호 콤보 조회" fetchSize="10">
        <![CDATA[
			SELECT  ROOM_NO
			FROM	TBDC_CAND_DORM_ASSIGN

		]]>
    </query>
    
    <query id="tbdc_cand_dorm_assign_fb004" desc="PK 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					RACER_PERIO_NO
					,CAND_NO
			FROM	TBDC_CAND_DORM_ASSIGN
			WHERE	RACER_PERIO_NO = NVL(?, RACER_PERIO_NO)					
		]]>
    </query>         
            
    <query id="tbdc_cand_dorm_assign_fb005" desc="기수조회" fetchSize="10">
        <![CDATA[
			SELECT CD_NM AS RACER_PERIO_NO
			,CD_NM AS RACER_PERIO_NM
			FROM TBDA_SPEC_CD	
			WHERE GRP_CD = 'A10001'
			ORDER BY CD DESC		
		]]>
    </query>            
    <query id="tbdc_cand_dorm_assign_ib001" desc="경륜후보생기숙사배정 입력" fetchSize="10">
        <![CDATA[
			INSERT INTO TBDC_CAND_DORM_ASSIGN (
				RACER_PERIO_NO
				,BUILD
				,ROOM_NO
				,CAND_NO
				,ROOM_CHIEF_YN
				,INST_ID
				,INST_DTM
				,UPDT_ID
				,UPDT_DTM        
			)VALUES
			(			
				 ?
				,?
				,?
				,?
				,?				
				,?
				,SYSDATE
				,?
				,SYSDATE
			)
		]]>
    </query>
    
         
    <query id="tbdc_cand_dorm_assign_ub001" desc="경륜후보생기숙사배정 수정" fetchSize="10">
        <![CDATA[
			UPDATE TBDC_CAND_DORM_ASSIGN
			SET
					BUILD  			    = ?
				    ,ROOM_NO            = ?
					,ROOM_CHIEF_YN		= ?
					,UPDT_ID        	= ?
					,UPDT_DTM       	= SYSDATE
			WHERE	RACER_PERIO_NO		= ?
			AND		CAND_NO				= ?
		]]>
    </query>
          
    <query id="tbdc_cand_dorm_assign_db001" desc="경륜후보생기숙사배정  삭제" fetchSize="10">
        <![CDATA[
			DELETE 
			FROM   	TBDC_CAND_DORM_ASSIGN
			WHERE	RACER_PERIO_NO		= ?
			AND		BUILD    			= ?
			AND     ROOM_NO             = ?
			AND		CAND_NO				= ?
		]]>
    </query>

    
</queryMap>