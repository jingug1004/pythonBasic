<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbdb_cmpt_edu_outl_mngr(세부교육일정)"> 
    <query id="tbdb_detl_edu_assign_fb001" desc="세부일정조회" fetchSize="10">
		<![CDATA[
			SELECT   
					'0' CHK
					,RACER_PERIO_NO
					,SEQ
					,DT
					,(SELECT WK FROM TBDB_WK_ABS WHERE RACER_PERIO_NO = ? AND DT BETWEEN STR_DT AND END_DT) AS WK 
					,STR_END_TIME
					,SECTN_CD
					,CRS_CD
					,DETL_EDU_CRS
					,OBJ
					,LECTR
					,(SELECT NM_KOR FROM TBDB_GUD_LECTR WHERE GUD_LECTR_ID=LECTR AND  RACER_PERIO_NO = ?) AS LECTR_NM
					,PLC 
					,(SELECT CD_NM FROM TBDA_SPEC_CD WHERE GRP_CD='D10061' AND CD=PLC) AS PLC_NM    
					,EDU_TIME
			FROM	TBDB_DETL_EDU_ASSIGN
			WHERE	RACER_PERIO_NO = ?
			AND		YY = NVL(?, YY)	
			AND		MM = NVL(?, MM)
			ORDER BY DT ASC	 , STR_END_TIME 		
	    ]]>
    </query>
    <query id="item_code_d02000003" desc="종목코드 조회" fetchSize="10">
        <![CDATA[
			SELECT 
			        TGC.GRP_CD      	-- 그룹코드
			      , TGC.GRP_NM      	-- 그룹명
			      , TSC.CD              -- 코드
			      , TSC.CD_NM       	-- 코드명
			      , TSC.RMK         	-- 비고
			FROM    TBDA_GRP_CD  TGC
			      , TBDA_SPEC_CD TSC
			WHERE TGC.GRP_CD = TSC.GRP_CD
			AND   TSC.DEL_YN = 'N'
			AND   TGC.GRP_CD IN ('D10064','D10030','D10088','D10089','D10090')
        ]]>
    </query> 
    <query id="tbdb_detl_edu_assign_fb002" desc="기수쿼리" fetchSize="10">
        <![CDATA[
			SELECT CD_NM AS RACER_PERIO_NO
			FROM TBDA_SPEC_CD	
			WHERE GRP_CD = 'A10001'
			ORDER BY CD DESC	
		]]>
    </query>      
  
    <query id="tbdb_detl_edu_assign_fb003" desc="강사조회" fetchSize="10">
        <![CDATA[
			SELECT 
					GUD_LECTR_ID
					,NM_KOR
					,BLNG
			FROM
				    TBDB_GUD_LECTR
			WHERE	RACER_PERIO_NO = ?
			AND		USE_YN = '001'
			ORDER BY 
					NM_KOR	
			ASC		
		]]>
    </query>     
    
    <query id="tbdb_detl_edu_assign_fb004" desc="년도조회" fetchSize="10">
        <![CDATA[
			SELECT 
					DISTINCT YY AS YY_CD
					,YY AS YY_NM 
			FROM	TBDB_WK_ABS
			ORDER BY YY DESC
		]]>
    </query>     
    <query id="tbdb_detl_edu_assign_fb005" desc="확정" fetchSize="10">
        <![CDATA[
		    SELECT 	RACER_PERIO_NO
		    		,MN_ID
		    		,CFM_FG 
		    FROM  TBDB_CFM
			WHERE RACER_PERIO_NO = ?
			AND TRIM(MN_ID) = ?
        ]]>
    </query>               
            
    <query id="tbdb_detl_edu_assign_ib001" desc="세부일정입력" fetchSize="10">
        <![CDATA[
			INSERT INTO TBDB_DETL_EDU_ASSIGN (
			    RACER_PERIO_NO		        
			    ,SEQ          
			    ,YY   
			    ,MM  			    			    
			    ,DT           
			    ,STR_END_TIME 
			    ,SECTN_CD     
			    ,CRS_CD       
			    ,DETL_EDU_CRS 
			    ,OBJ          
			    ,LECTR        
			    ,PLC          
			    ,EDU_TIME     
			    ,INST_ID      
			    ,INST_DTM      
			)
			SELECT
				 ?
				,NVL(MAX(SEQ), 0) + 1
				,?
				,?									
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,SYSDATE
			FROM 	TBDB_DETL_EDU_ASSIGN
			WHERE 	RACER_PERIO_NO = ?
		]]>
    </query>
    
         
    <query id="tbdb_detl_edu_assign_ub001" desc="세부일정 수정" fetchSize="10">
        <![CDATA[
			UPDATE TBDB_DETL_EDU_ASSIGN 
			SET
					YY				= ?
					,MM				= ?
					,DT				= ?
					,STR_END_TIME	= ?
					,SECTN_CD		= ?
					,CRS_CD			= ?
					,DETL_EDU_CRS	= ?
					,OBJ			= ?
					,LECTR			= ?
					,PLC     		= ?
					,EDU_TIME		= ?
					,UPDT_ID        = ?
					,UPDT_DTM       = SYSDATE
			WHERE	RACER_PERIO_NO	= ?
			AND		SEQ				= ?
		]]>
    </query>
          
    <query id="tbdb_detl_edu_assign_db001" desc="세부일정 삭제" fetchSize="10">
        <![CDATA[
			DELETE 
			FROM   	TBDB_DETL_EDU_ASSIGN 
			WHERE	RACER_PERIO_NO	= ?
			AND		SEQ				= ?   
		]]>
    </query>     
    
</queryMap>