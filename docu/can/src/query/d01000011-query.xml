<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="d01000011(부서이동 관리)">  	
    <query id="d01000011_s01" desc="권한부여현황" fetchSize="10">
        <![CDATA[
			SELECT /* d01000011_s01 */                  '0' AS DELAUTH_CHK                 ,'0' AS AUTH_CHK 			     ,A.USER_ID                                          --사용자 ID			     ,A.DEPT_CD PRE_DEPT_CD                              --이동전부서코드			     ,(SELECT GROUP_NAME FROM USRBM.V_GROUP C       			            WHERE C.GROUP_ID = A.DEPT_CD) PRE_DEPT_NM    --이동전부서명			     ,A.TEAM_CD PRE_TEAM_CD                              --이동전팀코드			     ,(SELECT GROUP_NAME FROM USRBM.V_GROUP C       			            WHERE C.GROUP_ID = A.TEAM_CD) PRE_TEAM_NM    --이동전팀명			     ,B.USER_NM                                          --사용자명			     ,B.DEPT_CD CUR_DEPT_CD                              --이동후부서코드			     ,B.DEPT_NM CUR_DEPT_NM                              --이동후부서명			     ,B.TEAM_CD CUR_TEAM_CD                              --이동후팀코드			     ,B.TEAM_NM CUR_TEAM_NM                              --이동후팀명			     			FROM TBDA_AUTH_APLY_DEPT A       --권한적용부서			     ,USRBM.TBRK_USER B			WHERE A.USER_ID = B.USER_ID			     AND A.TEAM_CD <> B.TEAM_CD			     AND A.TEAM_CD LIKE  '%' || NVL(? , A.TEAM_CD) || '%'			     AND B.USER_NM LIKE  '%' || NVL(? , B.USER_NM) || '%'             ORDER BY B.ORD_NO
        ]]>
    </query>         <query id="d01000011_s02" desc="팀쿼리" fetchSize="10">        <![CDATA[				SELECT 				          GROUP_ID      TEAM_CD				         ,GROUP_NAME    TEAM_NM				FROM USRBM.V_GROUP DEPT 				WHERE GROUP_ID LIKE 'GA12%'				ORDER BY GROUP_ORDER        ]]>    </query>           <query id="d01000011_u01" desc="권한적용부서 수정" fetchSize="10">        <![CDATA[                    UPDATE TBDA_AUTH_APLY_DEPT SET  /* d01000011_u01 */                 DEPT_CD = ?            --사용자                           ,TEAM_CD = ?            --장비구분                                 ,INST_ID = ?            --작성자                           ,INST_DT = SYSDATE      --작성일시            WHERE USER_ID = ?               ]]>    </query>            <query id="d01000011_d02" desc="권한적용부서 삭제" fetchSize="10">        <![CDATA[            DELETE TBDA_AUTH_APLY_DEPT   /* d01000011_d02 */             WHERE USER_ID = ?        ]]>    </query>               <query id="d01000011_m01" desc="권한적용부서 입력" fetchSize="10">        <![CDATA[                         MERGE INTO TBDA_AUTH_APLY_DEPT A  --권한적용부서  관리 /* d01000008_m01 */             USING                        (SELECT                                               USER_ID                       -- 사용자ID                        , ASSO_CD                       -- 대분류코드                                      , DEPT_CD                       -- 부서코드                                     , TEAM_CD                       -- 팀코드                        , ? AS INST_ID                    -- 작성자                                                                    FROM USRBM.TBRK_USER                      WHERE USER_ID   = ? ) B                                ON (                         A.USER_ID = B.USER_ID                )                                     WHEN MATCHED THEN                 UPDATE SET                     A.ASSO_CD          = B.ASSO_CD            --대분류코드                    ,A.DEPT_CD          = B.DEPT_CD            --부서코드                    ,A.TEAM_CD          = B.TEAM_CD            --팀코드             WHEN NOT MATCHED THEN                                   INSERT (                                           A.USER_ID                       -- 사용자ID                        , A.ASSO_CD                       -- 대분류코드                                      , A.DEPT_CD                       -- 부서코드                                     , A.TEAM_CD                       -- 팀코드                        , A.INST_ID                       -- 작성자                        , A.INST_DT                       -- 작성일시                 ) VALUES (                                           B.USER_ID                       -- 사용자ID                        , B.ASSO_CD                       -- 대분류코드                                      , B.DEPT_CD                       -- 부서코드                                     , B.TEAM_CD                       -- 팀코드                        , B.INST_ID                       -- 작성자                        , SYSDATE                       -- 작성일시                 )        ]]>    </query>       <query id="d01000011_d01" desc="권한부서삭제" fetchSize="10">        <![CDATA[            DELETE /* d01000008_d01 */                   FROM TBDA_AUTH_APLY_DEPT A            WHERE USER_ID = ?              AND NOT EXISTS (SELECT 1                            FROM TBDA_MN_AUTH                           WHERE USER_ID = A.USER_ID)                          ]]>    </query>    
</queryMap>