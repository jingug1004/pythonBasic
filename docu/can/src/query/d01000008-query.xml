<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbda_menu_mngr(메뉴관리)">  	<query id="d01000008_s00" desc="MENUGROUP쿼리" fetchSize="10">        <![CDATA[			SELECT			      ROWNUM ROW_ID			    , MN_ID			    , MN_NM			    , ORD_NO			    , UP_MN_ID			    , SCRN_ID			    , URL			    , RMK			    , INST_ID			    , INST_DTM			    , UPDT_ID			    , UPDT_DTM				, DECODE(PERSONAL_DATA_MN,'Y',PERSONAL_DATA_MN,'N') PERSONAL_DATA_MN	-- 개인정보처리 메뉴여부			FROM TBDA_MN			WHERE UP_MN_ID = '000000000'			ORDER BY MN_ID ASC        ]]>    </query>     
    <query id="d01000008_s01" desc="MENUGROUP쿼리" fetchSize="10">
        <![CDATA[
			SELECT					    A.*					    ,B.MN_NM AS UPMNNM				FROM						(									SELECT 											    '0' AS CHK											    , MN_ID											    , MN_NM											    , ORD_NO											    , UP_MN_ID											    , SCRN_ID											    , URL											    , RMK											    , INST_ID											    , INST_DTM											    , UPDT_ID											    , UPDT_DTM											    , CASE WHEN UP_MN_ID = '000000000' THEN '1' ELSE '2' END ISTOP											    											    , DECODE(PERSONAL_DATA_MN,'Y',PERSONAL_DATA_MN,'N') PERSONAL_DATA_MN	-- 개인정보처리 메뉴여부							FROM       			TBDA_MN							START WITH 			UP_MN_ID = NVL(?, '000000000')							CONNECT BY 			UP_MN_ID = PRIOR MN_ID							order siblings by 	UP_MN_ID, ORD_NO						) A						,TBDA_MN B			WHERE  		A.UP_MN_ID = B.MN_ID				  AND 		A.PERSONAL_DATA_MN = 'Y'
        ]]>
    </query> 

     <query id="d01000008_s02" desc="MENULIST쿼리" fetchSize="10">
        <![CDATA[
		SELECT  /* "d01000008_s02" */                      A.USER_ID          -- 사용자ID                         , A.USER_NM        -- 사용자명                             , A.PSWD           -- 비밀번호                    , A.DEPT_CD        -- 부서코드                    , A.DEPT_NM       -- 부서이름                    , A.TEAM_CD       -- 팀코드                    , A.TEAM_NM       -- 팀이름                    , A.FLOC          -- 직위코드                    , A.FGRADE            -- 직위                             , A.TEL_NO         -- 전화번호                             , A.EMAIL         -- 이메일                           , '0' AS CHK                    , NVL(B.PERSONAL_YN,0) PERSONAL_YN                    , B.PERSONAL_MN_IP                    , B.SRCH_YN              FROM  TBRK_USER A,                     (SELECT                               USER_ID                                , MN_ID                            , DECODE(PERSONAL_YN, 'Y', 1, 0) PERSONAL_YN                            , PERSONAL_MN_IP                            , INST_ID                                , INST_DTM                                , UPDT_ID                                , UPDT_DTM                            , SRCH_YN                           FROM TBDA_MN_AUTH                          WHERE MN_ID = ?                    ) B             WHERE A.USER_ID= B.USER_ID(+)               AND B.SRCH_YN IS NOT NULL               AND A.USER_NM LIKE '%' || NVL(?, A.USER_NM) || '%'              ORDER BY A.ORD_NO, A.TEAM_CD, A.FGRADE, A.USER_ID
        ]]>
    </query> 
    <query id="d01000008_s03" desc="동시 작업기준을 위한 작업시간을 조회" fetchSize="10">        <![CDATA[			SELECT /* d01000008_s03 */			       TO_CHAR(SYSDATE, 'YYYYMMDDHH24MI') AS CUR_DTM -- 작업기준일시			FROM   DUAL			        ]]>    </query>  
         <query id="d01000008_s04" desc="권한에 자료 존재 여부 확인" fetchSize="10">        <![CDATA[			SELECT /* d01000008_s04 */			       USER_ID -- 건수			FROM   TBDA_MN_AUTH			WHERE  USER_ID = ?			AND    MN_ID   = ? 			        ]]>    </query>         	<query id="d01000008_i02" desc="권한 추가" fetchSize="10">        <![CDATA[			INSERT /* d01000008_i02 */			       INTO TBDA_MN_AUTH (			      USER_ID			    , MN_ID			    , PERSONAL_YN			    , INST_ID			    , INST_DTM			    , PERSONAL_MN_IP			    , PERSONAL_AUTH_ID			    , PERSONAL_AUTH_CHK			    , PERSONAL_AUTH_DT			    , SRCH_YN			) VALUES (			      ?                 -- USER_ID			    , ?                 -- MN_ID			    , ?                 -- PERSONAL_YN			    , ?                 -- INST_ID			    			    , SYSDATE           -- INST_DT			    , ?					-- PERSONAL_MN_IP			    , ?					-- PERSONAL_AUTH_ID			    , ?					-- PERSONAL_AUTH_CHK			    , ? 				-- PERSONAL_AUTH_DT			    , ?					-- SRCH_YN			)        ]]>    </query>         <query id="d01000008_i03" desc="개인정보 처리내역 저장" fetchSize="10">        <![CDATA[			INSERT /* d01000008_i03 */			  INTO TBDA_PERSONAL_MN_AUTH_HIST (			            SEQ_NO			          , PERSONAL_MN_ID			          , PERSONAL_AUTH_ID			          , PERSONAL_AUTH_CHK			          , PERSONAL_AUTH_DT			          , USER_ID			          , PERSONAL_MN_IP				) VALUES (				        (SELECT NVL(MAX(SEQ_NO),0)+1 FROM TBDA_PERSONAL_MN_AUTH_HIST)         -- SEQ_NO				      , ? 		  -- PERSONAL_MN_ID				      , ?		  -- PERSONAL_AUTH_ID				      , ?		  -- PERSONAL_AUTH_CHK				      , ? 		  -- PERSONAL_AUTH_DT				      , ?		  -- USER_ID				      , ?		  -- PERSONAL_MN_IP			)        ]]>    </query>         <query id="d01000008_u02" desc="권한 수정" fetchSize="10">        <![CDATA[			UPDATE /* d01000008_u02 */			       TBDA_MN_AUTH			SET    PERSONAL_YN = ?				-- 개인정보처리메뉴 사용여부(Y:사용, N:미사용)			     , PERSONAL_MN_IP = ?			-- 개인정보처리메뉴 사용자 IP			     , PERSONAL_AUTH_ID = ?			-- 개인정보처리메뉴 권한부여자			     , PERSONAL_AUTH_CHK = ?		-- 개인정보처리메뉴 권한체크(Y:부여, N:말소)			     , PERSONAL_AUTH_DT = SYSDATE	-- 개인정보처리메뉴 권한부여일시 			     , UPDT_ID = ?					-- 수정자 사번			     , UPDT_DTM = SYSDATE			-- 수정일시			WHERE  USER_ID = ?					-- 사용자 사번			AND    MN_ID   = ?					-- 메뉴ID        ]]>    </query>     
</queryMap>