<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbdb_cmpt_edu_outl_mngr(종합교육일정)">

    <query id="tbdb_cmpt_edu_outl_fb001" desc="기수 조회" fetchSize="10">
        <![CDATA[
			SELECT CD_NM AS RACER_PERIO_NO
			FROM TBDA_SPEC_CD	
			WHERE GRP_CD = 'A10001'
			ORDER BY CD DESC		
		]]>
    </query>     
             
    <query id="tbdb_cmpt_edu_outl_fb002" desc="강사 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					GUD_LECTR_ID
					,NM_KOR
					,BLNG
			FROM
				    TBDB_GUD_LECTR
			WHERE	
					USE_YN = '001'
			ORDER BY 
					NM_KOR			
		]]>
    </query>
    
    <query id="item_code_d02000002" desc="종목코드 조회" fetchSize="10">
        <![CDATA[
			SELECT 
			        TGC.GRP_CD      	-- 그룹코드
			      , TGC.GRP_NM      	-- 그룹명
			      , TSC.CD              -- 코드
			      , TSC.CD_NM       	-- 코드명
			      , TSC.RMK         	-- 비고
			FROM    TBDA_GRP_CD  TGC
			      , TBDA_SPEC_CD TSC
			WHERE TGC.GRP_CD = TSC.GRP_CD
			AND   TSC.DEL_YN = 'N'
			AND   TGC.GRP_CD IN ('D10064','D10030','D10088','D10089','D10090')
        ]]>
    </query>  
        
    <query id="tbdb_cmpt_edu_outl_fb003" desc="교육개요 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					? AS RACER_PERIO_NO
					,'2' AS GBN
					,MIN(DT) AS EDU_STR_DT
					,MAX(DT) AS EDU_END_DT
					,TRUNC(ABS(MONTHS_BETWEEN(MAX(DT),  MIN(DT))))+1 AS EDU_MM
					,SUM(EDU_TIME) AS TOT_EDU_TIME 
			FROM	TBDB_DETL_EDU_ASSIGN
			WHERE	RACER_PERIO_NO = ?
		]]>
    </query>
    
    <query id="tbdb_cmpt_edu_outl_fb004" desc=" 시간배정표 조회" fetchSize="10">
		<![CDATA[
			SELECT  
					? AS RACER_PERIO_NO	
			    	,SECTN_CD
					,CRS_CD
					,'0' AS NO_RACER_TIME
					,SUM(EDU_TIME) AS RACER_TIME
					,'' AS LECTR
					,'' AS BLNG
					,'' AS RMK
					,'0' CHK
			FROM	TBDB_DETL_EDU_ASSIGN
			WHERE RACER_PERIO_NO = NVL(?, RACER_PERIO_NO)
			AND SECTN_CD = NVL(?, SECTN_CD)
			GROUP BY SECTN_CD, CRS_CD
			ORDER BY SECTN_CD, CRS_CD					
	    ]]>
    </query>
    <query id="tbdb_cmpt_edu_outl_fb005" desc="확정" fetchSize="10">
		<![CDATA[
			SELECT 	RACER_PERIO_NO
		    		,MN_ID
		    		,CFM_FG 
		    FROM  TBDB_CFM
			WHERE RACER_PERIO_NO = ?
			AND TRIM(MN_ID) = ?
  	    ]]>
    </query>  
    <query id="tbdb_cmpt_edu_outl_fb006" desc="세부일정조회" fetchSize="10">
		<![CDATA[ 
		 SELECT   
					 RACER_PERIO_NO
					,SEQ
					,DT
					,STR_END_TIME
					,SECTN_CD
					,CRS_CD
					,DETL_EDU_CRS
					,OBJ
					,LECTR
					,PLC     
					,EDU_TIME
			FROM	TBDB_DETL_EDU_ASSIGN
			WHERE RACER_PERIO_NO = NVL(?, RACER_PERIO_NO)
			AND SECTN_CD = NVL(?, SECTN_CD)
			ORDER BY SECTN_CD, CRS_CD	
			]]>
    </query>  
    
    <query id="tbdb_cmpt_edu_outl_fb007" desc="교육인원 조회" fetchSize="10">
        <![CDATA[
			SELECT 
					 CNT_SND_SELT AS EDU_PERS_NO
			FROM
					 TBDB_SELT_BAS
			WHERE RACER_PERIO_NO = ?		
		]]>
    </query>    
          
    <query id="tbdb_cmpt_edu_outl_ib001" desc=" 교육개요 입력" fetchSize="10">
        <![CDATA[
			INSERT INTO TBDB_CMPT_EDU_OUTL (
			      RACER_PERIO_NO
			    , GBN
			    , EDU_STR_DT
			    , EDU_END_DT
			    , EDU_MM
			    , TOT_EDU_TIME
			    , EDU_PERS_NO
			    , INST_ID
			    , INST_DTM
			)VALUES (
				 ?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,SYSDATE
				
			)    
		]]>
    </query>
    <query id="tbdb_cmpt_edu_outl_ib002" desc="시간배정표 입력" fetchSize="10">
        <![CDATA[
			INSERT INTO TBDB_CMPT_EDU_ASSIGN (
			      RACER_PERIO_NO
			    , SECTN_CD
			    , CRS_CD
			    , NO_RACER_TIME
			    , RACER_TIME
			    , LECTR
			    , BLNG
			    , RMK
			    , INST_ID
			    , INST_DTM
			    
			) VALUES (
				 ?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,SYSDATE
				
			)    
		]]>
    </query>   
    <query id="tbdb_cmpt_edu_outl_ub001" desc="교육개요 갱신" fetchSize="10">
        <![CDATA[
			UPDATE TBDB_CMPT_EDU_OUTL 
			SET
			       EDU_STR_DT     = ?
			     , EDU_END_DT     = ?
			     , EDU_MM         = ?
			     , TOT_EDU_TIME   = ?
			     , EDU_PERS_NO    = ?
			     , UPDT_ID        = ?
			     , UPDT_DTM       = SYSDATE
			WHERE 
				   RACER_PERIO_NO = ?
			AND    GBN            = ?    
		]]>
    </query>
    
    <query id="tbdb_cmpt_edu_outl_ub002" desc="시간배정표 갱신" fetchSize="10">
        <![CDATA[
			UPDATE TBDB_CMPT_EDU_ASSIGN
			SET
				 NO_RACER_TIME  = ?
			     , RACER_TIME     = ?
			     , LECTR          = ?
			     , BLNG           = ?
			     , RMK            = ? 
			     , UPDT_ID        = ?
			     , UPDT_DTM       = SYSDATE
			WHERE 
				   RACER_PERIO_NO = ?
			AND    SECTN_CD       = ?	   
			AND    CRS_CD         = ?    
		]]>
    </query>
          
    <query id="tbdb_cmpt_edu_outl_db001" desc="시간배정표 삭제" fetchSize="10">
        <![CDATA[
			DELETE 
			FROM   TBDB_CMPT_EDU_ASSIGN 
			WHERE
			       RACER_PERIO_NO = ?
			AND    SECTN_CD       = ?   
			AND    CRS_CD         = ?   
		]]>
    </query>     
    
</queryMap>