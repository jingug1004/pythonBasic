<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbef_equip_unfix_run_unfix_run 비정기 출주">
    <query id="tbef_equip_unfix_run_ff001" desc="비정기 출주 조회" fetchSize="50">
        <![CDATA[
            /* 비정기 출주 조회 */
			SELECT 
				0 AS CHK , -- check
				STND_YEAR, 	-- 기준년도 
				MBR_CD, 	-- 경정장 코드 
				TMS, 	-- 회차 
				DAY_ORD, 	-- 일차 
				SEQ, 	-- 일련번호 
				RUN_DT, 	-- 출주일자 
				MOT_NO, 	-- 모터 번호 
				BOAT_NO, 	-- 보트 번호 
				SUBSTR(MOT_NO,1,1)||SUBSTR(MOT_NO,6,3) AS MOT_REG_NO, 	-- 모터 등록 번호 
				SUBSTR(BOAT_NO,1,1)||SUBSTR(BOAT_NO,6,3) AS BOAT_REG_NO,	-- 보트 등록 번호 
				RUN_CNT, 	-- 출주 수 
				RMK	-- 비고 
			FROM TBEF_EQUIP_UNFIX_RUN TEU
			WHERE STND_YEAR = ?
			AND MBR_CD LIKE ?||'%'
			AND SUBSTR(MOT_NO,1,1)||SUBSTR(MOT_NO,6,3) LIKE DECODE(?, 'M', ?||'%', SUBSTR(MOT_NO,1,1)||SUBSTR(MOT_NO,6,3))
        	AND SUBSTR(BOAT_NO,1,1)||SUBSTR(BOAT_NO,6,3) LIKE DECODE(?, 'B', ?||'%', SUBSTR(BOAT_NO,1,1)||SUBSTR(BOAT_NO,6,3))
        	
			
        ]]>
    </query> 
    <query id="tbef_equip_unfix_run_if001" desc="비정기 출주 저장" fetchSize="10">
        <![CDATA[
            /* 비정기 출주 입력 */
			INSERT INTO TBEF_EQUIP_UNFIX_RUN (
			   STND_YEAR, 	-- 기준년도 
			   MBR_CD, 	-- 경정장 코드 
			   TMS, 	-- 회차 
			   DAY_ORD, 	-- 일차 
			   SEQ, 	-- 일련번호 
			   RUN_DT, 	-- 출주일자 
			   MOT_NO, 	-- 모터 번호 
			   BOAT_NO, 	-- 보트 번호 
			   RUN_CNT, 	-- 출주 수 
			   RMK, 	-- 비고 
			   INST_ID, 	-- 작성자 
			   INST_DTM	-- 작성일시 
			 ) 
			VALUES (
				?, 	-- 기준년도 
				?, 	-- 경정장 코드 
				?,	-- 회차 
			    ?, 	-- 일차 
			    SQ_TBEF_EQUIP_UNFIX_RUN.NEXTVAL, 	-- 일련번호 
			    ?,	-- 출주일자 
			    NVL((SELECT EQUIP_NO FROM TBEF_EQUIP TE WHERE TE.STND_YEAR=? AND TE.MBR_CD = ? AND TE.EQUIP_REG_NO=SUBSTR(?,2,3) AND TE.USE_YN ='Y' AND TE.EQUIP_TPE_CD='M'), 'M000'), 	-- 모터 번호 
			    NVL((SELECT EQUIP_NO FROM TBEF_EQUIP TE WHERE TE.STND_YEAR=? AND TE.MBR_CD = ? AND TE.EQUIP_REG_NO=SUBSTR(?,2,3) AND TE.USE_YN ='Y' AND TE.EQUIP_TPE_CD='B'), 'B000'),	-- 보트 번호 
			    ?,	-- 추주수 
			    ?, 	-- 비고 
			    ?, 	-- 작성자 
			    SYSDATE	-- 작성일시 
			 )
        ]]>
    </query> 
    <query id="tbef_equip_unfix_run_uf001" desc="비정기 출주 수정" fetchSize="10">
        <![CDATA[
            /* 비정기 출주  수정 */
			UPDATE TBEF_EQUIP_UNFIX_RUN
			SET 
					MBR_CD = ?, 	-- 경정장 코드 
					TMS = ?, 	-- 회차 
					DAY_ORD = ?, 	-- 일차    
					RUN_DT    = ?,	-- 출주일자 
			       MOT_NO    = NVL((SELECT EQUIP_NO FROM TBEF_EQUIP TE WHERE TE.STND_YEAR=? AND TE.MBR_CD = ? AND TE.EQUIP_REG_NO=SUBSTR(?,2,3) AND TE.USE_YN ='Y' AND TE.EQUIP_TPE_CD='M'), 'M000'), 	-- 모터 번호 
			       BOAT_NO   = NVL((SELECT EQUIP_NO FROM TBEF_EQUIP TE WHERE TE.STND_YEAR=? AND TE.MBR_CD = ? AND TE.EQUIP_REG_NO=SUBSTR(?,2,3) AND TE.USE_YN ='Y' AND TE.EQUIP_TPE_CD='B'), 'B000'),	-- 보트 번호 
			       RUN_CNT   = ?,	-- 출주 수 
			       RMK       = ?,	-- 비고 
			       UPDT_ID   = ?,	-- 수정자 
			       UPDT_DTM  = SYSDATE	-- 수정일시 
			WHERE  STND_YEAR = ?	-- 기준년도 
			AND    SEQ       = ?	-- 일련번호 

			       
        ]]>
    </query> 
    <query id="tbef_equip_unfix_run_df001" desc="삭제" fetchSize="10">
        <![CDATA[
            /* 비정기 출주 삭제 */
			DELETE 
			FROM TBEF_EQUIP_UNFIX_RUN
			WHERE  STND_YEAR = ?	-- 기준년도 
			AND    SEQ       = ?	-- 일련번호 

        ]]>
    </query> 
</queryMap>