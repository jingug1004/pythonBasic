<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="COM CODE">
    <query id="common_sysdate" desc="조회" fetchSize="10">
        <![CDATA[
			SELECT  /* common_sysdate */
			          TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') DATETIME
			        , TO_CHAR(SYSDATE, 'YYYYMMDD'        ) YYYYMMDD
			        , TO_CHAR(SYSDATE, 'HH24MISS'        ) TIME
			        , TO_CHAR(SYSDATE, 'YYYY'            ) YEAR
			        , TO_CHAR(SYSDATE, 'MM'              ) MONTH
			        , TO_CHAR(SYSDATE, 'DD'              ) DAY
			        , TO_CHAR(SYSDATE, 'HH24'            ) HOUR
			        , TO_CHAR(SYSDATE, 'MI'              ) MINUTE
			        , TO_CHAR(SYSDATE, 'SS'              ) SECOND
			        , TO_CHAR(SYSDATE, NVL(?, 'YYYYMMDD')) CUSTOM
			FROM    DUAL
        ]]>
    </query> 
    <query id="common_code" desc="조회" fetchSize="10">
        <![CDATA[
			SELECT  /* common_code */
			        TGC.GRP_CD      -- 그룹코드
			      , TGC.GRP_NM      -- 그룹명
			      , TSC.CD          -- 코드
			      , TSC.CD_NM       -- 코드명
			      , TSC.RMK         -- 비고
			      , TSC.PROV		-- 조항
			FROM    TBDM_GRP_CD  TGC
			      , TBDM_SPEC_CD TSC
			WHERE TGC.GRP_CD = TSC.GRP_CD
			AND   TSC.DEL_YN = 'N'
			AND   TGC.GRP_CD = ?
			ORDER BY TSC.RMK, TSC.CD
        ]]>
    </query>
     
	<query id="common_search_emp" desc="사원 조회" fetchSize="10">
        <![CDATA[
            SELECT   /* common_search_emp */
                      '0' AS CHK
                     ,TEAM_CD
                     ,TEAM_NM
                     ,DEPT_CD
                     ,DEPT_NM
                     ,FGRADE
                     ,FLOC
                     ,USER_ID
                     ,USER_NM                
                     ,DISP_ORDER
              FROM   VWEA_USER 
             WHERE   1=1
               AND   USER_ID LIKE '%' || NVL(? , USER_ID) || '%'
               AND   USER_NM LIKE '%' || NVL(? , USER_NM) || '%'
             ORDER BY DISP_ORDER  
        ]]>
    </query>
    
	<query id="common_search_emp" desc="사원 조회" fetchSize="10">
        <![CDATA[
            SELECT   /* common_search_emp */
                      '0' AS CHK
                     ,TEAM_CD
                     ,TEAM_NM
                     ,DEPT_CD
                     ,DEPT_NM
                     ,FGRADE
                     ,FLOC
                     ,USER_ID
                     ,USER_NM                
                     ,DISP_ORDER
              FROM   VWEA_USER 
             WHERE   1=1
               AND   USER_ID LIKE '%' || NVL(? , USER_ID) || '%'
               AND   USER_NM LIKE '%' || NVL(? , USER_NM) || '%'
             ORDER BY DISP_ORDER  
        ]]>
    </query>
    
    
    <query id="common_insert_alarm_hist" desc="알림이력 입력" fetchSize="10">

            INSERT INTO USRBM.TBRK_ALARM_HIST (  /* common_insert_alarm_hist */

				 ALARM_GBN    --알람구분
				,RECV_ID      --받는사람ID
				,SEQ_NO       --일련번호
				,MN_ID        --메뉴ID
				,HP_NO        --이동전화번호				
				,TITLE        --제목
				,CNTNT        --내용
				,SMS_SEQ_NO
				,INST_ID      --작성자ID
				,INST_DT      --작성일시
            ) VALUES (
                  ?             -- ALARM_GBN
                , ?             -- RECV_ID
                , USRBM.SQ_TBRK_ALARM_HIST.NEXTVAL    -- SEQ_NO
                , ?             -- MN_ID
                , ?             -- HP_NO
                , ?             -- TITLE               
                , ?             -- CNTNT
                , ?             -- SMS_SEQ_NO
                , ?             -- INST_ID              
                , SYSDATE       -- INST_DT
            )

    </query> 
    
    <query id="common_update_alarm_hist" desc="알림이력 수정 " fetchSize="10">
            UPDATE USRBM.TBRK_ALARM_HIST (  /* common_update_alarm_hist */
                 SMS_SEQ_NO    --SMS 전송 번호 
            WHERE ALARM_GBN = ?
                AND RECV_ID = ?
                AND SEQ_NO = ?
    </query> 
    
    
     <query id="common_insert_smsdata" desc="SMS 전송 입력 " fetchSize="10">
			 INSERT /* common_insert_smsdata */
			        INTO SMS.SMSDATA(
			        SEQNO,   --
			        INDATE,  
			        INTIME,  
			        MEMBER, 
			        SENDID,   
			
			        RPHONE1, 
			        RPHONE2, 
			        RPHONE3, 
			        RECVNAME,
			        
			        SPHONE1,
			        SPHONE2, 
			        SPHONE3, 
			        SENDNAME,
			        
			        MSG, 
			        URL, 
			
			        RDATE, 
			        RTIME, 
			        RESULT, 
			        KIND, 
			        ERRCODE,  
			        SYS_GBN, 
			        USERID 
			)VALUES(
			        ?,   --SEQNO
			        TO_CHAR (SYSDATE, 'yyyymmdd'), 
			        TO_CHAR (SYSDATE, 'hh24miss'),     
			        0, 
			        'kcycle',
			       
			        ?,    --RPHONE1
			        ?,    --RPHONE2
			        ?,    --RPHONE3
			        ?,    --RECVNAME
			       
			        ?,    --SPHONE1
			        ?,    --SPHONE2
			        ?,    --SPHONE3
			        ?,    --SENDNAME
			
			        SUBSTRB(?, 1, 120),    --MSG 
			        '', 
			        '00000000', '000000', 
			        '0', 'S', 0,     
			        'USRBM', 
			        ?  -- SENDUSERID    
			
			)

    </query> 
    
    <query id="common_select_smsdata_key" desc="SMS DATA KEY 조회" fetchSize="10">
      <![CDATA[
            SELECT /* common_select_smsdata_key */
                 SMS.SQ_SMSDATA.NEXTVAL  SMS_SEQ_NO  -- SMS DATA KEY
            FROM DUAL                       
        ]]>
    </query>
    
    
    <query id="common_select_mmsdata_key" desc="SMS DATA KEY 조회" fetchSize="10">
      <![CDATA[
            SELECT /* common_select_smsdata_key */
                 SMS.SEQNO.NEXTVAL  SMS_SEQ_NO  -- SMS DATA KEY
            FROM DUAL                       
        ]]>
    </query>
    
    
     <query id="common_insert_mmsdata" desc="LMS 전송 입력 " fetchSize="10">
			 INSERT /* rsy7010_i03 */
			        INTO SMS.MMSDATA(
			        SEQNO,   		-- 연번
              		USERCODE, 		-- 고객사코드
              		INTIME,  		-- 요청일시              		
              		REQTIME, 		-- 예약발송시간
              		RECVTIME,		-- 단말기 수신시간
                   	CALLPHONE, 		-- 수신자 전화번호
                   	REQPHONE, 		-- 발송자 전화번호
                   	SUBJECT, 		-- 제목
                   	MSG,     		-- 문자메세지 내용
                   	FKCONTENT, 		-- 미디어 외부참조키
                   	MEDIATYPE, 		-- 단말기 통신사 코드
                   	RESULT,			-- 결과   
                   	ERRCODE			-- 오류코드
            ) VALUES (
                    ?, 
                    'kcycle', 
                    TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'), 
                    ?, 
                    NULL,
                    REPLACE(?,'-',''), 
                    ?, 
                    SUBSTRB(?,1,80), 
                    ?, 
                    0, 
                    NULL, 
                    '0', 
                    0) 

    </query>
    
    <query id="cand_perio_no" desc="후보생 기수(전체포함) 조회" fetchSize="10">
      <![CDATA[     
			SELECT CD, CD_NM
			FROM  TBDM_SPEC_CD
			WHERE GRP_CD  = 'D10000'
			UNION ALL
			SELECT NULL, '전체' FROM DUAL
			ORDER BY CD DESC
        ]]>
    </query>      
    
    <query id="personal_mn" desc="조회" fetchSize="10">
        <![CDATA[
			SELECT PERSONAL_DATA_MN,
			       ? AS PERSONAL_MN_ID
			  FROM TBDM_MN
			 WHERE MN_ID = ?
        ]]>
    </query> 
    
    
    <query id="personal_id_chk" desc="조회" fetchSize="10">
        <![CDATA[
			SELECT PERSONAL_AUTH_CHK, USER_ID, concat(concat('[',PERSONAL_MN_IP),']') AS PERSONAL_MN_IP  
			  FROM (
			        SELECT SEQ_NO, PERSONAL_AUTH_CHK, USER_ID, PERSONAL_MN_IP
			          FROM TBDM_PERSONAL_MN_AUTH_HIST
			         WHERE PERSONAL_MN_ID = ?
			           AND USER_ID = ?
			        ORDER BY SEQ_NO DESC    
			       )
			 WHERE ROWNUM = 1 
        ]]>
    </query>    
    
</queryMap>
