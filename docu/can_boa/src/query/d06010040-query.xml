<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="출주표"> 
    <query id="tbdn_cand_race_fn401" desc="기수 조회" fetchSize="10">
		<![CDATA[
            SELECT
			         TCI .RACER_PERIO_NO     -- 기수      
			       , TCI .CAND_NO            -- 후보생번호
			       , TCI .NM_KOR             -- 후보생명
			       , TCR .TOT_BOAT_TIME      -- 승정시간
			       , TCRR.BOAT_TIME          -- 승정시간
            FROM     (
                        SELECT
                                 TCRO.CAND_NO                 -- 훈련생번호
                               , SUM(TCR.BOAT_TIME)                 TOT_BOAT_TIME
                        FROM     TBDN_CAND_RACE_ORGAN TCRO
                               , TBDN_CAND_RACE_RACE  TCR
            			WHERE  TCR .RACER_PERIO_NO   = TCRO.RACER_PERIO_NO       -- 기수      
            			AND    TCR .DAY_NO           = TCRO.DAY_NO               -- 출주번호  
            			AND    TCR .ROUND            = TCRO.ROUND                -- 라운드    
            			AND    TCR .GBN              = NVL(?, TCR .GBN)          -- 구분    
            			AND    TCR .RACER_PERIO_NO   = ?                         -- 기수    
                        GROUP BY TCRO.CAND_NO                                    -- 훈련생번호
                     ) TCR
                   , (
                        SELECT
                                 TCRO.CAND_NO                 -- 훈련생번호
                               , SUM(TCR.BOAT_TIME)                 BOAT_TIME
                        FROM     TBDN_CAND_RACE_ORGAN TCRO
                               , TBDN_CAND_RACE_RACE  TCR
            			WHERE  TCR .RACER_PERIO_NO   = TCRO.RACER_PERIO_NO       -- 기수      
            			AND    TCR .DAY_NO           = TCRO.DAY_NO               -- 출주번호  
            			AND    TCR .ROUND            = TCRO.ROUND                -- 라운드    
            			AND    TCR .GBN              = NVL(?, TCR .GBN)          -- 구분    
            			AND    TCR .RACER_PERIO_NO   = ?                         -- 기수    
            			AND    TCR .DAY_NO           = ?                         -- 출주번호  
            			AND    TCR .ROUND            = ?                         -- 라운드    
                        GROUP BY TCRO.CAND_NO                                    -- 훈련생번호
                     ) TCRR
                   , TBDN_CAND_IDENT TCI
            WHERE  TCI .CAND_NO          = TCR .CAND_NO(+)
            AND    TCI .CAND_NO          = TCRR.CAND_NO(+)
			AND    TCI .RACER_PERIO_NO   = ?       -- 기수
            ORDER BY TCI .CAND_NO
	    ]]>
    </query>
    <query id="tbdn_cand_race_fn402" desc="기수 조회" fetchSize="10">
		<![CDATA[
            SELECT
                     ROUND(AVG(TOT_BOAT_TIME)) AVG_BOAT_TIME
                   , MAX(TOT_BOAT_TIME)        MAX_BOAT_TIME
                   , MIN(TOT_BOAT_TIME)        MIN_BOAT_TIME
            FROM   (
                        SELECT
                                 TCRO.CAND_NO                 -- 훈련생번호
                               , SUM(TCR.BOAT_TIME)                 TOT_BOAT_TIME
                        FROM     TBDN_CAND_RACE_ORGAN TCRO
                               , TBDN_CAND_RACE_RACE  TCR
            			WHERE  TCR .RACER_PERIO_NO   = TCRO.RACER_PERIO_NO       -- 기수      
            			AND    TCR .DAY_NO           = TCRO.DAY_NO               -- 출주번호  
            			AND    TCR .ROUND            = TCRO.ROUND                -- 라운드    
            			AND    TCR .GBN              = NVL(?, TCR .GBN)          -- 구분   
            			AND    TCR .RACER_PERIO_NO   = ?                         -- 기수    
            			AND    TCRO.CAND_NO IS NOT NULL
                        GROUP BY TCRO.CAND_NO                                    -- 훈련생번호
                   )
	    ]]>
    </query>
</queryMap>