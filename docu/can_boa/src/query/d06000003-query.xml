<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="(세부교육일정)"> 
    <query id="tbdn_detl_edu_assign_fn001" desc="세부일정조회" fetchSize="10">
		<![CDATA[
			SELECT  '0' CHK
					,RACER_PERIO_NO
					,SEQ
					,DT
					,(SELECT WK FROM TBDN_WK_ABS WHERE RACER_PERIO_NO = ? AND DT BETWEEN STR_DT AND END_DT) AS WK 
					,STR_END_TIME
					,SECTN_CD
					,CRS_CD
					,DETL_EDU_CRS
					,OBJ
					,LECTR
					,PLC     
					,EDU_TIME
			FROM	TBDN_DETL_EDU_ASSIGN
			WHERE	RACER_PERIO_NO = ?
			AND		YY       = NVL(?, YY)	
			AND		TRIM(MM) = NVL(?, MM)
			ORDER BY DT, STR_END_TIME	  		
	    ]]>
    </query>

    <query id="tbdn_detl_edu_assign_fn002" desc="기수쿼리" fetchSize="10">
        <![CDATA[
			   
			   SELECT  CD  RACER_PERIO_NO
				 FROM  TBDM_SPEC_CD
				 WHERE GRP_CD  = 'D10000'
				 ORDER BY CD DESC
		]]>
    </query>      
  
    <query id="tbdn_detl_edu_assign_fn003" desc="강사조회" fetchSize="10">
        <![CDATA[
			SELECT 
					 GUD_LECTR_ID AS USER_ID
					,NM_KOR AS USER_NM
			FROM 	TBDN_GUD_LECTR
		]]>
    </query>     
    
    <query id="tbdn_detl_edu_assign_fn004" desc="년도조회" fetchSize="10">
        <![CDATA[
			SELECT  RMK AS YY_CD, RMK AS YY_NM
			FROM    TBDM_SPEC_CD
			WHERE GRP_CD = 'D10000'
			AND DEL_YN = 'N'
			ORDER BY RMK DESC
		]]>
    </query>     
                
    <query id="tbdn_detl_edu_assign_fn005" desc="확정" fetchSize="10">
        <![CDATA[
		    SELECT 	RACER_PERIO_NO
--		   			,YY
		    		,MN_ID
		    		,CFM_FG 
		    FROM  TBDN_CFM
			WHERE RACER_PERIO_NO = ?
			--AND YY = ?  
			AND TRIM(MN_ID) = ?
        ]]>
    </query>               
            
    <query id="tbdn_detl_edu_assign_in001" desc="세부일정입력" fetchSize="10">
        <![CDATA[
			INSERT INTO TBDN_DETL_EDU_ASSIGN (
			    RACER_PERIO_NO
			    ,SEQ
			    ,YY
			    ,MM
			    ,DT
			    ,STR_END_TIME
			    ,SECTN_CD
			    ,CRS_CD
			    ,DETL_EDU_CRS
			    ,OBJ
			    ,LECTR
			    ,PLC
			    ,EDU_TIME
			    ,INST_ID
			    ,INST_DTM  
			)
			SELECT
				 ?
				,NVL(MAX(SEQ), 0) + 1
				,?
				,?									
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,?
				,SYSDATE 
			FROM 	TBDN_DETL_EDU_ASSIGN
			WHERE 	RACER_PERIO_NO = ?
		]]>
    </query>
    
         
    <query id="tbdn_detl_edu_assign_un001" desc="세부일정 수정" fetchSize="10">
        <![CDATA[
			UPDATE TBDN_DETL_EDU_ASSIGN 
			SET      YY				= ?
					,MM				= ?
					,DT				= ?
					,STR_END_TIME	= ?
					,SECTN_CD		= ?
					,CRS_CD			= ?
					,DETL_EDU_CRS	= ?
					,OBJ			= ?
					,LECTR			= ?
					,PLC     		= ?
					,EDU_TIME		= ?
					,UPDT_ID        = ?
					,UPDT_DTM       = SYSDATE
			WHERE	RACER_PERIO_NO	= ?
			AND		SEQ				= ?
		]]>
    </query>
          
    <query id="tbdn_detl_edu_assign_dn001" desc="세부일정 삭제" fetchSize="10">
        <![CDATA[
			DELETE 
			FROM   	TBDN_DETL_EDU_ASSIGN 
			WHERE	RACER_PERIO_NO	= ?
			AND		SEQ				= ?   
		]]>
    </query>     
    
</queryMap>