<?xml version="1.0" encoding='EUC-KR'?>
<queryMap desc="tbdm_user_mngr(User관리)">
	<query id="tbdm_user_fm001" desc="USERLIST쿼리" fetchSize="10">
        <![CDATA[
			SELECT /* tbdm_user_fm001 */
			       A.USER_ID     -- 사용자ID         
			       , A.USER_NM     -- 사용자명         
			       --, A.PSWD        -- 비밀번호
			       , B.MENU_USE	   -- 메뉴사용 여부         
			       , B.DUTY_GRP_CD -- 업무그룹코드     
			       , A.DEPT_CD     -- 부서코드
			       , A.DEPT_NM	   -- 부서이름
			       , A.TEAM_CD	   -- 팀코드
			       , A.TEAM_NM	   -- 팀이름
			       , A.FLOC		   -- 직위코드
			       , A.FGRADE	   -- 직위         
			       , A.TEL_NO      -- 전화번호         
			       , B.HP_NO       -- 휴대폰번호
			       , A.EMAIL	   -- 이메일       
			       , B.STR_DT      -- 유효기간 시작일자
			       , B.END_DT      -- 유효기간 종료일자
			       , INST_ID     -- 작성자ID         
			       , INST_DTM    -- 작성일시         
			       , UPDT_ID     -- 수정자ID         
			       , UPDT_DTM    -- 수정일시         
			FROM   VWEA_USER A, TBDM_USER B
			WHERE  A.USER_ID = B.USER_ID(+)
			AND	   A.USER_NM LIKE NVL('%' || ? || '%', USER_NM)
			AND	   A.TEAM_NM LIKE NVL('%' || ? || '%', TEAM_NM)
			
        ]]>
    </query>
    
    <query id="tbdm_user_im002" desc="userInsertQuery" fetchSize="10">
        <![CDATA[
		    INSERT INTO TBDM_USER (USER_ID)
			(
			   		SELECT USER_ID 
					FROM USRBM.TBRK_USER	
					WHERE NOT EXISTS 
					( 
						SELECT USER_ID 
						FROM TBDM_USER
						WHERE USRBM.TBRK_USER.USER_ID = TBDM_USER.USER_ID
					)
					AND	  USRBM.TBRK_USER.DEPT_CD LIKE '%'||'GA14'||'%'
		    ) 
    	]]>
    </query>
    
    <query id="tbdm_user_im001" desc="userInsertQuery" fetchSize="10">
        <![CDATA[
			INSERT INTO TBDM_USER (
			      USER_ID
--			    , DUTY_GRP_CD
			    , HP_NO
			    , STR_DT
			    , END_DT
			    , INST_ID
			    , INST_DTM
			    , UPDT_ID
			    , UPDT_DTM)
			VALUES (
			      ?  	       -- USER_ID
--			    , ? 	       -- DUTY_GRP_CD
			    , ? 	       -- HP_NO
			    , ? 	       -- STR_DT
			    , ? 	       -- END_DT
			    , ? 	       -- INST_ID
			    , SYSDATE      -- INST_DTM
			    , ? 	       -- UPDT_ID
			    , SYSDATE      -- UPDT_DTM
			)
        ]]>
    </query>      
        
    	
    <query id="tbdm_user_um001" desc="userUpdateQuery" fetchSize="10">
        <![CDATA[
			MERGE INTO TBDM_USER DST /* userUpdateQuery */			       
		    USING (
		           SELECT ? AS HP_NO
		                 ,? AS STR_DT
		                 ,? AS END_DT
		                 ,? AS MENU_USE
		                 ,? AS UPDT_ID
		                 ,? AS USER_ID
		            FROM DUAL
		            ) SRC
		       ON (
		                 DST.USER_ID = SRC.USER_ID
		           )
		       WHEN MATCHED THEN
		               UPDATE SET
		                        DST.HP_NO    = SRC.HP_NO
		                      , DST.STR_DT   = SRC.STR_DT
		                      , DST.END_DT   = SRC.END_DT
		                      , DST.MENU_USE = SRC.MENU_USE
		                      , DST.UPDT_ID  = SRC.UPDT_ID
		                      , DST.UPDT_DTM = SYSDATE
		       WHEN NOT MATCHED THEN
		                INSERT (
		                       USER_ID
		                      ,HP_NO
		                      ,STR_DT
		                      ,END_DT
		                      ,MENU_USE
		                      ,INST_ID
		                      ,INST_DTM
		              ) VALUES (
		                      SRC.USER_ID
		                     ,SRC.HP_NO
		                     ,SRC.STR_DT
		                     ,SRC.END_DT
		                     ,SRC.MENU_USE
		                     ,SRC.UPDT_ID
		                     ,SYSDATE
		                     )          
        ]]>
    </query>       
    
     <query id="tbdm_user_dm001" desc="userDeleteQuery" fetchSize="10">
        <![CDATA[
			DELETE FROM TBDM_USER
			WHERE USER_ID       = ?    
        ]]>
    </query>             
</queryMap>