<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="comReportViewer" Left="8" OnLoadCompleted="fn_FormLoadSetting" OnSize="comReportViewer_OnSize" PidAttrib="7" Title="Report&#32;Viewer" Top="8" Ver="1.0" Width="793" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsRpt"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_paramPop"></Dataset>
		</Datasets>
		<Ubi Bottom="582" Height="580" Id="rptViewer" Left="2" Right="788" Top="2" Width="786">
			<_PersistData>&#13;&#10;/6yE8JIr/wAAAQA8UQAAd/I7APjy//7//fL4/PcMDwACBVQAWQBfUABFADD48QH+8C8DMQAyLwABNQH99S8CXgBuSQR0+vn+8C8L&#13;&#10;MgA1agAsOwBrCQRlD28FAfv07vGhAxQGswT+NAIHRABlAGYAH2EAdQBsVwMxAs4F7AIC1gTwv/vzBVMAxWjCAGVXAQID+fUDdH+t&#13;&#10;vLm0zAAA&#13;&#10;</_PersistData>
		</Ubi>
	</Form>
	<Script><![CDATA[function fn_FormLoadSetting(obj) {

	// SQL 방식
	if (fSQLCallFlag) {
		var RptFile="";
		if(isExistVar("sRptNm")) {
			RptFile = sRptNm;
		}
	
		if(isExistVar("paramDsId")) {
			ds_paramPop.Copy(parent.Object(paramDsId));
		} else {
			ds_paramPop.Copy(parent.Object("ds_reportParam"));
		}
		var sDirNm = mid(RptFile,0,3);
		rptViewer.ServletURL1="http://can.kcycle.or.kr/can/UbiForm";
		rptViewer.ServletURL2="http://can.kcycle.or.kr/can/UbiData";

		rptViewer.setJrfFileDir("/web/waspage/can_boa/report/"); // 절대 경로 주의!
        rptViewer.datasource = "uscanboa#jdbc/MRADB"; 								// 경주사업관리
        rptViewer.setJrfFileName(sRptNm);                                //Report File Name
		rptViewer.setJrfFileName(RptFile + ".jrf");
		rptViewer.FontRevision = true;
		//rptViewer.utfData = true;
		rptViewer.IsDeflater = true;
		rptViewer.SetVariable("isBase64", "true");

		
	
		for(var i=0; i<ds_paramPop.RowCount(); i++) {
			rptViewer.SetArgument(trim(ds_paramPop.GetColumn(i, "PARAM_NM")), trim(ds_paramPop.GetColumn(i, "PARAM_VAL")));
		}

		rptViewer.Retrieve();                                            //Report View
		
		//trace(ds_paramPop.savexml());
	} else {
			
		var i = 0;                                                       //Looper
		var arrDataSetList  = array();                                   //DataSet List
		var arrArgumentList = array();                                   //Argument List
		var arrArgument = array();                                       //Argument
	
		rptViewer.ServletURL1=GBL_RPTSURL1;                              //SERVLET URL1
		rptViewer.ServletURL2=GBL_RPTSURL2;                              //SERVLET URL2
		rptViewer.setFileURL(GBL_RPTFURL1);                              //Image File Context Root
	
		rptViewer.setJrfFileDir(GBL_RPTFILEPATH);                        //Report Path
		rptViewer.setJrfFileName(GBL_RPTFILENAME);                       //Report File Name
		
		arrDataSetList = split(GBL_RPTDATASET, ",");                     //Dataset Array List
		for (i=0; i<arrDataSetList.length(); i++) {                      //Dataset Setting
			rptViewer.SetDataset(arrDataSetList[i], arrDataSetList[i]);  //DataSource(UbiReport SQL(UDS ID) 명, Mi DataSet)
		}
		
		arrArgumentList = split2(GBL_RPTARGUMENT, "^", ",");             //Argument Array List
		for (i=0; i<arrArgumentList.length(); i++) {                     //Argument List Setting
			arrArgument = split(arrArgumentList[i], ","); 
			rptViewer.SetArgument(replace(arrArgument[0],'[',''),replace(arrArgument[1],']',''));                      //Argument Setting
		}
		
		rptViewer.Retrieve();                                            //Report View
		
		GBL_RPTFILEPATH = '';                                            //Variable Clear
		GBL_RPTFILENAME = '';                                            //Variable Clear
		GBL_RPTDATASET  = '';                                            //Variable Clear
		GBL_RPTARGUMENT = '';                                            //Variable Clear
		
		// Ubi.ServletURL1 = "";
		// Ubi.ServletURL2 = "";
		
		// Ubi.setFileURL("C:/Documents and Settings/Administrator/바탕 화면/UbiReport/sample/");
		// Ubi.setJrfFileDir("C:/Documents and Settings/Administrator/바탕 화면/UbiReport/sample/");
		// Ubi.setJrfFileName("sample.jrf");
		// Ubi.SetDataset("sql1", "ds_mip");
		// Ubi.SetArgument("arg", "arg value");
		
		// Ubi.Retrieve();
	}
}

function comReportViewer_OnSize(obj,nCx,nCy,nState)
{
	rptViewer.Width = nCx - 10;
	rptViewer.Height = nCy - rptViewer.Top  - 10;	
}
]]></Script>
</Window>