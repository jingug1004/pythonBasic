<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="D06000014" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="교육훈련일지" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsSearchPerioNo">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDiaryMst">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="WEATHER1" size="256" summ="default" type="STRING"/>
					<colinfo id="WEATHER2" size="256" summ="default" type="STRING"/>
					<colinfo id="WIND_DIRC1" size="256" summ="default" type="STRING"/>
					<colinfo id="WIND_DIRC2" size="256" summ="default" type="STRING"/>
					<colinfo id="WIND_SPD1" size="256" summ="default" type="STRING"/>
					<colinfo id="WIND_SPD2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMPT2" size="256" summ="default" type="STRING"/>
					<colinfo id="HUMID1" size="256" summ="default" type="STRING"/>
					<colinfo id="HUMID2" size="256" summ="default" type="STRING"/>
					<colinfo id="WAT_TEMP1" size="256" summ="default" type="STRING"/>
					<colinfo id="WAT_TEMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="WAT_LEV" size="256" summ="default" type="STRING"/>
					<colinfo id="INSTR" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_PLC" size="256" summ="default" type="STRING"/>
					<colinfo id="IND_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PERS_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_PERS_NO" size="256" summ="default" type="INT"/>
					<colinfo id="ABS_PERS_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_PERS_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ABS_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="WEATHER1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WEATHER2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WIND_DIRC1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WIND_DIRC2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="AM" size="256" summ="default" type="STRING"/>
					<colinfo id="PM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDiaryDetl" OnColumnChanged="dsDiaryDetl_OnColumnChanged" OnLoadCompleted="dsDiaryDetl_OnLoadCompleted">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="SECTN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_DETL" size="256" summ="default" type="STRING"/>
					<colinfo id="SECTN_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="AMPM_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDiaryAbs">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="RACER_PERIO_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CAND_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="NM_KOR" size="256" summ="default" type="STRING"/>
					<colinfo id="SECTN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EDU_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="AMPM_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10020</CD_GRP_ID>
						<DESCRIPTION>날씨코드</DESCRIPTION>
						<DSNAME>dsInputWeather</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10021</CD_GRP_ID>
						<DESCRIPTION>풍향코드</DESCRIPTION>
						<DSNAME>dsInputWindDirc</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10027</CD_GRP_ID>
						<DESCRIPTION>과정코드</DESCRIPTION>
						<DSNAME>dsInputSectnCd</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>과목코드</DESCRIPTION>
						<DSNAME>dsInputCrsCd</DSNAME>
						<QUERY_ID>item_code_d06000014_fn001</QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10075</CD_GRP_ID>
						<DESCRIPTION>위반코드</DESCRIPTION>
						<DSNAME>dsViol</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10087</CD_GRP_ID>
						<DESCRIPTION>오전오후코</DESCRIPTION>
						<DSNAME>dsAmPmCd</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInputWeather">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInputWindDirc">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInputSectnCd">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInputCrsCd">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDiaryAcdnt">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ROUND" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_REG_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CAND_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_CNTNT" size="256" summ="default" type="STRING"/>
					<colinfo id="REPAIT_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="NM_KOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDiaryAbsReport">
				<Contents>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="DT" size="256" type="STRING"/>
					<colinfo id="SEQ" size="256" type="STRING"/>
					<colinfo id="STR_END_TIME" size="256" type="STRING"/>
					<colinfo id="CAND_NO" size="256" type="STRING"/>
					<colinfo id="NM_KOR" size="256" type="STRING"/>
					<colinfo id="SECTN_CD" size="256" type="STRING"/>
					<colinfo id="CRS_CD" size="256" type="STRING"/>
					<colinfo id="EDU_TIME" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPerioNoCount">
				<Contents>
					<colinfo id="P_COUNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsViol">
				<Contents>
					<colinfo id="GRP_CD" size="256" type="STRING"/>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
					<colinfo id="PROV" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSearchLectr">
				<Contents>
					<colinfo id="LECTR_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCfm">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" type="STRING"/>
					<colinfo id="DT" size="256" type="STRING"/>
					<colinfo id="CFG_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEduWkDayCnt">
				<Contents>
					<colinfo id="RACER_PERIO_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="WK" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsAmPmCd">
				<Contents>
					<colinfo id="GRP_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" Right="1008" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="24" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Static Align="Right" Height="20" Id="Static6" Left="12" Style="snis_if_lable" TabOrder="26" Text="기수" Top="34" VAlign="Middle" Width="36"></Static>
		<Combo Border="Flat" CodeColumn="RACER_PERIO_NO" DataColumn="RACER_PERIO_NO" Enable="FALSE" Height="20" Id="cbSearchPerioNo" ImeMode="none" INDEX="0" InnerDataset="dsSearchPerioNo" Left="50" OnChanged="cbSearchPerioNo_OnChanged" Style="snis_if_input01" TabOrder="1" Top="33" Width="127"></Combo>
		<Div Height="20" Id="divBtnLst" Left="678" TabOrder="27" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="23" Text="조회조건" Top="6" VAlign="Middle" Width="274"></Static>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="25" Top="8" Width="17"></Image>
		<Calendar Border="Flat" Enable="FALSE" Height="20" Id="CalSearchDt" Left="218" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="2" Top="34" Width="86"></Calendar>
		<Static Align="Right" Height="20" Id="Static1" Left="180" Style="snis_if_lable" TabOrder="28" Text="일자" Top="34" VAlign="Middle" Width="36"></Static>
		<Shape BKColor="#ff8500" Bottom="70" Height="6" Id="Shape1" Left="12" LineKind="Vertical" LineWidth="0" Right="18" RoundHeight="10" RoundWidth="10" TabOrder="30" Top="64" Type="Ellipse" Width="6"></Shape>
		<Static Height="20" Id="Static7" Left="24" Style="snis_m_stitle" TabOrder="29" Text="기록측정&#32;상태" Top="58" VAlign="Middle" Width="92"></Static>
		<Shape BKColor="user2" Bottom="296" Height="216" Id="Shape3" Left="7" LineColor="user3" Right="1009" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="31" Top="80" Type="RoundRect" Width="1002"></Shape>
		<Combo BindDataset="dsDiaryMst" Border="Flat" CodeColumn="CD" Column="WEATHER1" DataColumn="CD_NM" Height="20" Id="cbWeather1" INDEX="0" InnerDataset="dsInputWeather" Left="137" Style="snis_m_input01" TabOrder="3" Top="91" Width="94"></Combo>
		<Static Align="Center" Border="Flat" Height="20" Id="Static37" Left="10" Style="snis_m_lable" TabOrder="34" Text="날씨&#32;" Top="92" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static24" Left="603" Style="snis_m_lable" TabOrder="33" Text="풍속&#32;" Top="92" VAlign="Middle" Width="46"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="WIND_SPD1" Height="20" Id="edWindSpd1" Left="651" MaxLength="5" Style="snis_m_input01" TabOrder="7" Top="92" Width="92"></Edit>
		<Static Align="Center" Border="Flat" Height="36" Id="Static16" Left="10" Style="snis_m_lable" TabOrder="32" Text="기타사항" Top="250" VAlign="Middle" Width="126"></Static>
		<TextArea BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="ETC_DESC" Height="36" Id="taEtcDesc" Left="138" MaxLength="2000" Style="snis_m_input01" TabOrder="19" Top="250" VScroll="TRUE" Width="870"></TextArea>
		<Combo BindDataset="dsDiaryMst" Border="Flat" CodeColumn="CD" Column="WIND_DIRC1" DataColumn="CD_NM" Height="20" Id="cbWindDirc1" InnerDataset="dsInputWindDirc" Left="395" Style="snis_m_input01" TabOrder="5" Top="91" Width="94"></Combo>
		<Static Align="Center" Border="Flat" Height="20" Id="Static0" Left="348" Style="snis_m_lable" TabOrder="35" Text="풍향&#32;" Top="92" VAlign="Middle" Width="46"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static8" Left="10" Style="snis_m_lable" TabOrder="36" Text="기온" Top="114" VAlign="Middle" Width="126"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsDiaryDetl" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="584" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="130" Id="grdDiaryDetl" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnCellClick="grdDiaryDetl_OnCellClick" OnHeadClick="fcGridSort" Right="613" SelColor="user19" Style="snis_grid" TabOrder="21" TabStop="true" Top="454" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="607">
			<contents>
				<format id="Default">
					<columns>
						<col width="31"/>
						<col width="81"/>
						<col width="113"/>
						<col width="54"/>
						<col width="54"/>
						<col width="189"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="red" display="text" text="체크"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="과정구분"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="교육과목"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="오전오후"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="교육시간"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="교육상세"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="expr:decode(CHK,&apos;0&apos;,&apos;checkbox&apos;,&apos;none&apos;)"/>
						<cell align="center" col="1" colid="SECTN_CD" combocol="CD" combodataset="dsInputSectnCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="2" colid="CRS_CD" combocol="CD" combodataset="dsInputCrsCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="3" colid="AMPM_CD" combocol="CD" combodataset="dsAmPmCd" combotext="CD_NM" display="combo" edit="combo"/>
						<cell align="center" col="4" colid="EDU_TIME" display="text" edit="normal"/>
						<cell align="center" col="5" colid="EDU_DETL" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="#ff8500" Bottom="366" Height="6" Id="Shape2" Left="624" LineKind="Vertical" LineWidth="0" Right="630" RoundHeight="10" RoundWidth="10" TabOrder="38" Top="360" Type="Ellipse" Width="6"></Shape>
		<Static Height="20" Id="Static12" Left="626" Style="snis_m_stitle" TabOrder="37" Text="불참시간&#32;내역" Top="434" VAlign="Middle" Width="92"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsDiaryAbs" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="584" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="130" Id="grdDiaryAbs" InputPanel="FALSE" Left="616" LineColor="user18" MinWidth="100" OnCellClick="grdDiaryAbs_OnCellClick" OnChar="grdDiaryAbs_OnChar" OnHeadClick="fcGridSort" Right="1008" SelColor="user19" Style="snis_grid" TabOrder="22" TabStop="true" Top="454" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="392">
			<contents>
				<format id="Default">
					<columns>
						<col width="44"/>
						<col width="62"/>
						<col width="90"/>
						<col width="100"/>
						<col width="70"/>
						<col width="100"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="red" display="text" font="굴림,9,Bold" text="체크"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="순번"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="학번"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="성명"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="불참시간"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" display="text" expr="currow+1"/>
						<cell align="center" col="2" colid="CAND_NO" display="text"/>
						<cell align="center" col="3" colid="NM_KOR" display="text"/>
						<cell align="center" col="4" colid="EDU_TIME" display="text" edit="numchar"/>
						<cell align="center" col="5" colid="RMK" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsDiaryAcdnt" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="424" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="104" Id="grdDiaryAcdnt" InputPanel="FALSE" Left="6" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="1008" SelColor="user19" Style="snis_grid" TabOrder="20" TabStop="true" Top="320" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1002">
			<contents>
				<format id="Default">
					<columns>
						<col width="58"/>
						<col width="58"/>
						<col width="63"/>
						<col width="45"/>
						<col width="97"/>
						<col width="89"/>
						<col width="122"/>
						<col width="168"/>
						<col width="140"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" text="출주번호"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="라운드"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="조번호"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="정번"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="학번"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="성명"/>
						<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="위반내용"/>
						<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="사고내용"/>
						<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="조치사항"/>
					</head>
					<body>
						<cell align="center" col="0" colid="DAY_NO" display="text"/>
						<cell align="center" col="1" colid="ROUND" display="text"/>
						<cell align="center" col="2" colid="TEAM_NO" display="text"/>
						<cell align="center" col="3" colid="RACE_REG_NO" display="text"/>
						<cell align="center" col="4" colid="CAND_NO" display="text"/>
						<cell align="center" col="5" colid="NM_KOR" display="text"/>
						<cell align="left" col="6" colid="VIOL_NM" display="normal"/>
						<cell align="left" col="7" colid="VIOL_CNTNT" display="text"/>
						<cell align="left" checklength="Byte" col="8" colid="REPAIT_DESC" display="text" edit="normal" limit="400"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Combo BindDataset="dsDiaryMst" Border="Flat" CodeColumn="CD" Column="WEATHER2" DataColumn="CD_NM" Height="20" Id="cbWeather2" INDEX="0" InnerDataset="dsInputWeather" Left="241" Style="snis_m_input01" TabOrder="4" Top="91" Width="94"></Combo>
		<Static Height="12" Id="Static14" Left="231" TabOrder="47" Text="~" Top="96" Width="10"></Static>
		<Static Height="12" Id="Static13" Left="489" TabOrder="47" Text="~" Top="96" Width="10"></Static>
		<Combo BindDataset="dsDiaryMst" Border="Flat" CodeColumn="CD" Column="WIND_DIRC2" DataColumn="CD_NM" Height="20" Id="cbWindDirc2" InnerDataset="dsInputWindDirc" Left="498" Style="snis_m_input01" TabOrder="6" Top="91" Width="94"></Combo>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="WIND_SPD2" Height="20" Id="edWindSpd2" Left="757" MaxLength="5" Style="snis_m_input01" TabOrder="8" Top="92" Width="92"></Edit>
		<Static Height="12" Id="Static15" Left="746" TabOrder="48" Text="~" Top="96" Width="10"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static17" Left="10" Style="snis_m_lable" TabOrder="49" Text="근태현황&#32;" Top="136" VAlign="Middle" Width="126"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static18" Left="138" Style="snis_m_lable" TabOrder="50" Text="총원&#32;" Top="136" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static19" Left="287" Style="snis_m_lable" TabOrder="51" Text="현원&#32;" Top="136" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static20" Left="435" Style="snis_m_lable" TabOrder="51" Text="결원" Top="136" VAlign="Middle" Width="70"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="TEMPT1" Height="20" Id="edTempt1" Left="138" MaxLength="5" Style="snis_m_input01" TabOrder="9" Top="114" Width="92"></Edit>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="TEMPT2" Height="20" Id="edTempt2" Left="242" MaxLength="5" Style="snis_m_input01" TabOrder="10" Top="114" Width="92"></Edit>
		<Static Height="12" Id="Static10" Left="231" TabOrder="51" Text="~" Top="118" Width="10"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static9" Left="348" Style="snis_m_lable" TabOrder="51" Text="습도" Top="114" VAlign="Middle" Width="46"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="HUMID2" Height="20" Id="edHumid2" Left="499" MaxLength="5" Style="snis_m_input01" TabOrder="12" Top="114" Width="92"></Edit>
		<Static Height="12" Id="Static11" Left="489" TabOrder="52" Text="~" Top="118" Width="10"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="HUMID1" Height="20" Id="edHumid1" Left="396" MaxLength="5" Style="snis_m_input01" TabOrder="11" Top="114" Width="92"></Edit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static21" Left="603" Style="snis_m_lable" TabOrder="53" Text="수온" Top="114" VAlign="Middle" Width="46"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="WAT_TEMP1" Height="20" Id="edWatTempt1" Left="651" MaxLength="5" Style="snis_m_input01" TabOrder="13" Top="114" Width="92"></Edit>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="WAT_TEMP2" Height="20" Id="edWatTempt2" Left="757" MaxLength="5" Style="snis_m_input01" TabOrder="14" Top="114" Width="92"></Edit>
		<Static Height="12" Id="Static22" Left="730" TabOrder="53" Text="~" Top="118" Width="10"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static23" Left="864" Style="snis_m_lable" TabOrder="55" Text="수위" Top="114" VAlign="Middle" Width="46"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="WAT_LEV" Height="20" Id="edWatLev" Left="912" MaxLength="5" Style="snis_m_input01" TabOrder="15" Top="114" Width="92"></Edit>
		<Static Height="12" Id="Static2" Left="746" TabOrder="54" Text="~" Top="120" Width="10"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="INSTR" Height="20" Id="edInstr" Left="723" MaxLength="100" Style="snis_m_input01" TabOrder="16" Top="136" Width="281"></Edit>
		<Static Align="Center" Border="Flat" Height="20" Id="Static3" Left="603" Style="snis_m_lable" TabOrder="55" Text="참여교관" Top="136" VAlign="Middle" Width="119"></Static>
		<Static Align="Center" Border="Flat" Height="20" Id="Static5" Left="10" Style="snis_m_lable" TabOrder="55" Text="교육장소" Top="158" VAlign="Middle" Width="126"></Static>
		<Edit BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="EDU_PLC" Height="20" Id="edEduPlc" Left="137" MaxLength="30" Style="snis_m_input01" TabOrder="17" Top="158" Width="870"></Edit>
		<Static Align="Center" Border="Flat" Height="68" Id="Static25" Left="10" Style="snis_m_lable" TabOrder="56" Text="지시사항" Top="180" VAlign="Middle" Width="126"></Static>
		<Div BKColor="user0" Height="23" Id="divSearch" Left="314" TabOrder="69" Text="Div0" Top="34" Url="common::comButtonSearch.xml" Width="60">
			<Contents></Contents>
		</Div>
		<Static Height="20" Id="Static4" Left="24" Style="snis_m_stitle" TabOrder="70" Text="위반및사고내용" Top="298" VAlign="Middle" Width="92"></Static>
		<Shape BKColor="#ff8500" Bottom="310" Height="6" Id="Shape4" Left="16" LineKind="Vertical" LineWidth="0" Right="22" RoundHeight="10" RoundWidth="10" TabOrder="72" Top="304" Type="Ellipse" Width="6"></Shape>
		<Shape BKColor="#ff8500" Bottom="366" Height="6" Id="Shape5" Left="12" LineKind="Vertical" LineWidth="0" Right="18" RoundHeight="10" RoundWidth="10" TabOrder="76" Top="360" Type="Ellipse" Width="6"></Shape>
		<Static Height="20" Id="Static26" Left="16" Style="snis_m_stitle" TabOrder="75" Text="상세교육내용" Top="434" VAlign="Middle" Width="92"></Static>
		<Edit Align="RIGHT" BindDataset="dsDiaryMst" Border="Flat" BorderColor="user16" Column="TOT_PERS_NO" DisableBKColor="user16" Enable="FALSE" Height="20" Id="edTotPersNo" Left="210" Style="snis_if_input01" TabOrder="71" Top="136" Width="74"></Edit>
		<Edit Align="RIGHT" BindDataset="dsDiaryMst" Border="Flat" BorderColor="user16" Column="CURR_PERS_NO" DisableBKColor="user16" Enable="FALSE" Height="20" Id="edCurrPersNo" Left="362" Style="snis_if_input01" TabOrder="72" Top="136" Width="66"></Edit>
		<Edit Align="RIGHT" BindDataset="dsDiaryMst" Border="Flat" BorderColor="user16" Column="ABS_PERS_NO" DisableBKColor="user16" Enable="FALSE" Height="20" Id="edAbsPersNo" Left="511" Style="snis_if_input01" TabOrder="72" Top="136" Width="68"></Edit>
		<TextArea BindDataset="dsDiaryMst" Border="Flat" CheckLength="Byte" Column="IND_DESC" Height="68" Id="txaIndDesc" Left="138" MaxLength="2000" Style="snis_m_input01" TabOrder="18" Top="180" VScroll="TRUE" Width="870"></TextArea>
		<Button ButtonStyle="TRUE" Enable="FALSE" Height="20" Id="btnCfm" ImageID="btn_pop_txt_02" Left="832" OnClick="btnCfm_OnClick" Style="snis_btn" TabOrder="65" Text="확정" Top="34" Transparent="TRUE" Width="40"></Button>
		<Button ButtonStyle="TRUE" Enable="FALSE" Height="20" Id="btnCfmCls" ImageID="btn_pop_txt_04" Left="874" OnClick="btnCfmCls_OnClick" Style="snis_btn" TabOrder="64" Text="확정취소" Top="34" Transparent="TRUE" Width="62"></Button>
		<Div Height="20" Id="divDiaryDetl" Left="560" TabOrder="66" Text="Div0" Top="432" Url="common::comButtonRow.xml" Width="42">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Height="20" Id="btnWkSche" ImageID="btn_pop_txt_11" Left="412" OnClick="btnWkSche_OnClick" Style="snis_btn" TabOrder="67" Text="주간교육계획&#32;가져오기" Top="433" Transparent="TRUE" Width="152"></Button>
		<Static Color="orangered" Height="18" Id="Static27" Left="103" TabOrder="68" Text="[체크]하면&#32;해당&#32;과정에&#32;[예외인원&#32;내역]&#32;설정&#32;가능" Top="440" Width="293"></Static>
		<Static Color="orangered" Height="21" Id="stcEdu" Left="714" TabOrder="69" Top="437" Width="88"></Static>
		<Button ButtonStyle="TRUE" Enable="FALSE" Height="20" Id="btnMakeDiary" ImageID="btn_pop_txt_10" Left="697" OnClick="fcDiaryMstAdd" Style="snis_btn" TabOrder="70" Text="교육훈련일지&#32;생성" Top="34" Transparent="TRUE" Width="135"></Button>
		<Button ButtonStyle="TRUE" Enable="FALSE" Height="20" Id="btnElec" ImageID="btn_pop_txt_04" Left="938" OnClick="fcElecPayment" Style="snis_btn" TabOrder="71" Text="전자결재" Top="34" Transparent="TRUE" Width="62"></Button>
		<Edit Height="21" Id="TxtContents" Left="528" TabOrder="72" Top="21" Visible="FALSE" Width="49"></Edit>
		<Ubi Bottom="45" Height="37" Id="rptViewer" Left="408" Right="501" Top="8" Visible="FALSE" Width="93">
			<_PersistData>&#13;&#10;/6wNLvOQ/wAAAQCdCQAAd9MDAPjy//7//fL4/PcMDwACBVQAWQBfUABFADD48QH+8C8DMQAyLwABNQH99S8CXgBuSQR0+vn+8C8L&#13;&#10;MgA1agAsOwBrCQRlD28FAfv07vGhBxQGtwT+NAIHRABlAGYAH2EAdQBsVwP48pkB7Pn82wTwv/r0BVMAxWjGAGVXAQID+fUDdF+t&#13;&#10;vLm0zNgHFPr0MwIwLwD+9AEx7vBBEg==&#13;&#10;</_PersistData>
		</Ubi>
		<Static Color="orangered" Height="16" Id="Static28" Left="860" TabOrder="74" Text="체크를&#32;하셔야&#32;저장됩니다." Top="437" Width="152"></Static>
		<Shape BKColor="#ff8500" Bottom="446" Height="6" Id="Shape6" Left="8" LineKind="Vertical" LineWidth="0" Right="14" RoundHeight="10" RoundWidth="10" TabOrder="75" Top="440" Type="Ellipse" Width="6"></Shape>
		<Shape BKColor="#ff8500" Bottom="446" Height="6" Id="Shape7" Left="616" LineKind="Vertical" LineWidth="0" Right="622" RoundHeight="10" RoundWidth="10" TabOrder="76" Top="440" Type="Ellipse" Width="6"></Shape>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::can_common_script.js";
#include "lib::can_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'D06000014';
var sBUTTONLIST   = 'TTFFTT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var sLastPeriodNo = "";                         // 현재의 최종기수보관
//var sMenuListNum    = "0";                          // 메뉴리스트의 갯수보관
//var sMenuUpId       = "";
//var sMenuUpNm       = "";

var sDiaryDetlDt	= "";
var sDiaryDetlSeq	= "";
var sStrEndTime		= "";
var sSectnCd		= "";
var sCrsCd			= "";
var sAmPmCd			= "";

var iGTotPersNo		= "";
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'F'+sInpt+'FTTT';
    
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	//초기 화면 BK Color설정 
	fnc_SetBKColor(this);
	CalSearchDt.Value = Today();
	//공통코드 조회
	fcd_GetComboDs(dsInComCd);
	
	// 화면 초기화
	fcInit();
	
	//기수쿼리
	fcPerioNo();
	
	btnMakeDiary.Enable = false;	//[교육훈련일지 생성] 버튼 비활성화
	
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/

function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "dsDiaryMst|dsDiaryDetl|dsDiaryAcdnt|dsDiaryAbs";
	if ( !fnc_FormUnloadCheck(sDataset , sFormId) ) return false;
}


/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}

	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
/*
    if ( obj.id == "btnCancel" || obj.id == "btnSearch" ) {
		dsDiaryMst.ClearData();
		dsDiaryAcdnt.ClearData();
		dsDiaryDetl.ClearData();
		dsDiaryAbs.ClearData();
		dsEduWkDayCnt.ClearData();
    }    
*/    
	dsDiaryMst.ClearData();
	dsDiaryAcdnt.ClearData();
	dsDiaryDetl.ClearData();
	dsDiaryAbs.ClearData();
	dsEduWkDayCnt.ClearData();
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/

function fcSearchCheck(obj) {
//    edSCfrntCd.Text = Trim(edSCfrntCd.Text);
	if(length(CalSearchDt.Value) <= 0){	
		//날짜는 필수 저장
		fnc_Message(SNIS_CAN_A003, "N");
		return;
	}	
	fcInit(obj);
	stcEdu.text = "";	//상세교육내용 체크된 과목명 없애기
	
	return true;
}

function fcSearch(obj) {

    if ( !fcSearchCheck(obj) ) return;
	        
    
    var sServiceName = "d06000014-service:searchPerioNoCount";
    var sInDataSet   = "";
    var sOutDataSet  = " dsPerioNoCount=dsPerioNoCount dsSearchLectr=dsSearchLectr "; 
	
	fcd_AddParam("racerPerioNo", Trim(cbSearchPerioNo.Value));
	fcd_AddParam("dt", Trim(CalSearchDt.Value));
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
    
            
    var sServiceName = "d06000014-service:searchDiaryMst";
    var sInDataSet   = "";
    var sOutDataSet  = " dsDiaryMst=dsDiaryMst dsDiaryDetl=dsDiaryDetl dsDiaryAcdnt=dsDiaryAcdnt dsSearchLectr=dsSearchLectr dsCfm=dsCfm dsEduWkDayCnt=dsEduWkDayCnt ";	
	fcd_AddParam("racerPerioNo", Trim(cbSearchPerioNo.Value));
	fcd_AddParam("dt", Trim(CalSearchDt.Value));
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
	 
}

//기수콤보
function fcPerioNo() {
	var racerPerioNo = null;
	var sServiceName = "d06000014-service:searchPerioNo";
    var sInDataSet   = "";
    var sOutDataSet  = " dsSearchPerioNo=dsSearchPerioNo "; 
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
}


/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {
	//변경된 자료가 있는지 체크
	var iDataCheck = 0;
	if(fnc_DatasetChangeCheck(dsDiaryMst) > 0){ //마스터 
		iDataCheck++;
	}
	if(fnc_DatasetChangeCheck(dsDiaryAcdnt) > 0){ //사고
		iDataCheck++;
	}		
	if(fnc_DatasetChangeCheck(dsDiaryDetl) > 0){ //상세
		iDataCheck++;
	}
	if(fnc_DatasetChangeCheck(dsDiaryAbs) > 0){	//결원		
		iDataCheck++;
	}
	 
	if(iDataCheck == 0){
		//저장 할 자료가 없음
		fnc_Message(SNIS_COM_1006, "N");	
		return;	
	}
		
	if(length(CalSearchDt.Value) <= 0){	
		//날짜는 필수 저장
		fnc_Message(SNIS_CAN_A003, "N");
		return;
	}
	
	//오전오후 구분자 입력여부 체크
    for(var i=0; i<dsDiaryDetl.rowcount; i++) {
		if(fnc_IsNull(dsDiaryDetl.GetColumn(i, "SECTN_CD"))) {
			fnc_Message(SNIS_COM_1035, "Y","상세교육내용의 [과정구분]은 ");
			return;
		}
		if(fnc_IsNull(dsDiaryDetl.GetColumn(i, "CRS_CD"))) {
			fnc_Message(SNIS_COM_1035, "Y","상세교육내용의 [교육과목]은");
			return;
		}
		if(fnc_IsNull(dsDiaryDetl.GetColumn(i, "AMPM_CD"))) {
			fnc_Message(SNIS_COM_1035, "Y","상세교육내용의 [오전오후] 구분은");
			return;
		}
		if(fnc_IsNull(dsDiaryDetl.GetColumn(i, "EDU_TIME"))) {
			fnc_Message(SNIS_COM_1035, "Y","상세교육내용의 [교육시간]은");
			return;
		}
		if(fnc_IsNull(dsDiaryDetl.GetColumn(i, "EDU_DETL"))) {
			fnc_Message(SNIS_COM_1035, "Y","상세교육내용의 [교육상세]는");
			return;
		}
	}

	return true;
}

function fcSave(obj) {
    
   if ( !fcSaveCheck() ) return;
    
//    fcSaveSetting();
           
    var sServiceName = "";
    var sInDataSet   = "";
    var sOutDataSet  = "";    
    var iCount = 0;   
       
    //결원 카운트 구하기 
    for(var i=0; i<dsDiaryAbs.rowcount; i++) {
		if (ToString(dsDiaryAbs.GetColumn(i, "CHK")) == "1"){
			iCount++;
		}
	} 

    //교육훈련일지   
    sServiceName  = "d06000014-service:saveDiaryMst";
    sInDataSet    = "dsDiaryMst=dsDiaryMst:u ";
    sOutDataSet   = "dsDiaryMst=dsDiaryMst ";

    for(var i=0; i<dsDiaryMst.rowcount; i++) {  
        dsDiaryMst.SetColumn(i, "RACER_PERIO_NO", Trim(cbSearchPerioNo.Value));
        dsDiaryMst.SetColumn(i, "DT", Trim(CalSearchDt.Value));
     //   dsDiaryMst.SetColumn(i, "ABS_PERS_NO", iCount);        
    }
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);


	//교육훈련사고
    sServiceName  = "d06000014-service:saveDiaryAcdnt";
    sInDataSet    = "dsDiaryAcdnt=dsDiaryAcdnt:u ";
    sOutDataSet   = "dsDiaryAcdnt=dsDiaryAcdnt ";
    for(var i=0; i<dsDiaryAcdnt.rowcount; i++) {  
        dsDiaryAcdnt.SetColumn(i, "RACER_PERIO_NO", Trim(cbSearchPerioNo.Value));
        dsDiaryAcdnt.SetColumn(i, "DT", Trim(CalSearchDt.Value));
    }
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);      
        
        
    //교윤훈련상세   
    sServiceName  = "d06000014-service:saveDiaryDetl";
    sInDataSet    = "dsDiaryDetl=dsDiaryDetl:u ";
    sOutDataSet   = "dsDiaryDetl=dsDiaryDetl ";
    for(var i=0; i<dsDiaryDetl.rowcount; i++) {   
        dsDiaryDetl.SetColumn(i, "RACER_PERIO_NO", Trim(cbSearchPerioNo.Value));
        dsDiaryDetl.SetColumn(i, "DT", Trim(CalSearchDt.Value));
    }    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
 
	//교육훈련결원
    sServiceName  = "d06000014-service:saveDiaryAbs";
    sInDataSet    = "dsDiaryAbs=dsDiaryAbs:u ";
    sOutDataSet   = "dsDiaryAbs=dsDiaryAbs ";
    
    for(var i=0; i<dsDiaryAbs.rowcount; i++) {   
        dsDiaryAbs.SetColumn(i, "RACER_PERIO_NO", Trim(cbSearchPerioNo.Value));
        dsDiaryAbs.SetColumn(i, "DT", Trim(CalSearchDt.Value));
        dsDiaryAbs.SetColumn(i, "SEQ", sDiaryDetlSeq);
        dsDiaryAbs.SetColumn(i, "STR_END_TIME", sStrEndTime);
        dsDiaryAbs.SetColumn(i, "SECTN_CD", sSectnCd);
        dsDiaryAbs.SetColumn(i, "CRS_CD", sCrsCd);
        dsDiaryAbs.SetColumn(i, "AMPM_CD", sAmPmCd);
    }
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
}


/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
	var sExcelList = "grdDiaryAcdnt:위반및사고내용|grdDiaryDetl:상세교육내용|grdDiaryAbs:재외인원내역";
    fcd_OpenExcelListExport(sExcelList);
}

/*-------------------------------------------------------------------------------------------------+
>>  인쇄 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcPrint(obj) {
	var sAm  = "";  // 오전훈련
	var sPm  = "";  // 오후훈련

	for (var i=0;i<dsDiaryDetl.RowCount();i++){
		if(dsDiaryDetl.GetColumn(i,"AMPM_CD") == "001") {	//오전교육
			sAm = sAm + dsDiaryDetl.GetColumn(i,"EDU_DETL") + "\n";
		}
		if(dsDiaryDetl.GetColumn(i,"AMPM_CD") == "002") {	//오후교육
			sPm = sPm + dsDiaryDetl.GetColumn(i,"EDU_DETL") + "\n";
		}
	}
	
	dsDiaryMst.SetColumn(0,"AM",sAm);
	dsDiaryMst.SetColumn(0,"PM",sPm);
	
	var logImgUrl = GBL_REPORT_URL+"log.jpg";
	var sSubUrl   = "";                     //레포트 파일이 있는 서브디렉토리
	var sRptNm    = "d06009014_1.jrf";      //레포트 파일명
	var sDataSet  = "dsDiaryMst=dsDiaryMst dsDiaryDetl=dsDiaryDetl dsDiaryAcdnt=dsDiaryAcdnt dsEduWkDayCnt=dsEduWkDayCnt";    //"UBI 쿼리명, MIP Dataset명"
	var sEduWk    = dsEduWkDayCnt.GetColumn(0,"WK");
	var sDayCnt   = dsEduWkDayCnt.GetColumn(0,"DAY_CNT");
	//var sArg      = "PerioNo="+ cbSearchPerioNo.Value+" W1="+cbWeather1.Text+" W2="+cbWeather2.Text+" W3="+cbWindDirc1.Text+" W4="+cbWindDirc2.Text+" ABS=" + sAbs +" EDUWK=" + sEduWk + " DAY_CNT=" + sDayCnt;		
	var sArg      = "PerioNo="+ cbSearchPerioNo.Value+" W1="+cbWeather1.Text+" W2="+cbWeather2.Text+" W3="+cbWindDirc1.Text+" W4="+cbWindDirc2.Text+" EDUWK=" + sEduWk + " DAY_CNT=" + sDayCnt;		
	var sRptDrct  = 1;                      //출력방향(0 : 수직, 1 : 수평)
	fnc_RPTPrint(sSubUrl, sRptNm, sDataSet, sArg, sRptDrct);
}


/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}


/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
    fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {

}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex){
	fnc_SetPopupDivCalendar(objGrd, nRow, nCell);
}


/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/

function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

    if ( !fnc_result(ErrorCode, ErrorMSG) ) return;

	var iCurrPersNo = 0; //현원
	var iAbsPersNo  = 0; //결원
	switch(sServiceName) {
        // 기수조회 
        case "d06000014-service:searchPerioNo" :	
			if ( IsExistVar("Arg_sDt") ) {
                if ( !fnc_IsNull(Arg_sDt) && !fnc_IsNull(Arg_sPerio) ) {
                    CalSearchDt.Value = Arg_sDt;
                    cbSearchPerioNo.Value = Arg_sPerio;
                }
            } else {
               calSearchDt.Value = Today();
            }
            fcSearch();
			break;
			
        // 기수카운터 조회
        case "d06000014-service:searchPerioNoCount" :	
			iGTotPersNo = toNumber(dsPerioNoCount.GetColumn(0,"P_COUNT"));
			break;

        // 일일교육훈련일지 마스터
        case "d06000014-service:searchDiaryMst" :

            if ( dsDiaryMst.GetRowCount() == 0 ) {
				btnMakeDiary.Enable = true;
			} else {
				btnMakeDiary.Enable = false;
			}

/*
			var sWeather1 = ToString(dsDiaryMst.GetColumn(0,"WEATHER1"));
			if(sWeather1 == ""){
				iCurrPersNo 		= iGTotPersNo;
				iAbsPersNo 			= 0;	
				edTotPersNo.value 	= iGTotPersNo;
				edCurrPersNo.value	= iCurrPersNo;
				edAbsPersNo.value 	= iAbsPersNo;
			}
*/			
			
			var Lectr_NM = "";
			
			for(var i=0;i<dsSearchLectr.rowcount;i++){
				Lectr_NM = Lectr_NM + ToString(dsSearchLectr.GetColumn(i, "LECTR_NM")) + ", ";
			}
			
			Lectr_NM = substr(Lectr_NM, 0, Lectr_NM.length-2);
			
			if(dsDiaryMst.GetColumn(0, "INSTR") = null){
				edInstr.Text = Lectr_NM;
			}
			else if(dsDiaryMst.GetColumn(0, "INSTR") = ""){
				edInstr.Text = Lectr_NM;
			}
			
			if((dsCfm.GetColumn(0,"CFG_YN")) == "Y"){
				btnCfm.Enable = false;
				btnCfmCls.Enable = true;			
				divBtnLst.btnPrint.Enable = true;	    //인쇄버튼 활성화
				divBtnLst.btnSave.Enable = false;	    //저장버튼 비활성화
				grdDiaryDetl.Enable = true;             //상세교육내용 비활성화
				grdDiaryAbs.Enable = false;				//제외인원 내역 비활성화
				btnWkSche.Enable = false;               //주가교육계획 가져오기 버튼 비활성화
				divDiaryDetl.btnAddRow.Enable = false;	//(+) 버튼 비활성화
				divDiaryDetl.btnDelRow.Enable = false;	//(-) 버튼 비활성화
				btnElec.Enable = "true";				//전자결재 활성화
				
            }
            else if((dsCfm.GetColumn(0,"CFG_YN")) == "N"){
				btnCfm.Enable = true;
                btnCfmCls.Enable = false;
                divBtnLst.btnPrint.Enable = false;	    //인쇄버튼 비활성화
   				divBtnLst.btnSave.Enable = true;	    //저장버튼 활성화
				grdDiaryDetl.Enable = true;             //상세교육내용 활성화
				grdDiaryAbs.Enable = true;				//제외인원 내역 활성화
				btnWkSche.Enable = true;                //주가교육계획 가져오기 버튼 활성화
				divDiaryDetl.btnAddRow.Enable = true;	//(+) 버튼 활성화
				divDiaryDetl.btnDelRow.Enable = true;	//(-) 버튼 활성화
				btnElec.Enable = "false";				//전자결재 비활성화

            } else{		//오류상황
            	btnCfm.Enable = false;
                btnCfmCls.Enable = false;
                divBtnLst.btnPrint.Enable = false;	    //인쇄버튼 비활성화
				divBtnLst.btnSave.Enable = false;	    //저장버튼 비활성화
				grdDiaryDetl.Enable = false;            //상세교육내용 비활성화
				grdDiaryAbs.Enable = false;				//제외인원 내역 비활성화
				btnWkSche.Enable = false;               //주가교육계획 가져오기 버튼 비활성화
				divDiaryDetl.btnAddRow.Enable = false;	//(+) 버튼 비활성화
				divDiaryDetl.btnDelRow.Enable = false;	//(-) 버튼 비활성화
				btnElec.Enable = "false";				//전자결재 비활성화
            }
            
            break;
            
        case "d06000014-service:saveCfm" : 
			fcSearch();
			break;
		case "d06000014-service:searchDiaryAbs" :
			break;
        case "d06000014-service:saveDiaryAbs" :
			fcSearch();
			break;
		case "d06000014-service:saveDiaryDetlInit" :
			//fcSearchDiaryDetl();
			fcSearch();
			break;	
		case "d06000014-service:searchDiaryDetlOnly" :
			fcDiaryMstAdd();
			break;	
		default :
			break;
	}
    //오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {

}


//결원조회
function grdDiaryDetl_OnCellDBLClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    var sServiceName= "";
    var sInDataSet  = "";
    var sOutDataSet = "";

	var sDt			= "";
	var sSeq		= "";
	for(var i=0; i<dsDiaryDetl.rowcount; i++) {
		if(i == nRow){
			sDiaryDetlDt 	= dsDiaryDetl.GetColumn(i, "DT");
			sDiaryDetlSeq	= dsDiaryDetl.GetColumn(i, "SEQ");
			sStrEndTime		= dsDiaryDetl.GetColumn(i, "STR_END_TIME");	
			sSectnCd		= dsDiaryDetl.GetColumn(i, "SECTN_CD");
			sCrsCd			= dsDiaryDetl.GetColumn(i, "CRS_CD");				
			break;
		}
	}
    
    sServiceName = "d06000014-service:searchDiaryAbs";
    sInDataSet   = "";
    sOutDataSet  = " dsDiaryAbs=dsDiaryAbs ";	
	fcd_AddParam("racerPerioNo", Trim(cbSearchPerioNo.Value));
	fcd_AddParam("dt", sDiaryDetlDt);
	fcd_AddParam("seq", sDiaryDetlSeq);
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);	
}


function dsDiaryDetl_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(Trim(strColumnID) == "SECTN_CD"){
		
		if(varNewValue == "001"){ 		//학과
			dsInputCrsCd.Filter("GRP_CD='D10030'");
		}else if(varNewValue == "002"){ //실기
			dsInputCrsCd.Filter("GRP_CD='D10064'");
		}else if(varNewValue == "003"){ //측정
			dsInputCrsCd.Filter("GRP_CD='D10010'");
		}else if(varNewValue == "004"){ //모트보트조종
			dsInputCrsCd.Filter("GRP_CD='D10078'");
		}
	}	
}

function grdDiaryDetl_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 0 && dsDiaryDetl.getColumn(nRow,"CHK") == "0")
	{
		for(var i =0; i < dsDiaryDetl.rowcount; i++) {
			if( i != nRow)
			{
				dsDiaryDetl.SetColumn(i,"CHK","0");
			}
		}
		
		var sServiceName= "";
		var sInDataSet  = "";
		var sOutDataSet = "";
	
		var sDt			= "";
		var sSeq		= "";
		for(var i=0; i<dsDiaryDetl.rowcount; i++) {
			if(i == nRow){
				sDiaryDetlDt 	= dsDiaryDetl.GetColumn(i, "DT");
				sDiaryDetlSeq	= dsDiaryDetl.GetColumn(i, "SEQ");
				sStrEndTime		= dsDiaryDetl.GetColumn(i, "STR_END_TIME");	
				sSectnCd		= dsDiaryDetl.GetColumn(i, "SECTN_CD");
				sCrsCd			= dsDiaryDetl.GetColumn(i, "CRS_CD");	
				sAmPmCd			= dsDiaryDetl.GetColumn(i, "AMPM_CD");	

				break;
			}
		}
    
        stcEdu.text = "[" + grdDiaryDetl.GetCellText("Body",nRow,2) + "]"; //상세교육내용 체크과목
    
		sServiceName = "d06000014-service:searchDiaryAbs";
		sInDataSet   = "";
		sOutDataSet  = " dsDiaryAbs=dsDiaryAbs ";	
		fcd_AddParam("racerPerioNo", Trim(cbSearchPerioNo.Value));
		fcd_AddParam("dt", sDiaryDetlDt);
		fcd_AddParam("seq", sDiaryDetlSeq);
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);	
	}
	else if(nCell != 0)
	{
		for(var i=0; i<dsDiaryDetl.rowcount; i++) {   
			sCrsCd = dsDiaryDetl.GetColumn(nRow,"SECTN_CD");
			if(sCrsCd == "001"){ 		//학과
				dsInputCrsCd.Filter("GRP_CD='D10030'");
			}else if(sCrsCd == "002"){ //실기
				dsInputCrsCd.Filter("GRP_CD='D10064'");			
			}else if(sCrsCd == "003"){ //측정
				dsInputCrsCd.Filter("GRP_CD='D10010'");
			}else if(sCrsCd == "004"){ //모트보트조종
				dsInputCrsCd.Filter("GRP_CD='D10078'");		
			}
		}
	}
}

function dsDiaryDetl_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	for(var i=0; i<dsDiaryDetl.rowcount; i++) {   
		sCrsCd = dsDiaryDetl.GetColumn(i,"SECTN_CD");
		if(sCrsCd == "001"){ 	//학과
			dsInputCrsCd.Filter("GRP_CD='D10030'");
		}else if(sCrsCd == "002"){ //실기
			dsInputCrsCd.Filter("GRP_CD='D10064'");			
		}else if(sCrsCd == "003"){ //측정
			dsInputCrsCd.Filter("GRP_CD='D10010'");
		}else if(sCrsCd == "004"){ //모트보트조종
			dsInputCrsCd.Filter("GRP_CD='D10078'");		
		}
	}	
}


function fcDiaryMstAdd(){
	if(1 > dsDiaryMst.rowcount){
		dsDiaryMst.AddRow();
		iCurrPersNo 		= iGTotPersNo;
		iAbsPersNo 			= 0;	
		edTotPersNo.value 	= iGTotPersNo;
		edCurrPersNo.value	= iCurrPersNo;
		edAbsPersNo.value 	= iAbsPersNo;

		btnCfm.Enable = false;
		btnCfmCls.Enable = false;
		divBtnLst.btnPrint.Enable = false;	    //인쇄버튼 비활성화
		divBtnLst.btnSave.Enable = true;	    //저장버튼 활성화
		grdDiaryDetl.Enable = true;            //상세교육내용 비활성화
		grdDiaryAbs.Enable = true;				//제외인원 내역 비활성화
		btnWkSche.Enable = true;               //주가교육계획 가져오기 버튼 비활성화
		divDiaryDetl.btnAddRow.Enable = true;	//(+) 버튼 비활성화
		divDiaryDetl.btnDelRow.Enable = true;	//(-) 버튼 비활성화
		
	}
}


/*
function dsDiaryMst_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	if(1 > dsDiaryMst.rowcount){
		dsDiaryMst.AddRow();
	}
}
*/
function cbSearchPerioNo_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fcPerioNoCount();
}

function grdDiaryAbs_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//var asb_cnt = dsDiaryMst.GetColumn(0,"ABS_PERS_NO");
	if(nCell == 0)
	{
		if(dsDiaryAbs.getColumn(nRow,"CHK") == "0")
		{
			dsDiaryAbs.SetColumn(nRow,"EDU_TIME",dsDiaryDetl.GetColumn(dsDiaryDetl.row,"EDU_TIME"));
		}
		else
		{
			dsDiaryAbs.SetColumn(nRow,"EDU_TIME","0");
		}
	}
}

/*
function grdDiaryAbs_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{

	//var absTime = dsDiaryAbs.GetColumn(grdDiaryAbs.GetClickedRow(),"EDU_TIME");
	var absTime = grdDiaryAbs.GetCellText("Body",grdDiaryAbs.GetClickedRow(),grdDiaryAbs.GetClickedCell());
	var eduTime = dsDiaryDetl.GetColumn(dsDiaryDetl.row,"EDU_TIME");
	alert(absTime);
	alert(eduTime);

	if(absTime > eduTime) {
		fnc_Message(L_COM_ALT_0024, "Y","불참시간은 교육시간보다 클 수");
		dsDiaryAbs.SetColumn(grdDiaryAbs.GetClickedRow(),"EDU_TIME",eduTime);
	}

}
*/

function grdDiaryAbs_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam,nRow,nCell,nPivotIndex)
{
	if(nCell == 4 ) {
		var absTime = ToNumber(strPostText);
		var eduTime = ToNumber(dsDiaryDetl.GetColumn(dsDiaryDetl.row,"EDU_TIME"));
		if(absTime > eduTime) {
			fnc_Message(L_COM_ALT_0024, "Y","불참시간은 교육시간보다 클 수");
			grdDiaryAbs.SetEditText(eduTime);
		}
	}	
}


function btnCfm_OnClick(obj)
{
	if ( !fcSearchCheck(obj) ) return;
	
	dsCfm.SetColumn(0,"CFG_YN","Y");
	
	var sServiceName = "";
    var sInDataSet   = "";
    var sOutDataSet  = "";    
       
    sServiceName  = "d06000014-service:saveCfm";
    
    sInDataSet     = " dsCfm=dsCfm " ;
    sOutDataSet    = " dsCfm=dsCfm " ;
      
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
}

function btnCfmCls_OnClick(obj)
{
	if ( !fcSearchCheck(obj) ) return;
	
	dsCfm.SetColumn(0,"CFG_YN","N");
	
	var sServiceName = "";
    var sInDataSet   = "";
    var sOutDataSet  = "";    
       
    sServiceName  = "d06000014-service:saveCfm";
    
    sInDataSet     = " dsCfm=dsCfm " ;
    sOutDataSet    = " dsCfm=dsCfm " ;
      
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");	
}


/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {
	//DataSet의 Header 정보가 있을 때  Add 처리
	switch(obj.GetForm().id) {
	case "divDiaryDetl":
		dsDiaryDetl.sort("SEQ",false);	//내림차순
		var maxSeq = dsDiaryDetl.GetColumn(0,"SEQ");
		var nRow = dsDiaryDetl.AddRow();
		dsDiaryDetl.SetColumn(nRow, "SEQ", maxSeq+1);
		break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj){
	switch(obj.GetForm().id){
	case "divDiaryDetl":
		fcDelRowChk(dsDiaryDetl);
		break;
	}
}

function fcDelRowChk(obj){
	if(obj.currow == -1){
		fnc_Message("선택된 행이 없습니다.","N");
		return;
	}
	else{
		obj.DeleteRow(obj.currow);
	}
}

function btnWkSche_OnClick(obj)
{
	var cfmMsg = "주간교육계획으로 교육정보를 초기화하시겠습니까?";
	if(confirm(cfmMsg)) {
		var sServiceName = "d06000014-service:saveDiaryDetlInit";
		var sInDataSet   = "";
		var sOutDataSet  = ""; 
	
		fcd_AddParam("racerPerioNo", Trim(cbSearchPerioNo.Value));
		fcd_AddParam("dt", Trim(CalSearchDt.Value));
		fcd_AddParam("saveflag", "DiaryDetlInit");
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
		
	}
}

function fcSearchDiaryDetl(obj) {

    if ( !fcSearchCheck(obj) ) return;
	        
    var sServiceName = "d06000014-service:searchDiaryDetlOnly";
    var sInDataSet   = "";
    var sOutDataSet  = " dsDiaryDetl=dsDiaryDetl ";	
	fcd_AddParam("racerPerioNo", Trim(cbSearchPerioNo.Value));
	fcd_AddParam("dt", Trim(CalSearchDt.Value));
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
	 
}

function fcElecPayment() {


	
	var sEduWk    = dsEduWkDayCnt.GetColumn(0,"WK");
	var sDayCnt   = dsEduWkDayCnt.GetColumn(0,"DAY_CNT");
	var sAm  = "";  // 오전훈련
	var sPm  = "";  // 오후훈련
	
	for (var i=0;i<dsDiaryDetl.RowCount();i++){
		if(dsDiaryDetl.GetColumn(i,"AMPM_CD") == "001") {	//오전교육
			sAm = sAm + dsDiaryDetl.GetColumn(i,"EDU_DETL") + "\n";
		}
		if(dsDiaryDetl.GetColumn(i,"AMPM_CD") == "002") {	//오후교육
			sPm = sPm + dsDiaryDetl.GetColumn(i,"EDU_DETL") + "\n";
		}
	}

	dsDiaryMst.SetColumn(0,"AM",sAm);
	dsDiaryMst.SetColumn(0,"PM",sPm);
	
	rptViewer.ServletURL1="";
	rptViewer.setFileURL(GBL_REPORT_URL);
	rptViewer.setJrfFileDir(GBL_REPORT_URL);
	rptViewer.setJrfFileName("d06009014_1.jrf");
	rptViewer.ServletURL2="";
	rptViewer.SetDataset("dsDiaryMst", "dsDiaryMst");
	rptViewer.SetDataset("dsDiaryDetl", "dsDiaryDetl");
	rptViewer.SetDataset("dsDiaryAcdnt", "dsDiaryAcdnt");
	rptViewer.SetDataset("dsEduWkDayCnt", "dsEduWkDayCnt");
	
	rptViewer.SetArgument("PerioNo", cbSearchPerioNo.Value);
	rptViewer.SetArgument("W1", cbWeather1.Text);
	rptViewer.SetArgument("W2", cbWeather2.Text);
	rptViewer.SetArgument("W3", cbWindDirc1.Text);
	rptViewer.SetArgument("W4", cbWindDirc2.Text);
	rptViewer.SetArgument("EDUWK", sEduWk);
	rptViewer.SetArgument("DAY_CNT", sDayCnt);
	rptViewer.Retrieve();
	
	var blank4 = "&nbsp;&nbsp;&nbsp;&nbsp;";
	var blank8 = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
	var pe = cbSearchPerioNo.value;
	var dt = ToString(dsDiaryMst.getColumn(0,"DT"), "@@@@년 @@월 @@일");
	var nDay = getDay(dsDiaryMst.getColumn(0,"DT"));
	var strDay = decode( nDay,0,"일",1,"월",2, "화", 3,"수",4, "목",5,"금",6,"토" );

	var vTitle = "제"+pe+"기 후보생 교육훈련일지("+dt+" "+strDay+"요일)";
	TxtContents.Text = "<br><br>"+blank4+"□ "+sEduWk+"주차 "+sDayCnt+"일차 교육훈련 결과보고<br><br>"
	  + blank8+"○ 총"+blank4+"원: "+dsDiaryMst.getColumn(0,"TOT_PERS_NO")+"명<br>"  
	  + blank8+"○ 교육참석: "+dsDiaryMst.getColumn(0,"CURR_PERS_NO")+"명<br>"
	  + blank8+"○ 교육불참: "+dsDiaryMst.getColumn(0,"ABS_PERS_NO")+"명<br>"
	  + blank8+"○ 불참내용: "+dsDiaryMst.getColumn(0,"ABS_RMK")+"<br>"
	  + blank8+"○ 참여교관: "+dsDiaryMst.getColumn(0,"INSTR")+"<br>"
	  + blank8+"○ 교육장소: "+dsDiaryMst.getColumn(0,"EDU_PLC")+"<br><br>"
	  + blank4+"※붙임: 교육훈련일지("+dt+" "+strDay+"요일)";

	fcd_ExecApproval("BA","",Trim(gdsUser.getColumn(0,"USER_ID")),vTitle,rptViewer,TxtContents, "PDF");
}
]]></Script>
</Window>