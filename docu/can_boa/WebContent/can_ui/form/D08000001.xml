<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="590" Id="D08000001" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="장비/유류내역" Top="8" Ver="1.0" Width="1014" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" type="STRING"/>
					<colinfo id="ALL_YN" size="1" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10076</CD_GRP_ID>
						<DESCRIPTION>장비구분</DESCRIPTION>
						<DSNAME>dsEqipGbn</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10077</CD_GRP_ID>
						<DESCRIPTION>상태</DESCRIPTION>
						<DSNAME>dsStatus</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10036</CD_GRP_ID>
						<DESCRIPTION>장비사용자구분</DESCRIPTION>
						<DSNAME>dsUserGbn</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10081</CD_GRP_ID>
						<DESCRIPTION>출고대상</DESCRIPTION>
						<DSNAME>dsOutGbn</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10082</CD_GRP_ID>
						<DESCRIPTION>유류구분</DESCRIPTION>
						<DSNAME>dsOilGbn</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>년도</DESCRIPTION>
						<DSNAME>dsYear</DSNAME>
						<QUERY_ID>d08000001_year</QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10084</CD_GRP_ID>
						<DESCRIPTION>장비사용자구분</DESCRIPTION>
						<DSNAME>dsEqipUserGbn</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>D10082</CD_GRP_ID>
						<DESCRIPTION>유류구분(Grid)</DESCRIPTION>
						<DSNAME>dsOilGbn2</DSNAME>
						<QUERY_ID></QUERY_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRepairList">
				<Contents>
					<colinfo id="EQUIP_GBN" size="256" type="STRING"/>
					<colinfo id="EQUIP_NO" size="256" type="STRING"/>
					<colinfo id="SEQ" size="256" type="STRING"/>
					<colinfo id="MANTC_DT" size="256" type="STRING"/>
					<colinfo id="MANTC_GBN" size="256" type="STRING"/>
					<colinfo id="MANTC_MAN" size="256" type="STRING"/>
					<colinfo id="CHECK_MAN" size="256" type="STRING"/>
					<colinfo id="USER_GBN" size="256" type="STRING"/>
					<colinfo id="USER_NO" size="256" type="STRING"/>
					<colinfo id="USER_NM" size="256" type="STRING"/>
					<colinfo id="MANTC_CMT" size="256" type="STRING"/>
					<colinfo id="SPEC_DESC" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPerioNo"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsEqipGbn" OnLoadCompleted="dsEqipGbn_OnLoadCompleted"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsStatus"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsUserGbn"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOilGbn" OnLoadCompleted="dsOilGbn_OnLoadCompleted"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutGbn"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOilEntList" OnColumnChanged="dsOilEntList_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="ENT_DT" size="256" type="STRING"/>
					<colinfo id="SUPR" size="256" type="STRING"/>
					<colinfo id="OIL_GBN" size="256" type="STRING"/>
					<colinfo id="ENT_QUANT" size="256" type="STRING"/>
					<colinfo id="OIL_STOCK" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOilOutList" OnColumnChanged="dsOilOutList_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="OUT_DT" size="256" type="STRING"/>
					<colinfo id="OIL_GBN" size="256" type="STRING"/>
					<colinfo id="OUT_OBJ" size="256" type="STRING"/>
					<colinfo id="OUT_QUANT" size="256" type="STRING"/>
					<colinfo id="OIL_STOCK" size="256" type="STRING"/>
					<colinfo id="CCIT_CNT" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsYear" OnLoadCompleted="dsYear_OnLoadCompleted"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsMonth" OnLoadCompleted="dsMonth_OnLoadCompleted">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
					<record>
						<CD>01</CD>
						<CD_NM>1</CD_NM>
					</record>
					<record>
						<CD>02</CD>
						<CD_NM>2</CD_NM>
					</record>
					<record>
						<CD>03</CD>
						<CD_NM>3</CD_NM>
					</record>
					<record>
						<CD>04</CD>
						<CD_NM>4</CD_NM>
					</record>
					<record>
						<CD>05</CD>
						<CD_NM>5</CD_NM>
					</record>
					<record>
						<CD>06</CD>
						<CD_NM>6</CD_NM>
					</record>
					<record>
						<CD>07</CD>
						<CD_NM>7</CD_NM>
					</record>
					<record>
						<CD>08</CD>
						<CD_NM>8</CD_NM>
					</record>
					<record>
						<CD>09</CD>
						<CD_NM>9</CD_NM>
					</record>
					<record>
						<CD>10</CD>
						<CD_NM>10</CD_NM>
					</record>
					<record>
						<CD>11</CD>
						<CD_NM>11</CD_NM>
					</record>
					<record>
						<CD>12</CD>
						<CD_NM>12</CD_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutSum">
				<Contents>
					<colinfo id="NM" size="256" type="STRING"/>
					<colinfo id="PLY" size="256" type="STRING"/>
					<colinfo id="CAN" size="256" type="STRING"/>
					<colinfo id="HLP" size="256" type="STRING"/>
					<colinfo id="SUMM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsEqipUserGbn"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOilGbn2"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsOilEasyOut" OnColumnChanged="dsOilOutList_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_GASOL_PLAYR" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_GASOL_CANDI" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_GASOL_RESCU" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_GASOL_ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_LUBR_PLAYR" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_LUBR_CANDI" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_LUBR_RESCU" size="256" summ="default" type="STRING"/>
					<colinfo id="OIL_GBN_LUBR_ETC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reportParam">
				<Contents>
					<colinfo id="PARAM_NM" size="256" type="STRING"/>
					<colinfo id="PARAM_VAL" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="58" Height="28" Id="Shape0" Left="6" LineColor="user1" Right="1008" RoundHeight="5" RoundUnit="Pixel" RoundWidth="5" TabOrder="1" Top="30" Type="RoundRect" Width="1002"></Shape>
		<Static Height="22" Id="stFormTitle" Left="30" Style="snis_m_title" TabOrder="2" Text="조회조건" Top="6" VAlign="Middle" Width="250"></Static>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="3" Top="8" Width="17"></Image>
		<Div Height="20" Id="divBtnLst" Left="678" TabOrder="4" Text="Div0" Top="6" Url="common::comButtonType.xml" Width="330">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static0" Left="8" Style="snis_if_lable" TabOrder="5" Text="장비구분" Top="34" VAlign="Middle" Width="52"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Height="20" Id="cbEqipGbn" InnerDataset="dsEqipGbn" Left="64" Style="snis_if_input01" TabOrder="6" Top="33" Width="80"></Combo>
		<Static Align="Right" Height="20" Id="Static1" Left="172" Style="snis_if_lable" TabOrder="7" Text="장비번호" Top="34" VAlign="Middle" Width="52"></Static>
		<Edit Border="Flat" Height="20" Id="edEqipNo" Left="226" Style="snis_if_input01" TabOrder="8" Top="34" Width="120"></Edit>
		<Tab Border="Flat" BorderColor="user3" Color="user41" Height="521" Id="Tab0" Left="8" MouseOverColor="user42" OnChanged="fcChangingTab" SelColor="user43" TabOrder="9" Top="64" Width="1002">
			<Contents>
				<TabPage BorderColor="black" Height="497" Id="tab2" ImageID="m_tab_04" Left="2" TabOrder="80" Text="유류입고" Top="22" Width="998">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOilEntList" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user3" Bottom="481" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="477" Id="grdOilIn" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" OnHeadClick="fcGridSort" Right="995" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="991">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="50"/>
									<col width="150"/>
									<col width="150"/>
									<col width="150"/>
									<col width="100"/>
									<col width="100"/>
									<col width="200"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="순번"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="일자"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="유류구분"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="공급자"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="공급량"/>
									<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="잔량"/>
									<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="비고"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" display="text" expr="row+1"/>
									<cell col="2" colid="ENT_DT" display="date" edit="date" expandimage="btn_list_search" expandshow="true"/>
									<cell col="3" colid="OIL_GBN" combocol="CD" combodataset="dsOilGbn2" combotext="CD_NM" display="combo" edit='expr:decode(rowtype,&quot;insert&quot;,&quot;combo&quot;,&quot;none&quot;)'/>
									<cell col="4" colid="SUPR" display="text" edit="normal" limit="50"/>
									<cell col="5" colid="ENT_QUANT" display="number" edit="number" limit="8"/>
									<cell col="6" colid="OIL_STOCK" display="number"/>
									<cell col="7" colid="RMK" display="text" edit="normal" limit="200"/>
								</body>
								<summary>
									<cell col="0" display="text"/>
									<cell col="1" display="text"/>
									<cell col="2" display="text"/>
									<cell col="3" display="text"/>
									<cell col="4" display="text"/>
									<cell align="right" col="5" display="number" expr='sum(&quot;ENT_QUANT&quot;)'/>
									<cell col="6" display="text"/>
									<cell col="7" display="text"/>
								</summary>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="497" Id="tab3" ImageID="m_tab_04" Left="2" TabOrder="12" Text="유류출고" Top="22" Width="998">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOilOutList" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user3" Bottom="481" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="477" Id="grdOilOut" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" OnHeadClick="fcGridSort" Right="995" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="991">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="50"/>
									<col width="150"/>
									<col width="150"/>
									<col width="150"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="순번"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="일자"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="유류구분"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="출고대상"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="출고량"/>
									<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9" text="잔량"/>
									<cell bkcolor="user20" col="7" color="user21" display="text" font="굴림,9" text="주회수(R)"/>
									<cell bkcolor="user20" col="8" color="user21" display="text" font="굴림,9" text="비고"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" display="text" expr="row+1"/>
									<cell col="2" colid="OUT_DT" display="date" edit="date" expandimage="btn_list_search" expandshow="true"/>
									<cell col="3" colid="OIL_GBN" combocol="CD" combodataset="dsOilGbn" combotext="CD_NM" display="combo" edit='expr:decode(rowtype,&quot;insert&quot;,&quot;combo&quot;,&quot;none&quot;)'/>
									<cell col="4" colid="OUT_OBJ" combocol="CD" combodataset="dsOutGbn" combotext="CD_NM" display="combo" edit='expr:decode(rowtype,&quot;insert&quot;,&quot;combo&quot;,&quot;none&quot;)'/>
									<cell col="5" colid="OUT_QUANT" display="number" edit="number" limit="8"/>
									<cell col="6" colid="OIL_STOCK" display="number"/>
									<cell align="right" col="7" colid="CCIT_CNT" display="number" edit="number" limit="3"/>
									<cell col="8" colid="RMK" display="text" edit="normal" limit="200"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="497" Id="tab4" ImageID="m_tab_04" Left="2" TabOrder="12" Text="출고집계" Top="22" Width="998">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsOutSum" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user3" Bottom="79" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="75" Id="grdOutSum" InputPanel="FALSE" Left="4" LineColor="user18" MinWidth="100" Right="995" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="991">
						<contents>
							<format id="Default">
								<columns>
									<col width="150"/>
									<col width="150"/>
									<col width="150"/>
									<col width="150"/>
									<col width="150"/>
									<col width="150"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9" text="선수"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9" text="후보생"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9" text="구조정"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9" text="기타"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9" text="계"/>
								</head>
								<body>
									<cell align="center" bkcolor="user20" celltype="head" col="0" colid="NM" color="user21" display="text" font="굴림,9" text="가솔린&#32;(리터)"/>
									<cell align="center" celltype="body" col="1" colid="PLY" display="number" font="굴림,9"/>
									<cell align="center" col="2" colid="CAN" display="number"/>
									<cell align="center" col="3" colid="HLP" display="number"/>
									<cell align="center" col="4" colid="ETC" display="number"/>
									<cell align="center" col="5" colid="SUMM" display="number"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="497" Id="tab5" ImageID="m_tab_04" Left="2" TabOrder="9" Text="간편출고" Top="22" Width="998">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoSelect="TRUE" BindDataset="dsOilEasyOut" BkColor2="default" BoldHead="true" Border="HalfFlat" BorderColor="user3" Bottom="478" Editable="TRUE" Enable="true" EndLineColor="default" Height="474" Id="grdOilEasyOut" InputPanel="FALSE" Left="4" LineColor="default" MinWidth="100" OnExpandEdit="fcGrdOnExpandEdit" OnHeadClick="fcGridSort" Right="985" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="981">
						<contents>
							<format id="Default">
								<columns>
									<col width="24"/>
									<col width="87"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="선택" Valign="Center"/>
									<cell col="1" display="text" font="굴림,9" rowspan="2" text="출고일자" Valign="Center"/>
									<cell col="2" colspan="5" display="text" font="굴림,9" text="가솔린"/>
									<cell col="7" colspan="5" display="text" font="굴림,9" text="엔진오일"/>
									<cell col="2" display="text" font="굴림,9" row="1" text="선수"/>
									<cell col="3" display="text" font="굴림,9" row="1" text="후보생"/>
									<cell col="4" display="text" font="굴림,9" row="1" text="구조정"/>
									<cell col="5" display="text" font="굴림,9" row="1" text="기타"/>
									<cell bkcolor="user2" col="6" display="text" font="굴림,9" row="1" text="소계"/>
									<cell col="7" display="text" font="굴림,9" row="1" text="선수"/>
									<cell col="8" display="text" font="굴림,9" row="1" text="후보생"/>
									<cell col="9" display="text" font="굴림,9" row="1" text="구조정"/>
									<cell col="10" display="text" font="굴림,9" row="1" text="기타"/>
									<cell bkcolor="beige" col="11" display="text" font="굴림,9" row="1" text="소계"/>
								</head>
								<body>
									<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" colid="OUT_DT" display="date" edit="date" expandimage="btn_list_search" expandshow="true"/>
									<cell col="2" colid="OUT_QUANT11" display="number" edit="number"/>
									<cell col="3" colid="OUT_QUANT12" display="number" edit="number"/>
									<cell col="4" colid="OUT_QUANT13" display="number" edit="number"/>
									<cell col="5" colid="OUT_QUANT14" display="number" edit="number"/>
									<cell bkcolor="beige" col="6" colid="OUT_QUANT10" display="number" expr="OUT_QUANT11+OUT_QUANT12+OUT_QUANT13+OUT_QUANT14"/>
									<cell col="7" colid="OUT_QUANT21" display="number" edit="number"/>
									<cell col="8" colid="OUT_QUANT22" display="number" edit="number"/>
									<cell col="9" colid="OUT_QUANT23" display="number" edit="number"/>
									<cell col="10" colid="OUT_QUANT24" display="number" edit="number"/>
									<cell bkcolor="beige" col="11" colid="OUT_QUANT20" display="number" edit="number" expr="OUT_QUANT21+OUT_QUANT22+OUT_QUANT23+OUT_QUANT24"/>
								</body>
								<summary>
									<cell col="0" display="text"/>
									<cell col="1" display="text"/>
									<cell align="right" col="2" display="number" expr='sum(&quot;OUT_QUANT11&quot;)'/>
									<cell align="right" col="3" display="number" expr='sum(&quot;OUT_QUANT12&quot;)'/>
									<cell align="right" col="4" display="number" expr='sum(&quot;OUT_QUANT13&quot;)'/>
									<cell align="right" col="5" display="number" expr='sum(&quot;OUT_QUANT14&quot;)'/>
									<cell align="right" col="6" display="number" expr='sum(&quot;OUT_QUANT10&quot;)'/>
									<cell align="right" col="7" display="number" expr='sum(&quot;OUT_QUANT21&quot;)'/>
									<cell align="right" col="8" display="number" expr='sum(&quot;OUT_QUANT22&quot;)'/>
									<cell align="right" col="9" display="number" expr='sum(&quot;OUT_QUANT23&quot;)'/>
									<cell align="right" col="10" display="number" expr='sum(&quot;OUT_QUANT24&quot;)'/>
									<cell align="right" col="11" display="number" expr='sum(&quot;OUT_QUANT20&quot;)'/>
								</summary>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Static Align="Right" Height="20" Id="Static3" Left="368" Style="snis_if_lable" TabOrder="10" Text="유류구분" Top="34" VAlign="Middle" Width="52"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Enable="FALSE" Height="20" Id="cbOil" InnerDataset="dsOilGbn" Left="424" Style="snis_if_input01" TabOrder="11" Top="33" Width="80"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="536" Style="snis_if_lable" TabOrder="12" Text="년도" Top="34" VAlign="Middle" Width="28"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Enable="FALSE" Height="20" Id="cbYear" InnerDataset="dsYear" Left="568" Style="snis_if_input01" TabOrder="13" Top="33" Width="70"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="672" Style="snis_if_lable" TabOrder="14" Text="월" Top="34" VAlign="Middle" Width="20"></Static>
		<Combo Border="Flat" CodeColumn="CD" DataColumn="CD_NM" Enable="FALSE" Height="20" Id="cbMonth" INDEX="0" InnerDataset="dsMonth" Left="696" Style="snis_if_input01" TabOrder="15" Top="33" Width="50"></Combo>
		<Div BKColor="user0" Height="23" Id="divSearch" Left="788" TabOrder="16" Text="Div0" Top="34" Url="common::comButtonSearch.xml" Width="70">
			<Contents></Contents>
		</Div>
		<Div Height="20" Id="divBtnRow" Left="960" TabOrder="17" Text="Div0" Top="60" Url="common::comButtonRow.xml" Width="48">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::can_common_script.js";
#include "lib::can_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = 'D08000001';
var sBUTTONLIST   = 'TTFTTT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                //Form의 Title 정보
var sFORMLOCATION = '';                                //Form의 Location 정보
var sUSERLAVEL    = '';                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트
var saMonth       = Array(5);
var saQuery       = Array(5);
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'F'+sInpt+'FTTT';
    
 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	//초기 화면 BK Color설정 
	fnc_SetBKColor(this);
	
	// 화면 초기화
	fcInit();

	//공통코드 조회
	fcd_GetComboDs(dsInComCd);
	
	cbYear.Index = 0;
	cbMonth.Index = 0;
	
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/

function fcFormUnloadProcess(obj) {
	
	var sDataset = "dsEquipList|dsRepairList|dsOilEntList|dsOilOutList";
	if ( !fnc_FormUnloadCheck(sDataset , sFormId) ) return false;
	
}


/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == 13 ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}

	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}



/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Clear 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
	dsEquipList.ClearData();
	dsRepairList.ClearData();
	dsOilEntList.ClearData();
	dsOilOutList.ClearData();
	dsOutSum.ClearData();
}
//조회버튼 클릭 시
function fcSearch(obj) {
	var sServiceName ;
    var sInDataSet   ;
    var sOutDataSet  ;
    saQuery[Tab0.TabIndex] ++;
    
    switch(Tab0.TabIndex){
	case 0://유류입고
		sServiceName = "d08000001-service:searchEntOilList";
		sInDataSet   = "";
		sOutDataSet  = "dsOilEntList=dsOilEntList";

		// 구분, 장비번호로 조회
		fcd_AddParam("OIL_GBN",trim(cbOil.Value));
		fcd_AddParam("ENT_YEAR" ,trim(cbYear.Value));
		fcd_AddParam("ENT_MONTH" ,trim(cbMonth.Value));
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
		break;
		 
	case 1://유류출고
		sServiceName = "d08000001-service:searchOutOilList";
		sInDataSet   = "";
		sOutDataSet  = "dsOilOutList=dsOilOutList";
		
		// 구분, 장비번호로 조회
		fcd_AddParam("OIL_GBN",cbOil.Value);
		fcd_AddParam("OUT_YEAR" ,cbYear.Value);
		fcd_AddParam("OUT_MONTH",cbMonth.Value);
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
		break;
		 
	case 2://출고 현황
		sServiceName = "d08000001-service:searchOutSum";
		sInDataSet   = "";
		sOutDataSet  = "dsOutSum=dsOutSum";
		
		fcd_AddParam("schYY" ,cbYear.Value);
		fcd_AddParam("schMM" ,cbMonth.Value);
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
		break;
	
	case 3:// 간편출고 현황
		sServiceName = "d08000001-service:searchEasyOutOilList";
		sInDataSet   = "";
		sOutDataSet  = "dsOilEasyOut=dsOilEasyOut";
		
		fcd_AddParam("schYY" ,cbYear.Value);
		fcd_AddParam("schMM" ,cbMonth.Value);
		fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
		break;
		 
    }
    
}


/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/

// 저장 공통
function fcSave(obj) {
	var sServiceName;
	var sInDataSet;
	var sOutDataSet;

	switch(Tab0.TabIndex){

	case 0://유류입고
		if(dsOilEntList.GetUpdate()){
			for(var i=0;i<dsOilEntList.GetRowCount();i++){
				if(fnc_IsNull(dsOilEntList.GetColumn(i,"ENT_DT"))){
					fnc_Message(SNIS_COM_1034,"N","일자");
					return false;
				}
				if(fnc_IsNull(dsOilEntList.GetColumn(i,"OIL_GBN"))){
					fnc_Message(SNIS_CAN_0008,"N","유류구분");
					return false;
				}
				if(fnc_IsNull(dsOilEntList.GetColumn(i,"SUPR"))){
					fnc_Message(SNIS_COM_1034,"N","공급자");
					return false;
				}
				if(fnc_IsNull(dsOilEntList.GetColumn(i,"ENT_QUANT"))){
					fnc_Message(SNIS_COM_1034,"N","공급량");
					return false;
				}
			}
			sServiceName     = "d08000001-service:saveEntOil";    
			sInDataSet       = "dsOilEntList=dsOilEntList:u";
			fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
		}
		break;
		
	case 1://유류출고
		if(dsOilOutList.GetUpdate()){
			for(var i=0;i<dsOilOutList.GetRowCount();i++){
				if(fnc_IsNull(dsOilOutList.GetColumn(i,"OUT_DT"))){
					fnc_Message(SNIS_COM_1034,"N","일자");
					return false;
				}
				if(fnc_IsNull(dsOilOutList.GetColumn(i,"OIL_GBN"))){
					fnc_Message(SNIS_CAN_0008,"N","유류구분");
					return false;
				}
				if(fnc_IsNull(dsOilOutList.GetColumn(i,"OUT_OBJ"))){
					fnc_Message(SNIS_CAN_0008,"N","출고대상");
					return false;
				}
				if(fnc_IsNull(dsOilOutList.GetColumn(i,"OUT_QUANT"))){
					fnc_Message(SNIS_COM_1034,"N","출고량");
					return false;
				}
			
			}
			
			trace(dsOilOutList.SaveXML());
		
			sServiceName     = "d08000001-service:saveOutOil";    
			sInDataSet       = "dsOilOutList=dsOilOutList:u";
			fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
		}
		break;
		
	case 2:	// 출고집계
		break;
	case 3:	// 유류 간편출고
		if(dsOilEasyOut.GetUpdate()){
			for(var i=0;i<dsOilEasyOut.GetRowCount();i++){
				if(fnc_IsNull(dsOilEasyOut.GetColumn(i,"OUT_DT"))){
					fnc_Message(SNIS_COM_1034,"N","일자");
					return false;
				}
			}
			
			trace(dsOilEasyOut.SaveXML());
		
			sServiceName     = "d08000001-service:saveEasyOutOil";    
			sInDataSet       = "dsOilEasyOut=dsOilEasyOut:u";
			fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack");
		}
		break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
	switch(Tab0.TabIndex){
	case 0:
		fnc_OpenExcelExport("Tab0.tab2.grdOilIn");
		break;
	case 1:
		fnc_OpenExcelExport("Tab0.tab3.grdOilOut");
		break;
	case 2:
		fnc_OpenExcelExport("Tab0.tab4.grdOutSum");
		break;
	case 3:
		fnc_OpenExcelExport("Tab0.tab5.grdOilEasyOut");
		break;
	}
    
}

/*-------------------------------------------------------------------------------------------------+
>>  인쇄 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcPrint(){
		
	
	// 자료 초기화
	ds_reportParam.DeleteAll();
	var nRnum;
	
    // 필드 값을 셋팅한다.
    var paramField = [
							"IO_YEAR"							// 입출 년도
						,	"IO_MONTH"							// 입출 월
					 ];

	// 값을 셋팅한다.
	var paramValue = [
							cbYear.Value
						,	cbMonth.Value
					 ];
					 
	
	var rowCnt = paramField.length;	
	for(var row = 0 ; row < rowCnt; row++)
	{
		nRnum = ds_reportParam.AppendRow();
		ds_reportParam.SetColumn(nRnum, "PARAM_NM", paramField[row]);
		ds_reportParam.SetColumn(nRnum, "PARAM_VAL",paramValue[row]);
	}
            
	/* 레포트 배율 추가 - 시작 */
	iRow = ds_reportParam.AddRow();

	// Default Scale 파라미터명 추가(고??
	ds_reportParam.SetColumn(iRow, "PARAM_NM", "DEFAULT_SCALE");
	ds_reportParam.SetColumn(iRow, "PARAM_VAL", "1");
	
	//트랙잭션을 태운다.
	fnc_ReportPreView("d08000001", ds_reportParam.ID, "Y");
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
    fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {
	var sSearchKind = "";
	var sInputValue = "";
    var sResponse; 
	
	switch(obj.id){
		case "imgZip":
			sResponse = fcd_HelpDialoge("POST","","");
			if(Length(sResponse)){
				dsCandIdent.SetColumn(0,"POST_NO",substr(sResponse[0],0,3)+substr(sResponse[0],4,3));
				dsCandIdent.SetColumn(0,"ADDR1",sResponse[1]);
			}
			break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex){
	  fnc_SetPopupDivCalendar(objGrd, nRow, nCell);	
}


/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/

function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {

    if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
	
    switch(sServiceName){  
		case "common-service:searchCode"://공통코드
			dsMonth.InsertRow(0);
			dsMonth.SetColumn(0,"CD","");
			dsMonth.SetColumn(0,"CD_NM","전체");
			cbYear.value = Mid(today(),0,4);
			saMonth[0] = 0;
			for (var i=1;i<5;i++) {
				saMonth[i] = toNumber(Mid(today(),4,2));
			}
			cbMonth.index = saMonth[0];
			for (var i=0;i<5;i++) saQuery[i] = 0;
			fcSearch();
			break;
		case "d08000001-service:searchEquipList":
			dsMotHstry.Filter("pos(EQUIP_GBN,"+quote("001")+")>=0");
			dsBoaHstry.Filter("pos(EQUIP_GBN,"+quote("002")+")>=0");
			break;
		case "d08000001-service:saveEntOil":
		case "d08000001-service:saveOutOil":
			fcSearch();
			break;
		case "d08000001-service:searchEasyOutOilList":
			break;
    }
    
    //오류가 없이 정상 처리되었다면...
	fcPostProcess(sServiceName);
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 Post Process!
+-------------------------------------------------------------------------------------------------*/
function fcPostProcess(sServiceName) {

}

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {
	if (obj.id != "btnAddRow") return;
	if (saQuery[Tab0.TabIndex] == 0) {
		fnc_message(SNIS_CAN_E003, "N");
		return;
	}
	switch(tab0.TabIndex) {
		case 0:
			var nRow = dsOilEntList.AddRow();
			dsOilEntList.SetColumn(nRow,"OIL_GBN",cbOil.Value);
			break;
			
		case 1:
			var nRow = dsOilOutList.AddRow();
			dsOilOutList.SetColumn(nRow,"OIL_GBN",cbOil.Value);
			break;
		case 3:
			var nRow = dsOilEasyOut.AddRow();
			dsOilEasyOut.SetColumn(nRow,"OUT_DT",today());
			break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj) {

	if (obj.id != "btnDelRow") return;

	switch(tab0.TabIndex){
	case 0:
		for(var i=dsOilEntList.GetRowCount()-1;i>=0;i--){
			if(dsOilEntList.GetColumn(i,"CHK") == 1){
				dsOilEntList.DeleteRow(i);
			}
		}
		break;		
		
	case 1:
		for(var i=dsOilOutList.GetRowCount()-1;i>=0;i--){
			if(dsOilOutList.GetColumn(i,"CHK") == 1){
				dsOilOutList.DeleteRow(i);
			}
		}
		break;
	case 3:
		for(var i=dsOilEasyOut.GetRowCount()-1;i>=0;i--){
			if(dsOilEasyOut.GetColumn(i,"CHK") == 1){
				dsOilEasyOut.DeleteRow(i);
			}
		}
		break;
	}
}


function fcViewRepairList(obj,nRow,nCell,nX,nY,nPivotIndex){
	var sServiceName = "d08000001-service:searchRepairList";
    var sInDataSet   = "";
    var sOutDataSet  = "dsRepairList=dsRepairList";
    
    // 구분, 장비번호로 조회
	fcd_AddParam("EQUIP_GBN",dsEquipList.GetColumn(nRow,"EQUIP_GBN"));
	fcd_AddParam("EQUIP_NO", dsEquipList.GetColumn(nRow,"EQUIP_NO"));
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack",false);
}

function fcChangingTab(obj,nOldIndex,nNewindex){
	//saMonth[nOldIndex] = cbMonth.index;
	//cbMonth.index=saMonth[nNewindex];
	switch(nNewindex){	
        case 0://유류입고
            fcSetSearchBar("FFTTT");
            break; 
               
        case 1://유류출고
            fcSetSearchBar("FFTTT");
            break;
            
        case 2://출고집계
            fcSetSearchBar("FFFTT");
            break;
            
        case 3://간편출고
            fcSetSearchBar("FFFTT");            
            break;
	}
	if (saQuery[nNewindex] == 0) fcSearch(obj);
}

function fcSetSearchBar(val){   
    //메뉴 타이틀 Enable/Disable
	arrMenu = array(6);
	arrMenu = split("cbEqipGbn|edEqipNo|cbOil|cbYear|cbMonth","|");
	
	for(var i=0;i<val.length;i++){
		if(substr(val,i,1) == "T"){
			Object(arrMenu[i]).Enable = true;
		}
		else{
			Object(arrMenu[i]).Enable = false;
		}
	}
}
function dsEqipGbn_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	dsEqipGbn.InsertRow(0);
	dsEqipGbn.SetColumn(0,"CD_NM","전체");
	cbEqipGbn.Index  = 0;
}

function dsOilGbn_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	dsOilGbn.InsertRow(0);
	dsOilGbn.SetColumn(0,"CD_NM","전체");
	cbOil.Index  = 0;
}

function dsYear_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	dsYear.InsertRow(0);
	dsYear.SetColumn(0,"CD_NM","전체");
	cbYear.Index  = 0;
}

function dsMonth_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	dsYear.InsertRow(0);
	dsYear.SetColumn(0,"CD_NM","전체");
	cbYear.Index  = 0;
}

// 유류입고 일자 변경 방지
function dsOilEntList_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == "ENT_DT") {
        if(dsOilEntList.GetRowType(nRow) == "update") {
            fnc_Message(SNIS_CAN_M003, "N", "일자");
            dsOilEntList.SetColumn(nRow, "ENT_DT", varOldValue);
        }
	}
}

// 유류 출고 일자 변경 방지
function dsOilOutList_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == "OUT_DT") {
        if(dsOilOutList.GetRowType(nRow) == "update") {
            fnc_Message(SNIS_CAN_M003, "N", "일자");
            dsOilOutList.SetColumn(nRow, "OUT_DT", varOldValue);
        }
	}
}
]]></Script>
</Window>