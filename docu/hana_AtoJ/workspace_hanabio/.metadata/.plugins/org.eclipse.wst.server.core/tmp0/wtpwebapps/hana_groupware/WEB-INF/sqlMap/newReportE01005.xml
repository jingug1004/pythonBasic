<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
  * @파일명 : newReportE01005.xml
  * @메뉴명 : 근태계
  * @최초작성일 : 2015/02/10            
  * @author : Jung.Jin.Muk(pc123pc@irush.co.kr)                  
  * @수정내역 :	
-->
<mapper namespace="newReportE01005">

	<select id="commuteDetail" parameterType="string" resultType="com.hanaph.gw.ea.newReport.vo.CommuteVO">
		SELECT APPROVAL_SEQ, KIND, BOGO_YN, BOGO_RECEIVER, TO_CHAR(TO_DATE(IMPOSITION_YMD,'yyyymmdd'),'yyyy-mm-dd') IMPOSITION_YMD, MIBOGO_REASON,
	           LATE_TM, LEAVE_TM, TO_CHAR(TO_DATE(START_ABSENCE_YMD,'yyyymmdd'),'yyyy-mm-dd') START_ABSENCE_YMD, TO_CHAR(TO_DATE(END_ABSENCE_YMD,'yyyymmdd'),'yyyy-mm-dd') END_ABSENCE_YMD, REASON
	  	  FROM GW_EA_COMMUTE
	  	 WHERE APPROVAL_SEQ = #{approval_seq}
	</select>
	
	<select id="commuteTardy" parameterType="hashmap" resultType="com.hanaph.gw.ea.newReport.vo.CommuteVO">
		SELECT F_GW_EA_COMMUTE_TARDY(#{emp_no}, #{year}) AS TARDY
	  	  FROM DUAL
	</select>
	
	<update id="updateCommute" parameterType="com.hanaph.gw.ea.newReport.vo.CommuteVO">
		UPDATE GW_EA_COMMUTE
		   SET KIND = #{kind}, BOGO_YN = #{bogo_yn}, BOGO_RECEIVER = #{bogo_receiver}, IMPOSITION_YMD = TO_CHAR(TO_DATE(#{imposition_ymd},'yyyy-mm-dd'),'yyyymmdd'), 
		       MIBOGO_REASON = #{mibogo_reason}, LATE_TM = #{late_tm}, LEAVE_TM = #{leave_tm}, START_ABSENCE_YMD = TO_CHAR(TO_DATE(#{start_absence_ymd},'yyyy-mm-dd'),'yyyymmdd'), 
		       END_ABSENCE_YMD = TO_CHAR(TO_DATE(#{end_absence_ymd},'yyyy-mm-dd'),'yyyymmdd'), REASON = #{reason}
	  	 WHERE APPROVAL_SEQ = #{approval_seq}	
	</update>
	
	<insert id="insertCommute" parameterType="com.hanaph.gw.ea.newReport.vo.CommuteVO" >
		INSERT INTO GW_EA_COMMUTE
        (
        	APPROVAL_SEQ, KIND, BOGO_YN, BOGO_RECEIVER, IMPOSITION_YMD, MIBOGO_REASON,
        	LATE_TM, LEAVE_TM, START_ABSENCE_YMD, END_ABSENCE_YMD, REASON
        )
     	VALUES
     	(
     		#{approval_seq}, #{kind}, #{bogo_yn}, #{bogo_receiver}, TO_CHAR(TO_DATE(#{imposition_ymd},'yyyy-mm-dd'),'yyyymmdd'), #{mibogo_reason}, 
     		#{late_tm}, #{leave_tm}, TO_CHAR(TO_DATE(#{start_absence_ymd},'yyyy-mm-dd'),'yyyymmdd'), TO_CHAR(TO_DATE(#{end_absence_ymd},'yyyy-mm-dd'),'yyyymmdd'), #{reason}
        )
	</insert>
	
	
</mapper>