/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.55
 * Generated at: 2015-12-18 02:32:06 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.jsps.business;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.util.List;
import com.hanaph.saleon.business.vo.MyPlVO;
import com.hanaph.saleon.member.vo.LoginUserVO;
import com.hanaph.saleon.common.utils.StringUtil;
import com.hanaph.saleon.common.utils.WebUtil;

public final class myPlList_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(4);
    _jspx_dependants.put("/include/head.jsp", Long.valueOf(1421734197738L));
    _jspx_dependants.put("/common/path.jsp", Long.valueOf(1430124365934L));
    _jspx_dependants.put("/include/footer.jsp", Long.valueOf(1421734197738L));
    _jspx_dependants.put("/common/sessionCheck.jsp", Long.valueOf(1430193978042L));
  }

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=utf-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write('\r');
      out.write('\n');
      out.write('\r');
      out.write('\n');
      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

	LoginUserVO loginUserVO = (LoginUserVO) session.getAttribute("onlineUser");	//세션생성 세션에서 emp_code를 가져온다.
	
	String userEmpCode  = "";		// 사원 코드
	String userEmpName  = "";		// 사원 이름
	String userEmpGb    = "";		// 사원 구분 
	String userDeptCode = "";		// 부서코드
	String userDeptName = "";		// 부서명
	String userGradeName = "";		// 사원 Grade Name
	String userDeptCd = "";			//hanahr 부서정보
	String userAssgnCd = "";			//직책 코드
	String userAssgnName = "";			//직책 코드명
	/*
	 * 로그인 정보가 있는경우
	 */
	if(loginUserVO != null){
		userEmpCode = StringUtil.nvl(loginUserVO.getEmp_code());    	// 사용자코드
		userEmpName = StringUtil.nvl(loginUserVO.getEmp_name());		// 사용자명
		userEmpGb = StringUtil.nvl(loginUserVO.getEmp_gb());			// 사용자 구분 코드
		userDeptCode = StringUtil.nvl(loginUserVO.getDept_code());  	// 부서 코드
		userDeptName = StringUtil.nvl(loginUserVO.getDept_name());		// 부서 명
		userGradeName = StringUtil.nvl(loginUserVO.getGrade_name());	// 사용자 부서명
		userDeptCd = StringUtil.nvl(loginUserVO.getDept_cd());  	    // 부서 코드
		userAssgnCd = StringUtil.nvl(loginUserVO.getAssgn_cd());  	    // 직책 코드
		userAssgnName = StringUtil.nvl(loginUserVO.getAssgn_name());  	// 직책 코드명
	}
	
	/* 현재 URI에 해당하는 프로그램 No(pgm_no) */
	String currPgmNoByUri = request.getAttribute("pgm_no") == null ? "" : (String) request.getAttribute("pgm_no");

      out.write('\r');
      out.write('\n');
      out.write('\r');
      out.write('\n');

	com.hanaph.saleon.common.utils.Environment env = new com.hanaph.saleon.common.utils.Environment();	//환경 변수
	
	String HTTPS_ONLINE_WEB_ROOT = env.getValue("https.web_root_dir.url");
	String HTTPS_ONLINE_ROOT = env.getValue("https.root_dir.url");
	String ONLINE_WEB_ROOT = env.getValue("web_root_dir.url");		//URL 프로토콜, 도메인, 포트, 서브컨텍스트명, web디렉토리
	String ONLINE_ROOT = env.getValue("root_dir.url");				//URL 프로토콜, 도메인, 포트, 서브컨텍스트명
	String JDBC_URL = env.getValue("jdbc.url");
	

      out.write('\r');
      out.write('\n');
      out.write('\r');
      out.write('\n');

	/* 제품 타입 코드 */
	List<MyPlVO> itemTypeList = (List<MyPlVO>)request.getAttribute("itemTypeList");	

      out.write("\r\n");
      out.write("<!DOCTYPE html>\r\n");
      out.write("<html lang=\"ko\">\r\n");
      out.write("<head>\r\n");
      out.write("\t");
      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\r\n");
      out.write("<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\tvar ONLINE_ROOT = \"");
      out.print(ONLINE_ROOT );
      out.write("\";\t\t/*환경변수*/\r\n");
      out.write("</script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/jquery-1.11.1.min.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/jquery-ui-1.10.4.custom.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/jquery.easyui.min.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/common.js\" charset=\"utf-8\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/default.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/placeholders.js\"></script>\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/css/easyui.css\" />\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/css/main.css\" />\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/css/jquery-ui.css\" />\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/css/smoothness/jquery-ui.theme.css\" />\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/css/fonts.css\" />\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/css/gw_sample.css\">");
      out.write("\r\n");
      out.write("\t<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/css/ui.jqgrid.css\">\r\n");
      out.write("\t<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/grid.locale-kr.js\"></script>\r\n");
      out.write("\t<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/jquery.jqGrid.min.js\"></script>\r\n");
      out.write("\t<script type=\"text/javascript\" src=\"");
      out.print(ONLINE_WEB_ROOT);
      out.write("/js/formCheck.js\"></script>\r\n");
      out.write("\t<script type=\"text/javascript\">\r\n");
      out.write("\t\r\n");
      out.write("\tvar saleActionFlag = false;\t\t//기능(엑셀, 인쇄) 제어를 위한 전역변수\r\n");
      out.write("\t\r\n");
      out.write("\t/* 화면의 Dom 객체가 모두 준비되었을 때 */\r\n");
      out.write("\t$(document).ready(function(){\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/*\r\n");
      out.write("\t\t*\t엔터키 눌렀을 때 INPUT 태그가 아닐 경우 목록 조회\r\n");
      out.write("\t\t*/\r\n");
      out.write("\t\t$('body').on('keydown', function(event){\r\n");
      out.write("\t\t\tif(event.keyCode==13){\r\n");
      out.write("\t\t\t\tif(event.target.nodeName != 'INPUT'){\r\n");
      out.write("\t\t\t\t\tgetGridList(); \r\n");
      out.write("\t\t\t\t\treturn false;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/*\r\n");
      out.write("\t\t*\t제품명 텍스트박스에서 엔터키 눌렀을 경우 목록3 조회\r\n");
      out.write("\t\t*/\r\n");
      out.write("\t\t$('#item_nm').on('keydown', function(event){\r\n");
      out.write("\t\t\tif(event.keyCode==13){\r\n");
      out.write("\t\t\t\tgetGrid3List(); \r\n");
      out.write("\t\t\t\treturn false;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\r\n");
      out.write("\t\tCommons.setDate('fr_date','to_date');\t//주문요청일 오늘날짜로 set\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* jqGrid의 jsonReader 옵션 전역 설정. row 반복 형태의 json 처리. */\r\n");
      out.write("\t    jsonReader : {\r\n");
      out.write("            repeatitems: false;\t// json 형태 설정. row 반복.\r\n");
      out.write("    \t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* 오른쪽 그리드. 현재 선택된 myPL그룹에 등록되지 않은 제품 목록 */\r\n");
      out.write("\t\t$(\"#grid_list3\").jqGrid({\r\n");
      out.write("\t\t\tmtype:\"get\",\r\n");
      out.write("\t\t\tdatatype:\"json\",\r\n");
      out.write("\t\t\tcolNames:[\"제품분류\",\"제품명\",\"제품ID\",\"item_kind\"],\r\n");
      out.write("\t\t\tcolModel:[\r\n");
      out.write("\t\t\t\t{name:\"item_kind_nm\",\tindex:\"item_kind_nm\", \talign:\"left\",\t\twidth:100\t},\t\t//제품분류명\r\n");
      out.write("\t\t\t\t{name:\"item_nm\",\t\tindex:\"item_nm\", \t\talign:\"left\",\t\twidth:190\t},\t\t//제품명\r\n");
      out.write("\t\t\t\t{name:\"item_id\",\t\tindex:\"item_id\", \t\thidden:true,\t\tkey:true\t},\t\t//제품id\r\n");
      out.write("\t\t\t\t{name:\"item_kind\",\t\tindex:\"item_kind\", \t\thidden:true\t\t\t\t\t\t}\t\t//제품분류코드\r\n");
      out.write("\t\t\t],\r\n");
      out.write("\t\t\theight:460,\r\n");
      out.write("\t\t\twidth:328,\r\n");
      out.write("\t\t\tshrinkToFit: false,\r\n");
      out.write("\t\t\tmultiselect: true,\r\n");
      out.write("\t\t\tmultiboxonly:true\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* 중간 그리드. 현재 선택된 myPL그룹에 등록된 제품 목록. */\r\n");
      out.write("\t\t$(\"#grid_list2\").jqGrid({\r\n");
      out.write("\t\t\tmtype:\"get\",\r\n");
      out.write("\t\t\tdatatype:\"json\",\r\n");
      out.write("\t\t\tcolNames:[\"정렬순서\",\"제품분류\",\"제품명\",\"제품ID\",\"item_kind\"],\r\n");
      out.write("\t\t\tcolModel:[\r\n");
      out.write("\t\t\t\t{name:\"sort_seq\",\t\tindex:\"sort_seq\", \t\talign:\"center\",\t\twidth:50,\t\t formatter:sortSeqFormatter\t},\t\t//정렬순서\r\n");
      out.write("\t\t\t\t{name:\"item_kind_nm\",\tindex:\"item_kind_nm\", \talign:\"left\",\t\twidth:100\t\t\t\t\t\t\t\t\t},\t\t//제품분류\r\n");
      out.write("\t\t\t\t{name:\"item_nm\",\t\tindex:\"item_nm\", \t\talign:\"left\",\t\twidth:150\t\t\t\t\t\t\t\t\t},\t\t//제품명\r\n");
      out.write("\t\t\t\t{name:\"item_id\",\t\tindex:\"item_id\", \t\thidden:true,\t\tkey:true\t\t\t\t\t\t\t\t\t},\t\t//제품id\r\n");
      out.write("\t\t\t\t{name:\"item_kind\",\t\tindex:\"item_kind\", \t\thidden:true\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t//제품분류코드\r\n");
      out.write("\t\t\t],\r\n");
      out.write("\t\t\theight:460,\r\n");
      out.write("\t\t\twidth:328,\r\n");
      out.write("\t\t\tmultiselect: true,\r\n");
      out.write("\t\t\tmultiboxonly:true,\r\n");
      out.write("\t\t\tonSelectCell: changeModifyForm,\r\n");
      out.write("\t\t\tloadComplete: function(data){\t//조회 완료시 호출되는 function\r\n");
      out.write("\t\t\t\tif(data.records != 0){\t//조회결과가 있을 경우\r\n");
      out.write("\t\t\t\t\tsaleActionFlag=true;\r\n");
      out.write("\t\t\t\t\tchangeModifyForm(data.rows[0].item_id);\t\t//첫 로우를 수정폼으로 변경\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tgetGrid3List();\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t}\t\t\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* 현재 선택된 myPL그룹에 등록된 제품 목록 인쇄 전용 그리드 */\r\n");
      out.write("\t\t$(\"#grid_list2_print\").jqGrid({\r\n");
      out.write("\t\t\tmtype:\"get\",\r\n");
      out.write("\t\t\tdatatype:\"json\",\r\n");
      out.write("\t\t\tcolNames:[\" \",\"분류\",\"제품명\",\"KD\",\"보험약가\",\"주성분/함량\",\"적응증\",\"용법/용량\", \"포장단위\", \"item_id\",\"사진용량\"],\r\n");
      out.write("\t\t\tcolModel:[\r\n");
      out.write("\t\t\t\t{name:\"item_kind1\",\t\tindex:\"item_kind1\", \talign:\"center\",\t\twidth:50, \tformatter:trimPrintFormatter},\t\t\r\n");
      out.write("\t\t\t\t{name:\"item_kind_nm\",\tindex:\"item_kind_nm\", \talign:\"center\",\t\twidth:50, \tformatter:trimPrintFormatter},\t\r\n");
      out.write("\t\t\t\t{name:\"item_nm\",\t\tindex:\"item_nm\", \t\talign:\"center\",\t\twidth:200,\tformatter:itemImgPrintFormatter\t},\r\n");
      out.write("\t\t\t\t{name:\"item_kd_no\",\t\tindex:\"item_kd_no\", \talign:\"center\",\t\twidth:50, \tformatter:trimPrintFormatter},\t\r\n");
      out.write("\t\t\t\t{name:\"item_out_danga\",\t\tindex:\"item_out_danga\", \talign:\"right\",\t\twidth:50, \tformatter:trimPrintFormatter},\t\t\r\n");
      out.write("\t\t\t\t{name:\"item_main_source_size\",\t\tindex:\"item_main_source_size\", \talign:\"left\",\t\twidth:200, \tformatter:trimPrintFormatter},\t\r\n");
      out.write("\t\t\t\t{name:\"item_effect\",\t\tindex:\"item_effect\", \talign:\"left\",\t\twidth:200, \tformatter:trimPrintFormatter},\t\r\n");
      out.write("\t\t\t\t{name:\"item_use_does\",\t\tindex:\"item_use_does\", \talign:\"left\",\t\twidth:200, \tformatter:trimPrintFormatter},\t\r\n");
      out.write("\t\t\t\t{name:\"item_pojang_unit\",\t\tindex:\"item_pojang_unit\", \talign:\"center\",\t\twidth:50, \tformatter:trimPrintFormatter},\t\r\n");
      out.write("\t\t\t\t{name:\"item_id\",\t\tindex:\"item_id\", \t\thidden:true,\t\tkey:true\t\t\t\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t{name:\"cnt\",\t\tindex:\"cnt\", \t\thidden:true\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t],\r\n");
      out.write("\t\t\tloadComplete: function(data){\r\n");
      out.write("\t\t\t\tif(data.records != 0){\t//조회결과가 있을 경우\r\n");
      out.write("\t\t\t\t\tCommons.extraAction(saleActionFlag, 'print', '");
      out.print(ONLINE_ROOT);
      out.write("/common/commonPrint.do', 'myPlList_print');\t//인쇄 팝업 호출\r\n");
      out.write("\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\talert('조회 결과가 없습니다.');\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* 왼쪽 그리드. myPL그룹 목록 */\r\n");
      out.write("\t\t$(\"#grid_list\").jqGrid({\r\n");
      out.write("\t\t\turl:\"");
      out.print(ONLINE_ROOT);
      out.write("/business/myplGroupGridList.do\",\r\n");
      out.write("\t\t\tmtype:\"get\",\r\n");
      out.write("\t\t\tdatatype:\"json\",\r\n");
      out.write("\t\t\tcolNames:[\"PL그룹명\",\"plgrp_nm\"],\r\n");
      out.write("\t\t\tcolModel:[\r\n");
      out.write("\t\t\t\t{name:\"plgrp_nm\",\tindex:\"plgrp_nm\", \talign:\"left\",\t\twidth:113\t},\t\t//PL그룹명\r\n");
      out.write("\t\t\t\t{name:\"plgrp_no\",\tindex:\"plgrp_no\", \thidden:true,\t\tkey:true\t}\t\t//plgrp_nm\r\n");
      out.write("\t\t\t],\r\n");
      out.write("\t\t\theight:435,\r\n");
      out.write("\t\t\trownumWidth : 30,\r\n");
      out.write("\t\t\twidth:118,\r\n");
      out.write("\t\t\tshrinkToFit: false,\r\n");
      out.write("\t\t\tonSelectRow: selPlGroupRow,\r\n");
      out.write("\t\t\tloadComplete: function(data){\t\t//조회 완료시 호출되는 function\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t$(\"#plgrp_no\").val(\"\");\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tif(data.records != 0){\t\t\t//조회결과가 있을 경우\r\n");
      out.write("\t\t\t\t\t$(\"#plGroupCnt\").html(\"P/L그룹 (총 \"+data.records+\"건)\");\r\n");
      out.write("\t\t\t\t\t$(\"#grid_list\").setSelection(data.rows[0].plgrp_no);\r\n");
      out.write("\t\t\t\t\t$(\"#plgrp_no\").val(data.rows[0].plgrp_no);\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t}\r\n");
      out.write("   \t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* 조회 버튼 클릭 */\r\n");
      out.write("\t\t$(\"#p_retrieve_btn\").on(\"click\",function(){\r\n");
      out.write("\t\t\tgetGridList();\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* 인쇄 버튼 클릭 */\r\n");
      out.write("\t\t$(\"#p_print_btn\").on(\"click\",function(){\r\n");
      out.write("\t\t\tprint();\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t/* 저장 버튼 클릭 */\r\n");
      out.write("\t\t$(\"#ct_save_btn\").on(\"click\",function(){\r\n");
      out.write("\t\t\tinsertMyPlList();\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t});\r\n");
      out.write("\t\r\n");
      out.write("\t/* 브라우저 창의 사이즈가 변경될 때 */ \r\n");
      out.write("    $(window).resize(function(){\r\n");
      out.write("\t\t$(\"#grid_list\").setGridWidth($('.box_type01').width(), true);\t//grid 영역의 넓이가 동적으로 조절\r\n");
      out.write("\t});\r\n");
      out.write("    \r\n");
      out.write(" \t/**\r\n");
      out.write(" \t*\tP/L그룹 목록\r\n");
      out.write(" \t*/\r\n");
      out.write("\tfunction getGridList(){\r\n");
      out.write(" \t\t$(\"#grid_list\").jqGrid('setGridParam',{url:\"");
      out.print(ONLINE_ROOT);
      out.write("/business/myplGroupGridList.do\"}).trigger(\"reloadGrid\");\r\n");
      out.write("\t}\r\n");
      out.write("    \r\n");
      out.write("    /**\r\n");
      out.write("    *\tP/L그룹 item list 조회\r\n");
      out.write("    */\r\n");
      out.write("\tfunction getGrid2List(){\r\n");
      out.write("\t\tvar frm = $(\"#frm\").serialize();\r\n");
      out.write(" \t\t$(\"#grid_list2\").jqGrid('setGridParam',{url:\"");
      out.print(ONLINE_ROOT);
      out.write("/business/myPlItemGridList.do?\"+frm}).trigger(\"reloadGrid\");\r\n");
      out.write("\t}\r\n");
      out.write(" \t\r\n");
      out.write("\t/**\r\n");
      out.write("\t*\titem list 조회\r\n");
      out.write("\t*/\r\n");
      out.write("\tfunction getGrid3List(){\r\n");
      out.write("\t\tvar frm = $(\"#frm\").serialize();\r\n");
      out.write("\t\t$(\"#grid_list3\").jqGrid('setGridParam',{url:\"");
      out.print(ONLINE_ROOT);
      out.write("/business/itemGridList.do?\"+encodeURI(frm)}).trigger(\"reloadGrid\");\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\t/**\r\n");
      out.write("\t * 중간 그리드 정렬순서에 사용된 포매터. 클릭시 입력폼으로 변환되고 포커스아웃될때 div로 변경됨. \r\n");
      out.write("\t * @param cellvalue\t해당 컬럼의 값\r\n");
      out.write("\t * @param rowObject\t해당 row의 데이터\r\n");
      out.write("\t * @returns {String}\r\n");
      out.write("\t */\r\n");
      out.write("\tfunction sortSeqFormatter(cellvalue,rowObject){\r\n");
      out.write("\t\t// 사용내역 포맷\r\n");
      out.write("\t\tif(typeof(cellvalue)==\"undefined\"){\r\n");
      out.write("\t\t\tcellvalue=\"\";\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar returnValue = \"<div id='sortSeqLayer_\"+rowObject.rowId+\"' onclick='javascript:changeModifyForm(\"+rowObject.rowId+\",\\\"sort_seq\\\");'>\"+cellvalue+\"&nbsp;</div>\";\r\n");
      out.write("\t\treturnValue += \"<div id='sortSeqInputLayer_\"+rowObject.rowId+\"' style='display:none;'>\";\r\n");
      out.write("\t\treturnValue += \"<input type='text' name='sort_seq' id='sort_seq_\"+rowObject.rowId+\"' value='\"+cellvalue+\"' onKeyDown='if(event.keyCode==13 || event.keyCode==9){moveNextEditCol(\"+rowObject.rowId+\",\\\"sort_seq\\\"); return false;}' onblur='javascript:changeModifyForm(\"+rowObject.rowId+\",\\\"sort_seq\\\");' />\";\r\n");
      out.write("\t\treturnValue += \"</div>\";\r\n");
      out.write("\t\treturn returnValue;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t * 다음 수정폼으로 이동\r\n");
      out.write("\t * @param prevRowId\t이전 로우 id\r\n");
      out.write("\t */\r\n");
      out.write("\tfunction moveNextEditCol(prevRowId){\r\n");
      out.write("\t\tvar nextRowId = Commons.jqGridGetNextRowId('grid_list2', prevRowId);\t//다음 로우 id 구함\r\n");
      out.write("\t\t//$(\"#sort_seq_\"+prevRowId).attr(\"onblur\", \"\");\t//onblur 이벤트 제거\r\n");
      out.write("\t\tchangeModifyForm(nextRowId);\t\t//다음 로우에 인풋폼 생성 \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t * 다음 수정폼으로 이동\r\n");
      out.write("\t * @param rowId\t현재 row id\r\n");
      out.write("\t * @returns {Boolean}\t\r\n");
      out.write("\t */\r\n");
      out.write("\tfunction changeModifyForm(rowId){\r\n");
      out.write("\t\tvar divForm = \"\";\r\n");
      out.write("\t\tvar textForm = \"\";\r\n");
      out.write("\t\tvar inputLayer = \"\";\r\n");
      out.write("\r\n");
      out.write("\t\tdivForm = $(\"#sortSeqLayer_\"+rowId);\r\n");
      out.write("\t\ttextForm = $(\"#sort_seq_\"+rowId);\r\n");
      out.write("\t\tinputLayer = $(\"#sortSeqInputLayer_\"+rowId);\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif (divForm.css(\"display\") == \"none\") { // 입력폼 감추고 영역 보이기  \r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tif(formCheck.isNumer($(\"#sort_seq_\"+rowId).val())){\r\n");
      out.write("\t\t\t\talert(\"정렬순서에는 숫자만 입력가능합니다.\");\r\n");
      out.write("\t\t\t\t$(\"#sort_seq_\"+rowId).focus();\r\n");
      out.write("\t\t\t\ttextForm.attr(\"onblur\", \"changeModifyForm('\"+rowId+\"');\"); // onblur 이벤트 생성\r\n");
      out.write("\t\t\t\treturn false;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t$(\"#sortSeqLayer_\"+rowId).text(textForm.val() + \" \"); // value 셋팅\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\tinputLayer.hide(); // 입력폼 감추기\r\n");
      out.write("\t\t\tdivForm.show(); // 영역 보이기\r\n");
      out.write("\t\t} else { // 영역 감추고 입력폼 보이기\r\n");
      out.write("\t\t\ttextForm.width(textForm.parents(\"td\").width() - 1); // input size 변경\r\n");
      out.write("\t\t\ttextForm.val($.trim(divForm.text())); // value 셋팅\r\n");
      out.write("\t\t\ttextForm.attr(\"onblur\", \"changeModifyForm('\"+rowId+\"');\"); // onblur 이벤트 생성\r\n");
      out.write("\t\t\tdivForm.hide(); // 영역 감추기\r\n");
      out.write("\t\t\tinputLayer.show(); // 입력폼 보이기\r\n");
      out.write("\t\t\ttextForm.focus();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t *\t왼쪽 그리드에서 myPL그룹 선택시 중간 그리드 조회\r\n");
      out.write("\t * @param id P/L그룹 ID\r\n");
      out.write("\t */\r\n");
      out.write("\tfunction selPlGroupRow(id){\r\n");
      out.write("\t\t$(\"#item_kind > option:eq(0)\").attr(\"selected\",\"selected\");\r\n");
      out.write("\t\t$(\"#plgrp_no\").val(id);\r\n");
      out.write("\t\tgetGrid2List();\r\n");
      out.write("\t\t\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t*\tmyPL 그룹에 소속시키도록 오른쪽 그리드에서 중간 그리드로 이동시키기\r\n");
      out.write("\t*/\r\n");
      out.write("\tfunction myPlListSend(){\r\n");
      out.write("\t\tvar myPlGrid = $(\"#grid_list2\");\r\n");
      out.write("\t\tvar itemGrid = $(\"#grid_list3\");\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar rowKey = itemGrid.getGridParam(\"selrow\");\r\n");
      out.write("\r\n");
      out.write("        if (!rowKey){\r\n");
      out.write("            alert(\"선택된 제품이 없습니다.\");\r\n");
      out.write("        \treturn;\r\n");
      out.write("        }else{\r\n");
      out.write("        \tvar itemsize =0;\r\n");
      out.write("        \tvar selectedIDs = itemGrid.getGridParam(\"selarrrow\");\r\n");
      out.write("        \titemsize = selectedIDs.length;\r\n");
      out.write("\r\n");
      out.write("        \tfor (var i = 0; i < itemsize; i++) {\r\n");
      out.write("        \t\t//추가하려는 제품 row 정보\r\n");
      out.write("            \tvar addRow = itemGrid.getRowData(selectedIDs[i]);\r\n");
      out.write("            \t\r\n");
      out.write("        \t\t\r\n");
      out.write("        \t\t//P/L목록에 추가\r\n");
      out.write("            \tmyPlGrid.addRowData(selectedIDs[i],addRow);\r\n");
      out.write("            }\r\n");
      out.write("        \t\r\n");
      out.write("        \tfor (var j = itemsize-1; j >= 0; j--) {\r\n");
      out.write("        \t\t//기존 제품 grid row 삭제\r\n");
      out.write("             \titemGrid.delRowData(selectedIDs[j]);\r\n");
      out.write("            }\r\n");
      out.write("        } \r\n");
      out.write("\t\t\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t*\tmyPL 그룹에서 빼도록 오른쪽 그리드로 이동시키기\r\n");
      out.write("\t*/\r\n");
      out.write("\tfunction itemListSend(){\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar myPlGrid = $(\"#grid_list2\");\r\n");
      out.write("\t\tvar itemGrid = $(\"#grid_list3\");\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar rowKey = myPlGrid.getGridParam(\"selrow\");\r\n");
      out.write("\r\n");
      out.write("        if (!rowKey){\r\n");
      out.write("            alert(\"선택된 제품이 없습니다.\");\r\n");
      out.write("        \treturn;\r\n");
      out.write("        }else{\r\n");
      out.write("        \tvar itemsize =0;\r\n");
      out.write("        \tvar selectedIDs = myPlGrid.getGridParam(\"selarrrow\");\r\n");
      out.write("        \titemsize = selectedIDs.length;\r\n");
      out.write("        \t\r\n");
      out.write("        \tfor (var i = 0; i < selectedIDs.length; i++) {\r\n");
      out.write("            \t\r\n");
      out.write("        \t\t//추가하려는 제품 row 정보\r\n");
      out.write("            \tvar addRow = myPlGrid.getRowData(selectedIDs[i]);\r\n");
      out.write("            \t//P/L목록에 추가\r\n");
      out.write("            \titemGrid.addRowData(selectedIDs[i],addRow);\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("        \tfor (var j = itemsize-1; j >= 0; j--) {\r\n");
      out.write("        \t\t//기존 제품 grid row 삭제\r\n");
      out.write("             \tmyPlGrid.delRowData(selectedIDs[j]);\r\n");
      out.write("            }\r\n");
      out.write("        } \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t*\t선택된 myPL그룹에 제품들 등록\r\n");
      out.write("\t*/\r\n");
      out.write("\tfunction insertMyPlList(){\r\n");
      out.write("\t\tif($(\"#plgrp_no\").val()==\"\"){\r\n");
      out.write("\t\t\talert(\"PL그룹을 먼저 선택해야 합니다.\\nPL그룹이 없으면 생성하시기 바랍니다.\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t//전체 rowData 가져오기(배열)\r\n");
      out.write("\t\tvar data = $(\"#grid_list2\").getRowData();\r\n");
      out.write("\t\tvar itemFrm = $('#itemFrm');\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif(itemFrm.find('input').size() > 0){\r\n");
      out.write("\t\t\t$(itemFrm.find('input')).each(function(e){$(this).remove();});\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t$(\"<input></input>\").attr({type:\"hidden\", name:\"plgrp_no\", \t\tvalue:$(\"#plgrp_no\").val()}).appendTo(itemFrm);\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tfor(var i=0; i < data.length; i++ ){\r\n");
      out.write("\t\t\tvar row = data[i];\r\n");
      out.write("\t\t\t$(\"<input></input>\").attr({type:\"hidden\", name:\"item_id\", \t\tvalue:row.item_id}).appendTo(itemFrm);\r\n");
      out.write("\t\t\t$(\"<input></input>\").attr({type:\"hidden\", name:\"sort_seq\", \t\tvalue:$('#sort_seq_'+row.item_id).val()}).appendTo(itemFrm);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\ttype:\"POST\",\r\n");
      out.write("\t\t\turl:\"");
      out.print(ONLINE_ROOT);
      out.write("/business/insertMyPlList.do\",\r\n");
      out.write("\t\t\tdata:$(\"#itemFrm\").serialize(),\r\n");
      out.write("\t\t\tdataType:\"json\",\r\n");
      out.write("\t\t\tsuccess:function(data){\r\n");
      out.write("\t\t\t\tif (data.result==\"Y\") {\r\n");
      out.write("\t\t\t\t\talert(\"저장하였습니다.\");\r\n");
      out.write("\t\t\t\t\t getGrid2List();\r\n");
      out.write("\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\talert(\"저장되지 않았습니다. 다시 시도해 주세요.\");\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t*\tP/L그룹 item list 인쇄\r\n");
      out.write("\t*/\r\n");
      out.write("\tfunction print(){\r\n");
      out.write("\t\tvar frm = $(\"#frm\").serialize();\r\n");
      out.write(" \t\t$(\"#grid_list2_print\").jqGrid('setGridParam',{url:\"");
      out.print(ONLINE_ROOT);
      out.write("/business/myPlItemGridList.do?\"+frm}).trigger(\"reloadGrid\");\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t * P/L그룹 item list 인쇄용 jqGrid 제품명/사진 Formatter\r\n");
      out.write("\t * @param cellvalue\t컬럼값\r\n");
      out.write("\t * @param options\tjqGrid옵션\r\n");
      out.write("\t * @param rowObject\trow 데이터\r\n");
      out.write("\t * @returns\r\n");
      out.write("\t */\r\n");
      out.write("\tfunction itemImgPrintFormatter(cellvalue, options, rowObject){\r\n");
      out.write("\t\tvar d = new Date();\r\n");
      out.write("\t\tvar returnValue = '<img id=\"item_img\" style=\"width:140px; height:100px; visibility:hidden\" src=\"\">';\r\n");
      out.write("\t\tif(rowObject.cnt > 0){\r\n");
      out.write("\t\t\treturnValue = '<img id=\"item_img\" style=\"width:140px; height:100px\" src=\"");
      out.print(ONLINE_ROOT );
      out.write("/business/getPlItemPhoto.do?item_id='+rowObject.item_id+'&amp;dummy='+d.getTime()+'\">';\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\treturn returnValue.toString();\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t/**\r\n");
      out.write("\t * P/L그룹 item list 인쇄용 jqGrid trim Formatter\r\n");
      out.write("\t * @param cellvalue\t컬럼값     \r\n");
      out.write("\t * @param options\tjqGrid옵션\r\n");
      out.write("\t * @param rowObject\trow 데이터 \r\n");
      out.write("\t * @returns\r\n");
      out.write("\t */\r\n");
      out.write("\tfunction trimPrintFormatter(cellvalue, options, rowObject){\r\n");
      out.write("\t\tvar returnValue = $.trim(cellvalue);\r\n");
      out.write("\t\treturn returnValue.toString();\r\n");
      out.write("\t}\r\n");
      out.write("\t</script>\r\n");
      out.write("\t\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");
      out.write("\t<form id=\"frm\" name=\"frm\" method=\"post\">\r\n");
      out.write("\t\t<input type=\"hidden\" id=\"plgrp_no\" name=\"plgrp_no\"/>\r\n");
      out.write("\t\t<!-- ##### content start ##### -->\r\n");
      out.write("\t\t<div class=\"inner_cont\">\r\n");
      out.write("\t\t\t<div class=\"w967 m0auto\">\r\n");
      out.write("\t\t\t\t<h2>My P/L</h2>\r\n");
      out.write("\t\t\t\t<p class=\"mt5\">\r\n");
      out.write("\t\t\t\t\t자신만의 제품리스트를 그룹별로 출력할 수 있는 화면입니다.\r\n");
      out.write("\t\t\t\t\t<!-- 마케팅부, 전산부, admin계정만 버튼을 보여준다. -->\r\n");
      out.write(" \t\t\t\t\t");
if(userDeptCd.equals("0138") || userDeptCd.equals("0007") || userEmpCode.equals("admin")){
      out.write("\r\n");
      out.write(" \t\t\t\t\t<button type=\"button\" class=\"btn\" onclick=\"javascript:Commons.popupOpen('plItemReg', '");
      out.print(ONLINE_ROOT);
      out.write("/business/common/myPlItemRegPopup.do', '850', '720');\">P/L제품등록</button>\r\n");
      out.write(" \t\t\t\t\t");
}
      out.write("\r\n");
      out.write(" \t\t\t\t\t");
      out.print(WebUtil.createButtonArea(currPgmNoByUri, "p_"));
      out.write("\r\n");
      out.write("\t\t\t\t</p>\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t<div class=\"wrap_mypl\">\r\n");
      out.write("\t\t\t\t\t<div class=\"box float_l\">\r\n");
      out.write("\t\t\t\t\t\t<p class=\"tit ta_c\" id=\"plGroupCnt\">\r\n");
      out.write("\t\t\t\t\t\t\tP/L그룹 (총00건)\r\n");
      out.write("\t\t\t\t\t\t</p>\r\n");
      out.write("\t\t\t\t\t\t<div class=\"box_type01 w120 h460\">\r\n");
      out.write("\t\t\t\t\t\t\t<table id=\"grid_list\"></table>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t<div class=\"ta_c mt10\">\r\n");
      out.write("\t\t\t\t\t\t\t<button type=\"button\" class=\"btn\" onclick=\"javascript:Commons.popupOpen('groupReg', '");
      out.print(ONLINE_ROOT);
      out.write("/business/common/myplGroupPopup.do', '560', '700');\">P/L그룹 관리</button>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t<div class=\"box float_l ml37\">\r\n");
      out.write("\t\t\t\t\t\t<div class=\"wrap_tit\">\r\n");
      out.write("\t\t\t\t\t\t\t<p class=\"tit float_l\">\r\n");
      out.write("\t\t\t\t\t\t\t\tMY P/L 정렬순서 변경시 저장버튼을 사용하세요.\r\n");
      out.write("\t\t\t\t\t\t\t</p>\r\n");
      out.write("\t\t\t\t\t\t\t<div class=\"float_r\">\r\n");
      out.write("\t\t\t\t\t\t\t\t");
      out.print(WebUtil.createButtonArea(currPgmNoByUri, "ct_"));
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t<div class=\"box_type01 w330\" id=\"myPlList\">\r\n");
      out.write("\t\t\t\t\t\t\t<table id=\"grid_list2\"></table>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t<div class=\"change float_l\">\r\n");
      out.write("\t\t\t\t\t\t<button type=\"button\" class=\"btn right\" onclick=\"javascript:itemListSend();\"><span class=\"blind\">오른쪽으로 이동</span></button><br />\r\n");
      out.write("\t\t\t\t\t\t<button type=\"button\" class=\"btn left\" onclick=\"javascript:myPlListSend();\"><span class=\"blind\">왼쪽으로 이동</span></button>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t<div class=\"box float_l\">\r\n");
      out.write("\t\t\t\t\t\t<label>제품목록</label>\r\n");
      out.write("\t\t\t\t\t\t<select class=\"w125\" id=\"item_kind\" name=\"item_kind\">\r\n");
      out.write("\t\t\t\t\t\t\t<option value=\"\">전체</option>\r\n");
      out.write("\t\t\t\t\t\t\t");
 if(itemTypeList!=null){
								for(int i=0;itemTypeList.size()>i;i++){
									MyPlVO myPlVO = new MyPlVO();
									myPlVO=itemTypeList.get(i);
								
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t\t<option value=\"");
      out.print(myPlVO.getItem_id());
      out.write('"');
      out.write('>');
      out.print(myPlVO.getItem_nm());
      out.write("</option>\r\n");
      out.write("\t\t\t\t\t\t\t\t");
}
							}
      out.write("\r\n");
      out.write("\t\t\t\t\t\t</select>\r\n");
      out.write("\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t<input type=\"text\" class=\"w95\" id=\"item_nm\" name=\"item_nm\"/>\r\n");
      out.write("\t\t\t\t\t\t<input type=\"text\" style=\"display:none\" name=\"block_submit_dummy\"/>\r\n");
      out.write("\t\t\t\t\t\t<button type=\"button\" class=\"btn ml10\" onclick=\"javascript:getGrid3List()\">찾기</button>\r\n");
      out.write("\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t<div class=\"box_type01 w330 h485\">\r\n");
      out.write("\t\t\t\t\t\t\t<table id=\"grid_list3\"></table>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t<!-- 인쇄전용 jqGrid -->\r\n");
      out.write("\t\t\t\t<div id=\"myPlList_print\" style=\"display:none\">\r\n");
      out.write("\t\t\t\t\t<table id=\"grid_list2_print\"></table>\r\n");
      out.write("\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\t\t<!-- ##### content end ##### -->\r\n");
      out.write("\t</form>\r\n");
      out.write("\t<form id=\"itemFrm\"></form>\r\n");
      out.write("\t");
      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("<div class=\"wrap_foot\">\r\n");
      out.write("\t<div class=\"footer\">\r\n");
      out.write("\t\tCopyright ⓒ 2014 <span class=\"copy_fc\">HANA PHARM CO.</span>, LTD. All Right Reserved.\r\n");
      out.write("\t</div>\r\n");
      out.write("</div>\r\n");
      out.write("<!-- 엑셀 다운로드용 iframe -->\r\n");
      out.write("<iframe name=\"excelDownFrame\" frameBorder=\"0\" width=\"0\" height=\"0\" class=\"blind\"></iframe>\r\n");
      out.write("\r\n");
      out.write("</body>\r\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
