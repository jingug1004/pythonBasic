<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
  * @파일명 : fileAttach.xml
  * @메뉴명 : 파일업로드 
  * @최초작성일 : 2015/02/10            
  * @author : Jung.Jin.Muk(pc123pc@irush.co.kr)                  
  * @수정내역 :	
-->
<mapper namespace="fileAttach"> 
	

	<insert id="insertFileAttach" parameterType="com.hanaph.gw.co.fileAttach.vo.FileAttachVO">
		<selectKey keyProperty="file_seq" resultType="Integer" order="BEFORE">
    		SELECT SEQ_GW_OF_FILE_ATTACH.NEXTVAL FROM DUAL
  		</selectKey>
			INSERT INTO GW_OF_FILE_ATTACH (
				FILE_SEQ, CD,
				FILE_PATH, ORIGIN_FILE_NM, FILE_NM,
				FILE_SIZE, FILE_EXT, CREATE_DT, CREATE_NO,
				DELETE_YN)
			VALUES (
				#{file_seq}, #{cd},
				#{file_path}, #{origin_file_nm}, #{file_nm},
				#{file_size}, #{file_ext}, SYSDATE, #{create_no},
				#{delete_yn}
			)
	</insert>
	
	<update id="updateFileAttach" parameterType="hashmap">
		UPDATE GW_OF_FILE_ATTACH
		   SET SEQ = #{seq}
		 WHERE FILE_SEQ = #{file_seq}
	</update>
	
	<select id="getAttachList" parameterType="hashmap" resultType="com.hanaph.gw.co.fileAttach.vo.FileAttachVO">

		SELECT
			FILE_SEQ, SEQ, CD,
			FILE_PATH, ORIGIN_FILE_NM, FILE_NM,
			FILE_SIZE, FILE_EXT, CREATE_DT, DELETE_YN
		FROM 
			GW_OF_FILE_ATTACH
		WHERE
	
			SEQ=#{seq}
		AND
			CD=#{cd}
		AND DELETE_YN = 'N'
	
	</select>

	<update id="deleteAttach" parameterType="com.hanaph.gw.co.fileAttach.vo.FileAttachVO">

		UPDATE
			GW_OF_FILE_ATTACH
		SET
			DELETE_YN = #{delete_yn}
		WHERE
			FILE_SEQ = #{file_seq}
		
	</update>
	
	<select id="getOriginFileNm" parameterType="String" resultType="String">
		SELECT ORIGIN_FILE_NM FROM GW_OF_FILE_ATTACH
		 WHERE FILE_SEQ = #{file_seq}
	</select>
	
	<update id="deleteAttachAll" parameterType="com.hanaph.gw.co.fileAttach.vo.FileAttachVO">
		UPDATE GW_OF_FILE_ATTACH
		  SET DELETE_YN = #{delete_yn}
		WHERE CD = #{cd} 
		  AND SEQ = #{seq}
	</update>
	
</mapper>
	
