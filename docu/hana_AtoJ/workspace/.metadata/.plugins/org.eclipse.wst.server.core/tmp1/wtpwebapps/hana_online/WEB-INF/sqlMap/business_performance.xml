<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
  * @파일명 : business_performance.xml
  * @메뉴명 : 실적현황_batch
  * @최초작성일 : 2014/10/31
  * @author : 윤범진          
  * @수정내역 :
 -->
<mapper namespace="performance"> 
	
	<select id="getPerformanceForPartGridList" parameterType="hashmap" resultType="com.hanaph.saleon.business.vo.PerformanceVO">
		/* 파트별 목록 */
		<if test="page != null">
			SELECT *
				FROM (SELECT T0.*, FLOOR((ROWNUM - 1) / #{perPageRow,jdbcType=INTEGER} + 1) PAGE
	        		FROM (
    	</if>
    	
    	<![CDATA[
                     SELECT X.PARTDIV                                AS PARTDIV                    ,  --직능코드
                            MAX(C.DIVNAME)                           AS COL4                       ,  --직능명(파트명)
                            SUM(X.SALE_AMT)                          AS SALE_AMT                   ,  --판매목표
                            SUM(X.SALE_AMT_SILJUK_BYUNG)             AS SALE_AMT_SILJUK_BYUNG      ,  --판매종합병원
                            SUM(X.SALE_AMT_SILJUK_MBYUNG)            AS SALE_AMT_SILJUK_MBYUNG     ,  --판매준종합병원
                            SUM(X.SALE_AMT_SILJUK_IN)                AS SALE_AMT_SILJUK_IN         ,  --
                            SUM(X.SALE_AMT_SILJUK_IN_LOCAL)          AS SALE_AMT_SILJUK_IN_LOCAL   ,  --판매도매로컬
                            SUM(X.SALE_AMT_SILJUK_IN_01)             AS SALE_AMT_SILJUK_IN_01      ,  --판매의원
                            SUM(X.SALE_AMT_SILJUK_IN_02)             AS SALE_AMT_SILJUK_IN_02      ,  --판매일반간납
                            SUM(X.SALE_AMT_SILJUK_IN_03)             AS SALE_AMT_SILJUK_IN_03      ,  --판매턴키
                            SUM(X.SALE_AMT_SILJUK_IN_04)             AS SALE_AMT_SILJUK_IN_04      ,  --판매입찰
                            SUM(X.SALE_AMT_SILJUK_IN_05)             AS SALE_AMT_SILJUK_IN_05      ,  --판매기타
                            SUM(X.SALE_AMT_SILJUK_OUT)               AS SALE_AMT_SILJUK_OUT        ,  --판매약국
                            SUM(X.SALE_AMT_BANPUM)                   AS SALE_AMT_BANPUM            ,  --판매반품
                            SUM(X.SALE_AMT_HALIN)                    AS SALE_AMT_HALIN             ,  --판매매출할인
                            SUM(X.SALE_AMT_HALINS01)                 AS SALE_AMT_HALINS01          ,  --판매수금할인(일반)
                            SUM(X.SALE_AMT_HALINS02)                 AS SALE_AMT_HALINS02          ,  --판매수금할인(조건)
                            SUM(X.SALE_AMT_SILJUK_IN)     + SUM(X.SALE_AMT_SILJUK_OUT) + SUM(X.SALE_AMT_SILJUK_BYUNG) +
                            SUM(X.SALE_AMT_SILJUK_MBYUNG) + SUM(X.SALE_AMT_BANPUM)     + (SUM(X.SALE_AMT_HALIN)       +
                            SUM(X.SALE_AMT_HALINS01)) + NVL(SUM(X.SALE_AMT_HALINS02),0)  AS SALE_AMT_SILJUK             ,  --판매계(수금할인조건제외)
                            DECODE(SUM(NVL(X.SALE_AMT,0)),0, 0,
                            ROUND((SUM(X.SALE_AMT_SILJUK_IN)    + SUM(X.SALE_AMT_SILJUK_OUT)    +
                                   SUM(X.SALE_AMT_SILJUK_BYUNG) + SUM(X.SALE_AMT_SILJUK_MBYUNG) +
                                   SUM(X.SALE_AMT_BANPUM)       + SUM(X.SALE_AMT_HALIN)         +
                                   SUM(X.SALE_AMT_HALINS01))    / SUM(X.SALE_AMT) * 100,2))
                                                                     AS SALE_PERCENT               ,  --
                            SUM(X.IN_AMT)                            AS IN_AMT                     ,  --수금목표
                            SUM(X.IN_AMT_SILJUK_BYUNG)               AS IN_AMT_SILJUK_BYUNG        ,  --수금종합병원
                            SUM(X.IN_AMT_SILJUK_MBYUNG)              AS IN_AMT_SILJUK_MBYUNG       ,  --수금준종합병원
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK_IN           ,  --
                            SUM(X.IN_AMT_SILJUK_IN_LOCAL)            AS IN_AMT_SILJUK_IN_LOCAL     ,  --수금도매
                            SUM(X.IN_AMT_SILJUK_IN_01)               AS IN_AMT_SILJUK_IN_01        ,  --수금의원
                            SUM(X.IN_AMT_SILJUK_IN_02)               AS IN_AMT_SILJUK_IN_02        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_03)               AS IN_AMT_SILJUK_IN_03        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_04)               AS IN_AMT_SILJUK_IN_04        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_05)               AS IN_AMT_SILJUK_IN_05        ,  --수금기타
                            SUM(X.IN_AMT_SILJUK_OUT)                 AS IN_AMT_SILJUK_OUT          ,  --수금약국
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK              ,  --수금계                              
                            DECODE(SUM(NVL(X.IN_AMT,0)), 0, 0,
                            ROUND((SUM(X.IN_AMT_SILJUK_IN)    ) / SUM(X.IN_AMT) * 100,2))
                                                                     AS IN_PERCENT                    --수금달성률
                       FROM
                         ( SELECT NVL(A.PARTDIV, '99')               AS PARTDIV                 ,
                                  A.DEPTCODE                         AS DEPTCODE                ,
                                  A.EMPCODE                          AS EMPCODE                 ,
                                  SUM(A.SALE_AMT)                    AS SALE_AMT                ,
                                  SUM(A.SALE_AMT_SILJUK_BYUNG)       AS SALE_AMT_SILJUK_BYUNG   ,
                                  SUM(A.SALE_AMT_SILJUK_MBYUNG)      AS SALE_AMT_SILJUK_MBYUNG  ,
                                  SUM(A.SALE_AMT_SILJUK_IN)          AS SALE_AMT_SILJUK_IN      ,
                                  SUM(A.SALE_AMT_SILJUK_IN_LOCAL)    AS SALE_AMT_SILJUK_IN_LOCAL,
                                  SUM(A.SALE_AMT_SILJUK_IN_01)       AS SALE_AMT_SILJUK_IN_01   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_02)       AS SALE_AMT_SILJUK_IN_02   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_03)       AS SALE_AMT_SILJUK_IN_03   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_04)       AS SALE_AMT_SILJUK_IN_04   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_05)       AS SALE_AMT_SILJUK_IN_05   ,
                                  SUM(A.SALE_AMT_SILJUK_OUT)         AS SALE_AMT_SILJUK_OUT     ,
                                  SUM(A.SALE_AMT_BANPUM)             AS SALE_AMT_BANPUM         ,
                                  SUM(A.SALE_AMT_HALIN)              AS SALE_AMT_HALIN          ,
                                  SUM(A.SALE_AMT_HALINS01)           AS SALE_AMT_HALINS01       ,
                                  SUM(A.SALE_AMT_HALINS02)           AS SALE_AMT_HALINS02       ,
                                  SUM(A.IN_AMT)                      AS IN_AMT                  ,
                                  SUM(A.IN_AMT_SILJUK_IN)            AS IN_AMT_SILJUK_IN        ,
                                  SUM(A.IN_AMT_SILJUK_IN_LOCAL)      AS IN_AMT_SILJUK_IN_LOCAL  ,
                                  SUM(A.IN_AMT_SILJUK_IN_01)         AS IN_AMT_SILJUK_IN_01     ,
                                  SUM(A.IN_AMT_SILJUK_IN_02)         AS IN_AMT_SILJUK_IN_02     ,
                                  SUM(A.IN_AMT_SILJUK_IN_03)         AS IN_AMT_SILJUK_IN_03     ,
                                  SUM(A.IN_AMT_SILJUK_IN_04)         AS IN_AMT_SILJUK_IN_04     ,
                                  SUM(A.IN_AMT_SILJUK_IN_05)         AS IN_AMT_SILJUK_IN_05     ,
                                  SUM(A.IN_AMT_SILJUK_OUT)           AS IN_AMT_SILJUK_OUT       ,
                                  SUM(A.IN_AMT_SILJUK_BYUNG)         AS IN_AMT_SILJUK_BYUNG     ,
                                  SUM(A.IN_AMT_SILJUK_MBYUNG)        AS IN_AMT_SILJUK_MBYUNG
                             FROM
                                ( --목표
                                  SELECT A.UTDIV                                                   AS PARTDIV                 ,
                                         A.DEPTCODE                                                AS DEPTCODE                ,
                                         A.EMPCODE                                                 AS EMPCODE                 ,
                                         SUM(CASE WHEN A.SALDIV = 'A' THEN A.TARGETAMT ELSE 0 END) AS SALE_AMT                ,  --판매목표
                                         0                                                         AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                         AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                         AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                         AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                         AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                         AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                         AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                         AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                         AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                         AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                         AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                         AS SALE_AMT_HALIN          ,  --매출:매출할인외
                                         0                                                         AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         SUM(CASE WHEN A.SALDIV = 'C' THEN A.TARGETAMT ELSE 0 END) AS IN_AMT                  ,  --수금목표
                                         0                                                         AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                         AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                         AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                         AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                         AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                         AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                         AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                         AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                         AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                         AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLTARGETSALEM A
                                   WHERE A.YEARMONTH BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.UTDIV   ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.DEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY A.UTDIV, A.DEPTCODE, A.EMPCODE
                               UNION ALL
                                  --판매
                                  SELECT B.ITPARTDIV                                                                                                                    AS PARTDIV                 ,
                                         B.ITDEPTCODE                                                                                                                   AS DEPTCODE                ,  --부서코드
                                         B.EMPCODE                                                                                                                      AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '60'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '80'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV IN ('05','10','70','90','99')            THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '05'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) = '4' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) > '6' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '70'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '90'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '99'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '20'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         SUM(CASE WHEN A.SALDIV IN ('B01','B10')                                                             THEN -B.SALAMT1 ELSE 0 END) AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                                                                                              AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         0                                                                                                                              AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                                                                                              AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                                                                                              AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                                                                                              AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                                                                                              AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLORDM A,
                                         ORAGMP.SLORDD B
                                   WHERE A.STATEDIV = '09'
                                     AND A.ORDERNO  = B.ORDERNO
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(B.ITPARTDIV ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(B.ITDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(B.EMPCODE   ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY B.ITPARTDIV, B.ITDEPTCODE, B.EMPCODE
                               UNION ALL
                                  --수금
                                  SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                         A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                         A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                         SUM(CASE WHEN A.COLDIV = '52' AND A.SALEAPPLY = 'Y' THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                   AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) NOT IN ('3','4')  THEN -(A.COLAMT - A.COLVAT) ELSE 0 END) AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) IN ('3','4')       THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLCOLM A
                                   WHERE A.STATEDIV = '09'
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                     AND A.COLDIV <> '55'   --잔고이월 제외 
                                     AND A.COLDIV NOT LIKE '3%'
                                GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                
                                UNION ALL

                                SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                       A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                       A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                       0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                       0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                       0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                       0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                       0                                                                  AS SALE_AMT_HALIN          ,  --매출:매출할인
                                       0                                                                  AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                       0                                                                  AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                       0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('40', '45') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '10' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '99' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '20' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                               ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '60' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '80' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                  FROM ORAGMP.SLCOLM A
                                 WHERE A.STATEDIV = '09'
                                   AND SUBSTR(A.APPDATE,1,7) BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#{as_date_fr,jdbcType=VARCHAR} || '-01','YYYY-MM-DD'), -24), 'YYYY-MM') AND #{as_date_to,jdbcType=VARCHAR}
                                   AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                   AND A.COLDIV <> '55'   --잔고이월 제외 
                                   AND A.COLDIV LIKE '3%'
                              GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                ) A
                         GROUP BY A.PARTDIV, A.DEPTCODE, A.EMPCODE
                         ) X,
                           ORAGMP.CMEMPM    A,
                           ORAGMP.CMDEPTM   B,
                           ORAGMP.CMCOMMONM C
                     WHERE X.EMPCODE  = A.EMPCODE (+)
                       AND X.DEPTCODE = B.DEPTCODE(+)
                       AND 'SL90'     = C.CMMCODE (+)
                       AND X.PARTDIV  = C.DIVCODE (+)
                  GROUP BY X.PARTDIV

    	]]>
		<!--
		<![CDATA[
						  SELECT MAX (rpt_gb) AS rpt_gb, part_cd, MAX (date_time) AS datef,
						         MAX (date_time) AS datet, SUM (siljukyul_in) AS siljukyul_in,
						         SUM (siljukyul_out) AS siljukyul_out,
						         SUM (siljukyul_in_su) AS siljukyul_in_su,
						         SUM (siljukyul_out_su) AS siljukyul_out_su,
						         SUM (siljukyul_byung) AS siljukyul_byung,
						         SUM (siljukyul_byung_su) AS siljukyul_byung_su,
						         MAX (rorder) AS rorder, '' AS col1,
						         (SELECT NVL (code2_nm, '미지정') FROM sale.sale0001 WHERE code_gb = '0013' AND part_cd = code1) AS col2, '' AS col3,
						         (SELECT NVL (code1_nm, '미지정') FROM sale.sale0001 WHERE code_gb = '0013' AND part_cd = code1) AS col4,
						         SUM (sale_amt) AS sale_amt,
						         SUM (sale_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in,
						         SUM (sale_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_local,
						         SUM (sale_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_01,
						         SUM (sale_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_02,
						         SUM (sale_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_03,
						         SUM (sale_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_04,
						         SUM (sale_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_05,
						         SUM (sale_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_out,
						         SUM (sale_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_byung,
						         SUM (sale_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_mbyung,
						         SUM (sale_amt_banpum) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_banpum,
						         SUM (sale_amt_halin) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halin,
						         SUM (sale_amt_halins01) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halins01,
						         SUM (sale_amt_halins02) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halins02,
						         (SUM (sale_amt_siljuk) + SUM (sale_amt_halins02)) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk,
						         ROUND(AVG (sale_percent), 2) AS sale_percent,
						         SUM (in_amt) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt,
						         SUM (in_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in,
						         SUM (in_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_local,
						         SUM (in_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_01,
						         SUM (in_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_02,
						         SUM (in_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_03,
						         SUM (in_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_04,
						         SUM (in_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_05,
						         SUM (in_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_out_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_out,
						         SUM (in_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_byung,
						         SUM (in_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_mbyung,
						         SUM (in_amt_siljuk) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk,
						         ROUND(AVG (in_percent), 2) AS in_percent,
						         TO_DATE (MAX (proc_date), 'YYYYMMDDHH24MISS') AS proc_date,
						         #{as_siljukyul_in,jdbcType=VARCHAR} AS as_siljukyul_in,
						         #{as_siljukyul_out,jdbcType=VARCHAR} AS as_siljukyul_out,
						         #{as_siljukyul_in_su,jdbcType=VARCHAR} AS as_siljukyul_in_su,
						         #{as_siljukyul_out_su,jdbcType=VARCHAR} AS as_siljukyul_out_su,
						         #{as_siljukyul_byung,jdbcType=VARCHAR} AS as_siljukyul_byung,
						         #{as_siljukyul_byung_su,jdbcType=VARCHAR} AS as_siljukyul_byung_su
						    FROM sale.salepart_batch2
						   WHERE SUBSTR (date_time, 1, 6) = #{as_date_time,jdbcType=VARCHAR}
						     AND part_cd LIKE NVL (#{as_part_cd,jdbcType=VARCHAR}, '%')
						     AND team_cd LIKE NVL (#{as_team_cd,jdbcType=VARCHAR}, '%')
						     AND emp_no LIKE NVL (#{as_emp_no,jdbcType=VARCHAR}, '%')
						     AND part_cd NOT IN ('08', '09', '10', '11', '12', '13')
						GROUP BY part_cd
		]]>
		-->
		 
					<if test="sidx != ''">
						ORDER BY ${sidx} ${sord}
					</if>
		
				<if test="page != null">
					) T0
				)
				WHERE PAGE = #{page,jdbcType=INTEGER}
				</if>
	</select>
	
	<select id="getPerformanceForPartGridTotalCount" parameterType="hashmap" resultType="com.hanaph.saleon.business.vo.PerformanceVO">
		/*파트별 카운트*/
		<![CDATA[
		SELECT COUNT(DISTINCT(PARTDIV)) total_cnt, 
		       SUM (sale_amt) AS total_sale_amt,
			   SUM (sale_amt_siljuk_in) AS total_sale_amt_siljuk_in,
			   SUM (sale_amt_siljuk_in_local) AS total_sale_amt_siljuk_in_local,
			   SUM (sale_amt_siljuk_in_01) AS total_sale_amt_siljuk_in_01,
			   SUM (sale_amt_siljuk_in_02) AS total_sale_amt_siljuk_in_02,
			   SUM (sale_amt_siljuk_in_03) AS total_sale_amt_siljuk_in_03,
			   SUM (sale_amt_siljuk_in_04) AS total_sale_amt_siljuk_in_04,
			   SUM (sale_amt_siljuk_in_05) AS total_sale_amt_siljuk_in_05,
			   SUM (sale_amt_siljuk_out) AS total_sale_amt_siljuk_out,
			   SUM (sale_amt_siljuk_byung) AS total_sale_amt_siljuk_byung,
			   SUM (sale_amt_siljuk_mbyung) AS total_sale_amt_siljuk_mbyung,
			   SUM (sale_amt_banpum) AS total_sale_amt_banpum,
			   SUM (sale_amt_halin) AS total_sale_amt_halin,
			   SUM (sale_amt_halins01) AS total_sale_amt_halins01,
			   SUM (sale_amt_halins02) AS total_sale_amt_halins02,
			   SUM (sale_amt_siljuk) AS total_sale_amt_siljuk,
			   ROUND(AVG (sale_percent), 2) AS total_sale_percent,
			   SUM (in_amt) AS total_in_amt,
	           SUM (in_amt_siljuk_in) AS total_in_amt_siljuk_in,
	           SUM (in_amt_siljuk_in_local) AS total_in_amt_siljuk_in_local,
	           SUM (in_amt_siljuk_in_01) AS total_in_amt_siljuk_in_01,
	           SUM (in_amt_siljuk_in_02) AS total_in_amt_siljuk_in_02,
	           SUM (in_amt_siljuk_in_03) AS total_in_amt_siljuk_in_03,
	           SUM (in_amt_siljuk_in_04) AS total_in_amt_siljuk_in_04,
	           SUM (in_amt_siljuk_in_05) AS total_in_amt_siljuk_in_05,
	           SUM (in_amt_siljuk_out) AS total_in_amt_siljuk_out,
	           SUM (in_amt_siljuk_byung) AS total_in_amt_siljuk_byung,
	           SUM (in_amt_siljuk_mbyung) AS total_in_amt_siljuk_mbyung,
	           SUM (in_amt_siljuk) AS total_in_amt_siljuk,
	           ROUND(AVG (in_percent), 2) AS total_in_percent
		FROM (
                     SELECT X.PARTDIV                                AS PARTDIV                    ,  --직능코드
                            MAX(C.DIVNAME)                                AS PARTDIVNAME                ,  --직능명(파트명)
                            SUM(X.SALE_AMT)                          AS SALE_AMT                   ,  --판매목표
                            SUM(X.SALE_AMT_SILJUK_BYUNG)             AS SALE_AMT_SILJUK_BYUNG      ,  --판매종합병원
                            SUM(X.SALE_AMT_SILJUK_MBYUNG)            AS SALE_AMT_SILJUK_MBYUNG     ,  --판매준종합병원
                            SUM(X.SALE_AMT_SILJUK_IN)                AS SALE_AMT_SILJUK_IN         ,  --
                            SUM(X.SALE_AMT_SILJUK_IN_LOCAL)          AS SALE_AMT_SILJUK_IN_LOCAL   ,  --판매도매로컬
                            SUM(X.SALE_AMT_SILJUK_IN_01)             AS SALE_AMT_SILJUK_IN_01      ,  --판매의원
                            SUM(X.SALE_AMT_SILJUK_IN_02)             AS SALE_AMT_SILJUK_IN_02      ,  --판매일반간납
                            SUM(X.SALE_AMT_SILJUK_IN_03)             AS SALE_AMT_SILJUK_IN_03      ,  --판매턴키
                            SUM(X.SALE_AMT_SILJUK_IN_04)             AS SALE_AMT_SILJUK_IN_04      ,  --판매입찰
                            SUM(X.SALE_AMT_SILJUK_IN_05)             AS SALE_AMT_SILJUK_IN_05      ,  --판매기타
                            SUM(X.SALE_AMT_SILJUK_OUT)               AS SALE_AMT_SILJUK_OUT        ,  --판매약국
                            SUM(X.SALE_AMT_BANPUM)                   AS SALE_AMT_BANPUM            ,  --판매반품
                            SUM(X.SALE_AMT_HALIN)                    AS SALE_AMT_HALIN             ,  --판매매출할인
                            SUM(X.SALE_AMT_HALINS01)                 AS SALE_AMT_HALINS01          ,  --판매수금할인(일반)
                            SUM(X.SALE_AMT_HALINS02)                 AS SALE_AMT_HALINS02          ,  --판매수금할인(조건)
                            SUM(X.SALE_AMT_SILJUK_IN)     + SUM(X.SALE_AMT_SILJUK_OUT) + SUM(X.SALE_AMT_SILJUK_BYUNG) +
                            SUM(X.SALE_AMT_SILJUK_MBYUNG) + SUM(X.SALE_AMT_BANPUM)     + (SUM(X.SALE_AMT_HALIN)       +
                            SUM(X.SALE_AMT_HALINS01)) + NVL(SUM(X.SALE_AMT_HALINS02),0)  AS SALE_AMT_SILJUK             ,  --판매계(수금할인조건제외)
                            DECODE(SUM(NVL(X.SALE_AMT,0)),0, 0,
                            ROUND((SUM(X.SALE_AMT_SILJUK_IN)    + SUM(X.SALE_AMT_SILJUK_OUT)    +
                                   SUM(X.SALE_AMT_SILJUK_BYUNG) + SUM(X.SALE_AMT_SILJUK_MBYUNG) +
                                   SUM(X.SALE_AMT_BANPUM)       + SUM(X.SALE_AMT_HALIN)         +
                                   SUM(X.SALE_AMT_HALINS01))    / SUM(X.SALE_AMT) * 100,2))
                                                                     AS SALE_PERCENT               ,  --
                            SUM(X.IN_AMT)                            AS IN_AMT                     ,  --수금목표
                            SUM(X.IN_AMT_SILJUK_BYUNG)               AS IN_AMT_SILJUK_BYUNG        ,  --수금종합병원
                            SUM(X.IN_AMT_SILJUK_MBYUNG)              AS IN_AMT_SILJUK_MBYUNG       ,  --수금준종합병원
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK_IN           ,  --
                            SUM(X.IN_AMT_SILJUK_IN_LOCAL)            AS IN_AMT_SILJUK_IN_LOCAL     ,  --수금도매
                            SUM(X.IN_AMT_SILJUK_IN_01)               AS IN_AMT_SILJUK_IN_01        ,  --수금의원
                            SUM(X.IN_AMT_SILJUK_IN_02)               AS IN_AMT_SILJUK_IN_02        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_03)               AS IN_AMT_SILJUK_IN_03        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_04)               AS IN_AMT_SILJUK_IN_04        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_05)               AS IN_AMT_SILJUK_IN_05        ,  --수금기타
                            SUM(X.IN_AMT_SILJUK_OUT)                 AS IN_AMT_SILJUK_OUT          ,  --수금약국
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK              ,  --수금계                              
                            DECODE(SUM(NVL(X.IN_AMT,0)), 0, 0,
                            ROUND((SUM(X.IN_AMT_SILJUK_IN)    ) / SUM(X.IN_AMT) * 100,2))
                                                                     AS IN_PERCENT                    --수금달성률
                       FROM
                         ( SELECT NVL(A.PARTDIV, '99')               AS PARTDIV                 ,
                                  A.DEPTCODE                         AS DEPTCODE                ,
                                  A.EMPCODE                          AS EMPCODE                 ,
                                  SUM(A.SALE_AMT)                    AS SALE_AMT                ,
                                  SUM(A.SALE_AMT_SILJUK_BYUNG)       AS SALE_AMT_SILJUK_BYUNG   ,
                                  SUM(A.SALE_AMT_SILJUK_MBYUNG)      AS SALE_AMT_SILJUK_MBYUNG  ,
                                  SUM(A.SALE_AMT_SILJUK_IN)          AS SALE_AMT_SILJUK_IN      ,
                                  SUM(A.SALE_AMT_SILJUK_IN_LOCAL)    AS SALE_AMT_SILJUK_IN_LOCAL,
                                  SUM(A.SALE_AMT_SILJUK_IN_01)       AS SALE_AMT_SILJUK_IN_01   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_02)       AS SALE_AMT_SILJUK_IN_02   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_03)       AS SALE_AMT_SILJUK_IN_03   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_04)       AS SALE_AMT_SILJUK_IN_04   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_05)       AS SALE_AMT_SILJUK_IN_05   ,
                                  SUM(A.SALE_AMT_SILJUK_OUT)         AS SALE_AMT_SILJUK_OUT     ,
                                  SUM(A.SALE_AMT_BANPUM)             AS SALE_AMT_BANPUM         ,
                                  SUM(A.SALE_AMT_HALIN)              AS SALE_AMT_HALIN          ,
                                  SUM(A.SALE_AMT_HALINS01)           AS SALE_AMT_HALINS01       ,
                                  SUM(A.SALE_AMT_HALINS02)           AS SALE_AMT_HALINS02       ,
                                  SUM(A.IN_AMT)                      AS IN_AMT                  ,
                                  SUM(A.IN_AMT_SILJUK_IN)            AS IN_AMT_SILJUK_IN        ,
                                  SUM(A.IN_AMT_SILJUK_IN_LOCAL)      AS IN_AMT_SILJUK_IN_LOCAL  ,
                                  SUM(A.IN_AMT_SILJUK_IN_01)         AS IN_AMT_SILJUK_IN_01     ,
                                  SUM(A.IN_AMT_SILJUK_IN_02)         AS IN_AMT_SILJUK_IN_02     ,
                                  SUM(A.IN_AMT_SILJUK_IN_03)         AS IN_AMT_SILJUK_IN_03     ,
                                  SUM(A.IN_AMT_SILJUK_IN_04)         AS IN_AMT_SILJUK_IN_04     ,
                                  SUM(A.IN_AMT_SILJUK_IN_05)         AS IN_AMT_SILJUK_IN_05     ,
                                  SUM(A.IN_AMT_SILJUK_OUT)           AS IN_AMT_SILJUK_OUT       ,
                                  SUM(A.IN_AMT_SILJUK_BYUNG)         AS IN_AMT_SILJUK_BYUNG     ,
                                  SUM(A.IN_AMT_SILJUK_MBYUNG)        AS IN_AMT_SILJUK_MBYUNG
                             FROM
                                ( --목표
                                  SELECT A.UTDIV                                                   AS PARTDIV                 ,
                                         A.DEPTCODE                                                AS DEPTCODE                ,
                                         A.EMPCODE                                                 AS EMPCODE                 ,
                                         SUM(CASE WHEN A.SALDIV = 'A' THEN A.TARGETAMT ELSE 0 END) AS SALE_AMT                ,  --판매목표
                                         0                                                         AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                         AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                         AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                         AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                         AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                         AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                         AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                         AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                         AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                         AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                         AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                         AS SALE_AMT_HALIN          ,  --매출:매출할인외
                                         0                                                         AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         SUM(CASE WHEN A.SALDIV = 'C' THEN A.TARGETAMT ELSE 0 END) AS IN_AMT                  ,  --수금목표
                                         0                                                         AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                         AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                         AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                         AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                         AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                         AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                         AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                         AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                         AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                         AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLTARGETSALEM A
                                   WHERE A.YEARMONTH BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.UTDIV   ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.DEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY A.UTDIV, A.DEPTCODE, A.EMPCODE
                               UNION ALL
                                  --판매
                                  SELECT B.ITPARTDIV                                                                                                                    AS PARTDIV                 ,
                                         B.ITDEPTCODE                                                                                                                   AS DEPTCODE                ,  --부서코드
                                         B.EMPCODE                                                                                                                      AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '60'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '80'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV IN ('05','10','70','90','99')            THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '05'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) = '4' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) > '6' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '70'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '90'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '99'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '20'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         SUM(CASE WHEN A.SALDIV IN ('B01','B10')                                                             THEN -B.SALAMT1 ELSE 0 END) AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                                                                                              AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         0                                                                                                                              AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                                                                                              AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                                                                                              AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                                                                                              AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                                                                                              AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLORDM A,
                                         ORAGMP.SLORDD B
                                   WHERE A.STATEDIV = '09'
                                     AND A.ORDERNO  = B.ORDERNO
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(B.ITPARTDIV ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(B.ITDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(B.EMPCODE   ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY B.ITPARTDIV, B.ITDEPTCODE, B.EMPCODE
                               UNION ALL
                                  --수금
                                  SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                         A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                         A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                         SUM(CASE WHEN A.COLDIV = '52' AND A.SALEAPPLY = 'Y' THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                   AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) NOT IN ('3','4')  THEN -(A.COLAMT - A.COLVAT) ELSE 0 END) AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) IN ('3','4')       THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLCOLM A
                                   WHERE A.STATEDIV = '09'
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                     AND A.COLDIV <> '55'   --잔고이월 제외 
                                     AND A.COLDIV NOT LIKE '3%'
                                GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                
                                UNION ALL

                                SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                       A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                       A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                       0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                       0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                       0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                       0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                       0                                                                  AS SALE_AMT_HALIN          ,  --매출:매출할인
                                       0                                                                  AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                       0                                                                  AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                       0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('40', '45') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '10' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '99' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '20' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                               ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '60' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '80' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                  FROM ORAGMP.SLCOLM A
                                 WHERE A.STATEDIV = '09'
                                   AND SUBSTR(A.APPDATE,1,7) BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#{as_date_fr,jdbcType=VARCHAR} || '-01','YYYY-MM-DD'), -24), 'YYYY-MM') AND #{as_date_to,jdbcType=VARCHAR}
                                   AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                   AND A.COLDIV <> '55'   --잔고이월 제외 
                                   AND A.COLDIV LIKE '3%'
                              GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                ) A
                         GROUP BY A.PARTDIV, A.DEPTCODE, A.EMPCODE
                         ) X,
                           ORAGMP.CMEMPM    A,
                           ORAGMP.CMDEPTM   B,
                           ORAGMP.CMCOMMONM C
                     WHERE X.EMPCODE  = A.EMPCODE (+)
                       AND X.DEPTCODE = B.DEPTCODE(+)
                       AND 'SL90'     = C.CMMCODE (+)
                       AND X.PARTDIV  = C.DIVCODE (+)
                  GROUP BY X.PARTDIV
				)
	]]>
	
	
	
	
	
	
	<!-- 
		SELECT COUNT(DISTINCT(part_cd)) total_cnt, SUM (sale_amt) AS total_sale_amt,
			   SUM (sale_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in,
			   SUM (sale_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_local,
			   SUM (sale_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_01,
			   SUM (sale_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_02,
			   SUM (sale_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_03,
			   SUM (sale_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_04,
			   SUM (sale_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_05,
			   SUM (sale_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_out,
			   SUM (sale_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_byung,
			   SUM (sale_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_mbyung,
			   SUM (sale_amt_banpum) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_banpum,
			   SUM (sale_amt_halin) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_halin,
			   SUM (sale_amt_halins01) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_halins01,
			   SUM (sale_amt_halins02) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_halins02,
			   (SUM (sale_amt_siljuk) + SUM (sale_amt_halins02)) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk,
			   ROUND(AVG (sale_percent), 2) AS total_sale_percent,
			   SUM (in_amt) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt,
	           SUM (in_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in,
	           SUM (in_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_local,
	           SUM (in_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_01,
	           SUM (in_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_02,
	           SUM (in_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_03,
	           SUM (in_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_04,
	           SUM (in_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_05,
	           SUM (in_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_out_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_out,
	           SUM (in_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_byung,
	           SUM (in_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_mbyung,
	           SUM (in_amt_siljuk) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk,
	           ROUND(AVG (in_percent), 2) AS total_in_percent
		  FROM sale.salepart_batch2
		 WHERE SUBSTR (date_time, 1, 6) = #{as_date_time,jdbcType=VARCHAR}
		   AND part_cd LIKE NVL (#{as_part_cd,jdbcType=VARCHAR}, '%')
		   AND team_cd LIKE NVL (#{as_team_cd,jdbcType=VARCHAR}, '%')
		   AND emp_no LIKE NVL (#{as_emp_no,jdbcType=VARCHAR}, '%')
		   AND part_cd NOT IN ('08', '09', '10', '11', '12', '13')
		-->
	</select>
	
	<select id="getPerformanceForTeamGridList" parameterType="hashmap" resultType="com.hanaph.saleon.business.vo.PerformanceVO">
		/*부서별 조회*/
		<if test="page != null">
			SELECT *
				FROM (SELECT T0.*, FLOOR((ROWNUM - 1) / #{perPageRow,jdbcType=INTEGER} + 1) PAGE
	        		FROM (
    	</if>
		<![CDATA[
                     SELECT X.PARTDIV                                AS PARTDIV                    ,  --직능코드
		                    (SELECT T.SEQ
		                       FROM ORAGMP.CMDEPTM T
		                      WHERE T.DEPTCODE = X.DEPTCODE )        AS RORDER                     ,
                            C.DIVNAME                                AS COL2       			       ,  --직능명(파트명)
                            X.DEPTCODE                               AS DEPTCODE                   ,  --부서코드
                            B.DEPTNAME                               AS COL4                       ,  --부서명(지점/팀명)
                            SUM(X.SALE_AMT)                          AS SALE_AMT                   ,  --판매목표
                            SUM(X.SALE_AMT_SILJUK_BYUNG)             AS SALE_AMT_SILJUK_BYUNG      ,  --판매종합병원
                            SUM(X.SALE_AMT_SILJUK_MBYUNG)            AS SALE_AMT_SILJUK_MBYUNG     ,  --판매준종합병원
                            SUM(X.SALE_AMT_SILJUK_IN)                AS SALE_AMT_SILJUK_IN         ,  --
                            SUM(X.SALE_AMT_SILJUK_IN_LOCAL)          AS SALE_AMT_SILJUK_IN_LOCAL   ,  --판매도매로컬
                            SUM(X.SALE_AMT_SILJUK_IN_01)             AS SALE_AMT_SILJUK_IN_01      ,  --판매의원
                            SUM(X.SALE_AMT_SILJUK_IN_02)             AS SALE_AMT_SILJUK_IN_02      ,  --판매일반간납
                            SUM(X.SALE_AMT_SILJUK_IN_03)             AS SALE_AMT_SILJUK_IN_03      ,  --판매턴키
                            SUM(X.SALE_AMT_SILJUK_IN_04)             AS SALE_AMT_SILJUK_IN_04      ,  --판매입찰
                            SUM(X.SALE_AMT_SILJUK_IN_05)             AS SALE_AMT_SILJUK_IN_05      ,  --판매기타
                            SUM(X.SALE_AMT_SILJUK_OUT)               AS SALE_AMT_SILJUK_OUT        ,  --판매약국
                            SUM(X.SALE_AMT_BANPUM)                   AS SALE_AMT_BANPUM            ,  --판매반품
                            SUM(X.SALE_AMT_HALIN)                    AS SALE_AMT_HALIN             ,  --판매매출할인
                            SUM(X.SALE_AMT_HALINS01)                 AS SALE_AMT_HALINS01          ,  --판매수금할인(일반)
                            SUM(X.SALE_AMT_HALINS02)                 AS SALE_AMT_HALINS02          ,  --판매수금할인(조건)
                            SUM(X.SALE_AMT_SILJUK_IN)     + SUM(X.SALE_AMT_SILJUK_OUT) + SUM(X.SALE_AMT_SILJUK_BYUNG) +
                            SUM(X.SALE_AMT_SILJUK_MBYUNG) + SUM(X.SALE_AMT_BANPUM)     + (SUM(X.SALE_AMT_HALIN)       +
                            SUM(X.SALE_AMT_HALINS01)) + NVL(SUM(X.SALE_AMT_HALINS02),0)  AS SALE_AMT_SILJUK            ,  --판매계(수금할인조건제외)
                            DECODE(SUM(NVL(X.SALE_AMT,0)),0, 0,
                            ROUND((SUM(X.SALE_AMT_SILJUK_IN)    + SUM(X.SALE_AMT_SILJUK_OUT)    +
                                   SUM(X.SALE_AMT_SILJUK_BYUNG) + SUM(X.SALE_AMT_SILJUK_MBYUNG) +
                                   SUM(X.SALE_AMT_BANPUM)       + SUM(X.SALE_AMT_HALIN)         +
                                   SUM(X.SALE_AMT_HALINS01))    / SUM(X.SALE_AMT) * 100,2))
                                                                     AS SALE_PERCENT               ,  --
                            SUM(X.IN_AMT)                            AS IN_AMT                     ,  --수금목표
                            SUM(X.IN_AMT_SILJUK_BYUNG)               AS IN_AMT_SILJUK_BYUNG        ,  --수금종합병원
                            SUM(X.IN_AMT_SILJUK_MBYUNG)              AS IN_AMT_SILJUK_MBYUNG       ,  --수금준종합병원
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK_IN           ,  --
                            SUM(X.IN_AMT_SILJUK_IN_LOCAL)            AS IN_AMT_SILJUK_IN_LOCAL     ,  --수금도매
                            SUM(X.IN_AMT_SILJUK_IN_01)               AS IN_AMT_SILJUK_IN_01        ,  --수금의원
                            SUM(X.IN_AMT_SILJUK_IN_02)               AS IN_AMT_SILJUK_IN_02        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_03)               AS IN_AMT_SILJUK_IN_03        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_04)               AS IN_AMT_SILJUK_IN_04        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_05)               AS IN_AMT_SILJUK_IN_05        ,  --수금기타
                            SUM(X.IN_AMT_SILJUK_OUT)                 AS IN_AMT_SILJUK_OUT          ,  --수금약국
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK              ,  --수금계
                            DECODE(SUM(NVL(X.IN_AMT,0)), 0, 0,
                            ROUND((SUM(X.IN_AMT_SILJUK_IN)    ) / SUM(X.IN_AMT) * 100,2))
                                                                     AS IN_PERCENT                    --수금달성률
                       FROM
                         ( SELECT A.PARTDIV                          AS PARTDIV                 ,
                                  A.DEPTCODE                         AS DEPTCODE                ,
                                  A.EMPCODE                          AS EMPCODE                 ,
                                  SUM(A.SALE_AMT)                    AS SALE_AMT                ,
                                  SUM(A.SALE_AMT_SILJUK_BYUNG)       AS SALE_AMT_SILJUK_BYUNG   ,
                                  SUM(A.SALE_AMT_SILJUK_MBYUNG)      AS SALE_AMT_SILJUK_MBYUNG  ,
                                  SUM(A.SALE_AMT_SILJUK_IN)          AS SALE_AMT_SILJUK_IN      ,
                                  SUM(A.SALE_AMT_SILJUK_IN_LOCAL)    AS SALE_AMT_SILJUK_IN_LOCAL,
                                  SUM(A.SALE_AMT_SILJUK_IN_01)       AS SALE_AMT_SILJUK_IN_01   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_02)       AS SALE_AMT_SILJUK_IN_02   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_03)       AS SALE_AMT_SILJUK_IN_03   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_04)       AS SALE_AMT_SILJUK_IN_04   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_05)       AS SALE_AMT_SILJUK_IN_05   ,
                                  SUM(A.SALE_AMT_SILJUK_OUT)         AS SALE_AMT_SILJUK_OUT     ,
                                  SUM(A.SALE_AMT_BANPUM)             AS SALE_AMT_BANPUM         ,
                                  SUM(A.SALE_AMT_HALIN)              AS SALE_AMT_HALIN          ,
                                  SUM(A.SALE_AMT_HALINS01)           AS SALE_AMT_HALINS01       ,
                                  SUM(A.SALE_AMT_HALINS02)           AS SALE_AMT_HALINS02       ,
                                  SUM(A.IN_AMT)                      AS IN_AMT                  ,
                                  SUM(A.IN_AMT_SILJUK_IN)            AS IN_AMT_SILJUK_IN        ,
                                  SUM(A.IN_AMT_SILJUK_IN_LOCAL)      AS IN_AMT_SILJUK_IN_LOCAL  ,
                                  SUM(A.IN_AMT_SILJUK_IN_01)         AS IN_AMT_SILJUK_IN_01     ,
                                  SUM(A.IN_AMT_SILJUK_IN_02)         AS IN_AMT_SILJUK_IN_02     ,
                                  SUM(A.IN_AMT_SILJUK_IN_03)         AS IN_AMT_SILJUK_IN_03     ,
                                  SUM(A.IN_AMT_SILJUK_IN_04)         AS IN_AMT_SILJUK_IN_04     ,
                                  SUM(A.IN_AMT_SILJUK_IN_05)         AS IN_AMT_SILJUK_IN_05     ,
                                  SUM(A.IN_AMT_SILJUK_OUT)           AS IN_AMT_SILJUK_OUT       ,
                                  SUM(A.IN_AMT_SILJUK_BYUNG)         AS IN_AMT_SILJUK_BYUNG     ,
                                  SUM(A.IN_AMT_SILJUK_MBYUNG)        AS IN_AMT_SILJUK_MBYUNG
                             FROM
                                ( --목표
                                  SELECT A.UTDIV                                                   AS PARTDIV                 ,
                                         A.DEPTCODE                                                AS DEPTCODE                ,
                                         A.EMPCODE                                                 AS EMPCODE                 ,
                                         SUM(CASE WHEN A.SALDIV = 'A' THEN A.TARGETAMT ELSE 0 END) AS SALE_AMT                ,  --판매목표
                                         0                                                         AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                         AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                         AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                         AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                         AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                         AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                         AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                         AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                         AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                         AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                         AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                         AS SALE_AMT_HALIN          ,  --매출:매출할인외
                                         0                                                         AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         SUM(CASE WHEN A.SALDIV = 'C' THEN A.TARGETAMT ELSE 0 END) AS IN_AMT                  ,  --수금목표
                                         0                                                         AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                         AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                         AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                         AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                         AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                         AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                         AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                         AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                         AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                         AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLTARGETSALEM A
                                   WHERE A.YEARMONTH BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.UTDIV   ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.DEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY A.UTDIV, A.DEPTCODE, A.EMPCODE
                               UNION ALL
                                  --판매
                                  SELECT B.ITPARTDIV                                                                                                                    AS PARTDIV                 ,
                                         B.ITDEPTCODE                                                                                                                   AS DEPTCODE                ,  --부서코드
                                         B.EMPCODE                                                                                                                      AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '60'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '80'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV IN ('05','10','70','90','99')            THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '05'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) = '4' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) > '6' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '70'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '90'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '99'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '20'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         SUM(CASE WHEN A.SALDIV IN ('B01','B10')                                                             THEN -B.SALAMT1 ELSE 0 END) AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                                                                                              AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         0                                                                                                                              AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                                                                                              AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                                                                                              AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                                                                                              AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                                                                                              AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLORDM A,
                                         ORAGMP.SLORDD B
                                   WHERE A.STATEDIV = '09'
                                     AND A.ORDERNO  = B.ORDERNO
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(B.ITPARTDIV ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(B.ITDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(B.EMPCODE   ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY B.ITPARTDIV, B.ITDEPTCODE, B.EMPCODE
                               UNION ALL
                                  --수금
                                  SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                         A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                         A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                         SUM(CASE WHEN A.COLDIV = '52' AND A.SALEAPPLY = 'Y' THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                   AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) NOT IN ('3','4')  THEN -(A.COLAMT - A.COLVAT) ELSE 0 END) AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) IN ('3','4')       THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLCOLM A
                                   WHERE A.STATEDIV = '09'
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                     AND A.COLDIV <> '55'   --잔고이월 제외 
                                     AND A.COLDIV NOT LIKE '3%'
                                GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                
                                UNION ALL

                                SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                       A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                       A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                       0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                       0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                       0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                       0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                       0                                                                  AS SALE_AMT_HALIN          ,  --매출:매출할인
                                       0                                                                  AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                       0                                                                  AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                       0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('40', '45') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '10' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '99' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '20' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                               ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '60' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '80' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                  FROM ORAGMP.SLCOLM A
                                 WHERE A.STATEDIV = '09'
                                   AND SUBSTR(A.APPDATE,1,7) BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#{as_date_fr,jdbcType=VARCHAR} || '-01','YYYY-MM-DD'), -24), 'YYYY-MM') AND #{as_date_to,jdbcType=VARCHAR}
                                   AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                   AND A.COLDIV <> '55'   --잔고이월 제외 
                                   AND A.COLDIV LIKE '3%'
                              GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                ) A
                         GROUP BY A.PARTDIV, A.DEPTCODE, A.EMPCODE
                         ) X,
                           ORAGMP.CMEMPM    A,
                           ORAGMP.CMDEPTM   B,
                           ORAGMP.CMCOMMONM C
                     WHERE X.EMPCODE  = A.EMPCODE (+)
                       AND X.DEPTCODE = B.DEPTCODE(+)
                       AND 'SL90'     = C.CMMCODE (+)
                       AND X.PARTDIV  = C.DIVCODE (+)
                  GROUP BY X.PARTDIV, C.DIVNAME, X.DEPTCODE, B.DEPTNAME
			         ]]>
					<!--
							SELECT team_cd, MAX (rpt_gb) AS rpt_gb, MAX (date_time) AS datef,
						         MAX (date_time) AS datet, SUM (siljukyul_in) AS siljukyul_in,
						         SUM (siljukyul_out) AS siljukyul_out,
						         SUM (siljukyul_in_su) AS siljukyul_in_su,
						         SUM (siljukyul_out_su) AS siljukyul_out_su,
						         SUM (siljukyul_byung) AS siljukyul_byung,
						         SUM (siljukyul_byung_su) AS siljukyul_byung_su,
						         MAX (rorder) AS rorder, '' AS col1, MAX (part_nm) AS col2,
						         team_cd AS col3, MAX (team_nm) AS col4, SUM (sale_amt) AS sale_amt,
						         SUM (sale_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in,
						         SUM (sale_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_local,
						         SUM (sale_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_01,
						         SUM (sale_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_02,
						         SUM (sale_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_03,
						         SUM (sale_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_04,
						         SUM (sale_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_05,
						         SUM (sale_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_out,
						         SUM (sale_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_byung,
						         SUM (sale_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_mbyung,
						         SUM (sale_amt_banpum) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_banpum,
						         SUM (sale_amt_halin) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halin,
						         SUM (sale_amt_halins01) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halins01,
						         SUM (sale_amt_halins02) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halins02,
						         (SUM (sale_amt_siljuk) + SUM (sale_amt_halins02)) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk,
						         ROUND(AVG (sale_percent), 2) AS sale_percent, SUM (in_amt) AS in_amt,
						         SUM (in_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in,
						         SUM (in_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_local,
						         SUM (in_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_01,
						         SUM (in_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_02,
						         SUM (in_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_03,
						         SUM (in_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_04,
						         SUM (in_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_05,
						         SUM (in_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_out_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_out,
						         SUM (in_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_byung,
						         SUM (in_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_mbyung,
						         SUM (in_amt_siljuk) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk,
						         ROUND(AVG (in_percent), 2) AS in_percent,
						         TO_DATE (MAX (proc_date), 'YYYYMMDDHH24MISS') AS proc_date,
						         #{as_siljukyul_in,jdbcType=VARCHAR} AS as_siljukyul_in,
						         #{as_siljukyul_out,jdbcType=VARCHAR} AS as_siljukyul_out,
						         #{as_siljukyul_in_su,jdbcType=VARCHAR} AS as_siljukyul_in_su,
						         #{as_siljukyul_out_su,jdbcType=VARCHAR} AS as_siljukyul_out_su,
						         #{as_siljukyul_byung,jdbcType=VARCHAR} AS as_siljukyul_byung,
						         #{as_siljukyul_byung_su,jdbcType=VARCHAR} AS as_siljukyul_byung_su
						    FROM sale.salepart_batch2
						   WHERE SUBSTR (date_time, 1, 6) = #{as_date_time,jdbcType=VARCHAR}
						     AND part_cd LIKE NVL (#{as_part_cd,jdbcType=VARCHAR}, '%')
						     AND team_cd LIKE NVL (#{as_team_cd,jdbcType=VARCHAR}, '%')
						     AND emp_no LIKE NVL (#{as_emp_no,jdbcType=VARCHAR}, '%')
						     AND emp_nm NOT LIKE '%도매%'
						     AND emp_nm NOT LIKE '%기타%'
						     AND emp_nm NOT LIKE '%미지정%'
						     AND emp_nm NOT LIKE '%채권관리부%'
						     AND rpt_gb NOT IN ('08', '09', '10', '11', '12', '13', 'ZZ')
						GROUP BY team_cd
					-->
		 
					<if test="sidx != ''">
						ORDER BY ${sidx} ${sord}
					</if>
		
				<if test="page != null">
					) T0
				)
				WHERE PAGE = #{page,jdbcType=INTEGER}
				</if>
	</select>
		
	<select id="getPerformanceForTeamGridTotalCount" parameterType="hashmap" resultType="com.hanaph.saleon.business.vo.PerformanceVO">
	/*부서별 카운트*/	
	<![CDATA[
		SELECT COUNT(DISTINCT(PARTDIV)) total_cnt,
			 SUM (sale_amt) AS total_sale_amt,
	         SUM (sale_amt_siljuk_in_local) AS total_sale_amt_siljuk_in_local,
	         SUM (sale_amt_siljuk_in_01) AS total_sale_amt_siljuk_in_01,
	         SUM (sale_amt_siljuk_in_02) AS total_sale_amt_siljuk_in_02,
	         SUM (sale_amt_siljuk_in_03) AS total_sale_amt_siljuk_in_03,
	         SUM (sale_amt_siljuk_in_04) AS total_sale_amt_siljuk_in_04,
	         SUM (sale_amt_siljuk_in_05) AS total_sale_amt_siljuk_in_05,
	         SUM (sale_amt_siljuk_out) AS total_sale_amt_siljuk_out,
	         SUM (sale_amt_siljuk_byung) AS total_sale_amt_siljuk_byung,
	         SUM (sale_amt_siljuk_mbyung) AS total_sale_amt_siljuk_mbyung,
	         SUM (sale_amt_siljuk) AS total_sale_amt_siljuk,
	         SUM (in_amt) AS total_in_amt,
	         SUM (sale_amt_banpum) AS total_sale_amt_banpum,
	         SUM (in_amt_siljuk_in_local) AS total_in_amt_siljuk_in_local,
	         SUM (in_amt_siljuk_in_01) AS total_in_amt_siljuk_in_01,
	         SUM (in_amt_siljuk_in_05) AS total_in_amt_siljuk_in_05,
	         SUM (in_amt_siljuk_out) AS total_in_amt_siljuk_out,
	         SUM (in_amt_siljuk_byung) AS total_in_amt_siljuk_byung,
	         SUM (in_amt_siljuk_mbyung) AS total_in_amt_siljuk_mbyung,
	         SUM (in_amt_siljuk) AS total_in_amt_siljuk
		  FROM(
                     SELECT X.PARTDIV                                AS PARTDIV                    ,  --직능코드
                            C.DIVNAME                                AS PARTDIVNAME                ,  --직능명(파트명)
                            X.DEPTCODE                               AS DEPTCODE                   ,  --부서코드
                            B.DEPTNAME                               AS DEPTNAME                   ,  --부서명(지점/팀명)
                            SUM(X.SALE_AMT)                          AS SALE_AMT                   ,  --판매목표
                            SUM(X.SALE_AMT_SILJUK_BYUNG)             AS SALE_AMT_SILJUK_BYUNG      ,  --판매종합병원
                            SUM(X.SALE_AMT_SILJUK_MBYUNG)            AS SALE_AMT_SILJUK_MBYUNG     ,  --판매준종합병원
                            SUM(X.SALE_AMT_SILJUK_IN)                AS SALE_AMT_SILJUK_IN         ,  --
                            SUM(X.SALE_AMT_SILJUK_IN_LOCAL)          AS SALE_AMT_SILJUK_IN_LOCAL   ,  --판매도매로컬
                            SUM(X.SALE_AMT_SILJUK_IN_01)             AS SALE_AMT_SILJUK_IN_01      ,  --판매의원
                            SUM(X.SALE_AMT_SILJUK_IN_02)             AS SALE_AMT_SILJUK_IN_02      ,  --판매일반간납
                            SUM(X.SALE_AMT_SILJUK_IN_03)             AS SALE_AMT_SILJUK_IN_03      ,  --판매턴키
                            SUM(X.SALE_AMT_SILJUK_IN_04)             AS SALE_AMT_SILJUK_IN_04      ,  --판매입찰
                            SUM(X.SALE_AMT_SILJUK_IN_05)             AS SALE_AMT_SILJUK_IN_05      ,  --판매기타
                            SUM(X.SALE_AMT_SILJUK_OUT)               AS SALE_AMT_SILJUK_OUT        ,  --판매약국
                            SUM(X.SALE_AMT_BANPUM)                   AS SALE_AMT_BANPUM            ,  --판매반품
                            SUM(X.SALE_AMT_HALIN)                    AS SALE_AMT_HALIN             ,  --판매매출할인
                            SUM(X.SALE_AMT_HALINS01)                 AS SALE_AMT_HALINS01          ,  --판매수금할인(일반)
                            SUM(X.SALE_AMT_HALINS02)                 AS SALE_AMT_HALINS02          ,  --판매수금할인(조건)
                            SUM(X.SALE_AMT_SILJUK_IN)     + SUM(X.SALE_AMT_SILJUK_OUT) + SUM(X.SALE_AMT_SILJUK_BYUNG) +
                            SUM(X.SALE_AMT_SILJUK_MBYUNG) + SUM(X.SALE_AMT_BANPUM)     + (SUM(X.SALE_AMT_HALIN)       +
                            SUM(X.SALE_AMT_HALINS01)) + NVL(SUM(X.SALE_AMT_HALINS02),0)  AS SALE_AMT_SILJUK             ,  --판매계(수금할인조건제외)
                            DECODE(SUM(NVL(X.SALE_AMT,0)),0, 0,
                            ROUND((SUM(X.SALE_AMT_SILJUK_IN)    + SUM(X.SALE_AMT_SILJUK_OUT)    +
                                   SUM(X.SALE_AMT_SILJUK_BYUNG) + SUM(X.SALE_AMT_SILJUK_MBYUNG) +
                                   SUM(X.SALE_AMT_BANPUM)       + SUM(X.SALE_AMT_HALIN)         +
                                   SUM(X.SALE_AMT_HALINS01))    / SUM(X.SALE_AMT) * 100,2))
                                                                     AS SALE_PERCENT               ,  --
                            SUM(X.IN_AMT)                            AS IN_AMT                     ,  --수금목표
                            SUM(X.IN_AMT_SILJUK_BYUNG)               AS IN_AMT_SILJUK_BYUNG        ,  --수금종합병원
                            SUM(X.IN_AMT_SILJUK_MBYUNG)              AS IN_AMT_SILJUK_MBYUNG       ,  --수금준종합병원
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK_IN           ,  --
                            SUM(X.IN_AMT_SILJUK_IN_LOCAL)            AS IN_AMT_SILJUK_IN_LOCAL     ,  --수금도매
                            SUM(X.IN_AMT_SILJUK_IN_01)               AS IN_AMT_SILJUK_IN_01        ,  --수금의원
                            SUM(X.IN_AMT_SILJUK_IN_02)               AS IN_AMT_SILJUK_IN_02        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_03)               AS IN_AMT_SILJUK_IN_03        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_04)               AS IN_AMT_SILJUK_IN_04        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_05)               AS IN_AMT_SILJUK_IN_05        ,  --수금기타
                            SUM(X.IN_AMT_SILJUK_OUT)                 AS IN_AMT_SILJUK_OUT          ,  --수금약국
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK              ,  --수금계
                            DECODE(SUM(NVL(X.IN_AMT,0)), 0, 0,
                            ROUND((SUM(X.IN_AMT_SILJUK_IN)    ) / SUM(X.IN_AMT) * 100,2))
                                                                     AS IN_PERCENT                    --수금달성률
                       FROM
                         ( SELECT A.PARTDIV                          AS PARTDIV                 ,
                                  A.DEPTCODE                         AS DEPTCODE                ,
                                  A.EMPCODE                          AS EMPCODE                 ,
                                  SUM(A.SALE_AMT)                    AS SALE_AMT                ,
                                  SUM(A.SALE_AMT_SILJUK_BYUNG)       AS SALE_AMT_SILJUK_BYUNG   ,
                                  SUM(A.SALE_AMT_SILJUK_MBYUNG)      AS SALE_AMT_SILJUK_MBYUNG  ,
                                  SUM(A.SALE_AMT_SILJUK_IN)          AS SALE_AMT_SILJUK_IN      ,
                                  SUM(A.SALE_AMT_SILJUK_IN_LOCAL)    AS SALE_AMT_SILJUK_IN_LOCAL,
                                  SUM(A.SALE_AMT_SILJUK_IN_01)       AS SALE_AMT_SILJUK_IN_01   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_02)       AS SALE_AMT_SILJUK_IN_02   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_03)       AS SALE_AMT_SILJUK_IN_03   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_04)       AS SALE_AMT_SILJUK_IN_04   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_05)       AS SALE_AMT_SILJUK_IN_05   ,
                                  SUM(A.SALE_AMT_SILJUK_OUT)         AS SALE_AMT_SILJUK_OUT     ,
                                  SUM(A.SALE_AMT_BANPUM)             AS SALE_AMT_BANPUM         ,
                                  SUM(A.SALE_AMT_HALIN)              AS SALE_AMT_HALIN          ,
                                  SUM(A.SALE_AMT_HALINS01)           AS SALE_AMT_HALINS01       ,
                                  SUM(A.SALE_AMT_HALINS02)           AS SALE_AMT_HALINS02       ,
                                  SUM(A.IN_AMT)                      AS IN_AMT                  ,
                                  SUM(A.IN_AMT_SILJUK_IN)            AS IN_AMT_SILJUK_IN        ,
                                  SUM(A.IN_AMT_SILJUK_IN_LOCAL)      AS IN_AMT_SILJUK_IN_LOCAL  ,
                                  SUM(A.IN_AMT_SILJUK_IN_01)         AS IN_AMT_SILJUK_IN_01     ,
                                  SUM(A.IN_AMT_SILJUK_IN_02)         AS IN_AMT_SILJUK_IN_02     ,
                                  SUM(A.IN_AMT_SILJUK_IN_03)         AS IN_AMT_SILJUK_IN_03     ,
                                  SUM(A.IN_AMT_SILJUK_IN_04)         AS IN_AMT_SILJUK_IN_04     ,
                                  SUM(A.IN_AMT_SILJUK_IN_05)         AS IN_AMT_SILJUK_IN_05     ,
                                  SUM(A.IN_AMT_SILJUK_OUT)           AS IN_AMT_SILJUK_OUT       ,
                                  SUM(A.IN_AMT_SILJUK_BYUNG)         AS IN_AMT_SILJUK_BYUNG     ,
                                  SUM(A.IN_AMT_SILJUK_MBYUNG)        AS IN_AMT_SILJUK_MBYUNG
                             FROM
                                ( --목표
                                  SELECT A.UTDIV                                                   AS PARTDIV                 ,
                                         A.DEPTCODE                                                AS DEPTCODE                ,
                                         A.EMPCODE                                                 AS EMPCODE                 ,
                                         SUM(CASE WHEN A.SALDIV = 'A' THEN A.TARGETAMT ELSE 0 END) AS SALE_AMT                ,  --판매목표
                                         0                                                         AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                         AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                         AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                         AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                         AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                         AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                         AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                         AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                         AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                         AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                         AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                         AS SALE_AMT_HALIN          ,  --매출:매출할인외
                                         0                                                         AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         SUM(CASE WHEN A.SALDIV = 'C' THEN A.TARGETAMT ELSE 0 END) AS IN_AMT                  ,  --수금목표
                                         0                                                         AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                         AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                         AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                         AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                         AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                         AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                         AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                         AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                         AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                         AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLTARGETSALEM A
                                   WHERE A.YEARMONTH BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.UTDIV   ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.DEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY A.UTDIV, A.DEPTCODE, A.EMPCODE
                               UNION ALL
                                  --판매
                                  SELECT B.ITPARTDIV                                                                                                                    AS PARTDIV                 ,
                                         B.ITDEPTCODE                                                                                                                   AS DEPTCODE                ,  --부서코드
                                         B.EMPCODE                                                                                                                      AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '60'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '80'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV IN ('05','10','70','90','99')            THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '05'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) = '4' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) > '6' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '70'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '90'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '99'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '20'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         SUM(CASE WHEN A.SALDIV IN ('B01','B10')                                                             THEN -B.SALAMT1 ELSE 0 END) AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                                                                                              AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         0                                                                                                                              AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                                                                                              AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                                                                                              AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                                                                                              AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                                                                                              AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLORDM A,
                                         ORAGMP.SLORDD B
                                   WHERE A.STATEDIV = '09'
                                     AND A.ORDERNO  = B.ORDERNO
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(B.ITPARTDIV ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(B.ITDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(B.EMPCODE   ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY B.ITPARTDIV, B.ITDEPTCODE, B.EMPCODE
                               UNION ALL
                                  --수금
                                  SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                         A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                         A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                         SUM(CASE WHEN A.COLDIV = '52' AND A.SALEAPPLY = 'Y' THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                   AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) NOT IN ('3','4')  THEN -(A.COLAMT - A.COLVAT) ELSE 0 END) AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) IN ('3','4')       THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLCOLM A
                                   WHERE A.STATEDIV = '09'
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                     AND A.COLDIV <> '55'   --잔고이월 제외 
                                     AND A.COLDIV NOT LIKE '3%'
                                GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                
                                UNION ALL

                                SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                       A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                       A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                       0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                       0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                       0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                       0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                       0                                                                  AS SALE_AMT_HALIN          ,  --매출:매출할인
                                       0                                                                  AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                       0                                                                  AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                       0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('40', '45') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '10' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '99' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '20' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                               ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '60' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '80' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                  FROM ORAGMP.SLCOLM A
                                 WHERE A.STATEDIV = '09'
                                   AND SUBSTR(A.APPDATE,1,7) BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#{as_date_fr,jdbcType=VARCHAR} || '-01','YYYY-MM-DD'), -24), 'YYYY-MM') AND #{as_date_to,jdbcType=VARCHAR}
                                   AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                   AND A.COLDIV <> '55'   --잔고이월 제외 
                                   AND A.COLDIV LIKE '3%'
                              GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                ) A
                         GROUP BY A.PARTDIV, A.DEPTCODE, A.EMPCODE
                         ) X,
                           ORAGMP.CMEMPM    A,
                           ORAGMP.CMDEPTM   B,
                           ORAGMP.CMCOMMONM C
                     WHERE X.EMPCODE  = A.EMPCODE (+)
                       AND X.DEPTCODE = B.DEPTCODE(+)
                       AND 'SL90'     = C.CMMCODE (+)
                       AND X.PARTDIV  = C.DIVCODE (+)
                  GROUP BY X.PARTDIV, C.DIVNAME, X.DEPTCODE, B.DEPTNAME
				)
	]]>
	
	
	<!-- 
		SELECT COUNT(DISTINCT(team_cd)) total_cnt, SUM (sale_amt) AS total_sale_amt,
	         SUM (sale_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_local,
	         SUM (sale_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_01,
	         SUM (sale_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_02,
	         SUM (sale_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_03,
	         SUM (sale_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_04,
	         SUM (sale_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_05,
	         SUM (sale_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_out,
	         SUM (sale_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_byung,
	         SUM (sale_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_mbyung,
	         (SUM (sale_amt_siljuk) + SUM (sale_amt_halins02)) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk,
	         SUM (in_amt) AS total_in_amt,
	         SUM (in_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_local,
	         SUM (in_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_01,
	         SUM (in_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_05,
	         SUM (in_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_out_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_out,
	         SUM (in_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_byung,
	         SUM (in_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_mbyung,
	         SUM (in_amt_siljuk) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk
		  FROM sale.salepart_batch2
		 WHERE SUBSTR (date_time, 1, 6) = #{as_date_time,jdbcType=VARCHAR}
	       AND part_cd LIKE NVL (#{as_part_cd,jdbcType=VARCHAR}, '%')
	       AND team_cd LIKE NVL (#{as_team_cd,jdbcType=VARCHAR}, '%')
	       AND emp_no LIKE NVL (#{as_emp_no,jdbcType=VARCHAR}, '%')
	       AND emp_nm NOT LIKE '%도매%'
	       AND emp_nm NOT LIKE '%기타%'
	       AND emp_nm NOT LIKE '%미지정%'
	       AND emp_nm NOT LIKE '%채권관리부%'
	       AND rpt_gb NOT IN ('08', '09', '10', '11', '12', '13', 'ZZ')
	       -->
	</select>
	
	<select id="getPerformanceForEmpGridList" parameterType="hashmap" resultType="com.hanaph.saleon.business.vo.PerformanceVO">
		/*사원별 */
		<if test="page != null">
			SELECT *
				FROM (SELECT T0.*, FLOOR((ROWNUM - 1) / #{perPageRow,jdbcType=INTEGER} + 1) PAGE
	        		FROM (
    	</if>
    	
    	<![CDATA[
                     SELECT X.PARTDIV                                AS PARTDIV                    ,  --직능코드
		                    ORAGMP.F_GET_SORT_SEQ(X.DEPTCODE)        AS RORDER                     ,
                            C.DIVNAME                                AS PARTDIVNAME                ,  --직능명(파트명)
                            X.DEPTCODE                               AS DEPTCODE                   ,  --부서코드
                            B.DEPTNAME                               AS COL2                   ,  --부서명(지점/팀명)
                            A.GRADEDIV                               AS GRADEDIV                   ,  --직위코드
                            X.EMPCODE                                AS EMPCODE                    ,  --사원번호
                            A.EMPNAME                                AS COL4                    ,  --사원명(담당사원)
                            SUM(X.SALE_AMT)                          AS SALE_AMT                   ,  --판매목표
                            SUM(X.SALE_AMT_SILJUK_BYUNG)             AS SALE_AMT_SILJUK_BYUNG      ,  --판매종합병원
                            SUM(X.SALE_AMT_SILJUK_MBYUNG)            AS SALE_AMT_SILJUK_MBYUNG     ,  --판매준종합병원
                            SUM(X.SALE_AMT_SILJUK_IN)                AS SALE_AMT_SILJUK_IN         ,  --
                            SUM(X.SALE_AMT_SILJUK_IN_LOCAL)          AS SALE_AMT_SILJUK_IN_LOCAL   ,  --판매도매로컬
                            SUM(X.SALE_AMT_SILJUK_IN_01)             AS SALE_AMT_SILJUK_IN_01      ,  --판매의원
                            SUM(X.SALE_AMT_SILJUK_IN_02)             AS SALE_AMT_SILJUK_IN_02      ,  --판매일반간납
                            SUM(X.SALE_AMT_SILJUK_IN_03)             AS SALE_AMT_SILJUK_IN_03      ,  --판매턴키
                            SUM(X.SALE_AMT_SILJUK_IN_04)             AS SALE_AMT_SILJUK_IN_04      ,  --판매입찰
                            SUM(X.SALE_AMT_SILJUK_IN_05)             AS SALE_AMT_SILJUK_IN_05      ,  --판매기타
                            SUM(X.SALE_AMT_SILJUK_OUT)               AS SALE_AMT_SILJUK_OUT        ,  --판매약국
                            SUM(X.SALE_AMT_BANPUM)                   AS SALE_AMT_BANPUM            ,  --판매반품
                            SUM(X.SALE_AMT_HALIN)                    AS SALE_AMT_HALIN             ,  --판매매출할인
                            SUM(X.SALE_AMT_HALINS01)                 AS SALE_AMT_HALINS01          ,  --판매수금할인(일반)
                            SUM(X.SALE_AMT_HALINS02)                 AS SALE_AMT_HALINS02          ,  --판매수금할인(조건)
                            SUM(X.SALE_AMT_SILJUK_IN)     + SUM(X.SALE_AMT_SILJUK_OUT) + SUM(X.SALE_AMT_SILJUK_BYUNG) +
                            SUM(X.SALE_AMT_SILJUK_MBYUNG) + SUM(X.SALE_AMT_BANPUM)     + (SUM(X.SALE_AMT_HALIN)       +
                            SUM(X.SALE_AMT_HALINS01)) + NVL(SUM(X.SALE_AMT_HALINS02),0)  AS SALE_AMT_SILJUK            ,  --판매계(수금할인조건제외)
                            DECODE(SUM(NVL(X.SALE_AMT,0)),0, 0,
                            ROUND((SUM(X.SALE_AMT_SILJUK_IN)    + SUM(X.SALE_AMT_SILJUK_OUT)    +
                                   SUM(X.SALE_AMT_SILJUK_BYUNG) + SUM(X.SALE_AMT_SILJUK_MBYUNG) +
                                   SUM(X.SALE_AMT_BANPUM)       + SUM(X.SALE_AMT_HALIN)         +
                                   SUM(X.SALE_AMT_HALINS01))    / SUM(X.SALE_AMT) * 100,2))
                                                                     AS SALE_PERCENT               ,  --
                            SUM(X.IN_AMT)                            AS IN_AMT                     ,  --수금목표
                            SUM(X.IN_AMT_SILJUK_BYUNG)               AS IN_AMT_SILJUK_BYUNG        ,  --수금종합병원
                            SUM(X.IN_AMT_SILJUK_MBYUNG)              AS IN_AMT_SILJUK_MBYUNG       ,  --수금준종합병원
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK_IN           ,  --
                            SUM(X.IN_AMT_SILJUK_IN_LOCAL)            AS IN_AMT_SILJUK_IN_LOCAL     ,  --수금도매
                            SUM(X.IN_AMT_SILJUK_IN_01)               AS IN_AMT_SILJUK_IN_01        ,  --수금의원
                            SUM(X.IN_AMT_SILJUK_IN_02)               AS IN_AMT_SILJUK_IN_02        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_03)               AS IN_AMT_SILJUK_IN_03        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_04)               AS IN_AMT_SILJUK_IN_04        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_05)               AS IN_AMT_SILJUK_IN_05        ,  --수금기타
                            SUM(X.IN_AMT_SILJUK_OUT)                 AS IN_AMT_SILJUK_OUT          ,  --수금약국
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK              ,  --수금계
                            DECODE(SUM(NVL(X.IN_AMT,0)), 0, 0,
                            ROUND((SUM(X.IN_AMT_SILJUK_IN)    ) / SUM(X.IN_AMT) * 100,2))
                                                                     AS IN_PERCENT                    --수금달성률
                       FROM
                         ( SELECT A.PARTDIV                          AS PARTDIV                 ,
                                  A.DEPTCODE                         AS DEPTCODE                ,
                                  A.EMPCODE                          AS EMPCODE                 ,
                                  SUM(A.SALE_AMT)                    AS SALE_AMT                ,
                                  SUM(A.SALE_AMT_SILJUK_BYUNG)       AS SALE_AMT_SILJUK_BYUNG   ,
                                  SUM(A.SALE_AMT_SILJUK_MBYUNG)      AS SALE_AMT_SILJUK_MBYUNG  ,
                                  SUM(A.SALE_AMT_SILJUK_IN)          AS SALE_AMT_SILJUK_IN      ,
                                  SUM(A.SALE_AMT_SILJUK_IN_LOCAL)    AS SALE_AMT_SILJUK_IN_LOCAL,
                                  SUM(A.SALE_AMT_SILJUK_IN_01)       AS SALE_AMT_SILJUK_IN_01   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_02)       AS SALE_AMT_SILJUK_IN_02   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_03)       AS SALE_AMT_SILJUK_IN_03   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_04)       AS SALE_AMT_SILJUK_IN_04   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_05)       AS SALE_AMT_SILJUK_IN_05   ,
                                  SUM(A.SALE_AMT_SILJUK_OUT)         AS SALE_AMT_SILJUK_OUT     ,
                                  SUM(A.SALE_AMT_BANPUM)             AS SALE_AMT_BANPUM         ,
                                  SUM(A.SALE_AMT_HALIN)              AS SALE_AMT_HALIN          ,
                                  SUM(A.SALE_AMT_HALINS01)           AS SALE_AMT_HALINS01       ,
                                  SUM(A.SALE_AMT_HALINS02)           AS SALE_AMT_HALINS02       ,
                                  SUM(A.IN_AMT)                      AS IN_AMT                  ,
                                  SUM(A.IN_AMT_SILJUK_IN)            AS IN_AMT_SILJUK_IN        ,
                                  SUM(A.IN_AMT_SILJUK_IN_LOCAL)      AS IN_AMT_SILJUK_IN_LOCAL  ,
                                  SUM(A.IN_AMT_SILJUK_IN_01)         AS IN_AMT_SILJUK_IN_01     ,
                                  SUM(A.IN_AMT_SILJUK_IN_02)         AS IN_AMT_SILJUK_IN_02     ,
                                  SUM(A.IN_AMT_SILJUK_IN_03)         AS IN_AMT_SILJUK_IN_03     ,
                                  SUM(A.IN_AMT_SILJUK_IN_04)         AS IN_AMT_SILJUK_IN_04     ,
                                  SUM(A.IN_AMT_SILJUK_IN_05)         AS IN_AMT_SILJUK_IN_05     ,
                                  SUM(A.IN_AMT_SILJUK_OUT)           AS IN_AMT_SILJUK_OUT       ,
                                  SUM(A.IN_AMT_SILJUK_BYUNG)         AS IN_AMT_SILJUK_BYUNG     ,
                                  SUM(A.IN_AMT_SILJUK_MBYUNG)        AS IN_AMT_SILJUK_MBYUNG
                             FROM
                                ( --목표
                                  SELECT A.UTDIV                                                   AS PARTDIV                 ,
                                         A.DEPTCODE                                                AS DEPTCODE                ,
                                         A.EMPCODE                                                 AS EMPCODE                 ,
                                         SUM(CASE WHEN A.SALDIV = 'A' THEN A.TARGETAMT ELSE 0 END) AS SALE_AMT                ,  --판매목표
                                         0                                                         AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                         AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                         AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                         AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                         AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                         AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                         AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                         AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                         AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                         AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                         AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                         AS SALE_AMT_HALIN          ,  --매출:매출할인외
                                         0                                                         AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         SUM(CASE WHEN A.SALDIV = 'C' THEN A.TARGETAMT ELSE 0 END) AS IN_AMT                  ,  --수금목표
                                         0                                                         AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                         AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                         AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                         AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                         AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                         AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                         AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                         AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                         AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                         AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLTARGETSALEM A
                                   WHERE A.YEARMONTH BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.UTDIV   ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.DEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY A.UTDIV, A.DEPTCODE, A.EMPCODE
                               UNION ALL
                                  --판매
                                  SELECT B.ITPARTDIV                                                                                                                    AS PARTDIV                 ,
                                         B.ITDEPTCODE                                                                                                                   AS DEPTCODE                ,  --부서코드
                                         B.EMPCODE                                                                                                                      AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '60'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '80'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV IN ('05','10','70','90','99')            THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '05'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) = '4' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) > '6' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '70'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '90'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '99'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '20'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         SUM(CASE WHEN A.SALDIV IN ('B01','B10')                                                             THEN -B.SALAMT1 ELSE 0 END) AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                                                                                              AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         0                                                                                                                              AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                                                                                              AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                                                                                              AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                                                                                              AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                                                                                              AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLORDM A,
                                         ORAGMP.SLORDD B
                                   WHERE A.STATEDIV = '09'
                                     AND A.ORDERNO  = B.ORDERNO
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(B.ITPARTDIV ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(B.ITDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(B.EMPCODE   ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY B.ITPARTDIV, B.ITDEPTCODE, B.EMPCODE
                               UNION ALL
                                  --수금
                                  SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                         A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                         A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                         SUM(CASE WHEN A.COLDIV = '52' AND A.SALEAPPLY = 'Y' THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                   AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) NOT IN ('3','4')  THEN -(A.COLAMT - A.COLVAT) ELSE 0 END) AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) IN ('3','4')       THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLCOLM A
                                   WHERE A.STATEDIV = '09'
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                     AND A.COLDIV <> '55'   --잔고이월 제외 
                                     AND A.COLDIV NOT LIKE '3%'
                                GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                
                                UNION ALL

                                SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                       A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                       A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                       0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                       0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                       0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                       0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                       0                                                                  AS SALE_AMT_HALIN          ,  --매출:매출할인
                                       0                                                                  AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                       0                                                                  AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                       0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('40', '45') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '10' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '99' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '20' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                               ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '60' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '80' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                  FROM ORAGMP.SLCOLM A
                                 WHERE A.STATEDIV = '09'
                                   AND SUBSTR(A.APPDATE,1,7) BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#{as_date_fr,jdbcType=VARCHAR} || '-01','YYYY-MM-DD'), -24), 'YYYY-MM') AND #{as_date_to,jdbcType=VARCHAR}
                                   AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                   AND A.COLDIV <> '55'   --잔고이월 제외 
                                   AND A.COLDIV LIKE '3%'
                              GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                ) A
                         GROUP BY A.PARTDIV, A.DEPTCODE, A.EMPCODE
                         ) X,
                           ORAGMP.CMEMPM    A,
                           ORAGMP.CMDEPTM   B,
                           ORAGMP.CMCOMMONM C
                     WHERE X.EMPCODE  = A.EMPCODE (+)
                       AND X.DEPTCODE = B.DEPTCODE(+)
                       AND 'SL90'     = C.CMMCODE (+)
                       AND X.PARTDIV  = C.DIVCODE (+)
                  GROUP BY X.PARTDIV, C.DIVNAME, X.DEPTCODE, B.DEPTNAME, A.GRADEDIV, X.EMPCODE, A.EMPNAME
			   ]]>				
    	<!-- 
		<![CDATA[
						  SELECT emp_no, 
						         rpt_gb, 
						         part_cd,
						         team_cd, 
						         MAX (date_time) AS datef,
						         MAX (date_time) AS datet, 
						         SUM (siljukyul_in) AS siljukyul_in,
						         SUM (siljukyul_out) AS siljukyul_out,
						         SUM (siljukyul_in_su) AS siljukyul_in_su,
						         SUM (siljukyul_out_su) AS siljukyul_out_su,
						         SUM (siljukyul_byung) AS siljukyul_byung,
						         SUM (siljukyul_byung_su) AS siljukyul_byung_su,
						         MAX (rorder) AS rorder,
						         '' AS col1, MAX (team_nm) AS col2, '' AS col3, MAX (emp_nm) AS col4,
						         SUM (sale_amt) AS sale_amt,
						         SUM (sale_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in,
						         SUM (sale_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_local,
						         SUM (sale_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_01,
						         SUM (sale_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_02,
						         SUM (sale_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_03,
						         SUM (sale_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_04,
						         SUM (sale_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_in_05,
						         SUM (sale_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_out,
						         SUM (sale_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_byung,
						         SUM (sale_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk_mbyung,
						         SUM (sale_amt_banpum) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_banpum,
						         SUM (sale_amt_halin) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halin,
						         SUM (sale_amt_halins01) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halins01,
						         SUM (sale_amt_halins02) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_halins02,
						         (SUM (sale_amt_siljuk) + SUM (sale_amt_halins02)) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS sale_amt_siljuk,
						         ROUND(SUM (sale_percent) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01), 2) AS sale_percent,
						         SUM (in_amt) AS in_amt,
						         SUM (in_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in,
						         SUM (in_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_local,
						         SUM (in_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_01,
						         SUM (in_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_02,
						         SUM (in_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_03,
						         SUM (in_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_04,
						         SUM (in_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in_05,
						         SUM (in_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_out_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_out,
						         SUM (in_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_byung,
						         SUM (in_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_mbyung,
						         SUM (in_amt_siljuk) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk,
						         ROUND(SUM (in_percent) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01), 2) AS in_percent,
						         TO_DATE (MAX (proc_date), 'YYYYMMDDHH24MISS') AS proc_date,
						         #{as_siljukyul_in,jdbcType=VARCHAR} AS as_siljukyul_in,
						         #{as_siljukyul_out,jdbcType=VARCHAR} AS as_siljukyul_out,
						         #{as_siljukyul_in_su,jdbcType=VARCHAR} AS as_siljukyul_in_su,
						         #{as_siljukyul_out_su,jdbcType=VARCHAR} AS as_siljukyul_out_su,
						         #{as_siljukyul_byung,jdbcType=VARCHAR} AS as_siljukyul_byung,
						         #{as_siljukyul_byung_su,jdbcType=VARCHAR} AS as_siljukyul_byung_su
						    FROM sale.salepart_batch2
						   WHERE SUBSTR (date_time, 1, 6) = #{as_date_time,jdbcType=VARCHAR}
					         AND part_cd LIKE NVL (#{as_part_cd,jdbcType=VARCHAR}, '%')
					         AND team_cd LIKE NVL (#{as_team_cd,jdbcType=VARCHAR}, '%')
					         AND emp_no LIKE NVL (#{as_emp_no,jdbcType=VARCHAR}, '%')
						     AND emp_nm NOT LIKE '%도매%'
						     AND emp_nm NOT LIKE '%기타%'
						     AND emp_nm NOT LIKE '%미지정%'
						     AND emp_nm NOT LIKE '%채권관리부%'
						     AND rpt_gb NOT IN ('08', '09', '10', '11', '12', '13')
						GROUP BY emp_no, 
						         rpt_gb, 
						         part_cd,
						         team_cd
		]]>
		-->
					<if test="sidx != ''">
						ORDER BY ${sidx} ${sord}
					</if>
		
				<if test="page != null">
					) T0
				)
				WHERE PAGE = #{page,jdbcType=INTEGER}
				</if>
	</select>
	
	<select id="getPerformanceForEmpGridTotalCount" parameterType="hashmap" resultType="com.hanaph.saleon.business.vo.PerformanceVO">
		/*사원별 카운트*/
		<![CDATA[
		SELECT COUNT(DISTINCT(PARTDIV)) total_cnt,
			 SUM (sale_amt) AS total_sale_amt,
	         SUM (sale_amt_siljuk_in_local) AS total_sale_amt_siljuk_in_local,
	         SUM (sale_amt_siljuk_in_01) AS total_sale_amt_siljuk_in_01,
	         SUM (sale_amt_siljuk_in_02) AS total_sale_amt_siljuk_in_02,
	         SUM (sale_amt_siljuk_in_03) AS total_sale_amt_siljuk_in_03,
	         SUM (sale_amt_siljuk_in_04) AS total_sale_amt_siljuk_in_04,
	         SUM (sale_amt_siljuk_in_05) AS total_sale_amt_siljuk_in_05,
	         SUM (sale_amt_siljuk_out) AS total_sale_amt_siljuk_out,
	         SUM (sale_amt_siljuk_byung) AS total_sale_amt_siljuk_byung,
	         SUM (sale_amt_siljuk_mbyung) AS total_sale_amt_siljuk_mbyung,
	         SUM (sale_amt_siljuk) AS total_sale_amt_siljuk,
	         SUM (in_amt) AS total_in_amt,
	         SUM (sale_amt_banpum) AS total_sale_amt_banpum,
	         SUM (in_amt_siljuk_in_local) AS total_in_amt_siljuk_in_local,
	         SUM (in_amt_siljuk_in_01) AS total_in_amt_siljuk_in_01,
	         SUM (in_amt_siljuk_in_05) AS total_in_amt_siljuk_in_05,
	         SUM (in_amt_siljuk_out) AS total_in_amt_siljuk_out,
	         SUM (in_amt_siljuk_byung) AS total_in_amt_siljuk_byung,
	         SUM (in_amt_siljuk_mbyung) AS total_in_amt_siljuk_mbyung,
	         SUM (in_amt_siljuk) AS total_in_amt_siljuk
	         FROM(
                     SELECT X.PARTDIV                                AS PARTDIV                    ,  --직능코드
                            C.DIVNAME                                AS PARTDIVNAME                ,  --직능명(파트명)
                            X.DEPTCODE                               AS DEPTCODE                   ,  --부서코드
                            B.DEPTNAME                               AS DEPTNAME                   ,  --부서명(지점/팀명)
                            A.GRADEDIV                               AS GRADEDIV                   ,  --직위코드
                            X.EMPCODE                                AS EMPCODE                    ,  --사원번호
                            A.EMPNAME                                AS EMPNAME                    ,  --사원명(담당사원)
                            SUM(X.SALE_AMT)                          AS SALE_AMT                   ,  --판매목표
                            SUM(X.SALE_AMT_SILJUK_BYUNG)             AS SALE_AMT_SILJUK_BYUNG      ,  --판매종합병원
                            SUM(X.SALE_AMT_SILJUK_MBYUNG)            AS SALE_AMT_SILJUK_MBYUNG     ,  --판매준종합병원
                            SUM(X.SALE_AMT_SILJUK_IN)                AS SALE_AMT_SILJUK_IN         ,  --
                            SUM(X.SALE_AMT_SILJUK_IN_LOCAL)          AS SALE_AMT_SILJUK_IN_LOCAL   ,  --판매도매로컬
                            SUM(X.SALE_AMT_SILJUK_IN_01)             AS SALE_AMT_SILJUK_IN_01      ,  --판매의원
                            SUM(X.SALE_AMT_SILJUK_IN_02)             AS SALE_AMT_SILJUK_IN_02      ,  --판매일반간납
                            SUM(X.SALE_AMT_SILJUK_IN_03)             AS SALE_AMT_SILJUK_IN_03      ,  --판매턴키
                            SUM(X.SALE_AMT_SILJUK_IN_04)             AS SALE_AMT_SILJUK_IN_04      ,  --판매입찰
                            SUM(X.SALE_AMT_SILJUK_IN_05)             AS SALE_AMT_SILJUK_IN_05      ,  --판매기타
                            SUM(X.SALE_AMT_SILJUK_OUT)               AS SALE_AMT_SILJUK_OUT        ,  --판매약국
                            SUM(X.SALE_AMT_BANPUM)                   AS SALE_AMT_BANPUM            ,  --판매반품
                            SUM(X.SALE_AMT_HALIN)                    AS SALE_AMT_HALIN             ,  --판매매출할인
                            SUM(X.SALE_AMT_HALINS01)                 AS SALE_AMT_HALINS01          ,  --판매수금할인(일반)
                            SUM(X.SALE_AMT_HALINS02)                 AS SALE_AMT_HALINS02          ,  --판매수금할인(조건)
                            SUM(X.SALE_AMT_SILJUK_IN)     + SUM(X.SALE_AMT_SILJUK_OUT) + SUM(X.SALE_AMT_SILJUK_BYUNG) +
                            SUM(X.SALE_AMT_SILJUK_MBYUNG) + SUM(X.SALE_AMT_BANPUM)     + (SUM(X.SALE_AMT_HALIN)       +
                            SUM(X.SALE_AMT_HALINS01)) + NVL(SUM(X.SALE_AMT_HALINS02),0)  AS SALE_AMT_SILJUK            ,  --판매계(수금할인조건제외)
                            DECODE(SUM(NVL(X.SALE_AMT,0)),0, 0,
                            ROUND((SUM(X.SALE_AMT_SILJUK_IN)    + SUM(X.SALE_AMT_SILJUK_OUT)    +
                                   SUM(X.SALE_AMT_SILJUK_BYUNG) + SUM(X.SALE_AMT_SILJUK_MBYUNG) +
                                   SUM(X.SALE_AMT_BANPUM)       + SUM(X.SALE_AMT_HALIN)         +
                                   SUM(X.SALE_AMT_HALINS01))    / SUM(X.SALE_AMT) * 100,2))
                                                                     AS SALE_PERCENT               ,  --
                            SUM(X.IN_AMT)                            AS IN_AMT                     ,  --수금목표
                            SUM(X.IN_AMT_SILJUK_BYUNG)               AS IN_AMT_SILJUK_BYUNG        ,  --수금종합병원
                            SUM(X.IN_AMT_SILJUK_MBYUNG)              AS IN_AMT_SILJUK_MBYUNG       ,  --수금준종합병원
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK_IN           ,  --
                            SUM(X.IN_AMT_SILJUK_IN_LOCAL)            AS IN_AMT_SILJUK_IN_LOCAL     ,  --수금도매
                            SUM(X.IN_AMT_SILJUK_IN_01)               AS IN_AMT_SILJUK_IN_01        ,  --수금의원
                            SUM(X.IN_AMT_SILJUK_IN_02)               AS IN_AMT_SILJUK_IN_02        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_03)               AS IN_AMT_SILJUK_IN_03        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_04)               AS IN_AMT_SILJUK_IN_04        ,  --
                            SUM(X.IN_AMT_SILJUK_IN_05)               AS IN_AMT_SILJUK_IN_05        ,  --수금기타
                            SUM(X.IN_AMT_SILJUK_OUT)                 AS IN_AMT_SILJUK_OUT          ,  --수금약국
                            SUM(X.IN_AMT_SILJUK_IN)                  AS IN_AMT_SILJUK              ,  --수금계
                            DECODE(SUM(NVL(X.IN_AMT,0)), 0, 0,
                            ROUND((SUM(X.IN_AMT_SILJUK_IN)    ) / SUM(X.IN_AMT) * 100,2))
                                                                     AS IN_PERCENT                    --수금달성률
                       FROM
                         ( SELECT A.PARTDIV                          AS PARTDIV                 ,
                                  A.DEPTCODE                         AS DEPTCODE                ,
                                  A.EMPCODE                          AS EMPCODE                 ,
                                  SUM(A.SALE_AMT)                    AS SALE_AMT                ,
                                  SUM(A.SALE_AMT_SILJUK_BYUNG)       AS SALE_AMT_SILJUK_BYUNG   ,
                                  SUM(A.SALE_AMT_SILJUK_MBYUNG)      AS SALE_AMT_SILJUK_MBYUNG  ,
                                  SUM(A.SALE_AMT_SILJUK_IN)          AS SALE_AMT_SILJUK_IN      ,
                                  SUM(A.SALE_AMT_SILJUK_IN_LOCAL)    AS SALE_AMT_SILJUK_IN_LOCAL,
                                  SUM(A.SALE_AMT_SILJUK_IN_01)       AS SALE_AMT_SILJUK_IN_01   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_02)       AS SALE_AMT_SILJUK_IN_02   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_03)       AS SALE_AMT_SILJUK_IN_03   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_04)       AS SALE_AMT_SILJUK_IN_04   ,
                                  SUM(A.SALE_AMT_SILJUK_IN_05)       AS SALE_AMT_SILJUK_IN_05   ,
                                  SUM(A.SALE_AMT_SILJUK_OUT)         AS SALE_AMT_SILJUK_OUT     ,
                                  SUM(A.SALE_AMT_BANPUM)             AS SALE_AMT_BANPUM         ,
                                  SUM(A.SALE_AMT_HALIN)              AS SALE_AMT_HALIN          ,
                                  SUM(A.SALE_AMT_HALINS01)           AS SALE_AMT_HALINS01       ,
                                  SUM(A.SALE_AMT_HALINS02)           AS SALE_AMT_HALINS02       ,
                                  SUM(A.IN_AMT)                      AS IN_AMT                  ,
                                  SUM(A.IN_AMT_SILJUK_IN)            AS IN_AMT_SILJUK_IN        ,
                                  SUM(A.IN_AMT_SILJUK_IN_LOCAL)      AS IN_AMT_SILJUK_IN_LOCAL  ,
                                  SUM(A.IN_AMT_SILJUK_IN_01)         AS IN_AMT_SILJUK_IN_01     ,
                                  SUM(A.IN_AMT_SILJUK_IN_02)         AS IN_AMT_SILJUK_IN_02     ,
                                  SUM(A.IN_AMT_SILJUK_IN_03)         AS IN_AMT_SILJUK_IN_03     ,
                                  SUM(A.IN_AMT_SILJUK_IN_04)         AS IN_AMT_SILJUK_IN_04     ,
                                  SUM(A.IN_AMT_SILJUK_IN_05)         AS IN_AMT_SILJUK_IN_05     ,
                                  SUM(A.IN_AMT_SILJUK_OUT)           AS IN_AMT_SILJUK_OUT       ,
                                  SUM(A.IN_AMT_SILJUK_BYUNG)         AS IN_AMT_SILJUK_BYUNG     ,
                                  SUM(A.IN_AMT_SILJUK_MBYUNG)        AS IN_AMT_SILJUK_MBYUNG
                             FROM
                                ( --목표
                                  SELECT A.UTDIV                                                   AS PARTDIV                 ,
                                         A.DEPTCODE                                                AS DEPTCODE                ,
                                         A.EMPCODE                                                 AS EMPCODE                 ,
                                         SUM(CASE WHEN A.SALDIV = 'A' THEN A.TARGETAMT ELSE 0 END) AS SALE_AMT                ,  --판매목표
                                         0                                                         AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                         AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                         AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                         AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                         AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                         AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                         AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                         AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                         AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                         AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                         AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                         AS SALE_AMT_HALIN          ,  --매출:매출할인외
                                         0                                                         AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         SUM(CASE WHEN A.SALDIV = 'C' THEN A.TARGETAMT ELSE 0 END) AS IN_AMT                  ,  --수금목표
                                         0                                                         AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                         AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                         AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                         AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                         AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                         AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                         AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                         AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                         AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                         AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLTARGETSALEM A
                                   WHERE A.YEARMONTH BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.UTDIV   ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.DEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY A.UTDIV, A.DEPTCODE, A.EMPCODE
                               UNION ALL
                                  --판매
                                  SELECT B.ITPARTDIV                                                                                                                    AS PARTDIV                 ,
                                         B.ITDEPTCODE                                                                                                                   AS DEPTCODE                ,  --부서코드
                                         B.EMPCODE                                                                                                                      AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '60'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '80'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV IN ('05','10','70','90','99')            THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '05'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) = '4' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '10' AND SUBSTR(A.ECUSTCODE,1,1) > '6' THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '70'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '90'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '99'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         SUM(CASE WHEN A.SALDIV IN ('A01','A21','A22') AND A.EUTDIV = '20'                                   THEN B.SALAMT1  ELSE 0 END) AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         SUM(CASE WHEN A.SALDIV IN ('B01','B10')                                                             THEN -B.SALAMT1 ELSE 0 END) AS SALE_AMT_BANPUM         ,  --매출:반품
                                         0                                                                                                                              AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         0                                                                                                                              AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         0                                                                                                                              AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN        ,  --수금:간납합계
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매로컬
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_01     ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         0                                                                                                                              AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         0                                                                                                                              AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         0                                                                                                                              AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLORDM A,
                                         ORAGMP.SLORDD B
                                   WHERE A.STATEDIV = '09'
                                     AND A.ORDERNO  = B.ORDERNO
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(B.ITPARTDIV ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(B.ITDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(B.EMPCODE   ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                GROUP BY B.ITPARTDIV, B.ITDEPTCODE, B.EMPCODE
                               UNION ALL
                                  --수금
                                  SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                         A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                         A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                         0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                         0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                         0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                         0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                         0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                         SUM(CASE WHEN A.COLDIV = '52' AND A.SALEAPPLY = 'Y' THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                   AS SALE_AMT_HALIN          ,  --매출:매출할인
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) NOT IN ('3','4')  THEN -(A.COLAMT - A.COLVAT) ELSE 0 END) AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                         SUM(CASE WHEN A.COLDIV = '59' AND A.SALEAPPLY = 'Y' AND SUBSTR(A.CUSTCODE,1,1) IN ('3','4')       THEN -(A.COLAMT - A.COLVAT) ELSE 0 END)                         AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                         0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                         0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN ROUND(A.COLAMT / 1.1) 
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                         SUM(CASE WHEN A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN ROUND(A.COLAMT / 1.1)  
                                                  ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                    FROM ORAGMP.SLCOLM A
                                   WHERE A.STATEDIV = '09'
                                     AND SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR}
                                     AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                     AND A.COLDIV <> '55'   --잔고이월 제외 
                                     AND A.COLDIV NOT LIKE '3%'
                                GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                
                                UNION ALL

                                SELECT A.PARTDIV                                                                                                                      AS PARTDIV                 ,
                                       A.EDEPTCODE                                                                                                                    AS DEPTCODE                ,  --부서코드
                                       A.EEMPCODE                                                                                                                     AS EMPCODE                 ,  --사원코드
                                       0                                                                                                                              AS SALE_AMT                ,  --판매목표
                                       0                                                                                                                              AS SALE_AMT_SILJUK_BYUNG   ,  --매출:종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_MBYUNG  ,  --매출:준종합병원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN      ,  --매출:간납합계
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_LOCAL,  --매출:도매로컬
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_01   ,  --매출:의원
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_02   ,  --매출:일반간납
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_03   ,  --매출:턴키
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_04   ,  --매출:입찰
                                       0                                                                                                                              AS SALE_AMT_SILJUK_IN_05   ,  --매출:기타
                                       0                                                                                                                              AS SALE_AMT_SILJUK_OUT     ,  --매출:약국
                                       0                                                                                                                              AS SALE_AMT_BANPUM         ,  --매출:반품
                                       0                                                                  AS SALE_AMT_HALIN          ,  --매출:매출할인
                                       0                                                                  AS SALE_AMT_HALINS01       ,  --매출:수금할인(일반)
                                       0                                                                  AS SALE_AMT_HALINS02       ,  --매출:수금할인(조건)
                                       0                                                                                                                              AS IN_AMT                  ,  --수금목표
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('10', '20', '40', '45', '60', '80', '99') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN        ,  --수금:합계                                                       
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV IN ('40', '45') THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV IN ('40', '45') AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_LOCAL  ,  --수금:도매
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '10' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '10' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_01  ,  --수금:의원
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_02     ,  --수금:일반간납
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_03     ,  --수금:턴키
                                       0                                                                                                                              AS IN_AMT_SILJUK_IN_04     ,  --수금:입찰
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '99' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '99' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1) 
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_IN_05     ,  --수금:기타
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '20' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '20' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                               ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_OUT       ,  --수금:약국
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '60' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '60' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                           AS IN_AMT_SILJUK_BYUNG     ,  --수금:종합병원
                                       SUM(CASE WHEN SUBSTR(A.APPDATE,1,7) BETWEEN #{as_date_fr,jdbcType=VARCHAR} AND #{as_date_to,jdbcType=VARCHAR} AND A.COLDIV NOT IN ('52', '59') AND A.EUTDIV = '80' THEN 
                                                CASE WHEN A.EXPDATE <= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(A.APPDATE,'YYYY-MM-DD'),6)),'YYYY-MM-DD') THEN ROUND(A.COLAMT / 1.1) 
                                                     ELSE 0 END
                                                WHEN A.EUTDIV = '80' AND MONTHS_BETWEEN(TO_DATE(SUBSTR(A.EXPDATE, 1, 7), 'YYYY-MM'), TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM')) BETWEEN 6 - MONTHS_BETWEEN(TO_DATE(#{as_date_to,jdbcType=VARCHAR}, 'YYYY-MM'), TO_DATE(#{as_date_fr,jdbcType=VARCHAR}, 'YYYY-MM')) AND 6 THEN ROUND(A.COLAMT / 1.1)
                                                ELSE 0 END)                                                                                                            AS IN_AMT_SILJUK_MBYUNG       --수금:준종합병원
                                  FROM ORAGMP.SLCOLM A
                                 WHERE A.STATEDIV = '09'
                                   AND SUBSTR(A.APPDATE,1,7) BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#{as_date_fr,jdbcType=VARCHAR} || '-01','YYYY-MM-DD'), -24), 'YYYY-MM') AND #{as_date_to,jdbcType=VARCHAR}
                                   AND NVL(A.PARTDIV  ,' ') LIKE #{as_part_cd,jdbcType=VARCHAR}  || '%'
                                     AND NVL(A.EDEPTCODE,' ') LIKE #{as_team_cd,jdbcType=VARCHAR} || '%'
                                     AND NVL(A.EEMPCODE ,' ') LIKE #{as_emp_no,jdbcType=VARCHAR}  || '%'
                                   AND A.COLDIV <> '55'   --잔고이월 제외 
                                   AND A.COLDIV LIKE '3%'
                              GROUP BY A.PARTDIV, A.EDEPTCODE, A.EEMPCODE
                                ) A
                         GROUP BY A.PARTDIV, A.DEPTCODE, A.EMPCODE
                         ) X,
                           ORAGMP.CMEMPM    A,
                           ORAGMP.CMDEPTM   B,
                           ORAGMP.CMCOMMONM C
                     WHERE X.EMPCODE  = A.EMPCODE (+)
                       AND X.DEPTCODE = B.DEPTCODE(+)
                       AND 'SL90'     = C.CMMCODE (+)
                       AND X.PARTDIV  = C.DIVCODE (+)
                  GROUP BY X.PARTDIV, C.DIVNAME, X.DEPTCODE, B.DEPTNAME, A.GRADEDIV, X.EMPCODE, A.EMPNAME

          		 )
		]]>	
	
	<!-- 
		SELECT COUNT(DISTINCT(emp_no)) total_cnt,
			 SUM (sale_amt) AS total_sale_amt,
	         SUM (sale_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_local,
	         SUM (sale_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_01,
	         SUM (sale_amt_siljuk_in_02) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_02,
	         SUM (sale_amt_siljuk_in_03) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_03,
	         SUM (sale_amt_siljuk_in_04) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_04,
	         SUM (sale_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_in_05,
	         SUM (sale_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_out,
	         SUM (sale_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_byung,
	         SUM (sale_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk_mbyung,
	         (SUM (sale_amt_siljuk) + SUM (sale_amt_halins02)) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) AS total_sale_amt_siljuk,
	         SUM (in_amt) AS total_in_amt,
	         SUM (in_amt_siljuk_in) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS in_amt_siljuk_in,
	         SUM (in_amt_siljuk_in_local) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_local,
	         SUM (in_amt_siljuk_in_01) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_01,
	         SUM (in_amt_siljuk_in_05) * (NVL (#{as_siljukyul_in,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_in_05,
	         SUM (in_amt_siljuk_out) * (NVL (#{as_siljukyul_out,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_out_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_out,
	         SUM (in_amt_siljuk_byung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_byung,
	         SUM (in_amt_siljuk_mbyung) * (NVL (#{as_siljukyul_byung,jdbcType=VARCHAR}, 100) * 0.01) * (NVL (#{as_siljukyul_byung_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk_mbyung,
	         SUM (in_amt_siljuk) * (NVL (#{as_siljukyul_in_su,jdbcType=VARCHAR}, 100) * 0.01) AS total_in_amt_siljuk
		  FROM sale.salepart_batch2
		 WHERE SUBSTR (date_time, 1, 6) = #{as_date_time,jdbcType=VARCHAR}
	       AND part_cd LIKE NVL (#{as_part_cd,jdbcType=VARCHAR}, '%')
	       AND team_cd LIKE NVL (#{as_team_cd,jdbcType=VARCHAR}, '%')
	       AND emp_no LIKE NVL (#{as_emp_no,jdbcType=VARCHAR}, '%')
	       AND emp_nm NOT LIKE '%도매%'
		   AND emp_nm NOT LIKE '%기타%'
		   AND emp_nm NOT LIKE '%미지정%'
		   AND emp_nm NOT LIKE '%채권관리부%'
		   AND rpt_gb NOT IN ('08', '09', '10', '11', '12', '13')
		    -->
	</select>
	
</mapper>
	
