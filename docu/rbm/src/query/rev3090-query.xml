<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="REV3090(다면평가비밀번호초기화)">
    <query id="rev3090_s01" desc="비밀번호 초기화 대상자 조회" fetchSize="10">
      <![CDATA[
			SELECT /* rev3090_s01 */
			       '0' AS CHK
			      ,A.ESTM_YEAR
			      ,A.ESTM_NUM
			      ,A.DEPT_CD
			      ,(SELECT DEPT_NM FROM TBRF_EV_DEPT WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND DEPT_CD = A.ESTM_DEPT) AS DEPT_NM
			      ,A.EMP_NO
			      ,A.EMP_NM
			  FROM TBRF_EV_EMP A
			 WHERE 1=1
			   AND A.PWD_NO IS NOT NULL
			   AND A.PERM_TEMP_GBN = '002'
			   AND A.WRK_GBN       = '001'
			   AND A.ESTM_YEAR     = ?
			   AND A.ESTM_NUM      = ?
			   AND DECODE(?, '', '1', A.DEPT_CD) = DECODE(?, '', '1', ?)
			   AND A.EMP_NM LIKE '%' || NVL(?, '') || '%'
			   --AND A.ESTM_ESC_GBN = 'Y'
			   AND ROWNUM < 31
	      ORDER BY A.DEPT_CD, A.EMP_NO
        ]]>
    </query>
    
    <query id="rev3090_s02" desc="경주사업관리 초기화 대상자(투표소장) 조회" fetchSize="10">
      <![CDATA[
			SELECT /* rev3090_s02 */
			       '0' AS CHK
			      ,A.ESTM_YEAR
			      ,A.ESTM_NUM
			      ,A.DEPT_CD
			      ,(SELECT DEPT_NM FROM TBRF_EV_DEPT WHERE ESTM_YEAR = A.ESTM_YEAR AND ESTM_NUM = A.ESTM_NUM AND DEPT_CD = A.ESTM_DEPT) AS DEPT_NM
			      ,A.EMP_NO
			      ,A.EMP_NM
                  ,FC_DEC(RES_NO) AS RES_NO
			      ,'' AS PSWD
			  FROM TBRF_EV_EMP A
                  ,TBRK_USER B
			 WHERE 1=1
			   AND A.PERM_TEMP_GBN = '002'
			   AND A.EMP_NO        = B.USER_ID
			   AND B.GBN           = '003'
			   AND A.ESTM_YEAR     = ?
			   AND A.ESTM_NUM      = ?
			   AND A.ESTM_DEPT     = A.DEPT_CD
			   AND DECODE(?, '', '1', A.DEPT_CD) = DECODE(?, '', '1', ?)
			   AND A.EMP_NM LIKE '%' || NVL(?, '') || '%'
	      ORDER BY A.DEPT_CD, A.EMP_NO
        ]]>
    </query>
    
    <query id="rev3090_u01" desc="비밀번호 초기화" fetchSize="10">
      <![CDATA[
			UPDATE /* rev3090_u01 */
			   	   TBRF_EV_EMP
			   SET PWD_NO  = NULL
			      ,UPDT_ID = ?
			      ,UPDT_DT = SYSDATE
			 WHERE 1=1
			   AND ESTM_YEAR = ?
			   AND ESTM_NUM  = ?
			   AND WRK_GBN   = '001'
			   AND EMP_NO    = ?
        ]]>
    </query>
    
    <query id="rev3090_u02" desc="경주사업 비밀번호 초기화" fetchSize="10">
      <![CDATA[
			UPDATE /* rev3090_u02 */
			   	   TBRK_USER
			   SET PSWD = ?
			      ,UPDT_ID = ?
			      ,UPDT_DT = SYSDATE
			 WHERE 1=1
			   AND GBN     = '003'
			   AND USER_ID = ?
        ]]>
    </query>
</queryMap>