<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="rsy4030(회선  관리)">
    <query id="rsy4030_s01" desc="회선  조회" fetchSize="10">
      <![CDATA[
 			SELECT /* rsy4030_s01 */
				'0' AS CHK
				
				,SEQ		--연번
				,LINE_NO	--회선번호
				,SVR_NO		--서비스번호
				,LINE_COMP	--회선제공업체코드				
				,PROD_NM	--상품명
				
				,INSTALL_LOC	--설치위치
				,MANAGER	--관리자
				,IP_INFO	--IP정보
				,JOIN_DT	--가입일자
				,AMT		--요금
				
				,PAY_DEPT	--납부부서
				,USE		--용도
				,MEMO		--메모
				,COM_REG_NO	--사업자등록번호
				,DEL_YN     --삭제여부
				
				,INST_ID	--작성자
				,INST_DT	--작성일시
				,UPDT_ID	--수정자
				,UPDT_DT	--수정일시


			FROM  TBRK_LINE_MANA

			WHERE
			         NVL(DEL_YN,'N') = 'N'  
			     AND LINE_COMP LIKE  '%' || NVL(? , LINE_COMP) || '%'	
				 AND PROD_NM LIKE  '%' || NVL(? , PROD_NM) || '%'
			
        ]]>
    </query>       


    <query id="rsy4030_u01" desc=" 회선  입력/수정" fetchSize="10">

        <![CDATA[
            MERGE INTO TBRK_LINE_MANA  A /* rsy4030_u01 */
            USING   
                    (SELECT
                        
                         ? AS SEQ           --연번
                        ,? AS LINE_NO       --회선번호
                        ,? AS SVR_NO        --서비스번호
                        ,? AS LINE_COMP     --회선제공업체코드              
                        ,? AS PROD_NM       --상품명
                        
                        ,? AS INSTALL_LOC   --설치위치
                        ,? AS MANAGER       --관리자
                        ,? AS IP_INFO       --IP정보
                        ,? AS JOIN_DT       --가입일자
                        ,? AS AMT           --요금
                        
                        ,? AS PAY_DEPT      --납부부서
                        ,? AS USE           --용도
                        ,? AS MEMO          --메모
                        ,? AS COM_REG_NO    --사업자등록번호               
                        
                        ,? AS INST_ID       --작성자
                        ,? AS UPDT_ID       --수정자   
                    FROM    DUAL ) B  
                
            ON (    
                    A.SEQ = B.SEQ           -- 연번
            )           
            
            WHEN MATCHED THEN
                UPDATE SET
	                  A.LINE_NO        = B.LINE_NO       --회선번호         
	                 ,A.SVR_NO         = B.SVR_NO        --서비스번호       
	                 ,A.LINE_COMP      = B.LINE_COMP     --회선제공업체코드 
	                 ,A.PROD_NM        = B.PROD_NM       --상품명           
	                 ,A.INSTALL_LOC    = B.INSTALL_LOC   --설치위치       
	                   
	                 ,A.MANAGER        = B.MANAGER       --관리자           
	                 ,A.IP_INFO        = B.IP_INFO       --IP정보           
	                 ,A.JOIN_DT        = B.JOIN_DT       --가입일자         
	                 ,A.AMT            = B.AMT           --요금             
	                 ,A.PAY_DEPT       = B.PAY_DEPT      --납부부서      
	                    
	                 ,A.USE            = B.USE           --용도             
	                 ,A.MEMO           = B.MEMO          --메모             
	                 ,A.COM_REG_NO     = B.COM_REG_NO    --사업자등록번호       
	                 ,A.UPDT_ID        = B.UPDT_ID       --수정자               
	                 ,A.UPDT_DT        = SYSDATE       -- 수정일시                  
            WHEN NOT MATCHED THEN 
                INSERT (
					 A.SEQ            --연번
					,A.LINE_NO        --회선번호
					,A.SVR_NO         --서비스번호
					,A.LINE_COMP      --회선제공업체코드              
					,A.PROD_NM        --상품명
					
					,A.INSTALL_LOC    --설치위치
					,A.MANAGER        --관리자
					,A.IP_INFO        --IP정보
					,A.JOIN_DT        --가입일자
					,A.AMT            --요금
					
					,A.PAY_DEPT       --납부부서
					,A.USE            --용도
					,A.MEMO           --메모
					,A.COM_REG_NO     --사업자등록번호               
					,A.DEL_YN         --삭제여부
					
					,A.INST_ID        --작성자
					,A.INST_DT        --작성일시
                    
                ) VALUES (
                    ( SELECT
                                NVL(MAX(SEQ),0) + 1
                                FROM  TBRK_LINE_MANA                
                     )                --SEQ   ,연번  
                    ,B.LINE_NO        --회선번호
                    ,B.SVR_NO         --서비스번호
                    ,B.LINE_COMP      --회선제공업체코드              
                    ,B.PROD_NM        --상품명
                    
                    ,B.INSTALL_LOC    --설치위치
                    ,B.MANAGER        --관리자
                    ,B.IP_INFO        --IP정보
                    ,B.JOIN_DT        --가입일자
                    ,B.AMT            --요금
                    
                    ,B.PAY_DEPT       --납부부서
                    ,B.USE            --용도
                    ,B.MEMO           --메모
                    ,B.COM_REG_NO     --사업자등록번호               
                    ,'N'
                    
                    ,B.INST_ID        --작성자
                    ,SYSDATE        --작성일시
                )
                
       
        ]]>

    </query>    



    <query id="rsy4030_d01" desc="회선  삭제" fetchSize="10">

        <![CDATA[

			UPDATE  TBRK_LINE_MANA SET  /* rsy4030_d01 */	
                DEL_YN = 'Y'
			WHERE SEQ = ?

        ]]>

    </query>  


</queryMap>