<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="RSM3100(경정교차 일자별)">
	<query id="rsm3100_select01" desc="경정교차 일자별(SELECT 일별)" fetchSize="10">
        <![CDATA[
		      SELECT /* rsm3100_select01 */                                                                                     
					TO_CHAR(TO_DATE(B.RACE_DAY),'YYYY-MM-DD') AS RACE_DAY,    --일자
		]]>
    </query>
    <query id="rsm3100_select02" desc="경정교차 일자별(SELECT 월별)" fetchSize="10">
        <![CDATA[
		      SELECT /* rsm3100_select02 */
					SUBSTR(B.RACE_DAY,5,2) AS RACE_DAY,	-- 월별
		]]>
    </query>

    <query id="rsm3100_select03" desc="경정교차 일자별(SELECT)" fetchSize="10">
        <![CDATA[
        		/* rsm3100_select03 */	
			     NVL(SUM(CASE WHEN SELL_CD = '04' AND COMM_NO = '07' AND DIV_NO = '01' THEN A.DIV_TOTAL END),0)
			     + NVL(SUM(CASE WHEN SELL_CD = '04' AND COMM_NO = '07' AND DIV_NO = '02' THEN A.DIV_TOTAL END),0)
			     + NVL(SUM(CASE WHEN SELL_CD = '04' AND COMM_NO = '07' AND DIV_NO IN ('03','05') THEN A.DIV_TOTAL END),0)
			     + NVL(SUM(CASE WHEN SELL_CD = '02' AND COMM_NO = '07'  THEN A.DIV_TOTAL END),0) AS DIV_TOTAL, -- 매출총계
			     NVL(SUM(CASE WHEN SELL_CD = '04' AND COMM_NO = '07' AND DIV_NO = '01' THEN A.DIV_TOTAL END),0) JANG01,	-- 광복    
			     NVL(SUM(CASE WHEN SELL_CD = '04' AND COMM_NO = '07' AND DIV_NO = '02' THEN A.DIV_TOTAL END),0) JANG02,	-- 서면 
			     NVL(SUM(CASE WHEN SELL_CD = '04' AND COMM_NO = '07' AND DIV_NO IN ('03','05') THEN A.DIV_TOTAL END),0) JANG04, -- 부산본장   
			     NVL(SUM(CASE WHEN SELL_CD = '02' AND COMM_NO = '07' AND DIV_NO = '02' THEN A.DIV_TOTAL END),0) JANG03, --김해 
			     NVL(SUM(CASE WHEN SELL_CD = '02' AND COMM_NO = '07' AND DIV_NO = '01' THEN A.DIV_TOTAL END),0) JANG05  --창원본장
		]]>
    </query>

    <query id="rsm3100_select04" desc="경정교차 일자별(SELECT)" fetchSize="10">
        <![CDATA[
             /* rsm3100_select04 */
			 FROM VW_SDL_DT A,VW_SDL_INFO B       -- 경정교차                                                                           
		]]>
    </query>

    <query id="rsm3100_select04Today" desc="경정교차 일자별(SELECT)" fetchSize="10">
        <![CDATA[
        	 /* rsm3100_select04Today */				
			 FROM TBES_SDL_DT A,VW_SDL_INFO B       -- 경정교차                                                                           
		]]>
    </query>

    <query id="rsm3100_select05" desc="경정교차 일자별(SELECT)" fetchSize="10">
        <![CDATA[
        	 /* rsm3100_select05 */
			 WHERE 1 = 1
			 	 AND A.MEET_CD = B.MEET_CD			                                                                                             
			 	 AND A.STND_YEAR = B.STND_YEAR
			 	 AND A.TMS = B.TMS
			 	 AND A.DAY_ORD = B.DAY_ORD
			 	 AND A.SELL_CD IN ('02','04')
			     AND A.MEET_CD = '003'                                                                              
			     AND B.RACE_DAY >= ?     -- 기간 시작일                                                                
			     AND B.RACE_DAY <= ?     -- 기간 종료일                                                               
			     AND A.STND_YEAR = SUBSTR(?,1,4) -- 기간 시작일
		]]>
    </query>

    <query id="rsm3100_groupby01" desc="경정교차 일자별(GROUPBY 일별)" fetchSize="10">
        <![CDATA[			                                                                  
				GROUP BY A.MEET_CD, A.STND_YEAR
				, B.RACE_DAY
				-- , ROLLUP(B.RACE_DAY) -- 최종 레코드의  TOTAL, SUM 생성용                                                    
			     ORDER BY B.RACE_DAY
        ]]>
    </query>
    
    <query id="rsm3100_groupby02" desc="경정교차 일자별(GROUPBY 월별)" fetchSize="10">
        <![CDATA[			                                                                  
				GROUP BY A.MEET_CD, A.STND_YEAR
				     , SUBSTR(B.RACE_DAY,5,2)
				    -- , ROLLUP(SUBSTR(B.RACE_DAY,5,2))	-- 최종 레코드의  TOTAL, SUM 생성용                                                    
     				ORDER BY SUBSTR(B.RACE_DAY,5,2)
        ]]>
    </query>
    
    

    
</queryMap>