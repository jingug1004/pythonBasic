<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="rsy4020(인프라장비 관리)">
    <query id="rsy4020_s01" desc="인프라장비  조회" fetchSize="10">
      <![CDATA[
 			SELECT /* rsy4020_s01 */
				'0' AS CHK
				,DIST_NO	-- 고유번호              
				,TPE_1		-- 대분류                
				,TPE_2		-- 중분류                
				,EQUIP_NM	-- 장비명                
				,EQUIP_ID	-- 장비ID   
				
				,INSTALL_LOC	-- 설치위치              
				,DTL_LOC	-- 세부위치              
				,ADOPT_DT	-- 도입일자              
				,PRHS_AMT	-- 구입금액              
				,MODEL_NM	-- 모델명  
				
				,DTL_SPEC	-- 세부사양              
				,CPU		-- CPU                   
				,Memory		-- memory                
				,HDD		-- HDD                   
				,OS_TYP		-- OSType
				
				,OS			-- OS                    
				,IN_IP		-- 내부IP                
				,OUT_IP		-- 외부IP                
				,ETC_IP		-- 기타IP                
				,CONN_TYP	-- 접속형태 
				
				,CONSOLE_ID		-- 콘솔유저              
				,CONSOLE_PSWD	-- 콘솔암호              
				,WEB_ID			-- 웹접근유저            
				,WEB_PSWD		-- 웹접근암호            
				,EQUIP_STR_WAY	-- 장비시작방법  
				
				,EQUIP_END_WAY	-- 장비종료방법          
				,MAINT_MNG		-- 유지보수담당자        
				,MAINT_MNG_TEL  -- 유지보수담당자연락처  
				,ETC			-- 기타 
				,DEL_YN         -- 삭제여부                 
				,INST_ID		-- 작성자                
				,INST_DT		-- 작성일시   
				
				,UPDT_ID		-- 수정자                
				,UPDT_DT		-- 수정일시              
	

			FROM  TBRK_INFRA_EQUIP

			WHERE  NVL(DEL_YN,'N') = 'N' 
			    AND TPE_1 LIKE  '%' || NVL(? , TPE_1) || '%'	
				AND TPE_2 LIKE  '%' || NVL(? , TPE_2) || '%'
				AND EQUIP_NM LIKE  '%' || NVL(? , EQUIP_NM) || '%'
			
        ]]>
    </query>       

        
    <query id="rsy4020_u01" desc="인프라장비  입력" fetchSize="10">
	   <![CDATA[
	   
	        MERGE INTO TBRK_INFRA_EQUIP A  /* rsy4020_u01 */
            USING   
                    (SELECT
						 ? AS DIST_NO       -- 고유번호
						,? AS TPE_1         -- 대분류
						,? AS TPE_2         -- 중분류
						,? AS EQUIP_NM      -- 장비명
						,? AS EQUIP_ID      -- 장비ID
						
						,? AS INSTALL_LOC   -- 설치위치
						,? AS DTL_LOC       -- 세부위치
						,? AS ADOPT_DT      -- 도입일자
						,? AS PRHS_AMT      -- 구입금액
						,? AS MODEL_NM      -- 모델명
						
						,? AS DTL_SPEC      -- 세부사양
						,? AS CPU           -- CPU
						,? AS Memory        -- memory
						,? AS HDD           -- HDD
						,? AS OS_TYP        -- OSType
						
						,? AS OS            -- OS
						,? AS IN_IP         -- 내부IP
						,? AS OUT_IP        -- 외부IP
						,? AS ETC_IP        -- 기타IP
						,? AS CONN_TYP      -- 접속형태
						
						,? AS CONSOLE_ID    -- 콘솔유저
						,? AS CONSOLE_PSWD  -- 콘솔암호
						,? AS WEB_ID        -- 웹접근유저
						,? AS WEB_PSWD      -- 웹접근암호
						,? AS EQUIP_STR_WAY -- 장비시작방법
						
						,? AS EQUIP_END_WAY -- 장비종료방법
						,? AS MAINT_MNG     -- 유지보수담당자
						,? AS MAINT_MNG_TEL -- 유지보수담당자연락처
						,? AS ETC           -- 기타
						,? AS INST_ID       -- 작성자
						,? AS UPDT_ID       -- 수정자
       
                    FROM    DUAL ) B  
                
            ON (    
                    A.DIST_NO = B.DIST_NO    -- 고유번호       
            )           
            
            WHEN MATCHED THEN
                UPDATE SET                            
                      A.TPE_1          =  B.TPE_1          -- 대분류                
                     ,A.TPE_2          =  B.TPE_2          -- 중분류                
                     ,A.EQUIP_NM       =  B.EQUIP_NM       -- 장비명                
                     ,A.EQUIP_ID       =  B.EQUIP_ID       -- 장비ID                
                     ,A.INSTALL_LOC    =  B.INSTALL_LOC    -- 설치위치
                                                             
                     ,A.DTL_LOC        =  B.DTL_LOC        -- 세부위치              
                     ,A.ADOPT_DT       =  B.ADOPT_DT       -- 도입일자              
                     ,A.PRHS_AMT       =  B.PRHS_AMT       -- 구입금액              
                     ,A.MODEL_NM       =  B.MODEL_NM       -- 모델명                
                     ,A.DTL_SPEC       =  B.DTL_SPEC       -- 세부사양     
                                                             
                     ,A.CPU            =  B.CPU            -- CPU                   
                     ,A.Memory         =  B.Memory         -- memory                
                     ,A.HDD            =  B.HDD            -- HDD                   
                     ,A.OS_TYP         =  B.OS_TYP         -- OSType                
                     ,A.OS             =  B.OS             -- OS       
                                                             
                     ,A.IN_IP          =  B.IN_IP          -- 내부IP                
                     ,A.OUT_IP         =  B.OUT_IP         -- 외부IP                
                     ,A.ETC_IP         =  B.ETC_IP         -- 기타IP                
                     ,A.CONN_TYP       =  B.CONN_TYP       -- 접속형태              
                     ,A.CONSOLE_ID     =  B.CONSOLE_ID     -- 콘솔유저 
                                                             
                     ,A.CONSOLE_PSWD   =  B.CONSOLE_PSWD   -- 콘솔암호              
                     ,A.WEB_ID         =  B.WEB_ID         -- 웹접근유저            
                     ,A.WEB_PSWD       =  B.WEB_PSWD       -- 웹접근암호            
                     ,A.EQUIP_STR_WAY  =  B.EQUIP_STR_WAY  -- 장비시작방법          
                     ,A.EQUIP_END_WAY  =  B.EQUIP_END_WAY  -- 장비종료방법   
  
                     ,A.MAINT_MNG      =  B.MAINT_MNG      -- 유지보수담당자        
                     ,A.MAINT_MNG_TEL  =  B.MAINT_MNG_TEL  -- 유지보수담당자연락처  
                     ,A.ETC            =  B.ETC            -- 기타                  
                     ,A.UPDT_ID        =  B.UPDT_ID        -- 수정자                      
                     ,A.UPDT_DT        =  SYSDATE           -- 수정일시
                
            WHEN NOT MATCHED THEN 
                
                INSERT (
            
					 A.DIST_NO    -- 고유번호
					,A.TPE_1      -- 대분류
					,A.TPE_2      -- 중분류
					,A.EQUIP_NM   -- 장비명
					,A.EQUIP_ID   -- 장비ID
					
					,A.INSTALL_LOC    -- 설치위치
					,A.DTL_LOC    -- 세부위치
					,A.ADOPT_DT   -- 도입일자
					,A.PRHS_AMT   -- 구입금액
					,A.MODEL_NM   -- 모델명
					
					,A.DTL_SPEC   -- 세부사양
					,A.CPU        -- CPU
					,A.Memory     -- memory
					,A.HDD        -- HDD
					,A.OS_TYP     -- OSType
					
					,A.OS         -- OS
					,A.IN_IP      -- 내부IP
					,A.OUT_IP     -- 외부IP
					,A.ETC_IP     -- 기타IP
					,A.CONN_TYP   -- 접속형태
					
					,A.CONSOLE_ID     -- 콘솔유저
					,A.CONSOLE_PSWD   -- 콘솔암호
					,A.WEB_ID         -- 웹접근유저
					,A.WEB_PSWD       -- 웹접근암호
					,A.EQUIP_STR_WAY  -- 장비시작방법
					
					,A.EQUIP_END_WAY  -- 장비종료방법
					,A.MAINT_MNG      -- 유지보수담당자
					,A.MAINT_MNG_TEL  -- 유지보수담당자연락처
					,A.ETC            -- 기타
					,A.DEL_YN         -- 삭제여부
					,A.INST_ID        -- 작성자
					,A.INST_DT        -- 작성일시
                    
                ) VALUES (
                        ( SELECT
                                NVL(MAX(DIST_NO),0) + 1
                                FROM  TBRK_INFRA_EQUIP              
                        )                   -- DIST_NO   ,고유번호           
	                    ,B.TPE_1           -- 대분류
	                    ,B.TPE_2           -- 중분류
	                    ,B.EQUIP_NM        -- 장비명
	                    ,B.EQUIP_ID        -- 장비ID
	                    
	                    ,B.INSTALL_LOC     -- 설치위치
	                    ,B.DTL_LOC         -- 세부위치
	                    ,B.ADOPT_DT        -- 도입일자
	                    ,B.PRHS_AMT        -- 구입금액
	                    ,B.MODEL_NM        -- 모델명
	                    
	                    ,B.DTL_SPEC        -- 세부사양
	                    ,B.CPU             -- CPU
	                    ,B.Memory          -- memory
	                    ,B.HDD             -- HDD
	                    ,B.OS_TYP          -- OSType
	                    
	                    ,B.OS              -- OS
	                    ,B.IN_IP           -- 내부IP
	                    ,B.OUT_IP          -- 외부IP
	                    ,B.ETC_IP          -- 기타IP
	                    ,B.CONN_TYP        -- 접속형태
	                    
	                    ,B.CONSOLE_ID      -- 콘솔유저
	                    ,B.CONSOLE_PSWD    -- 콘솔암호
	                    ,B.WEB_ID          -- 웹접근유저
	                    ,B.WEB_PSWD        -- 웹접근암호
	                    ,B.EQUIP_STR_WAY   -- 장비시작방법
	                    
	                    ,B.EQUIP_END_WAY   -- 장비종료방법
	                    ,B.MAINT_MNG       -- 유지보수담당자
	                    ,B.MAINT_MNG_TEL   -- 유지보수담당자연락처
	                    ,B.ETC             -- 기타
	                    ,'N'               -- 삭제여부
	                    ,B.INST_ID         -- 작성자 
                        ,SYSDATE           -- INST_DT
                )
                
     
			
        ]]>


    </query> 

    <query id="rsy4020_d01" desc="인프라장비  삭제" fetchSize="10">

        <![CDATA[

			UPDATE TBRK_INFRA_EQUIP SET  /* rsy4020_d01 */	
                    DEL_YN = 'Y'
			WHERE DIST_NO = ?

        ]]>

  </query>  



   <query id="rsy4020_s02" desc="인프라장비 SW 조회" fetchSize="10">
      <![CDATA[
 			SELECT /* rsy4020_s02 */
				'0' AS CHK				
				,A.DIST_NO		-- 고유번호
				,A.SW_DIST_NO	-- SW고유번호
				,A.RMK			-- 기타
				
				,A.INST_ID		-- 작성자                
				,A.INST_DT		-- 작성일시   
				
				,A.UPDT_ID		-- 수정자                
				,A.UPDT_DT		-- 수정일시 
		
				,B.DEV_COMP		-- 개발업체 
				,B.GOOD_NM		-- 제품명
				,B.VER_INFO		-- 버젼정보 
				,B.SW_NM        -- SW명
			FROM  TBRK_INFRA_MAPP A, TBRK_INFRA_SW B
			
			WHERE A.SW_DIST_NO = B.SW_DIST_NO(+)
				AND A.DIST_NO = ?
			
        ]]>
    </query>       
    
    
    
    <query id="rsy4020_u02" desc="인프라장비 SW  입력" fetchSize="10">

            MERGE INTO TBRK_INFRA_MAPP A  /* rbr1012_u01 */
            USING   
                    (SELECT
                         ? AS DIST_NO        -- 고유번호              
                        ,? AS SW_DIST_NO     -- SW고유번호                
                        ,? AS RMK            -- 기타                  
                        ,? AS INST_ID        -- 작성자
                        ,? AS UPDT_ID        -- 수정자                
                    FROM    DUAL ) B  
                
            ON (    
                     A.DIST_NO = B.DIST_NO              -- 고유번호 
                     AND A.SW_DIST_NO = B.SW_DIST_NO    -- SW고유번호   
            )           
            
            WHEN MATCHED THEN
                UPDATE SET                   
                      A.RMK               = B.RMK       -- 기타                  
                     ,A.UPDT_ID           = B.UPDT_ID   -- 수정자                        
                     ,A.UPDT_DT           = SYSDATE     -- 수정일시             
            WHEN NOT MATCHED THEN 
                
                INSERT (
                         A.DIST_NO        -- 고유번호              
                        ,A.SW_DIST_NO     -- SW고유번호                
                        ,A.RMK            -- 기타                  
                        ,A.INST_ID        -- 작성자                
                        ,A.INST_DT        -- 작성일시    
                    
                ) VALUES (
                         B.DIST_NO        -- 고유번호              
                        ,B.SW_DIST_NO     -- SW고유번호                
                        ,B.RMK            -- 기타                  
                        ,B.INST_ID        -- 작성자                
                        ,SYSDATE          -- 작성일시    
                )
                
        
    </query> 

    <query id="rsy4020_d02" desc="인프라장비 SW  삭제" fetchSize="10">

        <![CDATA[

			DELETE TBRK_INFRA_MAPP   /* rsy4020_d02 */	

			WHERE DIST_NO = ?
				AND  SW_DIST_NO = ?

        ]]>

  </query>  
</queryMap>