<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="rem4040(수동전송주기 관리 )">
  
    <query id="rem4040_s01" desc="수동전송주기  조회" fetchSize="10">
      <![CDATA[
            SELECT /* rem4040_s01 */
		            '0' AS CHK
                   ,TRAN_DT
                   ,TERM/1000 AS TERM
                   ,START_TM
                   ,END_TM
                   ,RMK
            FROM  TBIF_PERIOD --@TMONEY_LINK
            WHERE TRAN_DT BETWEEN ? AND ?
            ORDER BY TRAN_DT
        ]]>
    </query> 
    
    <query id="rem4040_d01" desc="수동전송주기  삭제" fetchSize="10">
      <![CDATA[
            DELETE /* rem4040_d01 */
		           FROM TBIF_PERIOD --@TMONEY_LINK
            WHERE TRAN_DT = ?
        ]]>
    </query> 
    
    <query id="rem4040_m01" desc="수동전송주기  수정" fetchSize="10">
      <![CDATA[
            MERGE /* rem4040_m01 */
		          INTO TMONEY.TBIF_PERIOD DST --@TMONEY_LINK DST
            USING (
                   SELECT ? AS TRAN_DT
                         ,? * 1000 AS TERM
                         ,? AS START_TM
                         ,? AS END_TM
                         ,? AS RMK
                         ,? AS USER_ID
                   FROM DUAL
                   ) SRC
             ON (
                  DST.TRAN_DT = SRC.TRAN_DT
                 )
             WHEN MATCHED THEN
                  UPDATE SET
                  			 DST.TERM     = SRC.TERM
                  			,DST.START_TM = SRC.START_TM
                  			,DST.END_TM   = SRC.END_TM
                  			,DST.RMK      = SRC.RMK
                  			,DST.UPDT_ID  = SRC.USER_ID
                  			,DST.UPDT_DTM = SYSDATE
             WHEN NOT MATCHED THEN
                  INSERT (
                  		   TRAN_DT
                  		  ,TERM
                  		  ,START_TM
                  		  ,END_TM
                  		  ,RMK
                  		  ,UPDT_ID
                  		  ,UPDT_DTM
                  ) VALUES (
                  		   SRC.TRAN_DT
                  		  ,SRC.TERM
                  		  ,SRC.START_TM
                  		  ,SRC.END_TM
                  		  ,SRC.RMK
                  		  ,SRC.USER_ID
                  		  ,SYSDATE
                  )
        ]]>
    </query> 
    
</queryMap>