<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="rsm6080(지불정지건수 조회)">
    
    <query id="rsm6080_s01" desc="rsm6080(지불정지건수 조회" fetchSize="10">
      <![CDATA[
          SELECT    /* rsm6080_s01 */
			        TIC_TYPE_CD
		           ,'경륜' AS MEET_NM
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '01' THEN 1 ELSE 0 END) AS mm_01
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '02' THEN 1 ELSE 0 END) AS mm_02
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '03' THEN 1 ELSE 0 END) AS mm_03
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '04' THEN 1 ELSE 0 END) AS mm_04
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '05' THEN 1 ELSE 0 END) AS mm_05
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '06' THEN 1 ELSE 0 END) AS mm_06
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '07' THEN 1 ELSE 0 END) AS mm_07
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '08' THEN 1 ELSE 0 END) AS mm_08
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '09' THEN 1 ELSE 0 END) AS mm_09
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '10' THEN 1 ELSE 0 END) AS mm_10
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '11' THEN 1 ELSE 0 END) AS mm_11
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '12' THEN 1 ELSE 0 END) AS mm_12
                   ,COUNT(*) AS TOT_CNT
		FROM     TBRD_STOPPAY_CNCL_CNTNT A,
		         VW_SDL_INFO B
		WHERE    STOPPAY_DT LIKE ?||'%'
		AND      A.PUBL_DT = B.RACE_DAY
		AND      B.MEET_CD  = '001'
		GROUP BY TIC_TYPE_CD
		UNION ALL
		SELECT     TIC_TYPE_CD
		           ,'경정'
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '01' THEN 1 ELSE 0 END) AS mm_01
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '02' THEN 1 ELSE 0 END) AS mm_02
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '03' THEN 1 ELSE 0 END) AS mm_03
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '04' THEN 1 ELSE 0 END) AS mm_04
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '05' THEN 1 ELSE 0 END) AS mm_05
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '06' THEN 1 ELSE 0 END) AS mm_06
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '07' THEN 1 ELSE 0 END) AS mm_07
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '08' THEN 1 ELSE 0 END) AS mm_08
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '09' THEN 1 ELSE 0 END) AS mm_09
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '10' THEN 1 ELSE 0 END) AS mm_10
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '11' THEN 1 ELSE 0 END) AS mm_11
		           ,SUM(CASE WHEN SUBSTR(STOPPAY_DT,5,2) = '12' THEN 1 ELSE 0 END) AS mm_12
                   ,COUNT(*) AS TOT_CNT
		FROM     TBRD_STOPPAY_CNCL_CNTNT A,
		         VW_SDL_INFO B
		WHERE    STOPPAY_DT LIKE ?||'%'
		AND      A.PUBL_DT = B.RACE_DAY
		AND      B.MEET_CD  = '003'
		GROUP BY TIC_TYPE_CD
		ORDER BY 1,2
		]]>
   </query>


</queryMap>