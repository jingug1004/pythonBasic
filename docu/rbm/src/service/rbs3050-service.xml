<?xml version="1.0" encoding="EUC-KR"?>

<service name="rbs3050" initial="SetResultKeys">

  <activity name="SetResultKeys"            class="com.posdata.glue.miplatform.biz.activity.PosSetResultKeyList">  
    <property name="staticResultKeyFile"    value="resultkey.properties" />
    <property name="resultKeyList"          value="dsOrderHist|dsSupplHistPop" />
    <transition name="success"              value="EventRouter" />
  </activity>

  <activity name="EventRouter"              class="com.posdata.glue.biz.activity.PosDefaultRouter">
    <transition name="searchOrderHist"      value="searchOrderHist" />     <!-- 소모품 주문 이력 조회 -->
    <transition name="searchOrderConts"     value="searchOrderConts" />    <!-- 주문 세부내역 조회 -->
    <transition name="saveSupplOrder"     	value="saveSupplOrder" />    <!-- 주문 내역 저장  -->
    <transition name="GatherRequest"     	value="GatherRequest" />    <!-- 주문 내역 저장  -->
  </activity>
  
  <!-- 주문이력 조회 -->
  <activity name="searchOrderHist"      class="com.posdata.glue.miplatform.biz.activity.PosSearch">
    <transition name="success"          value="end" />    
    <property name="resultkey"          value="dsOrderHist" />
    <property name="sqlkey"             value="rbs3050_s01" />
    <property name="param-count"        value="3" />    
    <property name="param0"             value="PRHS_DT_FROM" />   <!-- 구매일자From -->
    <property name="param1"             value="PRHS_DT_TO" />     <!-- 구매일자To -->
    <property name="param2"             value="BIZ_GBN" />        <!-- 소모품 분류  -->    
    <property name="dao"                value="rbmdao" />
  </activity>
  
  
  <!-- 주문 세부내역 조회 -->
  <activity name="searchOrderConts"      class="com.posdata.glue.miplatform.biz.activity.PosSearch">
    <transition name="success"          value="end" />    
    <property name="resultkey"          value="dsSupplHistPop" />
    <property name="sqlkey"             value="rbs3050_s02" />
    <property name="param-count"        value="2" />    
    <property name="param0"             value="PRHS_DT" />  		<!-- 주문일자-->
    <property name="param1"             value="BIZ_GBN" />        	<!-- 소모품 분류  -->    
    <property name="dao"                value="rbmdao" />
  </activity>
  
  
  <!-- 주문 내역 저장 -->
  <activity name="saveSupplOrder" 			class="snis.rbm.business.rbs3010.activity.SaveSupplStk">
    <transition name="success" 				value="searchOrderHist" />
  </activity>
  
  <!-- 요청자료 취합  -->
  <activity name="GatherRequest"      class="com.posdata.glue.miplatform.biz.activity.PosSearch">
    <transition name="success"          value="end" />    
    <property name="resultkey"          value="dsSupplHistPop" />
    <property name="sqlkey"             value="rbs3050_s03" />
    <property name="param-count"        value="3" />    
    <property name="param0"             value="PRHS_DT_FROM" />   <!-- 구매일자From -->
    <property name="param1"             value="PRHS_DT_TO" />     <!-- 구매일자To -->
    <property name="param2"             value="BIZ_GBN" />        <!-- 소모품 분류  -->    
    <property name="dao"                value="rbmdao" />
  </activity>
  
  <transaction-manager id="tx_rbm" commit="true" /> 
</service>