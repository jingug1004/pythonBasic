<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="REV1010" Left="8" OnLoadCompleted="fcFormLoadSetting" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="휴양소&#32;관리" Top="8" Ver="1.0" Width="816" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsRstMaster" OnColumnChanged="fcDsOnColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_STR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_END_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_STR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_END_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRsvYear">
				<Contents>
					<colinfo id="RSV_YEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>사업상태코드</DESCRIPTION>
						<DSNAME>dsRsvYear</DSNAME>
						<QUERY_ID>rev1010_yearCombo</QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusWk">
				<Contents>
					<colinfo id="RSV_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JJOB" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusAtt">
				<Contents>
					<colinfo id="ATT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusDate">
				<Contents>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsVenusDept">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPPER_DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_RANK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LVL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsWorkEmp">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WRK_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RES_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="PWD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ESC_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MULT_ESTM_GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_WK_JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_EMP" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="MNR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="SVR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="PERM_TEMP_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_WRK_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDept">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRegEmp">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WRK_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RES_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="PWD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_JOB_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="APT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_TIT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_ESC_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="FST_SND_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MULT_ESTM_GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_WK_JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="ESTM_EMP" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="MNR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="SVR_FST_SND" size="256" summ="default" type="STRING"/>
					<colinfo id="PERM_TEMP_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_WRK_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDwComm">
				<Contents>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="TELLER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsDwTelmp">
				<Contents>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TELLER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SOLD_AVG" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_DAY_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCnt">
				<Contents>
					<colinfo id="DEL_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsUploadFile">
				<Contents>
					<colinfo id="CLS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_URL" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="CONTENT" size="256" summ="default" type="BLOB"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="5" summ="default" type="INT"/>
					<colinfo id="SEQ" size="5" summ="default" type="INT"/>
					<colinfo id="TBL_NM" size="50" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="100" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="100" summ="default" type="STRING"/>
					<colinfo id="REAL_FILE_NM" size="200" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInUploadFile">
				<Contents>
					<colinfo id="CLS_CD" size="256" type="STRING"/>
					<colinfo id="SEQ_NO" size="256" type="STRING"/>
					<colinfo id="FILE_SEQ" size="256" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" type="STRING"/>
					<colinfo id="FILE_URL" size="256" type="STRING"/>
					<colinfo id="FILE_SIZE" size="256" type="STRING"/>
					<colinfo id="INST_ID" size="256" type="STRING"/>
					<colinfo id="INST_DTM" size="256" type="STRING"/>
					<colinfo id="UPDT_ID" size="256" type="STRING"/>
					<colinfo id="UPDT_DTM" size="256" type="STRING"/>
					<colinfo encrypt="base64" id="CONTENT" size="256" type="BLOB"/>
					<colinfo id="CHK" size="256" type="STRING"/>
					<colinfo id="PROG_BAR" size="256" type="STRING"/>
					<colinfo id="MAKE_MAN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFileMana">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FILE_KEY" size="5" summ="default" type="INT"/>
					<colinfo id="SEQ" size="5" summ="default" type="INT"/>
					<colinfo id="TBL_NM" size="50" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="100" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="100" summ="default" type="STRING"/>
					<colinfo id="REAL_FILE_NM" size="200" summ="default" type="STRING"/>
					<colinfo id="FILE_SIZE" size="10" summ="default" type="INT"/>
					<colinfo id="INST_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPcDiv">
				<Contents>
					<colinfo id="RSV_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SELL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="COMM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRsvTms"></Dataset>
			<Dataset DataSetType="Dataset" Id="dsAskInfo" OnColumnChanged="fcDsOnColumnChanged" OnRowPosChanged="fcDsOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_STR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RSV_END_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_STR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ASK_END_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsRstMasterInfo"></Dataset>
		</Datasets>
		<Div Height="28" Id="divBtnLst" Left="442" TabOrder="1" Text="Div0" Url="common::comButtonType.xml" Width="370">
			<Contents></Contents>
		</Div>
		<Static Font="굴림,9,Bold" Height="86" Id="Static0" Left="8" TabOrder="10" Top="154" Type="Groupbox" Width="800"></Static>
		<Image Height="20" Id="imgFormTitle" ImageID="m_titleblet" Left="8" TabOrder="3" Width="17"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsAskInfo" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="130" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="86" Id="grdAskInfo" InputPanel="FALSE" Left="8" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="809" SelColor="user19" Style="snis_grid" TabOrder="9" TabStop="true" Top="44" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="801">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="59"/>
						<col width="82"/>
						<col width="151"/>
						<col width="151"/>
						<col width="224"/>
					</columns>
					<head>
						<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="√"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="이용년도"/>
						<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="이용회차"/>
						<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="신청&#32;시작일"/>
						<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="신청&#32;종료일"/>
						<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="비고"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="RSV_YEAR" display="text"/>
						<cell align="center" col="2" colid="RSV_TMS" display="text"/>
						<cell align="center" col="3" colid="ASK_STR_DT" display="date"/>
						<cell align="center" col="4" colid="ASK_END_DT" display="date"/>
						<cell align="center" col="5" colid="RMK" display="text" multiline="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Border="Flat" Height="21" Id="Static4" Left="216" Style="snis_m_lable" TabOrder="11" Text="차수" Top="164" VAlign="Middle" Width="80"></Static>
		<Static Font="굴림,10,Bold" Height="22" Id="stFormTitle" Left="24" Style="snis_m_title" TabOrder="12" Text="휴양소&#32;관리" VAlign="Middle" Width="430"></Static>
		<Image Height="20" Id="Image0" ImageID="m_titleblet2" Left="11" TabOrder="13" Top="140" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="Static3" Left="32" Style="snis_m_title" TabOrder="14" Text="신청정보" Top="138" VAlign="Middle" Width="118"></Static>
		<Div Height="20" Id="revBtnRow" Left="769" Style="snis_grid" TabOrder="15" Text="Div0" ToolTipText="그룹코드" Top="22" Url="common::comButtonRow.xml" Width="40">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Border="Flat" Height="21" Id="Static6" Left="16" Style="snis_m_lable" TabOrder="16" Text="이용년도" Top="166" VAlign="Middle" Width="80"></Static>
		<Image Height="20" Id="Image1" ImageID="m_titleblet2" Left="499" TabOrder="17" Top="258" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="Static7" Left="520" Style="snis_m_title" TabOrder="18" Text="파일첨부" Top="256" VAlign="Middle" Width="118"></Static>
		<Static Align="Right" Border="Flat" Height="21" Id="Static8" Left="516" Style="snis_m_lable" TabOrder="19" Text="신청기간" Top="164" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="dsAskInfo" Border="Flat" Column="ASK_STR_DT" Height="21" Id="calEscStrDt" Left="597" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="2" Top="164" Width="90"></Calendar>
		<Calendar BindDataset="dsAskInfo" Border="Flat" Column="ASK_END_DT" Height="21" Id="calEscEndDt" Left="712" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="3" Top="164" Width="90"></Calendar>
		<Static Align="Right" Border="Flat" Height="21" Id="Static9" Left="516" Style="snis_m_lable" TabOrder="20" Text="전체이용기간" Top="189" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="dsAskInfo" Border="Flat" Column="USE_STR_DT" Height="21" Id="calPrmStrDt" Left="597" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="0" Top="189" Width="90"></Calendar>
		<Calendar BindDataset="dsAskInfo" Border="Flat" Column="USE_END_DT" Height="21" Id="calPrmEndDt" Left="712" SaturdayTextColor="blue" Style="snis_if_input01" SundayTextColor="red" TabOrder="1" Top="189" Width="90"></Calendar>
		<Static Align="Center" Border="None" Color="user4" Height="20" Id="Static11" Left="693" Style="snis_m_stitle" TabOrder="21" Text="~" Top="189" VAlign="Middle" Width="10"></Static>
		<Static Align="Center" Border="None" Color="user4" Height="20" Id="Static12" Left="693" Style="snis_m_stitle" TabOrder="22" Text="~" Top="164" VAlign="Middle" Width="10"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsUploadFile" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="568" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="292" Id="grdUploadFile" InputPanel="FALSE" Left="496" LineColor="user18" MinWidth="100" OnCellDBLClick="fcGrdOnCellDBLClick" Right="809" SelColor="user19" Style="snis_grid" TabOrder="23" TabStop="true" Top="276" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="313">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="730"/>
					</columns>
					<head>
						<cell autosizing="keep" bkcolor="user20" col="0" color="user21" display="text" text="√"/>
						<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="첨부파일"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="FILE_NM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="20" Id="fileBtnRow" Left="769" Style="snis_grid" TabOrder="5" Text="Div0" Top="253" Url="common::comButtonRow.xml" Width="38">
			<Contents></Contents>
		</Div>
		<FileDialog Bottom="274" Height="24" Id="fdSaveAs" Left="720" Right="744" TabOrder="35" Top="250" Width="24"></FileDialog>
		<Button ButtonStyle="TRUE" Color="user0" Cursor="HAND" Font="굴림,9,Bold" Height="24" Id="btnRstCrate" ImageID="btn_ev_status" Left="360" OnClick="fcBtnOnClick" TabOrder="4" Text="세부내역생성" Top="272" Width="88"></Button>
		<Image Height="20" Id="Image2" ImageID="m_titleblet2" Left="11" TabOrder="24" Top="257" Width="17"></Image>
		<Static Font="굴림,10,Bold" Height="22" Id="Static13" Left="32" Style="snis_m_title" TabOrder="25" Text="휴양소&#32;내역" Top="256" VAlign="Middle" Width="118"></Static>
		<Tab Border="Flat" BorderColor="user3" Height="292" Id="Tab0" Left="4" OnChanged="fcTabOnChanged" TabOrder="26" Top="276" Width="490">
			<Contents>
				<TabPage BorderColor="black" Height="268" Id="tab1" ImageID="m_tab_06" Left="2" TabOrder="56" Text="휴양소&#32;목록" Top="22" Width="486">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsRstMasterInfo" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="266" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="264" Id="grdRstMasterInfo" InputPanel="FALSE" Left="2" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="483" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="2" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="481">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="88"/>
									<col width="52"/>
									<col width="81"/>
									<col width="70"/>
									<col width="53"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="√"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="휴양소명"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="객실수"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="시작일"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="종료일"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="숙박일수"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" colid="RST_NAME" display="text" edit="normal"/>
									<cell align="center" col="2" colid="RSV_MAX_NUM" display="number" edit="number"/>
									<cell align="center" col="3" colid="USE_STR_DT" display="date" edit="date"/>
									<cell align="center" col="4" colid="USE_END_DT" display="date" edit="date"/>
									<cell align="center" col="5" colid="DAY_NUM" display="number" edit="number"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="268" Id="tab2" ImageID="m_tab_06" Left="2" TabOrder="56" Text="기간별&#32;목록" Top="22" Width="486">
					<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="dsRstMaster" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="266" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="264" Id="Grid0" InputPanel="FALSE" Left="2" LineColor="user18" MinWidth="100" OnHeadClick="fcGridSort" Right="483" SelColor="user19" Style="snis_grid" TabOrder="1" TabStop="true" Top="2" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="481">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="36"/>
									<col width="113"/>
									<col width="52"/>
									<col width="81"/>
									<col width="70"/>
									<col width="53"/>
								</columns>
								<head>
									<cell bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="√"/>
									<cell bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="연번"/>
									<cell bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="휴양소명"/>
									<cell bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="객실수"/>
									<cell bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="시작일"/>
									<cell bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="종료일"/>
									<cell bkcolor="user20" col="6" color="user21" display="text" font="굴림,9,Bold" text="숙박일수"/>
								</head>
								<body>
									<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" col="1" colid="RST_SEQ" display="text"/>
									<cell align="center" col="2" colid="RST_NAME" display="text"/>
									<cell align="center" col="3" colid="RSV_MAX_NUM" display="number" edit="number"/>
									<cell align="center" col="4" colid="USE_STR_DT" display="date" edit="date"/>
									<cell align="center" col="5" colid="USE_END_DT" display="date" edit="date"/>
									<cell align="center" col="6" colid="DAY_NUM" display="number"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Static Align="Right" Border="Flat" Height="21" Id="Static2" Left="16" Style="snis_m_lable" TabOrder="27" Text="비고" Top="212" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="dsAskInfo" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="RMK" Height="21" Id="Edit0" Left="98" Style="snis_if_input01" TabOrder="28" Top="212" Width="702"></Edit>
		<Edit Align="CENTER" BindDataset="dsAskInfo" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="RSV_TMS" Height="21" Id="Edit1" Left="298" Number="TRUE" Readonly="TRUE" Style="snis_if_input01" TabOrder="29" Top="164" Width="90"></Edit>
		<Edit Align="CENTER" BindDataset="dsAskInfo" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="RSV_YEAR" Height="21" Id="Edit2" Left="98" Number="TRUE" Readonly="TRUE" Style="snis_if_input01" TabOrder="30" Top="166" Width="90"></Edit>
		<Static Align="Right" Border="Flat" Height="21" Id="Static1" Left="16" Style="snis_m_lable" TabOrder="31" Text="숙박일수" Top="189" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="dsAskInfo" Border="Flat" BorderColor="user6" CheckLength="Byte" Column="DAY_NUM" Height="21" Id="edEstmTms" Left="98" Number="TRUE" Style="snis_if_input01" TabOrder="32" Top="189" Width="90"></Edit>
		<Div Height="20" Id="RstBtnRow" Left="449" Style="snis_grid" TabOrder="33" Text="Div0" Top="276" Url="common::comButtonRow.xml" Width="38">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = this.GetForm().id;
var sBUTTONLIST   = "FFFFTFT";                         //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = "";                                //사용자별 프로그램 사용 권한
var sFORMCAPTION  = "";                                //Form의 Title 정보
var sFORMLOCATION = "";                                //Form의 Location 정보
var sUSERLAVEL    = "";                                //Form의 사용  Level
var vREVOBJ       = Array(9);                          //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                //그리드 제목
var sCUROBJ       ;                                    //현재 LOST FOCUS 오브젝트

var sMenuGrpNum     = "0";                             // 메뉴그룹의 갯수보관
var sMenuListNum    = "0";                             // 메뉴리스트의 갯수보관
var sMenuUpId       = "";
var sMenuUpNm       = "";

var sRsvYear = "";
var sRsvTms  = "";

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'FTTFFFT';
  
    //화면환경 설정
    sFORMCAPTION  = obj.Title;
    sFORMLOCATION = "";

    //화면 정보 Display 및 Button 권한 설정
    fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
    
    //공통코드 조회
    fcd_GetComboDs(dsInComCd);
        
	//현재년도 없을 시, 추가
	if( dsRsvYear.FindRow("RSV_YEAR", fcd_GetSysdate("YYYY")) == -1 ) {
		dsRsvYear.InsertRow(0);
		dsRsvYear.SetColumn(0, "RSV_YEAR", fcd_GetSysdate("YYYY"));
		cboSchYear.Index = 0;
	}
	
	//저장권한 없을 시, '기초자료생성' 버튼 비활성화'
	if( sInpt == "F") {
		btnEstmEnd.Enable = false;
	}

    fcSearch(obj);  //시작시 조회
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
    //자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
    var sDataset = "dsAskInfo|dsRstMasterInfo|dsRstMaster|dsUploadFile";
    if (!fnc_FormUnloadCheck(sDataset, sFormId)) return false;
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
	dsAskInfo.ClearData();
    dsRstMasterInfo.ClearData();  
    dsRstMaster.ClearData();  
    dsUploadFile.ClearData();
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
    fcInit(obj); 
    return true;
}

function fcSearch(obj) {
    fcSearchAskInfo(obj);
}

function fcSearchAskInfo(obj) {
    if ( !fcSearchCheck(obj) ) return;

    var sServiceName = "rbs8010-service:searchAskInfo";
    var sInDataSet   = "";
    var sOutDataSet  = "dsAskInfo=dsAskInfo";     
    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

function fcSearchMaster(RsvYear, RsvTms) {

    var sServiceName = "rbs8010-service:searchRstMaster";
    var sInDataSet   = "";
    var sOutDataSet  = "dsRstMasterInfo=dsRstMasterInfo dsRstMaster=dsRstMaster ";     
    
    //조회조건
    fcd_AddParam("RSV_YEAR", RsvYear); 
    fcd_AddParam("RSV_TMS", RsvTms); 
    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

//첨부파일 조회
function fcSearchFile(sAttFileKey){	
    var sServiceName = "common_file-service:searchFileMana";
    var sInDataSet   = "";
    var sOutDataSet  = "dsUploadFile=dsUploadFile ";
    
    //조회조건
    fcd_AddParam("ATT_FILE_KEY", sAttFileKey);
    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}
/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {  
    //변경된 자료가 있는지 체크
    if ( !fnc_DatasetChangeCheck(dsAskInfo) && 
         !fnc_DatasetChangeCheck(dsRstMaster) && 
         !fnc_DatasetChangeCheck(dsUploadFile)) {
        //저장 할 자료가 없음
        fnc_Message(SNIS_COM_1006, "N");    
        return false;
    }
    
    // 필수항목체크
    oDataSet          = dsRstMaster;
    sMandatoryColID   = "RSV_YEAR|RSV_TMS|USE_STR_DT|USE_END_DT|RSV_MAX_NUM|RST_NAME";
    sMandatoryColName = "이용년도|이용회차|이용시작일|이용종료일|예약가능인원|휴양소명|";
    oGrid             = grdRstMaster;
    if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
        return false;
    }
    
	for (var i = 0 ; i < dsAskInfo.GetRowCount() ; i++ ) {
		if(dsAskInfo.GetRowType(i) == "insert" ||dsAskInfo.GetRowType(i) == "update" ) {
			if (dsAskInfo.GetColumn(i, "USE_STR_DT") > dsAskInfo.GetColumn(i, "USE_END_DT")) {
			    fnc_message("이용기간이 잘못 되었습니다.", "N");
			    return false;
			} else if (dsAskInfo.GetColumn(i, "ASK_STR_DT") > dsAskInfo.GetColumn(i, "ASK_END_DT")) {
			    fnc_message("신청기간이 잘못 되었습니다.", "N");
			    return false;
			} else if (dsAskInfo.GetColumn(i, "ASK_END_DT") > dsAskInfo.GetColumn(i, "USE_STR_DT"))  {
			    fnc_message("신청기간과 이용기간이 잘못 되었습니다.", "N");
			    return false;
			}   
		}
	}
    
    return true;
}

function fcSave(obj) {

    if ( !fcSaveCheck() ) return;
       
    var sServiceName = "rbs8010-service:saveRstMaster";
    var sInDataSet   = "dsAskInfo=dsAskInfo:u dsRstMaster=dsRstMaster:u dsUploadFile=dsUploadFile:u ";
    var sOutDataSet  = "dsAskInfo=dsAskInfo";    
    
    //첨부파일 서버 업로드 
    if( dsUploadFile.GetRowCount() > 0 ) {
        for (var i = 0 ; i < dsUploadFile.GetRowCount() ; i++ ) {
            if(dsUploadFile.GetRowType(i) == "insert" ) {
                var rtn_arr = fnc_FileWrite(  divBtnLst.HttpFile 
                                            , dsUploadFile.GetColumn(i, "FILE_PATH" )
                                            , dsUploadFile.GetColumn(i, "FILE_NM" ) 
                                            ,"");
    
                var fileSize = divBtnLst.HttpFile.GetFileSizeLocal(dsUploadFile.GetColumn(i, "FILE_PATH" ));
                
                if ( rtn_arr[0] != "SUCC" ) {
                    fnc_Message(SNIS_COM_1050, "N", rtn_arr[1]);
                    return false;
                }
            
                dsUploadFile.SetColumn(i, "FILE_PATH", rtn_arr[1] );
                dsUploadFile.SetColumn(i, "FILE_SIZE", fileSize );
            } // end if
        }
    } // end        
    
    
    fcd_AddParam("RSV_YEAR", sRsvYear);   
    fcd_AddParam("RSV_TMS" , sRsvTms);    
    
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
    //화면 종료
    Close();    
}

/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
    //특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
    fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
    
    if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
          
}

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {
    //DataSet의 Header 정보가 있을 때  Add 처리  
    switch ( obj.GetForm().id ) {
        case "revBtnRow" :
            
            var RsvYear = substr(today(),0,4);
            dsAskInfo.FireEvent = false;
            dsAskInfo.filter("RSV_YEAR='"+ RsvYear+"'");
            var mRow = dsAskInfo.rowcount();
            var maxRsvTms = dsAskInfo.GetColumn(mRow -1, "RSV_TMS");            
            var newRsvTms = Right('0'+toString(toNumber(maxRsvTms) + 1),2);
            dsAskInfo.UnFilter();
            dsAskInfo.FireEvent = true;
                        
            var nRow = dsAskInfo.AddRow();
            dsAskInfo.SetColumn(nRow, "RSV_YEAR", RsvYear);
            dsAskInfo.SetColumn(nRow, "RSV_TMS", newRsvTms);

            break;
            
        case "RstBtnRow" :
        
			var RsvYear = dsAskInfo.GetColumn(dsAskInfo.row, "RSV_YEAR");
			var RsvTms  = dsAskInfo.GetColumn(dsAskInfo.row, "RSV_TMS");
			
            dsRstMasterInfo.FireEvent = false;
            var RstSeq = 0;
            for(var i=0;i<dsRstMasterInfo.rowcount();i++) {
				if (RstSeq < toNumber(substr(dsRstMasterInfo.GetColumn(i, "RST_ID"),6))) {
					RstSeq = toNumber(substr(dsRstMasterInfo.GetColumn(i, "RST_ID"),6));
				}
            }
            var RstId = RsvYear+RsvTms+Right('0'+toString(RstSeq + 1),2);
            dsRstMasterInfo.FireEvent = true;

			var nRow = dsRstMasterInfo.AddRow();
            dsRstMasterInfo.SetColumn(nRow, "RSV_YEAR", dsAskInfo.GetColumn(dsAskInfo.row, "RSV_YEAR"));
            dsRstMasterInfo.SetColumn(nRow, "RSV_TMS",  dsAskInfo.GetColumn(dsAskInfo.row, "RSV_TMS"));
            dsRstMasterInfo.SetColumn(nRow, "RST_ID",  RstId);	//휴양소 아이디
            dsRstMasterInfo.SetColumn(nRow, "USE_STR_DT",  dsAskInfo.GetColumn(dsAskInfo.row, "USE_STR_DT"));
            dsRstMasterInfo.SetColumn(nRow, "USE_END_DT",  dsAskInfo.GetColumn(dsAskInfo.row, "USE_END_DT"));
            dsRstMasterInfo.SetColumn(nRow, "DAY_NUM",     dsAskInfo.GetColumn(dsAskInfo.row, "DAY_NUM"));
            
            break;
            
        case "fileBtnRow" : // 첨부파일 추가
            var sResponse = fcd_GetSelectFile();  
              
            if ( fnc_IsNull(sResponse) ) return;
        
            var nRow = dsUploadFile.addRow();
tRACE(sResponse);        
            dsUploadFile.SetColumn(nRow, "ATT_FILE_KEY", dsAskInfo.GetColumn(dsAskInfo.row,"ATT_FILE_KEY"));
			dsUploadFile.SetColumn(nRow, "FILE_PATH"   , sResponse[0] + "\\" + sResponse[1]);
			dsUploadFile.SetColumn(nRow, "FILE_NM"     , sResponse[1]);
            
            break;          
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj)
{
    switch ( obj.GetForm().id ) {
        case "revBtnRow" :	//평가마스터
            if ( !fnc_DeleteCheck(dsAskInfo, "CHK", "1") ) return;
            break;
        
        case "fileBtnRow" :	//첨부파일
            if ( !fnc_DeleteCheck(dsUploadFile, "CHK", "1") ) return;
            break;
    }
}



/*-------------------------------------------------------------------------------------------------+
>>  Row가 변경될 때
+-------------------------------------------------------------------------------------------------*/
function fcDsOnRowPosChanged(obj,nOldRow,nRow)
{
    switch( obj.id ) {
		case "dsAskInfo":
			var RsvYear = dsAskInfo.GetColumn(nRow, "RSV_YEAR");
			var RsvTms  = dsAskInfo.GetColumn(nRow, "RSV_TMS");
			fcSearchMaster(RsvYear, RsvTms);
			
			
            //첨부파일 조회
            if(dsAskInfo.GetRowType(nRow) ==  "insert") {
                dsUploadFile.ClearData();
            } else {
				sRsvYear = dsAskInfo.GetColumn(nRow, "RSV_YEAR");
				sRsvTms  = dsAskInfo.GetColumn(nRow, "RSV_TMS");
				if (toNumber(dsAskInfo.GetColumn(nRow, "ATT_FILE_KEY")) > 0) {
					fcSearchFile(dsAskInfo.GetColumn(nRow, "ATT_FILE_KEY"));
				} else {
					dsUploadFile.ClearData();
				}
            }
            
			break;            
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  버튼 클릭시
+-------------------------------------------------------------------------------------------------*/
function fcBtnOnClick(obj) {
    switch(obj.id) {
        case "btnRstCrate" :
            if(fnc_Message("선택된 휴양소의 기간별 자료를 생성하시겠습니가?", "Y")) {
				// 필수항목체크
				oDataSet          = dsRstMasterInfo;
				sMandatoryColID   = "RSV_MAX_NUM|DAY_NUM|USE_STR_DT|USE_END_DT|RST_NAME";
				sMandatoryColName = "객실수|숙박일수|시작일|종료일|휴양소명|";
				oGrid             = tab0.tab1.grdRstMasterInfo;
				if ( fnc_GetMandatoryViolateRow(oDataSet, sMandatoryColID, sMandatoryColName, oGrid) > -1 ) {
					return false;
				}		
				
				var nRow = 0;
				var rsvYear  = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "RSV_YEAR");
				var rsvTms   = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "RSV_TMS");
				var rstId    = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "RST_ID");
				var rstName  = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "RST_NAME");
				var rsvMaxNum  = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "RSV_MAX_NUM");
				var dayNum  = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "DAY_NUM");
				var useStrDt = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "USE_STR_DT");
				var useEndDt = "";
				var useLstEndDt = dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "USE_END_DT");				
				var rstSeq = 0;
				
				dsRstMaster.fireEvent = false;
				while(useEndDt<useLstEndDt) {
					rstSeq ++;
					nRow = dsRstMaster.AddRow();
					dsRstMaster.SetColumn(nRow, "RSV_YEAR", 	rsvYear);
					dsRstMaster.SetColumn(nRow, "RSV_TMS",  	rsvTms);
					dsRstMaster.SetColumn(nRow, "RST_ID",   	rstId);
					dsRstMaster.SetColumn(nRow, "RST_NAME", 	rstName);
					dsRstMaster.SetColumn(nRow, "RSV_MAX_NUM",  rsvMaxNum);
					dsRstMaster.SetColumn(nRow, "DAY_NUM",  	DayNum);
					
					dsRstMaster.SetColumn(nRow, "RST_SEQ",     	Right("0"+toString(rstSeq),2));					
					if (rstSeq != 1) useStrDt = useEndDt;
					useEndDt = AddDate(useStrDt, DayNum -1);
					dsRstMaster.SetColumn(nRow, "USE_STR_DT",  	useStrDt);
					dsRstMaster.SetColumn(nRow, "USE_END_DT",  	useEndDt);
				}
				dsRstMaster.fireEvent = true;
				if (useEndDt != dsRstMasterInfo.GetColumn(dsRstMasterInfo.row, "USE_END_DT")) {
					fnc_message("종료일자가 일치하지 않습니다. 최종 종료일을 확인하세요!","N");
				} 
				tab0.TabIndex = 1;
            }
            break;
        
    }
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 더블 클릭시
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnCellDBLClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var sLocalFileName  = fcd_GetSelectFile("Save", dsUploadFile.GetColumn(nRow, "FILE_NM"));
	var sServerFileName = dsUploadFile.GetColumn(nRow, "FILE_PATH");
	var sFileSize       = dsUploadFile.GetColumn(nRow, "FILE_SIZE");
	if ( sLocalFileName == null ) return;

	fnc_FileRead(divBtnLst.HttpFile, sLocalFileName[0] + "\\" + sLocalFileName[1], sServerFileName, sFileSize, nRow, "PROG_BAR", dsUploadFile);
}

function fcTabOnChanged(obj,nOldIndex,nNewindex)
{
	switch(tab0.tabindex) {
		case 0:
			btnRstCrate.Visible = true;
			break;
		case 1:
			btnRstCrate.Visible = false;
			break;
	}
}
]]></Script>
</Window>