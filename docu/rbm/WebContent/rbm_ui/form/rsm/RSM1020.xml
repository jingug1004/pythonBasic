<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form Height="576" Id="RSM1020" Left="8" OnLoadCompleted="fcFormLoadSetting" OnSize="fcOnSize" OnUnloadCompleted="fcFormUnloadProcess" PidAttrib="7" Title="PC파일&#32;업로드" Top="8" Ver="1.0" Width="816" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsFileVeri">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CD></CD>
						<CD_NM></CD_NM>
					</record>
					<record>
						<CD>001</CD>
						<CD_NM>업로드</CD_NM>
					</record>
					<record>
						<CD>002</CD>
						<CD_NM>실패</CD_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPcUpList" OnColumnChanged="fcOnColumnChanged" OnRowPosChanged="fcOnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="G_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="G_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="C_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="C_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="M_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="M_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="B_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="B_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="GITA" size="256" summ="default" type="STRING"/>
					<colinfo id="GITA_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="GITA_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="GITA_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KTAX" size="256" summ="default" type="STRING"/>
					<colinfo id="KTAX_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="KTAX_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="KTAX_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYO" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYO_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYO_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYO_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESU" size="256" summ="default" type="STRING"/>
					<colinfo id="RESU_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="RESU_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="RESU_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SATL" size="256" summ="default" type="STRING"/>
					<colinfo id="SATL_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SATL_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="SATL_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SELL" size="256" summ="default" type="STRING"/>
					<colinfo id="SELL_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SELL_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="SELL_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TELM" size="256" summ="default" type="STRING"/>
					<colinfo id="TELM_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TELM_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="TELM_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WINN" size="256" summ="default" type="STRING"/>
					<colinfo id="WINN_FILE_ROW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="WINN_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="WINN_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_VERI" size="256" summ="default" type="STRING"/>
					<colinfo id="VERI_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="VERI" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPcUp">
				<Contents>
					<colinfo id="FILE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_UPLOAD_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SEARCH" size="256" summ="default" type="STRING"/>
					<colinfo id="ROWCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_RMK" size="256" summ="default" type="STRING"/>
					<record>
						<DS_NM>dsGita</DS_NM>
						<DT></DT>
						<FILE_CD>001</FILE_CD>
						<FILE_CNT>13</FILE_CNT>
						<FILE_NM>gita</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>기타소득세(100배이상&#32;500만원미만)</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsKtax</DS_NM>
						<DT></DT>
						<FILE_CD>002</FILE_CD>
						<FILE_CNT>15</FILE_CNT>
						<FILE_NM>ktax</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>지급조서(100배이상&#32;500만원이상)</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsPayoffs</DS_NM>
						<DT></DT>
						<FILE_CD>003</FILE_CD>
						<FILE_CNT>27</FILE_CNT>
						<FILE_NM>payoffs</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>세금관련&#32;정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsResults</DS_NM>
						<DT></DT>
						<FILE_CD>004</FILE_CD>
						<FILE_CNT>12</FILE_CNT>
						<FILE_NM>results</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>경기결과&#32;상세정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsSatlit</DS_NM>
						<DT></DT>
						<FILE_CD>005</FILE_CD>
						<FILE_CNT>10</FILE_CNT>
						<FILE_NM>satlit</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>총매출액&#32;정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsSellst</DS_NM>
						<DT></DT>
						<FILE_CD>006</FILE_CD>
						<FILE_CNT>22</FILE_CNT>
						<FILE_NM>sellst</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>구간별&#32;매출액정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsTelmp</DS_NM>
						<DT></DT>
						<FILE_CD>007</FILE_CD>
						<FILE_CNT>16</FILE_CNT>
						<FILE_NM>telmp</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>발매실적&#32;정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsWinnmp</DS_NM>
						<DT></DT>
						<FILE_CD>008</FILE_CD>
						<FILE_CNT>31</FILE_CNT>
						<FILE_NM>winnmp</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>창구별구좌관리</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsStndYear">
				<Contents>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsMeetCd">
				<Contents>
					<colinfo id="CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CD_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CD>001</CD>
						<CD_NM>경륜</CD_NM>
					</record>
					<record>
						<CD>003</CD>
						<CD_NM>경정</CD_NM>
					</record>
					<record>
						<CD>000</CD>
						<CD_NM>평일</CD_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsGita">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsKtax">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPayoffs">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsResults">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsCond">
				<Contents>
					<colinfo id="MAX_STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MIN_STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="STND_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS" size="256" summ="default" type="STRING"/>
					<colinfo id="TMS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DAY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsInComCd">
				<Contents>
					<colinfo id="DSNAME" size="20" summ="default" type="STRING"/>
					<colinfo id="CD_GRP_ID" size="6" summ="default" type="STRING"/>
					<colinfo id="QUERY_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM4" size="256" summ="default" type="STRING"/>
					<colinfo id="TERM5" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPTION" size="256" summ="default" type="STRING"/>
					<colinfo id="ALL_YN" size="1" summ="default" type="STRING"/>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID>114</CD_GRP_ID>
						<DESCRIPTION></DESCRIPTION>
						<DSNAME>dsFilePath</DSNAME>
						<QUERY_ID></QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
					<record>
						<ALL_YN></ALL_YN>
						<CD_GRP_ID></CD_GRP_ID>
						<DESCRIPTION>경주일정보</DESCRIPTION>
						<DSNAME>dsCond</DSNAME>
						<QUERY_ID>rsm0000_s01</QUERY_ID>
						<TERM1></TERM1>
						<TERM2></TERM2>
						<TERM3></TERM3>
						<TERM4></TERM4>
						<TERM5></TERM5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSatlit">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsSellst">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsTelmp">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsWinnmp">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPcUpAll">
				<Contents>
					<colinfo id="FILE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_UPLOAD_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SEARCH" size="256" summ="default" type="STRING"/>
					<colinfo id="ROWCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_RMK" size="256" summ="default" type="STRING"/>
					<record>
						<DS_NM>dsGita</DS_NM>
						<DT></DT>
						<FILE_CD>001</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>gita</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>기타소득세(100배이상&#32;500만원미만)</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsKtax</DS_NM>
						<DT></DT>
						<FILE_CD>002</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>ktax</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>지급조서(100배이상&#32;500만원이상)</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsPayoffs</DS_NM>
						<DT></DT>
						<FILE_CD>003</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>payoffs</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>세금관련&#32;정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsResults</DS_NM>
						<DT></DT>
						<FILE_CD>004</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>results</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>경기결과&#32;상세정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsSatlit</DS_NM>
						<DT></DT>
						<FILE_CD>005</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>satlit</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>총매출액&#32;정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsSellst</DS_NM>
						<DT></DT>
						<FILE_CD>006</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>sellst</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>구간별&#32;매출액정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsTelmp</DS_NM>
						<DT></DT>
						<FILE_CD>007</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>telmp</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>발매실적&#32;정보</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsWinnmp</DS_NM>
						<DT></DT>
						<FILE_CD>008</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>winnmp</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>창구별구좌관리</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPcUpExcept">
				<Contents>
					<colinfo id="FILE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
					<colinfo id="RACE_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_UPLOAD_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_SEARCH" size="256" summ="default" type="STRING"/>
					<colinfo id="ROWCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_RMK" size="256" summ="default" type="STRING"/>
					<record>
						<DS_NM>dsGita</DS_NM>
						<DT></DT>
						<FILE_CD>001</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>gita</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>기타소득세(100배이상&#32;500배미만)</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
					<record>
						<DS_NM>dsKtax</DS_NM>
						<DT></DT>
						<FILE_CD>002</FILE_CD>
						<FILE_CNT></FILE_CNT>
						<FILE_NM>ktax</FILE_NM>
						<FILE_PATH></FILE_PATH>
						<FILE_RMK>지급조서(500배이상)</FILE_RMK>
						<FILE_SEARCH></FILE_SEARCH>
						<FILE_UPLOAD_NAME></FILE_UPLOAD_NAME>
						<RACE_DT></RACE_DT>
						<ROWCNT></ROWCNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsFilePath"></Dataset>
		</Datasets>
		<Div Height="22" Id="divBtnLst" Left="423" TabOrder="0" Text="Div0" Top="2" Url="common::comButtonType.xml" Width="390">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="dsPcUp" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="582" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="165" Id="grdPcUp" InputPanel="FALSE" Left="8" LineColor="user18" OnCellDBLClick="fcGrdOnCellDblClick" OnExpandUp="fcPcUpOnExpandUp" OnHeadClick="fcGridSort" Right="809" SelColor="user19" Style="snis_grid" TabOrder="2" TabStop="true" Top="417" UseDBuff="true" UsePopupMenu="true" UserData="RSZX" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="801">
			<contents>
				<format id="Default">
					<columns>
						<col width="60"/>
						<col width="60"/>
						<col width="70"/>
						<col width="290"/>
						<col width="60"/>
						<col width="257"/>
					</columns>
					<head>
						<cell autosizing="none" bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="파일코드"/>
						<cell autosizing="none" bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="파일구분"/>
						<cell autosizing="none" bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="일자"/>
						<cell autosizing="none" bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="파일찾기"/>
						<cell autosizing="none" bkcolor="user20" col="4" color="user21" display="text" font="굴림,9,Bold" text="건수"/>
						<cell autosizing="none" bkcolor="user20" col="5" color="user21" display="text" font="굴림,9,Bold" text="설명"/>
					</head>
					<body>
						<cell align="center" col="0" colid="FILE_CD" display="text" font="굴림,9"/>
						<cell col="1" colid="FILE_NM" display="text" font="굴림,9"/>
						<cell col="2" colid="RACE_DT" display="date" font="굴림,9"/>
						<cell align="left" col="3" colid="FILE_SEARCH" display="text" expandimage="btn_pop_search" expandshow="true" font="굴림,9"/>
						<cell align="right" col="4" colid="ROWCNT" display="number" font="굴림,9"/>
						<cell col="5" colid="FILE_RMK" display="text" font="굴림,9"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="dsPcUpList" BKColor="user15" BkColor2="user16" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user22" Bottom="386" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="290" Id="grdPcUpList" InputPanel="FALSE" Left="10" LineColor="user18" OnCellClick="fcPcUpListOnCellClick" OnCellDBLClick="fcGrdOnCellDblClick" OnCellPosChanged="fcPcUpListOnCellPosChanged" OnHeadClick="fcGridSort" Right="811" SelColor="user19" Style="snis_grid" TabOrder="3" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="801">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="60"/>
						<col fix="left" width="36"/>
						<col fix="left" width="32"/>
						<col fix="left" width="79"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="0"/>
					</columns>
					<head>
						<cell autosizing="none" bkcolor="user20" col="0" color="user21" display="text" font="굴림,9,Bold" text="기준년도"/>
						<cell autosizing="none" bkcolor="user20" col="1" color="user21" display="text" font="굴림,9,Bold" text="일자"/>
						<cell autosizing="none" bkcolor="user20" col="2" color="user21" display="text" font="굴림,9,Bold" text="구분"/>
						<cell autosizing="none" bkcolor="user20" col="3" color="user21" display="text" font="굴림,9,Bold" text="경기일자"/>
						<cell autosizing="none" bkcolor="user20" col="4" color="user21" colspan="2" display="text" font="굴림,9,Bold" text="경륜"/>
						<cell autosizing="none" bkcolor="user20" col="6" color="user21" colspan="2" display="text" font="굴림,9,Bold" text="경정"/>
						<cell autosizing="none" bkcolor="user20" col="8" color="user21" colspan="2" display="text" font="굴림,9,Bold" text="창원"/>
						<cell autosizing="none" bkcolor="user20" col="10" color="user21" colspan="2" display="text" font="굴림,9,Bold" text="부산"/>
						<cell bkcolor="user20" col="12" color="user21" colspan="2" display="text" text="검증"/>
						<cell autosizing="none" bkcolor="user20" col="14" color="user21" display="text" font="굴림,9,Bold" text="gita"/>
						<cell autosizing="none" bkcolor="user20" col="15" color="user21" display="text" font="굴림,9,Bold" text="ktax"/>
						<cell autosizing="none" bkcolor="user20" col="16" color="user21" display="text" font="굴림,9,Bold" text="payoffs"/>
						<cell autosizing="none" bkcolor="user20" col="17" color="user21" display="text" font="굴림,9,Bold" text="results"/>
						<cell autosizing="none" bkcolor="user20" col="18" color="user21" display="text" font="굴림,9,Bold" text="satlit"/>
						<cell autosizing="none" bkcolor="user20" col="19" color="user21" display="text" font="굴림,9,Bold" text="sellst"/>
						<cell autosizing="none" bkcolor="user20" col="20" color="user21" display="text" font="굴림,9,Bold" text="telmp"/>
						<cell autosizing="none" bkcolor="user20" col="21" color="user21" display="text" font="굴림,9,Bold" text="winnmp"/>
						<cell autosizing="none" bkcolor="user20" col="22" color="user21" display="text" font="굴림,9,Bold" text="chk"/>
					</head>
					<body>
						<cell align="center" col="0" colid="STND_YEAR" display="normal" font="굴림,9"/>
						<cell align="center" col="1" colid="DT" display="text" edit='expr:iif(dsPcUpList.getColumn(row,&quot;GUBUN&quot;)&#32;&#32;==&#32;&quot;999&quot;&#32;&amp;&amp;&#32;dsPcUpList.getrowtype(row)&#32;==&#32;&quot;insert&quot;&#32;,&quot;number&quot;,&quot;none&quot;)&#32;' expr='substr(DT,0,2)+&quot;-&quot;+substr(DT,2,4)' font="굴림,9"/>
						<cell align="center" col="2" colid="GUBUN_DESC" display="text" font="굴림,9"/>
						<cell align="center" col="3" colid="RACE_DAY" color="#10a603" cursor="hand" display="date" font="굴림,9,Bold"/>
						<cell align="center" col="4" display="text" expr='DECODE(G_TMS,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,G_TMS+&quot;회차&quot;)' font="굴림,9"/>
						<cell align="center" col="5" colid="G_DAY" display="text" expr='decode(G_DAY,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,G_DAY+&quot;일차&quot;)' font="굴림,9"/>
						<cell align="center" col="6" colid="M_TMS" display="text" expr='decode(M_TMS,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,M_TMS+&quot;회차&quot;)' font="굴림,9"/>
						<cell align="center" col="7" colid="M_DAY" display="text" expr='decode(M_DAY,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,M_DAY+&quot;일차&quot;)' font="굴림,9"/>
						<cell align="center" col="8" colid="C_TMS" display="text" expr='decode(C_TMS,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,C_TMS+&quot;회차&quot;)' font="굴림,9"/>
						<cell align="center" col="9" colid="C_DAY" display="text" expr='decode(C_DAY,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,C_DAY+&quot;일차&quot;)' font="굴림,9"/>
						<cell align="center" col="10" colid="B_TMS" display="text" expr='decode(B_TMS,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,B_TMS+&quot;회차&quot;)' font="굴림,9"/>
						<cell align="center" col="11" colid="B_DAY" display="text" expr='decode(B_DAY,null,&apos;&apos;,&apos;&apos;,&apos;&apos;,B_DAY+&quot;일차&quot;)' font="굴림,9"/>
						<cell align="center" col="12" colid="FILE_VERI" color="expr:decode(FILE_VERI,&apos;002&apos;,&apos;red&apos;,&apos;default&apos;)" combocol="CD" combodataset="dsFileVeri" combotext="CD_NM" display="combo" edit="combo" expr="decode(FILE_VERI,&apos;001&apos;,&apos;성공&apos;,&apos;002&apos;,&apos;실패&apos;,&apos;실패&apos;)" font="굴림,9"/>
						<cell align="center" bkcolor='expr:iif(VERI_DESC==&quot;불일치&quot;,&quot;red&quot;,&quot;default&quot;)' col="13" colid="VERI_DESC" display="text"/>
						<cell align="right" col="14" colid="GITA_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="15" colid="KTAX_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="16" colid="PAYO_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="17" colid="RESU_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="18" colid="SATL_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="19" colid="SELL_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="20" colid="TELM_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="21" colid="WINN_FILE_ROW_CNT" display="number" font="굴림,9"/>
						<cell align="right" col="22" colid="CHK" display="checkbox" edit="checkbox" font="굴림,9"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Color="user4" Height="20" Id="Static0" Left="24" Style="snis_m_stitle" TabOrder="3" Text="PC&#32;File&#32;업로드" Top="398" VAlign="Middle" Width="93"></Static>
		<Shape BKColor="user0" Bottom="68" Height="38" Id="Shape1" Left="8" LineColor="user1" LineKind="Vertical" Right="809" RoundHeight="10" RoundUnit="Pixel" RoundWidth="10" TabOrder="3" Top="30" Type="RoundRect" Width="801"></Shape>
		<Static Border="None" Height="20" Id="Static26" Left="28" Style="snis_if_lable" TabOrder="4" Text="년도" Top="39" VAlign="Middle" Width="23"></Static>
		<Combo Border="Flat" CodeColumn="STND_YEAR" DataColumn="STND_YEAR" Height="21" Id="cboStndYear" ImeMode="none" InnerDataset="dsStndYear" Left="62" OnChanged="fcCboOnChanged" ResetIndex="FIRST" Style="snis_if_input01" TabOrder="5" Top="38" Width="80">
			<Contents>
				<Record Data="&#32;" Default="true"/>
			</Contents>
		</Combo>
		<Static Color="user4" Height="20" Id="Static2" Left="24" Style="snis_m_stitle" TabOrder="7" Text="PC&#32;File&#32;업로드&#32;검증&#32;목록" Top="76" VAlign="Middle" Width="156"></Static>
		<Static Color="user4" Height="20" Id="stRaceDay" Left="119" Style="snis_m_stitle" TabOrder="6" Text="(경륜&#32;2011년&#32;8월&#32;21일&#32;32회차&#32;3일차)" Top="398" VAlign="Middle" Width="377"></Static>
		<Static Color="user4" Height="20" Id="stFormTitle" Left="24" Style="snis_m_stitle" TabOrder="11" Text="PC파일&#32;업로드" VAlign="Middle" Width="384"></Static>
		<Image Height="20" Id="Image3" ImageID="m_titleblet" Left="8" TabOrder="10" Top="3" Width="17"></Image>
		<Image Height="20" Id="Image0" ImageID="m_titleblet2" Left="8" TabOrder="11" Top="76" Width="17"></Image>
		<Image Height="20" Id="Image1" ImageID="m_titleblet2" Left="8" TabOrder="11" Top="398" Width="17"></Image>
		<Edit Height="26" Id="edRaceDay" Left="568" TabOrder="14" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edGtms" Left="656" TabOrder="15" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edGday" Left="688" TabOrder="16" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edCtms" Left="696" TabOrder="17" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edMtms" Left="712" TabOrder="18" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edMday" Left="712" TabOrder="19" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edBday" Left="720" TabOrder="20" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edBtms" Left="712" TabOrder="21" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edCday" Left="704" TabOrder="22" Top="387" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edGubun" Left="496" TabOrder="23" Top="389" Visible="FALSE" Width="84"></Edit>
		<Edit Height="26" Id="edDt" Left="448" TabOrder="24" Top="391" Visible="FALSE" Width="84"></Edit>
		<Button ButtonStyle="TRUE" Height="21" Id="btnIns" ImageID="btn_txt_11" Left="704" OnClick="fcInsRow" TabOrder="25" Text="평일환급입력" Top="74" Width="104"></Button>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*   Form Common Script                                                                             *
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var sFormId       = this.GetForm().id;
var sBUTTONLIST   = 'TTTTTTT';                          //공통기능정의(버튼순으로 T or F)
var sUSERAUTH     = '';                                 //사용자별 프로그램 사용 권한
var sFORMCAPTION  = '';                                 //Form의 Title 정보
var sFORMLOCATION = '';                                 //Form의 Location 정보
var sUSERLAVEL    = '';                                 //Form의 사용  Level
var vREVOBJ       = Array(9);                           //결과값 처리를 위한 오브젝트 
var sGRDTIT       = "";                                 //그리드 제목
var sCUROBJ       ;                                     //현재 LOST FOCUS 오브젝트

var sMenuGrpNum     = "0";                              // 메뉴그룹의 갯수보관
var sMenuListNum    = "0";                              // 메뉴리스트의 갯수보관
var sMenuUpId       = "";
var sMenuUpNm       = "";

var gnGrpRow        = 0;

var strOriSessionNo = "";	// PC파일 업로드 세션
var upFileCnt       = 0;
var sCurRow            ;
var sTrnCnt         = 0;
var sCalBakCnt      = 0;

var PStndYear       = "";
var PDt				= ""; // 일자
var PMeetGubun      = "";
var PRaceDay        = "";
var PSessionNo      = "";
var PGtms           = "";
var PGday           = "";
var PCtms           = "";
var PCday           = "";
var PMtms           = "";
var PMday           = "";
var PBtms           = "";
var PBday           = "";
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 Load時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormLoadSetting(obj) {  
    sBUTTONLIST   = 'TTTFTFT';     // T초기화,T조회,T저장,F삭제,T엑셀,F인쇄,T닫기

 	//화면환경 설정
	sFORMCAPTION  = obj.Title;
	sFORMLOCATION = "";

	// 화면그리드 리사이즈
	fcSetResize(this,this.width-4);	
	
	//화면 정보 Display 및 Button 권한 설정
	fnc_FormLoadSetting(obj, sFORMCAPTION, sFORMLOCATION, sBUTTONLIST, sUSERAUTH);
	
	
    //공통코드 조회
    
	fcd_GetComboDs(dsInComCd);	
	fcd_SetStndYear(dsStndYear,  dsCond.GetColumn(0,"MIN_STND_YEAR"), substr(fcd_GetSysdate("YYYYMMDD"), 0, 4)); 
	
	fcSearch();

	// 화면그리드 리사이즈
	fcSetResize(this,this.width-4);	
}

/*-------------------------------------------------------------------------------------------------+
>>  최초 화면 UNLoad時 처리 할 사항
+-------------------------------------------------------------------------------------------------*/
function fcFormUnloadProcess(obj) {
	//자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
	var sDataset = "dsPcUpList";	// PC File 업로드 검증 목록
	if (   !fnc_FormUnloadCheck(sDataset  , sFormId) ) return false;
}

/*-------------------------------------------------------------------------------------------------+
>>  단축키 처리(Form KeyDown)
+-------------------------------------------------------------------------------------------------*/
function fcHotKey(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam) {

	//Return Key Press時 Next Component focus
	if ( nChar == ENTER_KEY ) {
		var oFocusComponent = GetNextComponent(true);
		oFocusComponent.setfocus();
		return;
	}

	//Control Key가 눌려져 있다면 단축키 처리
	//if (bControl) fnc_HotKey(this, nChar);
}

/***************************************************************************************************
*                                      공통 버튼 Event 처리 부분                                   *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  취소 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInit(obj) {
	var i = 0;
    dsGita.ClearData(); // gita 파일
    dsKtax.ClearData();	// ktax 파일
    dsPayoffs.ClearData(); // Payoffs 파일
    dsResults.ClearData();	// Results 파일
    dsSatlit.ClearData();
    dsSellst.ClearData();
    dsTelmp.ClearData();
    dsWinnmp.ClearData();
    for (i=0; dsPcUp.RowCount() > i; i++) 
    {
		dsPcUp.SetColumn(i, "FILE_PATH", "");
        dsPcUp.SetColumn(i, "FILE_SEARCH", "");
        dsPcUp.SetColumn(i, "ROWCNT", "");
    }
    
    upFileCnt = 0;
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 체크 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearchCheck(obj) {
    dsPcUpList.ClearData();
	fcInit(obj);
	
	strOrisessionNo = "";
	
	return true;
}

/*-------------------------------------------------------------------------------------------------+
>>  조회 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearch(obj) {
    if ( !fcSearchCheck(obj) ) return;
    
	var sServiceName = "rsm1020-service:searchPcUpList";
    var sInDataSet   = "";
    var sOutDataSet  = "dsPcUpList=dsPcUpList ";
	
	fcd_AddParam("STND_YEAR", cboStndYear.Value);
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
	
}


/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 저장가능유무처리
+-------------------------------------------------------------------------------------------------*/
function fcSaveCheck(obj) {			
	
	// 파일 존재 여부 확인	
	var FILE_SEARCH ='';
	for(var i=0;i<dsPcUp.rowcount;i++)
	{
		FILE_SEARCH += decode(dsPcUp.GetColumn(i,"FILE_SEARCH"),null,'',dsPcUp.GetColumn(i,"FILE_SEARCH"));

		
	}
	
	if(FILE_SEARCH=='')
	{
		return false;
	}
	
	// 파일 확장자명 체크
	for(var i=0;i<dsPcUp.rowcount-1;i++)
	{
		var arrIfile = split(dsPcUp.GetColumn(i,"FILE_SEARCH"),".");
		var iFileExt = arrIfile[1];
		for(var j=i+1;j<dsPcUp.rowcount;j++)
		{
			var arrJfileExt = split(dsPcUp.GetColumn(j,"FILE_SEARCH"),".");
			var jFileExt = arrJfileExt[1];

			if(Length(arrJfileExt)>0 && Length(jFileExt) && iFileExt != jFileExt)
			{
				var sMessage = "["+dsPcUp.GetColumn(i,"FILE_SEARCH") +"] 와 ["+dsPcUp.GetColumn(j,"FILE_SEARCH")+"] 확장자가 다릅니다.";
				fnc_Message(sMessage, "N");	
				return false;
			}
		}
	}

  
    if(dsPcUpList.getColumn(dsPcUpList.row,"GUBUN") != "999"){
        
        if(dsWinnmp.GetRowCount() >0){
			var sWinnMpDt = replace(substr(dsWinnmp.GetColumn(0,"column30"),0,8),"/","");
			var sWinRaceDt = substr(dsPcUp.GetColumn(7,"RACE_DT"),2,6);
			
			
			if(sWinnMpDt != sWinRaceDt){
				fnc_Message(SNIS_RBM_D019, "N");	
			
				return false;
			}
		}	
    }
   	

   	if((dsPcUpList.GetRowType(dsPcUpList.row) == "normal" || dsPcUpList.GetRowType(dsPcUpList.row) == "update" )
			&& Length(dsPcUpList.GetColumn(dsPcUpList.row,"FILE_VERI")) <=0 ){
				
				var sFilVeriDesc ="검증여부를 선택하여 주십시오.";
				fnc_Message(sFilVeriDesc, "N");	
			
				return false;
    }
	return true;
}


/*-------------------------------------------------------------------------------------------------+
>>  저장 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/

function fcSave(obj) {

	if ( !fcSaveCheck() ) return;
    
	var sServiceName = "rsm1020-service:savePCFileUpload";
    var sInDataSet   = "dsPcUp=dsPcUp:a dsPcUpList=dsPcUpList:u ";
    var sOutDataSet  = "";
	
	var STND_YEAR = dsPcUpList.GetColumn(dsPcUpList.row, "STND_YEAR" );
	var DT= dsPcUpList.GetColumn(dsPcUpList.row, "DT" );
	var sUploadRoot = dsFilePath.GetColumn(0,"CD_NM");
	
	var sWork = STND_YEAR+"|"+ DT;
	
	// 파일 PATH 에  구분 코드 , 날짜 붙여서 저장 시키기 (파일 경로를 분할하기 위함)
	if(fcDsCheck(0)) // GITA 데이터 체크
	{		
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(0, "FILE_PATH" ), dsPcUp.GetColumn(0, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "GITA 파일 업로드 에러발생");
			return false;
		}
		
		dsPcUp.SetColumn(0,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(0,"FILE_NM",dsPcUp.GetColumn(0, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"GITA_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"GITA_FILE_NM",dsPcUp.GetColumn(0, "FILE_SEARCH"));
		
	}
	
	
	if(fcDsCheck(1)) // KTAX 파일 체크
	{
		
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(1, "FILE_PATH" ), dsPcUp.GetColumn(1, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "KTAX 파일 업로드 에러발생");
			return false;
		}
		
		dsPcUp.SetColumn(1,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(1,"FILE_NM",dsPcUp.GetColumn(1, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"KTAX_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"KTAX_FILE_NM",dsPcUp.GetColumn(1, "FILE_SEARCH"));
	}
	
	if(fcDsCheck(2)) // PAYOFFS 파일 체크
	{		
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(2, "FILE_PATH" ), dsPcUp.GetColumn(2, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "PAYOFFS 파일 업로드 에러발생");
			return false;
		}
		dsPcUp.SetColumn(2,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(2,"FILE_NM",dsPcUp.GetColumn(2, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"PAYO_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"PAYO_FILE_NM",dsPcUp.GetColumn(2, "FILE_SEARCH"));
	}
	
	if(fcDsCheck(3)) 	// RESULTS
	{
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(3, "FILE_PATH" ), dsPcUp.GetColumn(3, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "RESULTS 파일 업로드 에러발생");
			return false;
		}
		dsPcUp.SetColumn(3,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(3,"FILE_NM",dsPcUp.GetColumn(3, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"RESU_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"RESU_FILE_NM",dsPcUp.GetColumn(3, "FILE_SEARCH"));
	}
	
	if(fcDsCheck(4)) // SATLIT
	{
		
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(4, "FILE_PATH" ), dsPcUp.GetColumn(4, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "SATLIT 파일 업로드 에러발생");
			return false;
		}
		dsPcUp.SetColumn(4,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(4,"FILE_NM",dsPcUp.GetColumn(4, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"SATL_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"SATL_FILE_NM",dsPcUp.GetColumn(4, "FILE_SEARCH"));
	}
	
	if(fcDsCheck(5)) // SELLST
	{
		
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(5, "FILE_PATH" ), dsPcUp.GetColumn(5, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "SELLST 파일 업로드 에러발생");
			return false;
		}
		dsPcUp.SetColumn(5,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(5,"FILE_NM",dsPcUp.GetColumn(5, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"SELL_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"SELL_FILE_NM",dsPcUp.GetColumn(5, "FILE_SEARCH"));
	}
	
	if(fcDsCheck(6)) //  TELMP
	{
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(6, "FILE_PATH" ), dsPcUp.GetColumn(6, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "TELMP 파일 업로드 에러발생");
			return false;
		}
		dsPcUp.SetColumn(6,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(6,"FILE_NM",dsPcUp.GetColumn(6, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"TELM_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"TELM_FILE_NM",dsPcUp.GetColumn(6, "FILE_SEARCH"));
	}
	
	if(fcDsCheck(7)) //  WINNMP 
	{
		
		var arrFile = fnc_PCFileUploader(  divBtnLst.HttpFile , dsPcUp.GetColumn(7, "FILE_PATH" ), dsPcUp.GetColumn(7, "FILE_SEARCH" ) ,sUploadRoot,sWork,""); 	
		if ( arrFile[0] != "SUCC" ) 
		{
			alert(arrFile[1] + "WINNMP 파일 업로드 에러발생");
			return false;
		}
		dsPcUp.SetColumn(7,"FILE_PATH",arrFile[1]);
//		dsPcUp.SetColumn(7,"FILE_NM",dsPcUp.GetColumn(7, "FILE_SEARCH"));
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"WINN_FILE_PATH",arrFile[1]);
		dsPcUpList.SetColumn(dsPcUpList.currow,"WINN_FILE_NM",dsPcUp.GetColumn(7, "FILE_SEARCH"));
	}
	
	
	
	fcParamInit();
	fcParamSet();	
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
	
}

/*-------------------------------------------------------------------------------------------------+
>>  PC파일업로드 서버 전송

function fcSendServ(sServiceName, sInDataSet, sOutDataSet, sServiceGubun, sDsName) {
	
    sServiceName = "";
    fcParamSet();
    sServiceName = sServiceGubun+sDsName;
    fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", true);
    
}

+-------------------------------------------------------------------------------------------------*/


/*-------------------------------------------------------------------------------------------------+
>>  파라메터 초기 세팅
+-------------------------------------------------------------------------------------------------*/
function fcParamInit() 
{
    PStndYear   = cboStndYear.Value;
	PDt			= edDt.Text;
	PMeetGubun  = edGubun.Text;  // grdPcUpList 에 경륜, 경정 구분 값 넣기
	PRaceDay    = edRaceDay.Text;// grdPcUpList 에 RACE DAY 값 넣기
	PSessionNo  = strOriSessionNo;
	PGtms       = edGtms.Text;	// 광명 회차
	PGday       = edGday.Text;	// 광명 일차
	PCtms       = edCtms.Text;	// 창원 회차
	PCday       = edCday.Text;	// 창원 일차
	PMtms       = edMtms.Text;	// 경정 회차
	PMday       = edMday.Text;	// 경정 일차
	PBtms       = edBtms.Text;	// 부산 회차
	PBday       = edBday.Text;	// 부산 일차
}



/*-------------------------------------------------------------------------------------------------+
>>  트랜잭션 전에 초기에 저장해둔 파라메터 세팅
+-------------------------------------------------------------------------------------------------*/
function fcParamSet() {
    fcd_AddParam("STND_YEAR",    PStndYear);
    fcd_AddParam("DT",    PDt);
	fcd_AddParam("MEET_GUBUN",   PMeetGubun);
	fcd_AddParam("RACE_DAY",     PRaceDay);
	fcd_AddParam("SESSION_NO",   PSessionNo);
	fcd_AddParam("G_TMS",        PGtms);	// 광명 회차
	fcd_AddParam("G_DAY",        PGday);	// 광명 일차
	fcd_AddParam("C_TMS",        PCtms);	// 창완 회차 
	fcd_AddParam("C_DAY",        PCday);	// 창원 일차
	fcd_AddParam("M_TMS",        PMtms); // 경정 회차
	fcd_AddParam("M_DAY",        PMday); // 경정 일차
	fcd_AddParam("B_TMS",        PBtms);	// 부산 회차
	fcd_AddParam("B_DAY",        PBday);	// 부산 일차
	
	
	for(var i=0;i<dsPcUp.rowcount;i++)
	{
		dsPcUp.SetColumn(i,"DT",dsPcUpList.GetColumn(dsPcUpList.currow,"DT"));
	}
	
	
}


/*-------------------------------------------------------------------------------------------------+
>>  전송하려는 데이터셋 건수 체크해서 트랜잭션 발생여부 체크
+-------------------------------------------------------------------------------------------------*/
function fcDsCheck(nRow) {
    var fileName;
    
//    fileName = trim(dsPcUp.GetColumn(nRow, "FILE_SEARCH"));    
    fileName = trim(dsPcUp.GetColumn(nRow, "FILE_UPLOAD_NAME"));    
    if(fileName == null || fileName == "") {
        return false;        
    }else{
        sTrnCnt += 1;
        return true;
    }    
}


/*-------------------------------------------------------------------------------------------------+
>>  엑셀 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcToExcel(obj) {
    var sExcelList = "grdPcUpList:PC파일업로드"; //데이터셋 정의
    fcd_OpenExcelListExport(sExcelList);
}

/*-------------------------------------------------------------------------------------------------+
>>  행추가 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcAddRow(obj) {
    
}


/*-------------------------------------------------------------------------------------------------+
>>  행삭제 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcDelRow(obj) {
	//DataSet의 Header 정보가 있을 때  Add 처리 	
	//if ( !fnc_DeleteCheck(grid, "chk", "1") ) return;
	
}


/*-------------------------------------------------------------------------------------------------+
>>  인쇄
+-------------------------------------------------------------------------------------------------*/
function fcPrint(){
			
}

/*-------------------------------------------------------------------------------------------------+
>>  화면 종료(닫기) 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcEnd(obj) {
	//화면 종료
	Close();	
}


/***************************************************************************************************
*                                      공통 Function 처리 부분                                     *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Text Box가 Focus를 받을 때
+-------------------------------------------------------------------------------------------------*/
function fcEditFocus(obj) {
//	fnc_EditFocus(obj);
}

/*-------------------------------------------------------------------------------------------------+
>>  그리드 정렬
+-------------------------------------------------------------------------------------------------*/
function fcGridSort(obj,nCell,nX,nY) {
	//특정 Head 클릭 시 해당 항목으로 Sort(만약 특정 컬럼을 누를때만 소트하고자 한다면 nCell로 조건)
	fnc_GridSort(obj, object(obj.BindDataset), nCell);
}

/*-------------------------------------------------------------------------------------------------+
>>  Help Popup Open
+-------------------------------------------------------------------------------------------------*/
function fcHelpDialoge(obj,nX,nY) {

}

/*-------------------------------------------------------------------------------------------------+
>>  그리드에서 팝업 처리 
+-------------------------------------------------------------------------------------------------*/
function fcGrdOnExpandEdit(objGrd, nRow, nCell, strVal, nPivotIndex){
	
}

/***************************************************************************************************
*                                      사용자 정의  처리 부분                                      *
***************************************************************************************************/
/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) 
{
	

    if ( !fnc_result(ErrorCode, ErrorMSG) ) return;
    
    
    
	if ( sServiceName == "rsm1020-service:searchPcUpList" ) 
	{   
		fcDSPcUp(0); // 첫번째 행 데이터 선택
	}
	
	
	if (sServiceName == "rsm1020-service:savePCFileUpload")  
	{			
		var ARRAY2_GBL_RET_VALUE = split2(GBL_RET_VALUE,"^","=");		
		GBL_RET_VALUE = "";// 사용한 GBL_RET_VALUE 변수는 초기화 시켜줌 다른 페이지 이동 할 때 들고감
		
		var RESULT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"RESULT"); // 결과
		
		var FILE_VERI	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"FILE_VERI"); // 파일 검증 값 반환
				
		var GITA_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"GITA_FILE_ROW_CNT"); // GITA 파일 갯수 반환 값 
		var KTAX_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"KTAX_FILE_ROW_CNT"); // KTAX 파일 갯수 반환 값 
		var PAYO_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"PAYO_FILE_ROW_CNT"); // PAYO 파일 갯수 반환 값 
		var RESU_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"RESU_FILE_ROW_CNT"); // RESU 파일 갯수 반환 값 
		
		var SATL_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"SATL_FILE_ROW_CNT"); // SATL 파일 갯수 반환 값 
		var SELL_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"SELL_FILE_ROW_CNT"); // SELL 파일 갯수 반환 값 
		var TELM_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"TELM_FILE_ROW_CNT"); // TELM 파일 갯수 반환 값 
		var WINN_FILE_ROW_CNT	= fcArray2Value(ARRAY2_GBL_RET_VALUE,"WINN_FILE_ROW_CNT"); // WINN 파일 갯수 반환 값 
		var RESULT_VERI			= fcArray2Value(ARRAY2_GBL_RET_VALUE,"RESULT_VERI"); // WINN 파일 갯수 반환 값 
		
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"FILE_VERI",FILE_VERI);
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"GITA_FILE_ROW_CNT",GITA_FILE_ROW_CNT);
		dsPcUpList.SetColumn(dsPcUpList.currow,"KTAX_FILE_ROW_CNT",KTAX_FILE_ROW_CNT);
		dsPcUpList.SetColumn(dsPcUpList.currow,"PAYO_FILE_ROW_CNT",PAYO_FILE_ROW_CNT);
		dsPcUpList.SetColumn(dsPcUpList.currow,"RESU_FILE_ROW_CNT",RESU_FILE_ROW_CNT);
		
		dsPcUpList.SetColumn(dsPcUpList.currow,"SATL_FILE_ROW_CNT",SATL_FILE_ROW_CNT);
		dsPcUpList.SetColumn(dsPcUpList.currow,"SELL_FILE_ROW_CNT",SELL_FILE_ROW_CNT);
		dsPcUpList.SetColumn(dsPcUpList.currow,"TELM_FILE_ROW_CNT",TELM_FILE_ROW_CNT);
		dsPcUpList.SetColumn(dsPcUpList.currow,"WINN_FILE_ROW_CNT",WINN_FILE_ROW_CNT);
		
		
		if(RESULT!="")
		{
		
			//ktax,gita 0 건일경우 성공으로 업데이트 
			if(RESULT =="T"){
				if(FILE_VERI =="002"){
					if((dsPcUpList.GetColumn(dsPcUpList.currow,"GUBUN") == "999") || (PAYO_FILE_ROW_CNT >0 && RESU_FILE_ROW_CNT>0 && SATL_FILE_ROW_CNT>0 
							&& SELL_FILE_ROW_CNT>0 && TELM_FILE_ROW_CNT && WINN_FILE_ROW_CNT>0)){
							
							
							dsPcUp.SetColumn(0, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
							dsPcUp.SetColumn(1, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
							dsPcUp.SetColumn(2, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
							dsPcUp.SetColumn(3, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
							dsPcUp.SetColumn(4, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
							dsPcUp.SetColumn(5, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
							dsPcUp.SetColumn(6, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
							dsPcUp.SetColumn(7, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			
							var CHK = dsPcUpList.GetColumn(dsPcUpList.currow,"CHK");
							if(CHK=="1")
							{
								dsPcUpList.SetColumn(dsPcUpList.currow,"CHK","0"); // 체크 상태로 만들어줌
							}
							else
							{
								dsPcUpList.SetColumn(dsPcUpList.currow,"CHK","1"); // 체크 상태로 만들어줌
							}
		
			
							dsPcUpList.SetColumn(dsPcUpList.currow,"FILE_VERI","001");						
							dsPcUpList.SetColumn(dsPcUpList.currow,"VERI",RESULT_VERI);
							
							
							fcSave();
							return;
					}
				
				
				
				}
			
			
			}
	   
			var RESULT_DESC = "";
			
			if(RESULT == "T"){
			
					if(RESULT_VERI =="002" && dsPcUpList.getColumn(dsPcUpList.row,"GUBUN") != "999"){
			
						RESULT_DESC = " 업로드된 파일의  자료검증이 불일치 되었습니다. \n\n";
						RESULT_DESC += " 불일치 자료는 매출현황에 조회가 되지 않습니다. \n\n 확인 바랍니다!!! ";
						
					}else{
						RESULT_DESC = "파일 업로드 및 검증이 완료되었습니다.";
					}
			
				
			}else{
				RESULT_DESC = "파일 업로드 가  실패하였습니다.";
			}
			
			
			fnc_Message(RESULT_DESC, "N");	
		
			
			dsPcUp.SetColumn(0, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			dsPcUp.SetColumn(1, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			dsPcUp.SetColumn(2, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			dsPcUp.SetColumn(3, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			dsPcUp.SetColumn(4, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			dsPcUp.SetColumn(5, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			dsPcUp.SetColumn(6, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			dsPcUp.SetColumn(7, "FILE_UPLOAD_NAME","");	// 업로드 파일 초기화
			
			
			
		}
		
		var CHK = dsPcUpList.GetColumn(dsPcUpList.currow,"CHK");
		if(CHK=="1")
		{
			dsPcUpList.SetColumn(dsPcUpList.currow,"CHK","0"); // 체크 상태로 만들어줌
		}
		else
		{
			dsPcUpList.SetColumn(dsPcUpList.currow,"CHK","1"); // 체크 상태로 만들어줌
		}
		
		fcSearch();

	}
	
}


/*-------------------------------------------------------------------------------------------------+
>>  평일 환급 입력 버튼 클릭 時 처리
+-------------------------------------------------------------------------------------------------*/
function fcInsRow(obj) 
{
	//DataSet의 Header 정보가 있을 때  Add 처리
	if ( fnc_DatasetChangeCheck(dsPcUpList) ) {
		fnc_Message(L_COM_ALT_0024, "N", "현재 작업중인 행이 존재하기 때문에\r\n 행을 추가할 수 ");
		return;
	}

    
    if(dsPcUpList.FindRow("DT",fcd_GetSysdate("MMDD") ) >= 0 ){
		fnc_Message(SNIS_RBM_D009,"N");
		return;
    }
    
	dsPcUpList.InsertRow();
	dsPcUpList.SetColumn(dsPcUpList.row,"STND_YEAR",substr(fcd_GetSysdate("YYYYMMDD"), 0, 4));
	dsPcUpList.SetColumn(dsPcUpList.row,"DT",substr(fcd_GetSysdate("YYYYMMDD"), 4, 7));	
	dsPcUpList.SetColumn(dsPcUpList.row,"GUBUN","999");		
	dsPcUpList.SetColumn(dsPcUpList.row,"GUBUN_DESC","평일");		
	
	dsPcUpList.SetColumn(dsPcUpList.row,"G_TMS","");		
	dsPcUpList.SetColumn(dsPcUpList.row,"G_DAY","");		
	dsPcUpList.SetColumn(dsPcUpList.row,"C_TMS","");		
	dsPcUpList.SetColumn(dsPcUpList.row,"C_DAY","");		
	dsPcUpList.SetColumn(dsPcUpList.row,"M_TMS","");		
	dsPcUpList.SetColumn(dsPcUpList.row,"M_DAY","");		
	dsPcUpList.SetColumn(dsPcUpList.row,"B_TMS","");		
	dsPcUpList.SetColumn(dsPcUpList.row,"B_DAY","");		
	
	//grdPcUpList.SetCellProp("body",1,"edit","number"); 
	
	grdPcUpList.SetFocus(); // 입력 첫 항목으로 Focus
	
		
	fcDSPcUp(0); // 첫번째 행 데이터 선택
	
	dsPcUp.Copy(dsPcUpExcept);
	
	dsPcUpList.SetColumn(dsPcUpList.currow, "CHK", "1");
	
}

/*
>>그리드의 파일찾기 버튼을 눌렀을 경우 이벤트
>>파일찾기 --> 파일파싱 --> 데이터셋바인딩
*/
function fcPcUpOnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
	
	var strFileNm       = "";   //파일찾기 파일명
	var aryFileNm       = "";   
	var strFileCd       = "";   //파일종류코드
	var intFileCnt      = "";   //파일별 갯수
	var strOriFileNm    = "";   //파일종류명
	var strSessionNo    = "";   //세션번호
	var objDsNm         = "";   //ds
	
	dsPcUp.SetColumn(nRow, "FILE_PATH", "");      //파일 경로 초기화
	dsPcUp.SetColumn(nRow, "FILE_SEARCH", "");      //파일명 초기화
	dsPcUp.SetColumn(nRow, "ROWCNT", "");           //건수 초기화
	divBtnLst.fldImage.FileName = "";               //다이얼로그 파일명 초기화
	divBtnLst.fldImage.Type = "Open";               //다이얼로그 파일명 초기화
	
	divBtnLst.fldImage.Open();
	divBtnLst.flImage.FileName = divBtnLst.fldImage.FilePath + "\\" + divBtnLst.fldImage.FileName;
    var FILE_PATH = divBtnLst.flImage.FileName;
	divBtnLst.flImage.Open ( "t+" ); // t: text 모드, +: 읽기/쓰기
	
	strFileCd       = dsPcUp.GetColumn(nRow, "FILE_CD");
	intFileCnt      = dsPcUp.GetColumn(nRow, "FILE_CNT");
	strOriFileNm    = dsPcUp.GetColumn(nRow, "FILE_NM");
	objDsNm         = dsPcUp.GetColumn(nRow, "DS_NM");
	
	obj             = object(objDsNm);
	
	
	obj.ClearData();
	
	
	
	if (divBtnLst.fldImage.FileName = "") return;
	
	
	aryFileNm       = split(divBtnLst.fldImage.FileName, ".");
	strFileNm       = aryFileNm[0];
	strSessionNo    = aryFileNm[1];	
	
	//파일명 가지고 해당 파일이 맞는지 체크한다.
	if (strOriFileNm <> strFileNm) {    //파일명이 틀리면 return
        fnc_Message(SNIS_CRA_I001, "N");	// "해당 파일명은 등록된 파일명과 일치하지 않습니다. \n파일을 다시 선택해 주십시요. ";
        return false;
	}
	
	//처음 입력된 세션번호와 다음 입력되는 세션번호가 같은지 체크한다.
//	if (strOrisessionNo <> "") {
//        if (strOrisessionNo <> strSessionNo) {
//            fnc_Message(SNIS_CRA_I003, "N");	// "파일 확장자가 다른 파일과 다릅니다. \n파일을 다시 선택해 주십시요. ";
//            return false;
//        }
//	}
	
	
	//파일종류 가지고 데이터셋 바인딩 함수 호출
	//파람 : 파일갯수, 데이터셋명	
	
	SetWaitCursor(true); // 시스템의 Mouse Cursor를 모래시계(Wait Cursor)로 설정하거나 해제하는 Form API 입니다
	SetCapture();		// 마우스의 이동/ 눌림을 가로채서 Script와 화면에 도달하지 못하도록 하는 Form API 입니다.

	if (!fcDsBinding(nRow, objDsNm)) {   //false면 에러발생으로 return한다.
        alert("BINDING ERROR...............");
        return false;
	}
	
	//------------------------------------------------------------
	strOriSessionNo = strSessionNo;
	

	
	dsPcUp.SetColumn(nRow, "FILE_PATH", FILE_PATH);
	dsPcUp.SetColumn(nRow, "FILE_UPLOAD_NAME", divBtnLst.fldImage.FileName);
	dsPcUp.SetColumn(nRow, "FILE_SEARCH", divBtnLst.fldImage.FileName);
	dsPcUp.SetColumn(nRow, "ROWCNT", obj.RowCount());
	//trace(obj.SaveXML());
	divBtnLst.flImage.Close();
	
	SetWaitCursor(false);
    ReleaseCapture();
	
	
	
	
}

//파일내용을 읽어서 데이터셋에 바인딩 시키는 부분
function fcDsBinding(fileCnt, objNm) {        
    var strTxt;
	var arrTxt;
	var arrTxt2;
	var row;
	var i;
	var j;
	    
	obj = object(objNm);
	strTxt = divBtnLst.flImage.Read();
	arrTxt = split(strTxt,"\n","");
	
	for( i=0; i< arrTxt.length; i++ ) {	
        arrTxt2 = split(arrTxt[i],",");
		if(arrTxt2.length > 0){
            if(i==0) fcDsColumnSet(obj, arrTxt2.length);    //처음 해더 생성
            row = obj.AddRow(); 
                
            for( j=0; j< arrTxt2.length; j++) {
                obj.SetColumn(row, "column"+j, replace(arrTxt2[j],chr(13),""));            
            }
		}
		
	}   
	
	upFileCnt += 1;	
	return true;	
}



//데이터셋에 해더생성
function fcDsColumnSet(obj, colCnt) {
    var k;    
    for( k=0; k< colCnt; k++) {
        obj.AddColumn("column"+k);
    }
}

//조건 : 년도를 변경했을 경우 재조회
function fcCboOnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fcSearch();
}


function fcPcUpListOnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//재클릭했을경우 기존선택한 일자와 같은 경주일자이면  아래 이벤트 타지 않도록 한다.
//    if (dsPcUpList.GetColumn(nRow,"RACE_DAY") == edRaceDay.Text) return;
    fcInit(obj);
    fcDSPcUp(nRow); //  dsPcUp 정보 셋팅
    
}

//조회내역 클릭이 아닌 키보드 이동일 경우 클릭과 같은 이벤트 발생
function fcPcUpListOnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	fcPcUpListOnCellClick(obj, nRow);
	
	
}


// 그리드 선택 하였을 때 정보 셋팅
function fcDSPcUp(nRow)
{
	// 날짜 형태 만들기	시작 
	var arrTms = Array(4);
	arrTms[0] = dsPcUpList.GetColumn(nRow,"G_TMS");	// 경륜 회차
	arrTms[1] = dsPcUpList.GetColumn(nRow,"M_TMS");	// 경정 회차
	arrTms[2] = dsPcUpList.GetColumn(nRow,"C_TMS");	// 창원 회차
	arrTms[3] = dsPcUpList.GetColumn(nRow,"B_TMS");	// 부산 회차
	
	var arrDayOrd = Array(4);
	arrDayOrd[0] = dsPcUpList.GetColumn(nRow,"G_DAY"); // 경륜 일차
	arrDayOrd[1] = dsPcUpList.GetColumn(nRow,"M_DAY"); // 경정 일차
	arrDayOrd[2] = dsPcUpList.GetColumn(nRow,"C_DAY"); // 창원 일차
	arrDayOrd[3] = dsPcUpList.GetColumn(nRow,"B_DAY"); // 부산 일차
	
	var sTms = "";
	var sDayOrd = "";
	for(var i=0;i<arrTms.length;i++)
	{
		var tmpTms=decode(arrTms[i],null,"",arrTms[i]);
		var tmpDayOrd=decode(arrDayOrd[i],null,"",arrDayOrd[i]);
		if(tmpTms!="")
		{
			sTms	= tmpTms;
			sDayOrd	= tmpDayOrd;
		}
	}
	
	var sMeetCd = decode(arrTms[1],null,"001","","001","003");
	
	// 날짜 형태 만들기	끝
    
    var STND_YEAR = dsPcUpList.GetColumn(nRow,"STND_YEAR");
    
    edDt.Text	= dsPcUpList.GetColumn(nRow,"DT");
    edGubun.Text	= dsPcUpList.GetColumn(nRow,"GUBUN");
    
    
    var RACE_DAY	=	decode(dsPcUpList.GetColumn(nRow,"RACE_DAY"),null,"",dsPcUpList.GetColumn(nRow,"RACE_DAY"));
	
	edRaceDay.Text  = RACE_DAY;	
	
	edGtms.Text     = dsPcUpList.GetColumn(nRow,"G_TMS");
	edGday.text     = dsPcUpList.GetColumn(nRow,"G_DAY");
	edCtms.Text     = dsPcUpList.GetColumn(nRow,"C_TMS");
	edCday.text     = dsPcUpList.GetColumn(nRow,"C_DAY");
	edMtms.Text     = dsPcUpList.GetColumn(nRow,"M_TMS");
	edMday.text     = dsPcUpList.GetColumn(nRow,"M_DAY");
	edBtms.Text     = dsPcUpList.GetColumn(nRow,"B_TMS");
	edBday.text     = dsPcUpList.GetColumn(nRow,"B_DAY");
	
	
	
	if(RACE_DAY=='')
	{
		dsPcUp.Copy(dsPcUpExcept);
	}
	else
	{
		dsPcUp.Copy(dsPcUpAll);
	}
	
	
	var sGubun = "";
	
	if (edGubun.Text == "001") 
	{
        sGubun   = "경륜";
    }
    else if (edGubun.Text == "003")
    {
        sGubun   = "경정 ";
    }
    else
    {
		sGubun   = "평일 ";
    }
    
	var sDate      = STND_YEAR+"년 "+substr(edDt.Text, 0, 2)+"월 "+substr(edDt.Text, 2, 2)+"일 ";
	
	var sTmsDayOrd = sTms+"회 "+sDayOrd+"일차";
    
    stRaceDay.Text ="("+sGubun+" "+sDate+" "+sTmsDayOrd+")";
    
    
    // GITA
    dsPcUp.SetColumn(0,"DT", dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(0,"RACE_DT", dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(0,"FILE_PATH",dsPcUpList.GetColumn(nRow,"GITA_FILE_PATH"));
    dsPcUp.SetColumn(0,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"GITA_FILE_NM"));
    dsPcUp.SetColumn(0,"ROWCNT",dsPcUpList.GetColumn(nRow,"GITA_FILE_ROW_CNT"));
    
    // KTAX
    dsPcUp.SetColumn(1,"DT",dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(1,"RACE_DT",dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(1,"FILE_PATH",dsPcUpList.GetColumn(nRow,"KTAX_FILE_PATH"));
    dsPcUp.SetColumn(1,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"KTAX_FILE_NM"));
    dsPcUp.SetColumn(1,"ROWCNT",dsPcUpList.GetColumn(nRow,"KTAX_FILE_ROW_CNT"));
    
    
    // PAYO
    dsPcUp.SetColumn(2,"DT",dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(2,"RACE_DT",dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(2,"FILE_PATH",dsPcUpList.GetColumn(nRow,"PAYO_FILE_PATH"));
    dsPcUp.SetColumn(2,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"PAYO_FILE_NM"));
    dsPcUp.SetColumn(2,"ROWCNT",dsPcUpList.GetColumn(nRow,"PAYO_FILE_ROW_CNT"));
    
    
    // RESU
    dsPcUp.SetColumn(3,"DT",dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(3,"RACE_DT",dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(3,"FILE_PATH",dsPcUpList.GetColumn(nRow,"RESU_FILE_PATH"));
    dsPcUp.SetColumn(3,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"RESU_FILE_NM"));
    dsPcUp.SetColumn(3,"ROWCNT",dsPcUpList.GetColumn(nRow,"RESU_FILE_ROW_CNT"));
    
    
    // SATL
    dsPcUp.SetColumn(4,"DT", dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(4,"RACE_DT", dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(4,"FILE_PATH",dsPcUpList.GetColumn(nRow,"SATL_FILE_PATH"));
    dsPcUp.SetColumn(4,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"SATL_FILE_NM"));
    dsPcUp.SetColumn(4,"ROWCNT",dsPcUpList.GetColumn(nRow,"SATL_FILE_ROW_CNT"));
    
    // SELL
    dsPcUp.SetColumn(5,"DT",dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(5,"RACE_DT",dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(5,"FILE_PATH",dsPcUpList.GetColumn(nRow,"SELL_FILE_PATH"));
    dsPcUp.SetColumn(5,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"SELL_FILE_NM"));
    dsPcUp.SetColumn(5,"ROWCNT",dsPcUpList.GetColumn(nRow,"SELL_FILE_ROW_CNT"));
    
    
    // TELM
    dsPcUp.SetColumn(6,"DT",dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(6,"RACE_DT",dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(6,"FILE_PATH",dsPcUpList.GetColumn(nRow,"TELM_FILE_PATH"));
    dsPcUp.SetColumn(6,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"TELM_FILE_NM"));
    dsPcUp.SetColumn(6,"ROWCNT",dsPcUpList.GetColumn(nRow,"TELM_FILE_ROW_CNT"));
    
    
    // WINN
    dsPcUp.SetColumn(7,"DT",dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(7,"RACE_DT",dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
    dsPcUp.SetColumn(7,"FILE_PATH",dsPcUpList.GetColumn(nRow,"WINN_FILE_PATH"));
    dsPcUp.SetColumn(7,"FILE_SEARCH",dsPcUpList.GetColumn(nRow,"WINN_FILE_NM"));
    dsPcUp.SetColumn(7,"ROWCNT",dsPcUpList.GetColumn(nRow,"WINN_FILE_ROW_CNT"));
    
    
    
}

// 그리드 더블 클릭시 이벤트
function fcGrdOnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	switch ( obj.id ) 
	{	
		case "grdPcUpList" : // pc 파일 업로드일 경우 파일을 저장한다
			if(nCell==3)
			{
				if (dsPcUpList.GetColumn(nRow,"RACE_DAY") != "") 
				{
					var arrTms = Array(4);
					arrTms[0] = dsPcUpList.GetColumn(nRow,"G_TMS");	// 경륜 회차
					arrTms[1] = dsPcUpList.GetColumn(nRow,"M_TMS");	// 경정 회차
					arrTms[2] = dsPcUpList.GetColumn(nRow,"C_TMS");	// 창원 회차
					arrTms[3] = dsPcUpList.GetColumn(nRow,"B_TMS");	// 부산 회차
					
					var arrDayOrd = Array(4);
					arrDayOrd[0] = dsPcUpList.GetColumn(nRow,"G_DAY"); // 경륜 일차
					arrDayOrd[1] = dsPcUpList.GetColumn(nRow,"M_DAY"); // 경정 일차
					arrDayOrd[2] = dsPcUpList.GetColumn(nRow,"C_DAY"); // 창원 일차
					arrDayOrd[3] = dsPcUpList.GetColumn(nRow,"B_DAY"); // 부산 일차
					
					var sTms = "";
					var sDayOrd = "";
					for(var i=0;i<arrTms.length;i++)
					{
						var tmpTms=decode(arrTms[i],null,"",arrTms[i]);
						var tmpDayOrd=decode(arrDayOrd[i],null,"",arrDayOrd[i]);
						if(tmpTms!="")
						{
							sTms	= tmpTms;
							sDayOrd	= tmpDayOrd;
						}
					}
					
					var sMeetCd = decode(arrTms[1],null,"001","","001","003");
				
					var strParam  = " MEET_CD="+sMeetCd;
						strParam += " STND_YEAR="+dsPcUpList.GetColumn(nRow,"STND_YEAR");				
						strParam += " TMS="+sTms;
						strParam += " DAY_ORD="+sDayOrd;
						strParam += " RACE_DAY="+dsPcUpList.GetColumn(nRow,"RACE_DAY");				
						GBL_RET_VALUE=strParam; // 값 생성	
						global.FrameBottom.fcOpenMdiForm("RSM1030", "PC파일검증대장", "frm_rsm::RSM1030.xml");
				}
			}
			
			break;
	
		case "grdPcUp" : // pc 파일 업로드일 경우 파일을 저장한다
			if(nCell!=3)
			{
				return;
			}
			
			var sLocalFileName  = fcd_GetSelectPCFile("Save", dsPcUp.GetColumn(nRow, "FILE_SEARCH")); // 파일명
			// 파일 바로 열때..
			//var sLocalFileName  = fcd_GetSelectFile("Save", dsPcUp.GetColumn(nRow, "FILE_SEARCH")); // 파일명
			var sServerFileName = dsPcUp.GetColumn(nRow, "FILE_PATH");	// 파일 경로
			var sFileSize       = 0;
			if ( sLocalFileName == null ) return;
		
			fnc_PCFileRead(divBtnLst.HttpFile, sLocalFileName[0] + "\\" + sLocalFileName[1], sServerFileName, sFileSize, nRow, "PROG_BAR", dsPcUp);
			// 파일 바로 열때..
			//fnc_FileRead(divBtnLst.HttpFile,   sLocalFileName[0] + "\\" + sLocalFileName[1], sServerFileName, sFileSize, nRow, "PROG_BAR", dsPcUp);

			break;
	}
}


//  평일 환급 날짜 변경시
function fcOnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{	
	if(strColumnID == "DT")
	{
	
		if(dsPcUpList.GetRowType(nRow) == "insert"){
			if(varOldValue != varNewValue){
				for(var i=0;i<dsPcUpList.GetRowCount();i++)
				{
					if(i != nRow && dsPcUpList.GetColumn(i,"DT")  == dsPcUpList.GetColumn(nRow, "DT")){
						fnc_Message(SNIS_RBM_D009,"N");
						
						dsPcUpList.SetColumn(nRow,"DT",varOldValue);
						return;
					}
				
				}
			
			}
		
    	}

    
		var sOldValue = decode(varOldValue,null,'',varOldValue);
		var sNewValue = decode(varNewValue,null,'',varNewValue);
		if(sOldValue !="" && sOldValue!=varNewValue)
		{
			for(var i=0;i<dsPcUp.rowcount;i++)
			{
				dsPcUp.SetColumn(i,"DT", dsPcUpList.GetColumn(nRow,"DT"));
				dsPcUp.SetColumn(i,"RACE_DT",dsPcUpList.GetColumn(nRow,"STND_YEAR")+dsPcUpList.GetColumn(nRow,"DT"));
			}
			
		}
	}
}


// 행 변경시
function fcOnRowPosChanged(obj,nOldRow,nRow)
{
	strOrisessionNo = "";
}


// 2차원 배열의 변수 값 확인
function fcArray2Value(arr2Param,strParam)
{
	var strResult = "";
	for(var i=0;i<arr2Param.length;i++)
	{	
		for(var j=0;j<arr2Param[i].length;j++)
		{
			if(arr2Param[i][0]==strParam)
			{
				strResult = arr2Param[i][1];
			}
		}
	}
	return strResult;
}

// 특정콤포넌트(그리드) 리사이즈
function fcSetResize(obj,nX)
{	
	var arrObj = array(-1);
	arrObj[0] = "grdPcUpList";
	arrObj[1] = "grdPcUp";
	
	var nWidth = nX-8;
	if( nX <= 820){
		for( var i=0; i<length(arrObj); i++){
			object(arrObj[i]).Autofit = false;		
			object(arrObj[i]).width = 801;
			object(arrObj[i]).Redraw;
		}
		Shape1.Width = 801;	
		divBtnLst.Left = this.width - 393;			
		btnIns.Left = this.width - 114;
		return;
	}
	
	for( var i=0; i<length(arrObj); i++){
	
		object(arrObj[i]).right = nWidth;
		if( i == 0){
			if( nX < 1120) object(arrObj[i]).Autofit = false;		
			else object(arrObj[i]).Autofit = true;		
		}else{
			object(arrObj[i]).Autofit = true;		
		}
	}	
		
	// 공통
	Shape1.Width = nWidth-8;
	divBtnLst.Left = this.width - 393;	
	btnIns.Left = this.width - 114;
}

// 해당 폼사이즈 변경시
function fcOnSize(obj,nCx,nCy,nState)
{
	
	fcSetResize(obj,nCx);

}


]]></Script>
</Window>