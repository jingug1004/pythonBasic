<?xml version="1.0" encoding="euc-kr"?>
<Window>
	<Form BorderColor="MENU" Height="704" Id="comHelpPopup" Left="8" OnActivate="comHelpPopup_OnActivate" OnLoadCompleted="fcFormLoadSetting" PidAttrib="7" Title="[도움말]" Top="8" Ver="1.0" Width="1008" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsCode">
				<Contents>
					<colinfo id="CD" size="256" type="STRING"/>
					<colinfo id="CD_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsOutUserMn">
				<Contents>
					<colinfo id="MN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORD_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="UP_MN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="SCRN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="URL" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="LVL" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="color" size="256" summ="default" type="STRING"/>
					<colinfo id="MN_LEVEL" size="256" summ="default" type="STRING"/>
					<colinfo id="UPUP_MN_ID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<WebBrowser Border="SunkenEdge" Height="664" Id="WB" Left="253" TabOrder="1" Top="32" Width="755"></WebBrowser>
		<TreeView BindDataset="dsOutUserMn" Border="Flat" BorderColor="user1" Color="user4" Expand="FALSE" Height="662" Id="trvMnGrp" ImageColumn="LVL" ImageID="treeImage" ImageIndex="0" InnerImageCount="4" Left="-1" LevelColumn="LVL" OnClick="trvMnGrp_OnClick" OnDblClick="trvMnGrp_OnDblClick" TabOrder="2" TEXTColumn="MN_NM" Top="32" Width="255"></TreeView>
		<Image Height="32" Id="Image0" ImageID="c_topbg01" LeftMargin="0" TabOrder="3" Width="1008"></Image>
		<Image Color="black" Cursor="HAND" Height="20" Id="ImgConfirm" ImageID="btn_txt_02" Left="902" OnClick="ImgPrintOnClick" Static="FALSE" TabOrder="4" Text="출력" Top="9" Width="51"></Image>
		<Image Color="black" Cursor="HAND" Height="20" Id="Image1" ImageID="btn_txt_02" Left="954" OnClick="ImgConfirm_OnClick" Static="FALSE" TabOrder="5" Text="&#32;닫기" Top="9" Width="51"></Image>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                      *
123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
***************************************************************************************************/

/************************
*  공통 Script Include  *
************************/
#include "lib::rbm_common_script.js";
#include "lib::rbm_app_script.js";


/*********************
*  화면 변수 선언부  *
*********************/
var sSearchKind     = "";                                 //본 화면에선 사용하지않음
var sInputValue     = "";                                 //기본 검색 조건
var sCommonGubn     = "";                                 //본 화면에선 사용하지않음 

var sDivCodeType    = "";
var sDivCodeGubun   = "";
var sHelpURL        = GBL_SERVER_URL+"help/";  //차후 서버 경로로 바꿔야 한다.
var tmpMenuId       = "";
var sUserID = gdsUser.GetColumn(0,"USER_ID");
/*-----------------------------------+
|  최초 화면 Load時 처리 할 사항     |
+------------------------------------*/
function fcFormLoadSetting(obj){  
	fcSearch();     
}


/*-------------------------------------------------------------------------------------------------+
>>  조회 처리
+-------------------------------------------------------------------------------------------------*/
function fcSearch() {  
    
	var sServiceName = "common_login-service:searchUserMn";
    var sInDataSet   = "";
    var sOutDataSet  = "dsOutUserMn=dsOutUserMn "; 

	fcd_AddParam("USER_ID", sUserID);
	
	fcd_SendTransaction(sServiceName, sInDataSet, sOutDataSet, "fcCallBack", false);
}

function fcPageCall(pMenuId){

    WB.PageUrl = sHelpURL+pMenuId+".mht";
    WB.Run();
}

//닫기
function ImgConfirm_OnClick(obj,nX,nY)
{
	Close(false);
}

//인쇄
function ImgPrintOnClick(obj,nX,nY)
{
	WB.Print();
}

function fcCancel(obj)
{
	Close(false);
}

function trvMnGrp_OnDblClick(obj,nRow)
{
	if (fnc_IsNull(dsOutUserMn.GetColumn(nRow,"SCRN_ID"))) return;
	WB.PageUrl = sHelpURL+dsOutUserMn.GetColumn(nRow,"MN_ID")+".mht";
    WB.Run();
}

function trvMnGrp_OnClick(obj,nOldRow,nNewRow)
{
/*
    if(LENGTH(dsOutUserMn.GetColumn(nNewRow,"URL")) >0){
    	WB.PageUrl = sHelpURL+dsOutUserMn.GetColumn(nNewRow,"MN_ID")+".mht";
		WB.Run();
    }
*/
}

/*-------------------------------------------------------------------------------------------------+
>>  Transaction 후 처리 해야 할 내용!
+-------------------------------------------------------------------------------------------------*/
function fcCallBack(sServiceName, ErrorCode, ErrorMSG) {
    if(sServiceName == "common_login-service:searchUserMn")
    {        
		// 도움말 화면 오픈시, 디폴트로 활성창의 도움말을 불러온다.
		dsOutUserMn.row = dsOutUserMn.FindRowNF("MN_ID", GBL_MENUID);
		trvMnGrp_OnDblClick(this, dsOutUserMn.row);
		/*
        Tab0_tab1_tv_menu_OnDblClick(Tab0.tab1.tv_menu, ds_menuForMnl.row);
        
		WB.PageUrl = sHelpURL+GBL_MENUID+".mht";
		WB.Run();
		*/
    }
}



function setHelpId(sMenuId)
{
	dsOutUserMn.row = dsOutUserMn.FindRowNF("MN_ID", sMenuId);
	trvMnGrp_OnDblClick(this, dsOutUserMn.row);
}]]></Script>
</Window>