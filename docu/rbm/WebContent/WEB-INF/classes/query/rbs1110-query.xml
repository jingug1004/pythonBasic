<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="rbs1110(명예심판 차수 관리 )">
  <query id="rbs1110_s01" desc="기준 년도  조회" fetchSize="10">
      <![CDATA[
            SELECT /* RBS1110_S01 */
                   SUBSTR(STND_YEAR,1,4) AS CD
                  ,SUBSTR(STND_YEAR,1,4)||'년' AS CD_NM
			FROM   TBRS_HNR_REFRE_TMS
			WHERE  MEET_CD = ?
			UNION
			SELECT TO_CHAR(SYSDATE, 'YYYY')
			      ,TO_CHAR(SYSDATE, 'YYYY')||'년'
			FROM DUAL 
			ORDER BY 1 DESC
        ]]>
    </query>       
    
    <query id="rbs1110_s02" desc="명예심판 차수  조회 " fetchSize="10">
      <![CDATA[
            SELECT /* rbs1110_s02 */
                   '' AS CHK
                   ,A.MEET_CD
			       ,A.STND_YEAR
			       ,A.TMS
			       ,A.EVENT_DY
			       ,A.RMK
			       ,(SELECT NVL(COUNT(*),0) 
			         FROM   TBRS_HNR_REFRE_WNR B 
			         WHERE  B.MEET_CD = A.MEET_CD 
			         AND    B.STND_YEAR=A.STND_YEAR 
			         AND    B.TMS=A.TMS) AS WNR_CNT
			FROM  TBRS_HNR_REFRE_TMS A 
			WHERE 1=1                                        
			AND A.MEET_CD    = ?                               
			AND A.STND_YEAR  = ?                               
			ORDER BY 2,3,4 
        ]]>
    </query>       
    
    <query id="rbs1110_i01" desc="명예심판 차수 조회 " fetchSize="10">
      <![CDATA[
			INSERT /* rbs1110_i01 */
			       INTO TBRS_HNR_REFRE_TMS
			       (MEET_CD, STND_YEAR, TMS, EVENT_DY, RMK, INST_ID, INST_DT)
			VALUES
			       (?, ?, (SELECT NVL(MAX(TMS),0)+1 FROM TBRS_HNR_REFRE_TMS WHERE MEET_CD = ? AND STND_YEAR = ?), ?, ?, ?, SYSDATE)
        ]]> 
    </query>    
    
    
    <query id="rbs1110_u01" desc="명예심판 차수  수정 " fetchSize="10">
      <![CDATA[           
           UPDATE  /* rbs1110_u01 */      
                   TBRS_HNR_REFRE_TMS 
           SET     EVENT_DY  = ?
                  ,RMK       = ?
                  ,UPDT_ID   = ?
                  ,UPDT_DT   = SYSDATE
           WHERE   MEET_CD   = ?
               AND STND_YEAR = ?
               AND TMS       = ?      
        ]]>
    </query>    
        
    <query id="rbs1110_d01" desc="명예심판 차수  삭제 " fetchSize="10">
      <![CDATA[           
           DELETE  /* rbs1110_d01 */      
                   FROM TBRS_HNR_REFRE_TMS 
           WHERE   MEET_CD   = ?
               AND STND_YEAR = ?
               AND TMS       = ?      
        ]]>
    </query>    
        
</queryMap>