<?xml version="1.0" encoding='EUC-KR'?>

<queryMap desc="RSY7020(알림관리)">
    <query id="rsy7020_s01" desc="알림담당자 조회" fetchSize="10">
      <![CDATA[
            SELECT  /*rsy7020_s01*/
                     A.GBN          --구분코드
                    ,A.USER_ID      --사용자ID
                    ,A.USER_NM      --사용자명
                    ,A.EMAIL        --이메일
                    ,A.HP_NO        --이동전화번호
                    ,A.TEL_NO       --전화번호
                    ,A.FLOC         --직위
                    ,A.FGRADE       --직급
                    ,A.BRNC_CD      --지점코드
                    ,A.ASSO_CD      --대분류코드
                    ,A.DEPT_CD      --부서코드
                    ,A.TEAM_CD      --팀코드
                    ,A.ASSO_NM      --대분류명
                    ,A.DEPT_NM      --부서명
                    ,A.TEAM_NM      --팀명
                    ,A.INST_ID      --작성자
                    ,A.INST_DT      --작성일시
                    ,A.UPDT_ID      --수정자
                    ,A.UPDT_DT      --수정일시
			        ,DECODE(B.RECV_ID,NULL,'N','Y') ALARM_YN
			        ,DECODE(B.RECV_ID,NULL,'0','1') CHK
			        ,B.RECV_ID
              FROM  TBRK_USER A       --사용자 관리
                     ,(SELECT * 
			            FROM TBRK_ALARM 
			            WHERE ALARM_CD = ?  
			             AND ALARM_GBN = ? ) B
             WHERE  1 = 1
                AND  A.USER_ID = B.RECV_ID(+)
                AND  A.USER_NM LIKE  '%' || NVL(? , A.USER_NM) || '%' 
                AND  A.TEAM_CD LIKE  '%' || NVL(? , A.TEAM_CD) || '%'  
             ORDER BY  DECODE(B.RECV_ID,NULL,'1','0'), A.DISP_ORDER 
                    
        ]]>
    </query>
    <query id="rsy7020_i01" desc="알림담당자 입력" fetchSize="10">

            INSERT INTO TBRK_ALARM (  /* rsy7020_i01 */

                 ALARM_CD     --알람코드
                ,ALARM_GBN    --알람구분코드
                ,RECV_ID      --받는사람ID

                ,INST_ID      --작성자ID
                ,INST_DT      --작성일시
                ,UPDT_ID      --수정자ID
                ,UPDT_DT      --수정일시

            ) VALUES (

                  ?             -- ALARM_CD
                , ?             -- ALARM_GBN
                , ?             -- RECV_ID
                                         
                , ?             -- INST_ID              
                , SYSDATE       -- INST_DT
                , ?             -- UPDT_ID              
                , SYSDATE       -- UPDT_DT
            )

    </query> 
    
    <query id="rsy7020_d01" desc="알림담당자 삭제" fetchSize="10">

            DELETE FROM TBRK_ALARM
            WHERE ALARM_CD = ?      -- 알림코드
                AND RECV_ID = ?     -- 받는사람ID
                AND ALARM_GBN = ?   -- 알람구분코드

    </query> 
</queryMap>