<!DOCTYPE html>
<html lang="en">

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>발그레 | 관리자페이지</title>

   	#parse ("/admin/layout/common_css.vm")	
   	
   	<link href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css" rel="stylesheet">
   	<link href="https://cdn.datatables.net/buttons/1.2.4/css/buttons.dataTables.min.css" rel="stylesheet">
   	<link href="https://cdn.datatables.net/buttons/1.2.4/css/buttons.bootstrap.min.css" rel="stylesheet">
   	<link href="https://cdn.datatables.net/select/1.2.1/css/select.dataTables.min.css" rel="stylesheet">
	<link href="https://cdn.datatables.net/responsive/2.0.2/css/responsive.dataTables.min.css" rel="stylesheet" />
  </head>

<body class="nav-md">
	<div class="container body">
		<div class="main_container">
			#parse ("/admin/layout/header.vm")
			  <!-- page content -->
        <div class="right_col" role="main">
          <div class="">
            <div class="clearfix"></div>

            <div class="row">
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>1:1문의 <small>답변</small></h2>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
					<form class="form-horizontal form-label-left">
						<div class="item form-group">
							<label class="control-label col-md-3 col-sm-3 col-xs-12">작성자</label>
							<div class="col-md-6 col-sm-6 col-xs-12">
                        		<input type="text" class="form-control" readonly="readonly" value="$!{qna.user.name}">
                        	</div>
                      	</div>
                      	<div class="item form-group">
							<label class="control-label col-md-3 col-sm-3 col-xs-12" for="description">연락처 </label>
                        	<div class="col-md-6 col-sm-6 col-xs-12">
                        		<input type="text" class="form-control" readonly="readonly" value="$!{qna.user.phone}">
                        	</div>
                      	</div>
                      	<div class="item form-group">
							<label class="control-label col-md-3 col-sm-3 col-xs-12" for="description">이메일</label>
                        	<div class="col-md-6 col-sm-6 col-xs-12">
                        		<input type="text" class="form-control" readonly="readonly" value="$!{qna.user.email}">
                        	</div>
                      	</div>
                      	<div class="item form-group">
							<label class="control-label col-md-3 col-sm-3 col-xs-12" for="description">작성일</label>
                        	<div class="col-md-6 col-sm-6 col-xs-12">
                        		<input type="text" class="form-control" readonly="readonly" value="$!{qna.regDate}">
                        	</div>
                      	</div>
                      	<div class="item form-group">
                      		<label class="control-label col-md-3 col-sm-3 col-xs-12" for="type">제목</label>
                        	<div class="col-md-6 col-sm-6 col-xs-12">
	                      		<input type="text" class="form-control" readonly="readonly" value="$!{qna.subject}">
	                    	</div>
                      	</div>
                      	<div class="item form-group">
                      		<label class="control-label col-md-3 col-sm-3 col-xs-12" for="type">문의분류1</label>
                        	<div class="col-md-6 col-sm-6 col-xs-12">
	                      		<input type="text" class="form-control" readonly="readonly" value="$!{qna.qnaClass1}">
	                    	</div>
                      	</div>
                      	<div class="item form-group">
                      		<label class="control-label col-md-3 col-sm-3 col-xs-12" for="type">문의분류2</label>
                        	<div class="col-md-6 col-sm-6 col-xs-12">
	                      		<input type="text" class="form-control" readonly="readonly" value="$!{qna.qnaClass2}">
	                    	</div>
                      	</div>
                      	<div class="item form-group">
                        	<label class="control-label col-md-3 col-sm-3 col-xs-12" for="subject">이미지</label>
                        	<div class="col-md-6 col-sm-6 col-xs-12">
                        		#foreach( $photo in $qna.qnaPhoto )
                        			<img src="$!{image_url}$!{photo.photoPath}">
	                      		#end
                 			</div>
                 		</div>
                      	<div class="item form-group">
	                        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="description">내용</label>
    	                    <div class="col-md-6 col-sm-6 col-xs-12">
    	                    	<div class="bs-example" data-example-id="simple-jumbotron">
				                    <div class="jumbotron">
				                      <p>$!{qna.content}</p>
				                    </div>
				                  </div>
            	            </div>
                	    </div>
                	    <div class="form-group">
                    		<label class="control-label col-md-3 col-sm-3 col-xs-12">답글</label>
                    		<div class="col-md-6 col-sm-6 col-xs-12">
                      			<textarea id="reply" class="resizable_textarea form-control" placeholder="답글을 입력하세요." required="required">$!{qna.reply_content}</textarea>
                    		</div>
                  		</div>
                      <div class="ln_solid"></div>
                      <div class="form-group">
                        <div class="col-md-6 col-md-offset-3">
                        	<button type="button" class="btn btn-primary" onclick="javascript:history.back();">취소</button>
                          	<button id="send" type="submit" class="btn btn-success">답변하기</button>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- /page content -->
		#parse ("/admin/layout/footer.vm")
	</div>
</div>

	#parse ("/admin/layout/common_js.vm")
	
  <!-- Autosize -->
    <script>
      $(document).ready(function() {
        autosize($('.resizable_textarea'));
      });
    </script>
    <!-- /Autosize -->

	<!-- validator -->
	<script>
      // initialize the validator function
      validator.message.date = 'not a real date';

      // validate a field on "blur" event, a 'select' on 'change' event & a '.reuired' classed multifield on 'keyup':
      $('form')
        .on('blur', 'input[required], input.optional, select.required', validator.checkField)
        .on('change', 'select.required', validator.checkField)
        .on('keypress', 'input[required][pattern]', validator.keypress);

      $('.multi.required').on('keyup blur', 'input', function() {
        validator.checkField.apply($(this).siblings().last()[0]);
      });

      $('form').submit(function(e) {
        e.preventDefault();
        var submit = true;

        // evaluate the form using generic validaing
        if (!validator.checkAll($(this))) {
          submit = false;
        }
        
        if (submit)
        	insertData();
        	
          //this.submit();

        return false;
      });

	function insertData() {
		var data = new FormData();
		data.append("id", "$!{qna.id}");
		data.append("reply", $("#reply").val());

		
		$.ajax({
			url: 'reply_proc',
			processData: false,
			contentType: false,
			data: data,
			type: 'POST',
			success: function(result){
				bootbox.alert("답글이 등록 되었습니다.", function() {
					window.location.reload(true);
				});
			},
			 error: function(){
				 bootbox.alert("오류가 발생였습니다.\n잠시 후 다시 시도해 주세요.", function() {});
			 }
		});
    }
    </script>
    <!-- /validator -->
</body>
</html>